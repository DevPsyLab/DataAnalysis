<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.84      6.96    15.23    42.88 1.00     1649     2420
sd(Days)                6.55      1.50     4.16    10.02 1.00     1505     2276
cor(Intercept,Days)     0.09      0.31    -0.48     0.69 1.00     1038     1586

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.57      7.27   237.24   266.14 1.00     2044     2261
Days         10.41      1.67     6.95    13.72 1.00     1509     1994

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.57    23.07    29.23 1.00     2850     2798

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9886  13.06689 228.0643 279.5447
309 211.4635  13.32323 185.3592 237.6370
310 213.0251  13.66457 185.6706 238.9975
330 274.6266  13.45710 248.6027 301.3646
331 272.7698  12.93547 248.4559 298.4785
332 260.4220  12.02211 237.3326 284.3410
333 268.2351  13.03986 243.2533 294.7380
334 244.5806  12.21006 220.6206 268.1200
335 250.4325  13.56817 224.3897 278.0941
337 285.7712  12.95631 260.6857 311.8310
349 226.7842  13.32969 199.4413 252.8487
350 238.9984  13.23687 212.7875 264.0116
351 255.9483  12.35789 232.6590 280.5892
352 271.9972  12.77473 246.4559 296.7653
369 254.6142  12.00480 231.0412 278.1235
370 226.6784  13.56291 199.6605 252.7066
371 252.0830  12.59818 227.9145 277.2045
372 263.6789  12.09456 239.9720 287.8670

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6191972  2.497940 14.86717365 24.445058
309  1.7654717  2.530045 -3.21146859  6.547570
310  4.9369092  2.539905 -0.01836614  9.951118
330  5.7531475  2.495844  0.82085873 10.641706
331  7.5194187  2.462057  2.68129328 12.254758
332 10.1592662  2.326332  5.38949556 14.662297
333 10.2805841  2.423433  5.36415667 14.851028
334 11.4424856  2.342545  6.95426348 16.018808
335 -0.1901964  2.614876 -5.31429980  4.764908
337 19.1776328  2.470038 14.29948723 23.988450
349 11.5219708  2.496785  6.60939264 16.456249
350 16.9460562  2.562953 12.03977286 22.076461
351  7.4556631  2.373577  2.78957103 11.925132
352 14.0454755  2.416413  9.19714992 18.872049
369 11.3470450  2.307456  6.95353355 16.122057
370 15.1671620  2.565597 10.22876211 20.356209
371  9.4784869  2.368249  4.70741275 14.138621
372 11.7785393  2.277205  7.26676984 16.085248</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9886 13.066887 228.0643 279.5447
  [2,] 273.6078 11.176802 251.6478 295.4124
  [3,] 293.2270  9.569624 274.7798 312.0549
  [4,] 312.8462  8.409155 296.3967 329.1393
  [5,] 332.4654  7.894902 316.7910 347.6716
  [6,] 352.0846  8.150121 335.7012 367.7807
  [7,] 371.7037  9.110372 353.7900 389.1685
  [8,] 391.3229 10.585494 370.8646 412.0083
  [9,] 410.9421 12.392978 386.9805 435.1849
 [10,] 430.5613 14.408280 402.8108 459.1377
 [11,] 211.4635 13.323234 185.3592 237.6370
 [12,] 213.2289 11.419500 190.5066 235.8237
 [13,] 214.9944  9.803248 195.5595 234.2028
 [14,] 216.7599  8.637396 199.6780 233.3371
 [15,] 218.5254  8.118362 202.2281 234.3274
 [16,] 220.2908  8.367392 203.6170 236.7751
 [17,] 222.0563  9.323141 203.7799 240.3696
 [18,] 223.8218 10.799580 202.9577 245.2564
 [19,] 225.5872 12.615195 201.0664 250.1946
 [20,] 227.3527 14.644372 198.7586 256.0814
 [21,] 213.0251 13.664566 185.6706 238.9975
 [22,] 217.9620 11.720087 194.5813 240.0994
 [23,] 222.8989 10.045035 203.1586 241.8618
 [24,] 227.8358  8.794729 210.6544 244.6773
 [25,] 232.7727  8.166641 216.9087 248.7655
 [26,] 237.7096  8.303194 221.9902 254.4256
 [27,] 242.6465  9.170292 224.9570 261.0985
 [28,] 247.5835 10.589982 227.1923 269.0241
 [29,] 252.5204 12.373497 228.1926 277.1836
 [30,] 257.4573 14.386151 228.9589 286.0252
 [31,] 274.6266 13.457102 248.6027 301.3646
 [32,] 280.3798 11.543463 257.8986 303.6317
 [33,] 286.1329  9.892824 266.5690 305.6464
 [34,] 291.8860  8.656955 275.0559 309.0211
 [35,] 297.6392  8.029710 281.6596 313.4354
 [36,] 303.3923  8.152797 287.5122 319.2209
 [37,] 309.1455  8.995467 291.3772 326.5063
 [38,] 314.8986 10.383989 294.5024 335.0840
 [39,] 320.6518 12.132374 296.8626 344.5242
 [40,] 326.4049 14.107454 299.1739 354.3349
 [41,] 272.7698 12.935469 248.4559 298.4785
 [42,] 280.2893 11.088435 259.3767 302.1459
 [43,] 287.8087  9.523858 269.6151 306.6106
 [44,] 295.3281  8.401060 279.2355 311.8992
 [45,] 302.8475  7.910449 287.5322 318.4913
 [46,] 310.3669  8.166765 294.1690 326.5644
 [47,] 317.8864  9.107159 299.9245 335.6515
 [48,] 325.4058 10.550265 304.6969 345.9375
 [49,] 332.9252 12.320686 308.6685 356.6090
 [50,] 340.4446 14.297341 312.1864 367.9248
 [51,] 260.4220 12.022109 237.3326 284.3410
 [52,] 270.5812 10.375427 250.2645 291.2968
 [53,] 280.7405  9.032803 262.6868 298.8558
 [54,] 290.8998  8.145993 274.4821 307.1339
 [55,] 301.0590  7.870611 285.3933 316.4894
 [56,] 311.2183  8.267978 295.1202 327.3406
 [57,] 321.3775  9.251813 303.6920 339.6572
 [58,] 331.5368 10.660969 310.6638 352.7304
 [59,] 341.6961 12.350713 317.6036 366.1597
 [60,] 351.8553 14.221379 323.7834 379.7250
 [61,] 268.2351 13.039859 243.2533 294.7380
 [62,] 278.5157 11.227903 256.9341 301.0964
 [63,] 288.7963  9.687093 269.7934 307.9766
 [64,] 299.0769  8.565032 282.1898 316.0568
 [65,] 309.3574  8.039020 293.5228 324.9458
 [66,] 319.6380  8.224230 303.6349 335.7624
 [67,] 329.9186  9.077232 312.1756 347.8920
 [68,] 340.1992 10.435535 319.5741 360.4849
 [69,] 350.4798 12.130569 326.0003 373.8058
 [70,] 360.7604 14.040906 332.5585 387.4277
 [71,] 244.5806 12.210055 220.6206 268.1200
 [72,] 256.0231 10.528912 234.8332 276.6144
 [73,] 267.4656  9.143608 248.9045 285.7169
 [74,] 278.9081  8.205375 262.9362 295.3005
 [75,] 290.3506  7.875647 275.0221 306.0838
 [76,] 301.7931  8.227910 285.9176 318.2869
 [77,] 313.2356  9.184020 295.2740 331.4614
 [78,] 324.6780 10.581539 303.7425 345.3659
 [79,] 336.1205 12.270564 311.7012 360.0505
 [80,] 347.5630 14.147069 319.4649 374.9252
 [81,] 250.4325 13.568168 224.3897 278.0941
 [82,] 250.2423 11.533819 228.5053 273.7854
 [83,] 250.0521  9.779465 231.3821 270.1936
 [84,] 249.8620  8.480686 233.3498 266.9143
 [85,] 249.6718  7.866467 234.2882 265.1826
 [86,] 249.4816  8.094178 233.6611 265.1164
 [87,] 249.2914  9.100840 231.4104 267.0450
 [88,] 249.1012 10.668177 228.2066 269.8790
 [89,] 248.9110 12.588482 224.2796 273.4288
 [90,] 248.7208 14.724296 219.3902 277.3215
 [91,] 285.7712 12.956307 260.6857 311.8310
 [92,] 304.9488 11.112984 283.4759 327.1631
 [93,] 324.1265  9.556835 305.4590 342.8023
 [94,] 343.3041  8.448075 326.5491 360.3659
 [95,] 362.4817  7.975526 346.6438 378.5416
 [96,] 381.6594  8.249257 365.5560 397.9105
 [97,] 400.8370  9.202915 383.3383 418.9513
 [98,] 420.0146 10.655479 399.2911 441.2264
 [99,] 439.1923 12.433301 414.8571 463.7478
[100,] 458.3699 14.416550 430.1660 486.6977
[101,] 226.7842 13.329692 199.4413 252.8487
[102,] 238.3061 11.436359 215.3844 260.4496
[103,] 249.8281  9.816710 230.4349 268.9636
[104,] 261.3501  8.626306 244.5855 278.3722
[105,] 272.8720  8.057691 257.2802 288.9098
[106,] 284.3940  8.240600 268.6804 300.8613
[107,] 295.9160  9.129977 277.8128 313.4206
[108,] 307.4380 10.548618 285.9658 327.5902
[109,] 318.9599 12.314953 294.1901 342.7388
[110,] 330.4819 14.300723 301.9258 358.2097
[111,] 238.9984 13.236873 212.7875 264.0116
[112,] 255.9444 11.276574 233.7932 277.5782
[113,] 272.8905  9.604421 253.9867 291.6207
[114,] 289.8365  8.394412 273.2003 306.0238
[115,] 306.7826  7.862878 291.2673 321.8151
[116,] 323.7286  8.143771 307.5871 339.4774
[117,] 340.6747  9.162676 322.5864 358.8379
[118,] 357.6208 10.711009 336.9785 379.0028
[119,] 374.5668 12.595009 350.4377 399.5991
[120,] 391.5129 14.686056 363.2399 420.9494
[121,] 255.9483 12.357894 232.6590 280.5892
[122,] 263.4040 10.652545 243.3515 284.5259
[123,] 270.8597  9.246816 253.3836 288.9123
[124,] 278.3153  8.294470 262.3926 294.5995
[125,] 285.7710  7.959937 270.4447 301.6338
[126,] 293.2266  8.318094 276.8734 309.6355
[127,] 300.6823  9.289162 282.3506 318.5654
[128,] 308.1380 10.707666 286.9697 328.8470
[129,] 315.5936 12.421249 290.7914 339.6181
[130,] 323.0493 14.324401 294.1588 350.8766
[131,] 271.9972 12.774728 246.4559 296.7653
[132,] 286.0426 11.004879 264.0258 307.5021
[133,] 300.0881  9.523611 280.8459 318.4677
[134,] 314.1336  8.483458 297.2309 330.3469
[135,] 328.1791  8.057112 311.9575 343.6743
[136,] 342.2245  8.339254 325.5618 358.2403
[137,] 356.2700  9.265385 338.1890 374.0528
[138,] 370.3155 10.669098 349.8487 390.9024
[139,] 384.3610 12.389110 360.2761 408.3228
[140,] 398.4064 14.311833 370.1366 425.8310
[141,] 254.6142 12.004798 231.0412 278.1235
[142,] 265.9612 10.351213 245.9073 286.5838
[143,] 277.3082  8.990480 259.6886 295.2463
[144,] 288.6553  8.072086 272.8315 304.2802
[145,] 300.0023  7.754812 285.1223 314.8735
[146,] 311.3494  8.109523 295.5575 326.8970
[147,] 322.6964  9.057611 305.0669 340.1794
[148,] 334.0435 10.438629 313.7456 354.0518
[149,] 345.3905 12.105302 322.0411 369.1435
[150,] 356.7376 13.955659 330.0818 384.8316
[151,] 226.6784 13.562911 199.6605 252.7066
[152,] 241.8456 11.581743 218.9863 263.7359
[153,] 257.0128  9.873478 237.5305 275.8370
[154,] 272.1799  8.602265 255.1037 289.0258
[155,] 287.3471  7.979782 271.7380 302.9544
[156,] 302.5142  8.155946 286.4803 318.4925
[157,] 317.6814  9.084413 299.9012 335.5484
[158,] 332.8486 10.568739 312.2908 353.4113
[159,] 348.0157 12.411064 323.2575 371.9441
[160,] 363.1829 14.475336 334.1866 391.2569
[161,] 252.0830 12.598180 227.9145 277.2045
[162,] 261.5615 10.870931 240.4839 283.0608
[163,] 271.0399  9.426417 252.9718 289.9117
[164,] 280.5184  8.411584 264.2816 297.2006
[165,] 289.9969  7.991830 274.7801 305.7847
[166,] 299.4754  8.258400 283.1784 315.5414
[167,] 308.9539  9.151512 290.9307 326.8146
[168,] 318.4324 10.512678 297.3123 338.9268
[169,] 327.9109 12.186051 303.3328 351.7851
[170,] 337.3893 14.060600 309.0850 364.9818
[171,] 263.6789 12.094564 239.9720 287.8670
[172,] 275.4574 10.448684 254.7478 296.4774
[173,] 287.2360  9.079804 269.1788 305.6458
[174,] 299.0145  8.129084 282.8921 315.0625
[175,] 310.7930  7.751936 295.6687 326.2695
[176,] 322.5716  8.029592 306.5861 338.3465
[177,] 334.3501  8.900983 316.4876 351.5131
[178,] 346.1286 10.215282 325.5534 365.9608
[179,] 357.9072 11.825726 334.4393 380.6700
[180,] 369.6857 13.627727 342.4922 396.0539</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.4285661 13.066887  -29.98474211  21.4956669
  [2,]  -14.9030633 11.176802  -36.70772473   7.0569143
  [3,]  -42.4263605  9.569624  -61.25428225 -23.9791505
  [4,]    8.5936422  8.409155   -7.69952054  25.0430507
  [5,]   24.3865450  7.894902    9.18034761  40.0609462
  [6,]   62.6055478  8.150121   46.90936712  78.9889413
  [7,]   10.5000505  9.110372   -6.96467510  28.4137721
  [8,] -101.1743467 10.585494 -121.85965022 -80.7160093
  [9,]   19.6431560 12.392978   -4.59963272  43.6047802
 [10,]   35.7921588 14.408280    7.21578481  63.5426521
 [11,]   11.2704235 13.323234  -14.90308494  37.3746992
 [12,]   -7.9631482 11.419500  -30.55786105  14.7591569
 [13,]  -12.0166198  9.803248  -31.22497287   7.4182556
 [14,]  -12.0528915  8.637396  -28.63008304   5.0289673
 [15,]  -10.8092632  8.118362  -26.61132735   5.4880020
 [16,]   -4.3290349  8.367392  -20.81327393  12.3447516
 [17,]   -8.4260066  9.323141  -26.73930685   9.8503745
 [18,]   -6.0945783 10.799580  -27.52922185  14.7695241
 [19,]   -1.2915500 12.615195  -25.89892310  23.2293460
 [20,]    9.9614784 14.644372  -18.76724853  38.5556476
 [21,]  -13.9711924 13.664566  -39.94364417  13.3832951
 [22,]  -23.6298015 11.720087  -45.76717225  -0.2491101
 [23,]   11.4210893 10.045035   -7.54176971  31.1614228
 [24,]    5.0057801  8.794729  -11.83566214  22.1872142
 [25,]   -3.4653291  8.166641  -19.45807865  12.3986795
 [26,]  -17.2517383  8.303194  -33.96767791  -1.5322581
 [27,]   -7.2257475  9.170292  -25.67770648  10.4638104
 [28,]    8.1676433 10.589982  -13.27296094  28.5587878
 [29,]    8.4921341 12.373497  -16.17108056  32.8199244
 [30,]   -9.9419751 14.386151  -38.50992822  18.5564468
 [31,]   46.9159954 13.457102   20.17801803  72.9399094
 [32,]   20.0204479 11.543463   -3.23149747  42.5015947
 [33,]   -2.2763996  9.892824  -21.78994093  17.2874767
 [34,]   -6.7530471  8.656955  -23.88811692  10.0770811
 [35,]  -11.8418945  8.029710  -27.63812899   4.1376655
 [36,]   -5.8068420  8.152797  -21.63541153  10.0733164
 [37,]  -28.9058895  8.995467  -46.26667429 -11.1375958
 [38,]    3.3626630 10.383989  -16.82272754  23.7588634
 [39,]  -15.3022845 12.132374  -39.17471234   8.4868625
 [40,]   27.6437680 14.107454   -0.28621366  54.8748018
 [41,]   14.8380521 12.935469  -10.87064977  39.1520332
 [42,]    4.7107334 11.088435  -17.14585398  25.6232695
 [43,]   14.0119148  9.523858   -4.78995170  32.2054660
 [44,]   24.7871961  8.401060    8.21608318  40.8797542
 [45,]   13.4297774  7.910449   -2.21398758  28.7450694
 [46,]  -17.0482413  8.166765  -33.24573158  -0.8502700
 [47,]  -27.8113599  9.107159  -45.57645492  -9.8495030
 [48,]    9.4119214 10.550265  -11.11976559  30.1207603
 [49,]  -39.1782973 12.320686  -62.86214740 -14.9215746
 [50,]   31.1364840 14.297341    3.65627080  59.3946592
 [51,]  -25.5613521 12.022109  -49.48042842  -2.4720018
 [52,]  -27.7694183 10.375427  -48.48500033  -7.4527448
 [53,]   -7.7791845  9.032803  -25.89449779  10.2745047
 [54,]   18.8690493  8.145993    2.63494960  35.2866816
 [55,]   16.4038831  7.870611    0.97350634  32.0696191
 [56,]   -1.2206831  8.267978  -17.34303326  14.8774479
 [57,]  132.7843506  9.251813  114.50474908 150.4698682
 [58,]   15.2942844 10.660969   -5.89932046  36.1672914
 [59,]  -11.3957818 12.350713  -35.85944062  12.6966643
 [60,]  -97.9909480 14.221379 -125.86055004 -69.9189783
 [61,]   15.6072954 13.039859  -10.89564105  40.5891395
 [62,]   11.0393114 11.227903  -11.54139383  32.6208711
 [63,]  -12.0269727  9.687093  -31.20730453   6.9758973
 [64,]    0.7328432  8.565032  -16.24714483  17.6199267
 [65,]  -12.1864409  8.039020  -27.77475285   3.6482335
 [66,]   18.5284750  8.224230    2.40412336  34.5315603
 [67,]    2.1078910  9.077232  -15.86548294  19.8509020
 [68,]    8.6407069 10.435535  -11.64503771  29.2658163
 [69,]  -17.1197772 12.130569  -40.44581818   7.3596504
 [70,]    1.2824387 14.040906  -25.38485876  29.4843227
 [71,]   20.8924574 12.210055   -2.64686899  44.8525064
 [72,]   20.1780718 10.528912   -0.41318240  41.3679690
 [73,]  -24.1009138  9.143608  -42.35224128  -5.5397838
 [74,]  -24.2357994  8.205375  -40.62819289  -8.2638729
 [75,]  -11.3261850  7.875647  -27.05936570   4.0023186
 [76,]  -17.6018706  8.227910  -34.09566685  -1.7263729
 [77,]   -7.7107562  9.184020  -25.93656470  10.2508405
 [78,]    6.8448582 10.581539  -13.84301002  27.7803532
 [79,]   -0.3736274 12.270564  -24.30357974  24.0456918
 [80,]   29.7359870 14.147069    2.37384336  57.8341031
 [81,]   -8.8242393 13.568168  -36.48575101  17.2185510
 [82,]   23.7048571 11.533819    0.16184484  45.4418614
 [83,]    4.4385535  9.779465  -15.70293948  23.1086472
 [84,]   20.9401498  8.480686    3.88781652  37.4522736
 [85,]    1.7801462  7.866467  -13.73073516  17.1637035
 [86,]    5.1546426  8.094178  -10.48022687  20.9750605
 [87,]   -3.8390610  9.100840  -21.59269667  14.0418807
 [88,]  -13.7901646 10.668177  -34.56797504   7.1043812
 [89,]  -13.1568682 12.588482  -37.67472047  11.4744731
 [90,]  -11.4741718 14.724296  -40.07490158  17.8563622
 [91,]   26.5953982 12.956307    0.53556772  51.6809438
 [92,]    8.8569654 11.112984  -13.35731804  30.3298929
 [93,]  -32.5152675  9.556835  -51.19107743 -13.8478366
 [94,]    2.8180997  8.448075  -14.24369311  19.5730605
 [95,]    3.2506668  7.975526  -12.80915394  19.0885583
 [96,]   10.1791340  8.249257   -6.07202142  26.2824995
 [97,]    3.4231011  9.202915  -14.69121713  20.9217936
 [98,]   -3.3223317 10.655479  -24.53407514  17.4011894
 [99,]   16.6720354 12.433301   -7.88350258  41.0071875
[100,]    0.5468026 14.416550  -27.78097552  28.7506760
[101,]    9.3190418 13.329692  -16.74545037  36.6618812
[102,]   -7.9894290 11.436359  -30.13291547  14.9322541
[103,]  -10.9024998  9.816710  -30.03803839   8.4906854
[104,]   -6.4280706  8.626306  -23.45020661  10.3364737
[105,]  -22.1617414  8.057691  -38.19945001  -6.5699297
[106,]  -14.6196121  8.240600  -31.08687407   1.0940449
[107,]  -14.3511829  9.129977  -31.85578289   3.7519524
[108,]    0.6640463 10.548618  -19.48818340  22.1362067
[109,]   17.3206755 12.314953   -6.45818251  42.0905007
[110,]   21.1632047 14.300723   -6.56462762  49.7193197
[111,]   17.2984324 13.236873   -7.71482369  43.5092654
[112,]  -12.4901237 11.276574  -34.12389863   9.6610571
[113,]  -16.6858799  9.604421  -35.41605245   2.2178934
[114,]  -34.3094361  8.394412  -50.49672659 -17.6731549
[115,]  -37.8660922  7.862878  -52.89856868 -22.3507861
[116,]    5.9960516  8.143771   -9.75270390  22.1375508
[117,]   38.7697954  9.162676   20.60664035  56.8581437
[118,]    5.2976393 10.711009  -16.08441513  25.9398889
[119,]   19.9203831 12.595009   -5.11187604  44.0495328
[120,]   -2.4601730 14.686056  -31.89671822  25.8128005
[121,]   -5.4218332 12.357894  -30.06271846  17.8675069
[122,]   36.6536036 10.652545   15.53167432  56.7060710
[123,]   -0.9657595  9.246816  -19.01837737  16.5103195
[124,]    2.2737774  8.294470  -14.01038116  18.1965115
[125,]  -13.9435858  7.959937  -29.80636050   1.3827398
[126,]   11.4069511  8.318094   -5.00192346  27.7601535
[127,]  -12.9357120  9.289162  -30.81882994   5.3959563
[128,]  -41.5424752 10.707666  -62.25145917 -20.3741730
[129,]    5.9481617 12.421249  -18.07630430  30.7504276
[130,]   24.5161986 14.324401   -3.31105328  53.4067341
[131,]  -50.3200553 12.774728  -75.08822659 -24.7787981
[132,]   12.1512692 11.004879   -9.30816559  34.1680793
[133,]   26.7903936  9.523611    8.41080277  46.0326034
[134,]   32.7219181  8.483458   16.50859554  49.6245608
[135,]   20.5611426  8.057112    5.06585273  36.7827459
[136,]   10.6041671  8.339254   -5.41158506  27.2668672
[137,]   -1.8434084  9.265385  -19.62620481  16.2376388
[138,]   -9.8828840 10.669098  -30.46984468  10.5839312
[139,]   -8.7203595 12.389110  -32.68222404  15.3644620
[140,]   -9.8647350 14.311833  -37.28928282  18.4050636
[141,]   17.3093420 12.004798   -6.20000910  40.8822552
[142,]    2.4756970 10.351213  -18.14694086  22.5295705
[143,]  -20.0658479  8.990480  -38.00386967  -2.4461878
[144,]  -10.9986929  8.072086  -26.62357108   4.8251155
[145,]   14.8198621  7.754812   -0.05131051  29.6999101
[146,]    5.8641172  8.109523   -9.68350525  21.6559823
[147,]  -24.5611278  9.057611  -42.04406518  -6.9315664
[148,]   14.0794273 10.438629   -5.92892365  34.3773376
[149,]   -5.1105177 12.105302  -28.86345347  18.2389199
[150,]    9.7755374 13.955659  -18.31852073  36.4312511
[151,]   -1.4144313 13.562911  -27.44258805  25.6034509
[152,]   -7.3220933 11.581743  -29.21243748  15.5372123
[153,]  -18.1119553  9.873478  -36.93619298   1.3702648
[154,]  -31.7069173  8.602265  -48.55282326 -14.6306567
[155,]  -19.8097793  7.979782  -35.41714762  -4.2007439
[156,]   41.6794587  8.155946   25.70121961  57.7134269
[157,]  -36.5333033  9.084413  -54.40028909 -18.7530859
[158,]   14.7369348 10.568739   -5.82578624  35.2946604
[159,]   17.1472728 12.411064   -6.78107617  41.9055178
[160,]    9.0459108 14.475336  -19.02813997  38.0422255
[161,]   17.7974362 12.598180   -7.32409322  41.9658666
[162,]   10.8813493 10.870931  -10.61795931  31.9589078
[163,]    6.8589624  9.426417  -12.01275843  24.9271142
[164,]    1.2710755  8.411584  -15.41113047  17.5079044
[165,]  -10.8264114  7.991830  -26.61415332   4.3904276
[166,]  -14.9633983  8.258400  -31.02939920   1.3336493
[167,]  -49.6880852  9.151512  -67.54879903 -31.6648679
[168,]  -13.8017721 10.512678  -34.29620265   7.3183488
[169,]   22.8698410 12.186051   -1.00437928  47.4478533
[170,]   32.0798541 14.060600    4.48743278  60.3841668
[171,]    5.7328279 12.094564  -18.45526602  29.4396646
[172,]   -1.9834114 10.448684  -23.00340803  18.7262435
[173,]   10.3608493  9.079804   -8.04896308  28.4179506
[174,]   11.6171100  8.129084   -4.43085580  27.7395102
[175,]  -23.6204293  7.751936  -39.09688738  -8.4961081
[176,]    7.0360314  8.029592   -8.73886109  23.0215204
[177,]    0.1316921  8.900983  -17.03133307  17.9941749
[178,]   -2.9087472 10.215282  -22.74085734  17.6664824
[179,]   11.2345135 11.825726  -11.52834749  34.7024187
[180,]   -5.5621257 13.627727  -31.93029055  21.6314257</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.5  3.4
looic      1770.1 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   454       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   103       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.1 22.8
p_loo        35.1  9.0
looic      1724.3 45.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     175   97.2%   530       
 (0.5, 0.7]   (ok)         2    1.1%   717       
   (0.7, 1]   (bad)        1    0.6%   34        
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -22.9      12.0  
fit_sleep1 -91.3      21.4  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.5  3.4
looic      1770.1 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   454       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   103       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.1 22.8
p_loo        35.1  9.0
looic      1724.3 45.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     175   97.2%   530       
 (0.5, 0.7]   (ok)         2    1.1%   717       
   (0.7, 1]   (bad)        1    0.6%   34        
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.1     22.8        35.1    9.0   1724.3
fit_sleep2  -22.9      12.0  -885.1     14.4        19.5    3.4   1770.1
fit_sleep1  -91.3      21.4  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   45.6  
fit_sleep2   28.8  
fit_sleep1   21.1  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
2.314272e-40 1.122724e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.87      1.55      0.3     5.31       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.13      1.55    -3.31     2.84       5.32      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.62.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.2          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        ggridges_0.5.4       callr_3.7.3         
 [34] stringr_1.4.1        digest_0.6.30        minqa_1.2.5         
 [37] rmarkdown_2.18       base64enc_0.1-3      pkgconfig_2.0.3     
 [40] htmltools_0.5.3      highr_0.9            fastmap_1.1.0       
 [43] htmlwidgets_1.5.4    rlang_1.0.6          shiny_1.7.3         
 [46] jquerylib_0.1.4      farver_2.1.1         generics_0.1.3      
 [49] zoo_1.8-11           jsonlite_1.8.3       gtools_3.9.3        
 [52] crosstalk_1.2.0      dplyr_1.0.10         distributional_0.3.1
 [55] inline_0.3.19        magrittr_2.0.3       loo_2.5.1           
 [58] bayesplot_1.9.0      munsell_0.5.0        fansi_1.0.3         
 [61] abind_1.4-5          lifecycle_1.0.3      stringi_1.7.8       
 [64] yaml_2.3.6           MASS_7.3-58.1        plyr_1.8.8          
 [67] pkgbuild_1.3.1       grid_4.2.2           parallel_4.2.2      
 [70] promises_1.2.0.1     crayon_1.5.2         miniUI_0.1.1.1      
 [73] lattice_0.20-45      splines_4.2.2        knitr_1.40          
 [76] ps_1.7.2             pillar_1.8.1         igraph_1.3.5        
 [79] boot_1.3-28          markdown_1.3         shinystan_2.6.0     
 [82] reshape2_1.4.4       codetools_0.2-18     stats4_4.2.2        
 [85] rstantools_2.2.0     glue_1.6.2           evaluate_0.18       
 [88] V8_4.2.1             RcppParallel_5.1.5   vctrs_0.5.0         
 [91] nloptr_2.0.3         httpuv_1.6.6         gtable_0.3.1        
 [94] assertthat_0.2.1     cachem_1.0.6         ggplot2_3.4.0       
 [97] xfun_0.34            mime_0.12            xtable_1.8-4        
[100] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[103] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
