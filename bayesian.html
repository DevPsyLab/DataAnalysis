<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.70      6.90    15.33    42.39 1.00     1681     2239
sd(Days)                6.57      1.58     4.14    10.20 1.00     1380     1799
cor(Intercept,Days)     0.10      0.30    -0.48     0.67 1.00     1073     1529

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.28      7.64   235.99   266.50 1.00     1478     2308
Days         10.39      1.72     6.98    13.72 1.00     1405     1738

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.95      1.56    23.16    29.30 1.00     3115     2820

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0006  13.26729 228.0786 279.5271
309 211.5312  13.15594 185.3032 236.9717
310 213.2457  12.92564 187.7415 238.0602
330 274.0332  13.51674 248.2555 300.9297
331 272.7250  13.11405 248.0696 299.3110
332 260.0168  12.68473 235.9779 286.2490
333 267.5582  12.46615 243.3617 292.7576
334 244.2345  12.70341 218.6304 267.7995
335 250.1403  13.36322 224.4508 276.8641
337 285.9011  12.82761 261.7485 311.2003
349 227.1233  13.19661 200.9351 252.6776
350 239.2036  12.99199 213.4187 264.6451
351 255.6472  12.65838 231.2415 281.1933
352 272.0490  12.69464 246.6902 297.2759
369 254.7202  12.07016 230.6077 277.7073
370 226.5244  13.66744 198.9520 251.8760
371 252.2571  12.23349 229.0885 276.6096
372 263.2764  12.22621 239.3063 287.8316

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6376047  2.516493 14.8117961 24.798091
309  1.7360760  2.522767 -3.2247725  6.652355
310  4.8339473  2.437806  0.1456025  9.610529
330  5.8011337  2.586603  0.7056178 10.819289
331  7.5580433  2.481579  2.5803956 12.297344
332 10.2704961  2.425038  5.4272260 14.785595
333 10.3409997  2.323685  5.6607920 14.781064
334 11.5240107  2.430180  6.8782759 16.325567
335 -0.1307718  2.587661 -5.2853382  4.774204
337 19.1419369  2.436506 14.3616608 23.858033
349 11.4685633  2.482014  6.5981947 16.367549
350 16.9345699  2.504432 12.0044904 21.898029
351  7.5088297  2.410929  2.7916734 12.225234
352 14.0690224  2.426712  9.4546347 19.001674
369 11.3385563  2.326085  6.8286971 15.981855
370 15.1982748  2.547949 10.4610472 20.227281
371  9.4940926  2.331005  4.9436291 14.004385
372 11.8107904  2.381797  7.0379727 16.445065</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0006 13.267289 228.0786 279.5271
  [2,] 273.6382 11.374115 251.0620 295.3043
  [3,] 293.2758  9.766550 273.4066 312.1736
  [4,] 312.9134  8.606160 295.6455 329.5949
  [5,] 332.5510  8.087765 316.7381 348.3877
  [6,] 352.1886  8.332068 335.8216 368.7439
  [7,] 371.8262  9.279022 353.7709 390.3077
  [8,] 391.4638 10.744422 370.5501 412.3123
  [9,] 411.1014 12.547926 386.0180 435.8450
 [10,] 430.7390 14.564468 401.7226 459.3853
 [11,] 211.5312 13.155942 185.3032 236.9717
 [12,] 213.2673 11.258231 191.0706 235.0988
 [13,] 215.0033  9.651187 195.4777 233.8018
 [14,] 216.7394  8.501279 199.6807 233.0614
 [15,] 218.4755  8.007921 202.5403 233.8279
 [16,] 220.2116  8.289183 203.6097 236.3686
 [17,] 221.9476  9.274859 203.4912 239.9426
 [18,] 223.6837 10.773308 202.5737 245.1808
 [19,] 225.4198 12.602938 200.6441 250.7504
 [20,] 227.1559 14.640103 198.3618 256.4928
 [21,] 213.2457 12.925644 187.7415 238.0602
 [22,] 218.0796 11.087139 195.7573 239.3554
 [23,] 222.9136  9.521704 203.6544 241.5625
 [24,] 227.7475  8.383725 211.2946 244.4225
 [25,] 232.5815  7.861083 217.5593 248.2860
 [26,] 237.4154  8.074170 222.0139 253.5926
 [27,] 242.2494  8.970708 224.9358 260.1639
 [28,] 247.0833 10.375008 227.1510 267.6308
 [29,] 251.9173 12.111721 228.9269 275.9257
 [30,] 256.7512 14.058185 229.8432 284.5580
 [31,] 274.0332 13.516741 248.2555 300.9297
 [32,] 279.8343 11.529796 257.5613 302.9588
 [33,] 285.6355  9.826043 266.5179 305.3991
 [34,] 291.4366  8.575960 274.6117 308.6535
 [35,] 297.2377  7.995254 281.4908 312.7303
 [36,] 303.0389  8.226914 287.4081 319.0696
 [37,] 308.8400  9.209841 291.2204 327.0626
 [38,] 314.6411 10.739704 294.1093 335.9563
 [39,] 320.4423 12.619127 296.3250 345.1562
 [40,] 326.2434 14.714771 298.0223 355.3565
 [41,] 272.7250 13.114052 248.0696 299.3110
 [42,] 280.2831 11.224997 259.4544 303.3789
 [43,] 287.8411  9.609330 269.4507 307.5131
 [44,] 295.3992  8.425815 279.1829 312.3085
 [45,] 302.9572  7.871846 287.2034 318.1292
 [46,] 310.5152  8.077996 294.3610 325.9224
 [47,] 318.0733  8.992138 299.7394 335.1623
 [48,] 325.6313 10.429743 304.9694 345.6467
 [49,] 333.1894 12.207252 309.2271 356.5909
 [50,] 340.7474 14.197568 313.3820 367.6810
 [51,] 260.0168 12.684731 235.9779 286.2490
 [52,] 270.2873 10.929034 249.3047 292.6067
 [53,] 280.5578  9.473478 262.1218 299.8742
 [54,] 290.8283  8.474162 274.5326 308.0900
 [55,] 301.0988  8.101708 285.3217 316.9792
 [56,] 311.3693  8.439523 295.0362 327.7749
 [57,] 321.6398  9.411431 303.7547 339.9415
 [58,] 331.9103 10.848325 310.7066 352.8379
 [59,] 342.1808 12.592017 317.5449 366.7556
 [60,] 352.4512 14.532489 323.7771 380.5239
 [61,] 267.5582 12.466155 243.3617 292.7576
 [62,] 277.8992 10.758196 256.7892 299.3908
 [63,] 288.2402  9.320492 269.5810 306.6071
 [64,] 298.5812  8.294781 281.9146 314.5003
 [65,] 308.9222  7.844377 293.1667 324.1116
 [66,] 319.2632  8.066233 302.9495 335.1220
 [67,] 329.6042  8.910276 311.5429 347.0553
 [68,] 339.9452 10.223549 319.2324 359.9690
 [69,] 350.2862 11.851072 326.2905 373.1437
 [70,] 360.6272 13.681151 332.9377 386.5521
 [71,] 244.2345 12.703412 218.6304 267.7995
 [72,] 255.7585 10.915764 233.9535 276.6432
 [73,] 267.2825  9.420334 248.9810 286.0320
 [74,] 278.8065  8.375143 262.6458 295.1428
 [75,] 290.3305  7.959579 274.8858 306.0265
 [76,] 301.8545  8.269119 285.8949 318.2066
 [77,] 313.3785  9.231106 295.7134 331.4873
 [78,] 324.9025 10.670513 304.0860 345.7983
 [79,] 336.4265 12.422477 312.1801 360.8263
 [80,] 347.9506 14.373155 319.9415 375.9624
 [81,] 250.1403 13.363217 224.4508 276.8641
 [82,] 250.0096 11.378074 227.7253 272.5146
 [83,] 249.8788  9.681815 231.0270 268.9250
 [84,] 249.7480  8.450237 233.3393 266.5148
 [85,] 249.6173  7.903633 234.3098 264.9687
 [86,] 249.4865  8.180484 233.7080 265.2365
 [87,] 249.3557  9.206801 231.6225 267.2374
 [88,] 249.2249 10.770424 228.3289 269.7713
 [89,] 249.0942 12.674023 224.5151 273.5655
 [90,] 248.9634 14.786874 219.9443 278.1844
 [91,] 285.9011 12.827612 261.7485 311.2003
 [92,] 305.0430 11.010858 283.9252 327.1051
 [93,] 324.1850  9.476469 305.4737 343.0198
 [94,] 343.3269  8.380994 326.4552 360.0310
 [95,] 362.4689  7.908968 346.7022 378.4155
 [96,] 381.6108  8.169186 365.2119 397.8362
 [97,] 400.7527  9.099041 382.6512 418.3882
 [98,] 419.8947 10.522482 398.8954 440.1845
 [99,] 439.0366 12.268896 414.8460 463.0587
[100,] 458.1785 14.219779 430.9885 485.7334
[101,] 227.1233 13.196608 200.9351 252.6776
[102,] 238.5919 11.331671 216.1665 260.8698
[103,] 250.0605  9.745968 230.9639 269.6540
[104,] 261.5290  8.595452 244.1966 278.7142
[105,] 272.9976  8.068487 256.9379 288.9083
[106,] 284.4662  8.284925 267.9726 300.8111
[107,] 295.9347  9.192402 278.0479 314.0249
[108,] 307.4033 10.615146 287.0413 328.4650
[109,] 318.8719 12.376719 294.9095 343.1545
[110,] 330.3404 14.352903 302.6475 358.0918
[111,] 239.2036 12.991989 213.4187 264.6451
[112,] 256.1382 11.095567 233.9874 278.1345
[113,] 273.0727  9.485557 254.2990 292.3881
[114,] 290.0073  8.329726 273.8731 306.7057
[115,] 306.9419  7.831809 291.7943 322.9367
[116,] 323.8764  8.113846 307.8612 340.3714
[117,] 340.8110  9.103633 322.9772 358.9519
[118,] 357.7456 10.604816 336.6670 378.6983
[119,] 374.6801 12.433522 349.5895 398.4979
[120,] 391.6147 14.466071 362.6035 419.1785
[121,] 255.6472 12.658384 231.2415 281.1933
[122,] 263.1561 10.896830 241.9918 284.5670
[123,] 270.6649  9.427210 252.2353 289.3354
[124,] 278.1737  8.404097 261.5004 294.6699
[125,] 285.6826  8.000660 270.1678 301.5800
[126,] 293.1914  8.307673 276.7823 309.4886
[127,] 300.7002  9.254700 282.4660 318.9346
[128,] 308.2090 10.672706 287.1826 329.3620
[129,] 315.7179 12.401170 291.3296 340.2640
[130,] 323.2267 14.328173 295.6849 351.7901
[131,] 272.0490 12.694641 246.6902 297.2759
[132,] 286.1180 10.913664 264.6779 307.6068
[133,] 300.1870  9.425500 281.3924 319.0735
[134,] 314.2560  8.387484 297.5812 330.9469
[135,] 328.3250  7.977318 312.4584 344.0346
[136,] 342.3941  8.288738 326.1893 358.4714
[137,] 356.4631  9.249140 338.8252 374.2081
[138,] 370.5321 10.684937 349.9597 391.1925
[139,] 384.6011 12.432499 360.5538 408.8442
[140,] 398.6702 14.378596 370.9119 427.1336
[141,] 254.7202 12.070159 230.6077 277.7073
[142,] 266.0588 10.364022 244.9066 285.7167
[143,] 277.3973  8.941951 259.5594 294.8142
[144,] 288.7359  7.957724 272.8810 304.5082
[145,] 300.0744  7.583772 285.0968 315.2198
[146,] 311.4130  7.907159 296.0285 327.1126
[147,] 322.7515  8.851784 305.5629 340.5366
[148,] 334.0901 10.247260 314.4602 354.5815
[149,] 345.4286 11.936496 322.9135 369.6961
[150,] 356.7672 13.812128 330.7670 384.6524
[151,] 226.5244 13.667445 198.9520 251.8760
[152,] 241.7227 11.701251 218.1853 263.1384
[153,] 256.9209 10.001180 236.6638 275.5883
[154,] 272.1192  8.724220 254.7436 288.4292
[155,] 287.3175  8.073692 271.3528 302.7298
[156,] 302.5158  8.200067 286.3749 318.6942
[157,] 317.7140  9.070930 300.1537 335.6702
[158,] 332.9123 10.502692 312.5276 353.5837
[159,] 348.1106 12.301032 324.6324 372.4732
[160,] 363.3089 14.328584 336.0189 391.4748
[161,] 252.2571 12.233488 229.0885 276.6096
[162,] 261.7512 10.537800 241.9410 283.0351
[163,] 271.2453  9.126850 253.6210 289.2105
[164,] 280.7394  8.149892 264.6163 296.3548
[165,] 290.2335  7.772339 274.7542 305.3434
[166,] 299.7275  8.078672 283.8294 315.1519
[167,] 309.2216  8.999322 291.5343 326.2789
[168,] 318.7157 10.371973 298.1218 338.7415
[169,] 328.2098 12.043049 304.3342 351.2511
[170,] 337.7039 13.905374 310.2619 364.4755
[171,] 263.2764 12.226207 239.3063 287.8316
[172,] 275.0872 10.515734 254.8081 296.3501
[173,] 286.8980  9.111921 269.4307 304.8378
[174,] 298.7088  8.174317 282.8316 314.7127
[175,] 310.5196  7.871323 295.4541 325.7345
[176,] 322.3304  8.272963 306.4148 338.5121
[177,] 334.1412  9.288272 316.4043 352.4576
[178,] 345.9520 10.744673 325.1977 367.4192
[179,] 357.7628 12.488792 333.5765 382.5768
[180,] 369.5736 14.416579 341.6668 397.9170</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.4405951 13.267289  -29.9670585  21.4813690
  [2,]  -14.9334998 11.374115  -36.5995744   7.6426624
  [3,]  -42.4752045  9.766550  -61.3730348 -22.6060154
  [4,]    8.5263909  8.606160   -8.1551153  25.7942529
  [5,]   24.3008862  8.087765    8.4641581  40.1138373
  [6,]   62.5014815  8.332068   45.9461533  78.8684819
  [7,]   10.3775768  9.279022   -8.1038727  28.4329094
  [8,] -101.3152279 10.744422 -122.1636593 -80.4014962
  [9,]   19.4838674 12.547926   -5.2596794  44.5673415
 [10,]   35.6144627 14.564468    6.9681517  64.6309462
 [11,]   11.2027153 13.155942  -14.2378264  37.4306535
 [12,]   -8.0014607 11.258231  -29.8330360  14.1952326
 [13,]  -12.0255367  9.651187  -30.8240305   7.5000998
 [14,]  -12.0324126  8.501279  -28.3544153   5.0262518
 [15,]  -10.7593886  8.007921  -26.1117999   5.1757815
 [16,]   -4.2497646  8.289183  -20.4067924  12.3521276
 [17,]   -8.3173406  9.274859  -26.3122980  10.1390688
 [18,]   -5.9565166 10.773308  -27.4535621  15.1534970
 [19,]   -1.1240926 12.602938  -26.4547199  23.6515906
 [20,]   10.1583314 14.640103  -19.1785587  38.9523890
 [21,]  -14.1917805 12.925644  -39.0063248  11.3124212
 [22,]  -23.7474278 11.087139  -45.0231848  -1.4250649
 [23,]   11.4064249  9.521704   -7.2425348  30.6656065
 [24,]    5.0940776  8.383725  -11.5809276  21.5469884
 [25,]   -3.2740697  7.861083  -18.9786403  11.7481385
 [26,]  -16.9575170  8.074170  -33.1347046  -1.5560048
 [27,]   -6.8285643  8.970708  -24.7431424  10.4850062
 [28,]    8.6677884 10.375008  -11.8796782  28.6001171
 [29,]    9.0952411 12.111721  -14.9132126  32.0856048
 [30,]   -9.2359062 14.058185  -37.0427087  17.6720933
 [31,]   47.5093869 13.516741   20.6128913  73.2871220
 [32,]   20.5658532 11.529796   -2.5586004  42.8388785
 [33,]   -1.7789805  9.826043  -21.5425799  17.3386229
 [34,]   -6.3036142  8.575960  -23.5205298  10.5212657
 [35,]  -11.4404479  7.995254  -26.9330246   4.3065058
 [36,]   -5.4533816  8.226914  -21.4840672  10.1773556
 [37,]  -28.6004153  9.209841  -46.8230040 -10.9807675
 [38,]    3.6201510 10.739704  -17.6950396  24.1519947
 [39,]  -15.0927827 12.619127  -39.8067333   9.0244724
 [40,]   27.8052836 14.714771   -1.3078107  56.0264178
 [41,]   14.8828747 13.114052  -11.7030822  39.5383014
 [42,]    4.7169314 11.224997  -18.3788951  25.5456144
 [43,]   13.9794881  9.609330   -5.6924833  32.3699081
 [44,]   24.7161448  8.425815    7.8068109  40.9324413
 [45,]   13.3201015  7.871846   -1.8518531  29.0738767
 [46,]  -17.1965418  8.077996  -32.6036618  -1.0422716
 [47,]  -27.9982851  8.992138  -45.0873110  -9.6643945
 [48,]    9.1863716 10.429743  -10.8290211  29.8482605
 [49,]  -39.4424717 12.207252  -62.8440212 -15.4801656
 [50,]   30.8336851 14.197568    3.9000924  58.1990842
 [51,]  -25.1561812 12.684731  -51.3883971  -1.1173328
 [52,]  -27.4754773 10.929034  -49.7948600  -6.4928932
 [53,]   -7.5964734  9.473478  -26.9128716  10.8394614
 [54,]   18.9405305  8.474162    1.6787865  35.2361528
 [55,]   16.3641344  8.101708    0.4837117  32.1412416
 [56,]   -1.3716617  8.439523  -17.7773163  14.9614026
 [57,]  132.5221422  9.411431  114.2203968 150.4072373
 [58,]   14.9208461 10.848325   -6.0067928  36.1245291
 [59,]  -11.8804500 12.592017  -36.4552669  12.7554227
 [60,]  -98.5868461 14.532489 -126.6595369 -69.9127382
 [61,]   16.2841708 12.466155   -8.9152160  40.4806945
 [62,]   11.6557711 10.758196   -9.8358206  32.7658094
 [63,]  -11.4709286  9.320492  -29.8378062   7.1883443
 [64,]    1.2284717  8.294781  -14.6905752  17.8951166
 [65,]  -11.7512280  7.844377  -26.9406486   4.0043056
 [66,]   18.9032723  8.066233    3.0445470  35.2170061
 [67,]    2.4222726  8.910276  -15.0287926  20.4835776
 [68,]    8.8946729 10.223549  -11.1290715  29.6075177
 [69,]  -16.9262268 11.851072  -39.7837390   7.0694943
 [70,]    1.4155735 13.681151  -24.5092533  29.1051486
 [71,]   21.2386377 12.703412   -2.3264195  46.8426857
 [72,]   20.4427270 10.915764   -0.4420404  42.2477075
 [73,]  -23.9177838  9.420334  -42.6673477  -5.6163006
 [74,]  -24.1341945  8.375143  -40.4704999  -7.9734836
 [75,]  -11.3061052  7.959579  -27.0020772   4.1385669
 [76,]  -17.6633160  8.269119  -34.0154270  -1.7036906
 [77,]   -7.8537267  9.231106  -25.9625352   9.8113955
 [78,]    6.6203625 10.670513  -14.2753538  27.4368796
 [79,]   -0.6796482 12.422477  -25.0794090  23.5668171
 [80,]   29.3484410 14.373155    1.3365506  57.3575377
 [81,]   -8.5320411 13.363217  -35.2557530  17.1575028
 [82,]   23.9376308 11.378074    1.4325561  46.2218724
 [83,]    4.6119026  9.681815  -14.4342715  23.4637405
 [84,]   21.0540744  8.450237    4.2873406  37.4627721
 [85,]    1.8346463  7.903633  -13.5168410  17.1421386
 [86,]    5.1497181  8.180484  -10.6003450  20.9282436
 [87,]   -3.9034100  9.206801  -21.7850953  13.8298318
 [88,]  -13.9139382 10.770424  -34.4602869   6.9820767
 [89,]  -13.3400664 12.674023  -37.8113750  11.2389907
 [90,]  -11.7167945 14.786874  -40.9378104  17.3022740
 [91,]   26.4654958 12.827612    1.1663092  50.6181460
 [92,]    8.7627589 11.010858  -13.2992924  29.8806475
 [93,]  -32.5737780  9.476469  -51.4086031 -13.8625035
 [94,]    2.7952851  8.380994  -13.9088459  19.6670333
 [95,]    3.2635482  7.908968  -12.6831455  19.0301857
 [96,]   10.2277113  8.169186   -5.9976817  26.6265647
 [97,]    3.5073744  9.099041  -14.1281093  21.6089471
 [98,]   -3.2023624 10.522482  -23.4922232  17.7968604
 [99,]   16.8277007 12.268896   -7.1943540  41.0182926
[100,]    0.7381638 14.219779  -26.8167299  27.9282479
[101,]    8.9798547 13.196608  -16.5743689  35.1680925
[102,]   -8.2752086 11.331671  -30.5530979  14.1501845
[103,]  -11.1348719  9.745968  -30.7283884   7.9616733
[104,]   -6.6070352  8.595452  -23.7922327  10.7253995
[105,]  -22.2872985  8.068487  -38.1979979  -6.2275873
[106,]  -14.6917618  8.284925  -31.0366845   1.8017691
[107,]  -14.3699252  9.192402  -32.4600896   3.5169288
[108,]    0.6987115 10.615146  -20.3630381  21.0606732
[109,]   17.4087482 12.376719   -6.8738978  41.3711227
[110,]   21.3046849 14.352903   -6.4466841  48.9975765
[111,]   17.0932151 12.991989   -8.3483307  42.8780653
[112,]  -12.6838548 11.095567  -34.6801756   9.4669496
[113,]  -16.8681246  9.485557  -36.1834737   1.9055554
[114,]  -34.4801945  8.329726  -51.1785511 -18.3460277
[115,]  -38.0253643  7.831809  -54.0201784 -22.8778395
[116,]    5.8482658  8.113846  -10.6467446  21.8635053
[117,]   38.6334959  9.103633   20.4926210  56.4673029
[118,]    5.1728261 10.604816  -15.7798731  26.2513701
[119,]   19.8070562 12.433522   -4.0107106  44.8976990
[120,]   -2.5620137 14.466071  -30.1257649  26.4492085
[121,]   -5.1207363 12.658384  -30.6667848  19.2850431
[122,]   36.9015340 10.896830   15.4905675  58.0657541
[123,]   -0.7709957  9.427210  -19.4415108  17.6585780
[124,]    2.4153746  8.404097  -14.0808027  19.0887455
[125,]  -13.8551551  8.000660  -29.7526303   1.6596327
[126,]   11.4422152  8.307673   -4.8549856  27.8512750
[127,]  -12.9536145  9.254700  -31.1880058   5.2806308
[128,]  -41.6135442 10.672706  -62.7665368 -20.5871013
[129,]    5.8239261 12.401170  -18.7221762  30.2121835
[130,]   24.3387965 14.328173   -4.2246048  51.8805605
[131,]  -50.3718541 12.694641  -75.5988106 -25.0131252
[132,]   12.0759234 10.913664   -9.4129423  33.5160378
[133,]   26.6915010  9.425500    7.8050194  45.4861456
[134,]   32.5994786  8.387484   15.9085694  49.2742874
[135,]   20.4151561  7.977318    4.7055678  36.2817869
[136,]   10.4346337  8.288738   -5.6426826  26.6394276
[137,]   -2.0364887  9.249140  -19.7815403  15.6013991
[138,]  -10.0995111 10.684937  -30.7598788  10.4728607
[139,]   -8.9605336 12.432499  -33.2035597  15.0867686
[140,]  -10.1284560 14.378596  -38.5918591  17.6297967
[141,]   17.2033031 12.070159   -5.7838451  41.3158204
[142,]    2.3781468 10.364022  -17.2798497  23.5302887
[143,]  -20.1549096  8.941951  -37.5718380  -2.3170005
[144,]  -11.0792659  7.957724  -26.8516065   4.7756142
[145,]   14.7477777  7.583772   -0.3976440  29.7253991
[146,]    5.8005214  7.907159   -9.8991125  21.1849880
[147,]  -24.6162350  8.851784  -42.4013205  -7.4276080
[148,]   14.0328087 10.247260   -6.4585558  33.6626647
[149,]   -5.1486477 11.936496  -29.4160642  17.3665491
[150,]    9.7458960 13.812128  -18.1392603  35.7460563
[151,]   -1.2603824 13.667445  -26.6119891  26.3120171
[152,]   -7.1991572 11.701251  -28.6148822  16.3381962
[153,]  -18.0201320 10.001180  -36.6874621   2.2369592
[154,]  -31.6462068  8.724220  -47.9562191 -14.2705782
[155,]  -19.7801816  8.073692  -35.1925149  -3.8155083
[156,]   41.6779436  8.200067   25.4994996  57.8188044
[157,]  -36.5659312  9.070930  -54.5221005 -19.0056200
[158,]   14.6731940 10.502692   -5.9982319  35.0579295
[159,]   17.0524192 12.301032   -7.3101510  40.5306484
[160,]    8.9199444 14.328584  -19.2460016  36.2098506
[161,]   17.6233154 12.233488   -6.7291780  40.7918693
[162,]   10.6916227 10.537800  -10.5923301  30.5018248
[163,]    6.6536301  9.126850  -11.3115993  24.2779051
[164,]    1.0501374  8.149892  -14.5653167  17.1731513
[165,]  -11.0629552  7.772339  -26.1729292   4.4162889
[166,]  -15.2155479  8.078672  -30.6398501   0.6826228
[167,]  -49.9558405  8.999322  -67.0131062 -32.2685193
[168,]  -14.0851332 10.371973  -34.1109401   6.5087770
[169,]   22.5708742 12.043049   -0.4703689  46.4465312
[170,]   31.7652816 13.905374    4.9936591  59.2073327
[171,]    6.1352625 12.226207  -18.4198599  30.1053805
[172,]   -1.6132280 10.515734  -22.8761176  18.6658715
[173,]   10.6987816  9.111921   -7.2410044  28.1660521
[174,]   11.9227912  8.174317   -4.0811236  27.7999892
[175,]  -23.3469993  7.871323  -38.5619378  -8.2814513
[176,]    7.2772103  8.272963   -8.9045292  23.1927736
[177,]    0.3406199  9.288272  -17.9758350  18.0774833
[178,]   -2.7320705 10.744673  -24.1993432  18.0222296
[179,]   11.3789390 12.488792  -13.4350510  35.5651907
[180,]   -5.4499514 14.416579  -33.7933638  22.4567615</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.5
p_loo        19.6  3.5
looic      1770.0 29.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1189      
 (0.5, 0.7]   (ok)         1    0.6%   369       
   (0.7, 1]   (bad)        1    0.6%   63        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.1
p_loo        34.0  8.4
looic      1722.1 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   863       
 (0.5, 0.7]   (ok)         5    2.8%   451       
   (0.7, 1]   (bad)        2    1.1%   31        
   (1, Inf)   (very bad)   1    0.6%   13        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.0      11.5  
fit_sleep1 -92.2      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.5
p_loo        19.6  3.5
looic      1770.0 29.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1189      
 (0.5, 0.7]   (ok)         1    0.6%   369       
   (0.7, 1]   (bad)        1    0.6%   63        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.1
p_loo        34.0  8.4
looic      1722.1 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   863       
 (0.5, 0.7]   (ok)         5    2.8%   451       
   (0.7, 1]   (bad)        2    1.1%   31        
   (1, Inf)   (very bad)   1    0.6%   13        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.1     22.1        34.0    8.4   1722.1
fit_sleep2  -24.0      11.5  -885.0     14.5        19.6    3.5   1770.0
fit_sleep1  -92.2      20.9  -953.2     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.3  
fit_sleep2   29.0  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
9.222263e-41 3.908290e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.93      1.58     0.34     5.43       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.07      1.58     -3.2      2.9       5.26      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
