<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.79      6.91    15.64    42.91 1.00     1679     2186
sd(Days)                6.59      1.49     4.19    10.16 1.00     1263     1912
cor(Intercept,Days)     0.08      0.29    -0.46     0.66 1.00      995     1728

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.08      7.54   236.57   265.96 1.00     1550     2234
Days         10.34      1.76     6.96    13.86 1.00     1343     1706

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.87      1.53    23.15    29.05 1.00     3251     3089

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1037  12.74469 228.5593 278.3404
309 211.2977  13.17079 185.2312 236.2240
310 213.0558  13.01461 187.3813 238.3491
330 274.7891  13.23763 250.0282 300.9730
331 273.3040  12.98932 248.5951 298.9086
332 260.1355  11.86983 237.1430 283.8136
333 267.7063  12.45159 244.3896 292.3562
334 244.5186  12.28133 220.3249 268.2940
335 250.8816  13.46838 224.2519 278.2640
337 286.1583  13.04878 261.3547 311.4789
349 226.3809  12.85164 199.8138 250.5377
350 238.6242  13.14541 212.3519 263.4819
351 255.9149  12.36551 231.4766 280.3565
352 271.7351  12.53330 247.6843 297.1911
369 254.5696  12.52989 230.3938 279.4398
370 226.2432  13.62707 198.3060 251.4289
371 251.9756  12.42289 227.3333 276.6497
372 263.1756  12.18574 239.3554 287.4951

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.5912003  2.436592 14.91823335 24.371314
309  1.7409198  2.477628 -3.26544476  6.534426
310  4.8753021  2.482040  0.05444183  9.690382
330  5.6386573  2.552791  0.64484515 10.589648
331  7.4492651  2.449853  2.51332893 12.095990
332 10.2173688  2.281585  5.77276787 14.563315
333 10.3319357  2.370428  5.69548049 14.866299
334 11.4956762  2.319098  6.94381259 16.065799
335 -0.2639527  2.556137 -5.43910295  4.661617
337 19.1192257  2.479039 14.28939164 24.159801
349 11.6082055  2.422298  6.98731966 16.620584
350 16.9954761  2.480628 12.28058928 22.062586
351  7.4894170  2.365427  2.84751270 12.107277
352 14.0752066  2.389615  9.33141211 18.718884
369 11.3355547  2.412074  6.62500087 16.047933
370 15.1953357  2.587454 10.18875630 20.484805
371  9.5244332  2.372056  4.82333481 14.164773
372 11.8304667  2.334634  7.19510713 16.552462</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1037 12.744687 228.5593 278.3404
  [2,] 273.6949 10.925524 251.3817 294.6358
  [3,] 293.2861  9.390476 274.6694 311.5034
  [4,] 312.8773  8.298734 296.5101 329.1028
  [5,] 332.4685  7.837786 317.2627 347.8626
  [6,] 352.0597  8.115834 336.4292 368.2477
  [7,] 371.6509  9.065130 354.4799 389.6482
  [8,] 391.2421 10.505254 371.6381 411.9318
  [9,] 410.8333 12.264506 387.1716 435.1440
 [10,] 430.4245 14.224971 402.9939 458.5301
 [11,] 211.2977 13.170790 185.2312 236.2240
 [12,] 213.0386 11.284967 190.5669 234.6619
 [13,] 214.7795  9.669981 196.1437 233.0497
 [14,] 216.5204  8.481974 199.7058 232.7914
 [15,] 218.2613  7.915586 203.0956 233.7745
 [16,] 220.0023  8.102247 204.2072 236.0145
 [17,] 221.7432  8.995198 204.0018 239.3939
 [18,] 223.4841 10.414320 202.6251 243.8103
 [19,] 225.2250 12.177020 200.9410 248.8630
 [20,] 226.9659 14.155524 198.6538 254.2158
 [21,] 213.0558 13.014612 187.3813 238.3491
 [22,] 217.9311 11.081508 196.2790 239.4539
 [23,] 222.8064  9.409600 204.3598 241.0356
 [24,] 227.6817  8.161027 211.7847 243.3839
 [25,] 232.5570  7.548855 217.8983 247.3492
 [26,] 237.4323  7.725872 222.1738 252.9159
 [27,] 242.3076  8.643728 225.2646 259.3600
 [28,] 247.1829 10.102475 227.3045 266.9703
 [29,] 252.0582 11.904916 228.9343 275.5871
 [30,] 256.9335 13.918157 229.6927 284.4340
 [31,] 274.7891 13.237629 250.0282 300.9730
 [32,] 280.4277 11.303885 259.4243 302.5997
 [33,] 286.0664  9.662002 267.8511 305.1496
 [34,] 291.7050  8.483174 275.6504 308.0581
 [35,] 297.3437  7.975442 281.9647 312.8797
 [36,] 302.9823  8.263449 286.6637 318.9096
 [37,] 308.6210  9.273348 290.1379 326.7790
 [38,] 314.2597 10.804576 292.6398 335.6117
 [39,] 319.8983 12.669500 294.8136 344.4982
 [40,] 325.5370 14.742018 295.9147 354.5280
 [41,] 273.3040 12.989318 248.5951 298.9086
 [42,] 280.7532 11.131187 259.7842 302.2970
 [43,] 288.2025  9.543994 270.0564 306.5530
 [44,] 295.6518  8.383071 279.3733 311.6617
 [45,] 303.1010  7.840120 287.7157 318.5190
 [46,] 310.5503  8.041309 294.7518 326.3341
 [47,] 317.9995  8.936518 300.3563 335.5437
 [48,] 325.4488 10.347155 305.3331 345.9520
 [49,] 332.8981 12.094191 308.8928 356.6969
 [50,] 340.3473 14.052716 312.6396 367.7295
 [51,] 260.1355 11.869830 237.1430 283.8136
 [52,] 270.3529 10.253637 250.0740 290.5428
 [53,] 280.5703  8.932666 263.0491 298.1191
 [54,] 290.7876  8.053524 274.9175 306.3977
 [55,] 301.0050  7.767705 285.6417 316.3333
 [56,] 311.2224  8.137965 295.1624 327.6380
 [57,] 321.4397  9.084436 303.2174 339.4760
 [58,] 331.6571 10.451734 310.8467 352.1481
 [59,] 341.8745 12.098007 317.9862 365.5804
 [60,] 352.0918 13.924656 324.8401 379.6316
 [61,] 267.7063 12.451593 244.3896 292.3562
 [62,] 278.0382 10.735389 257.6882 299.4248
 [63,] 288.3702  9.310899 270.5451 306.3828
 [64,] 298.7021  8.329163 282.5070 314.9087
 [65,] 309.0340  7.955812 293.4554 324.2202
 [66,] 319.3660  8.273620 303.0282 335.3277
 [67,] 329.6979  9.211324 311.7173 347.5142
 [68,] 340.0298 10.605755 319.2292 360.6653
 [69,] 350.3618 12.302579 326.6791 374.2394
 [70,] 360.6937 14.193756 333.2088 388.2000
 [71,] 244.5186 12.281330 220.3249 268.2940
 [72,] 256.0143 10.608133 235.2163 276.6805
 [73,] 267.5099  9.219020 249.3865 285.5845
 [74,] 279.0056  8.258607 262.9253 295.3276
 [75,] 290.5013  7.885131 274.9143 305.8773
 [76,] 301.9970  8.179391 285.6164 318.4321
 [77,] 313.4926  9.076674 295.1779 331.3559
 [78,] 324.9883 10.422380 303.8680 345.2672
 [79,] 336.4840 12.067412 312.2075 360.2725
 [80,] 347.9797 13.905945 320.3148 375.1967
 [81,] 250.8816 13.468376 224.2519 278.2640
 [82,] 250.6176 11.489157 228.1612 274.0322
 [83,] 250.3537  9.781206 231.3376 269.8742
 [84,] 250.0897  8.509461 233.7020 266.6009
 [85,] 249.8258  7.887809 234.4072 264.9270
 [86,] 249.5618  8.067949 233.4258 265.1100
 [87,] 249.2979  9.001875 231.4521 266.4665
 [88,] 249.0339 10.490156 228.3820 269.1368
 [89,] 248.7700 12.333720 224.5224 272.5164
 [90,] 248.5060 14.396722 220.0665 276.3903
 [91,] 286.1583 13.048781 261.3547 311.4789
 [92,] 305.2775 11.188758 283.6961 327.0989
 [93,] 324.3968  9.612346 306.0091 343.4781
 [94,] 343.5160  8.479231 326.8874 360.5234
 [95,] 362.6352  7.980525 346.8604 378.3361
 [96,] 381.7544  8.232343 365.9195 397.9390
 [97,] 400.8737  9.173082 383.1746 419.1724
 [98,] 419.9929 10.621236 399.2599 441.3259
 [99,] 439.1121 12.400288 414.9025 464.0233
[100,] 458.2313 14.388013 430.5185 487.1939
[101,] 226.3809 12.851636 199.8138 250.5377
[102,] 237.9891 11.022378 215.2814 258.5140
[103,] 249.5973  9.463411 230.5543 267.7222
[104,] 261.2056  8.327936 244.9586 277.3574
[105,] 272.8138  7.803073 257.7653 287.9469
[106,] 284.4220  8.009771 269.0864 300.2170
[107,] 296.0302  8.897189 279.0883 313.2121
[108,] 307.6384 10.290703 287.8284 327.8112
[109,] 319.2466 12.015500 296.2097 342.6302
[110,] 330.8548 13.949227 304.5832 358.2038
[111,] 238.6242 13.145411 212.3519 263.4819
[112,] 255.6197 11.281064 232.9939 276.9895
[113,] 272.6152  9.696908 253.2504 291.3078
[114,] 289.6107  8.550127 272.5698 305.8896
[115,] 306.6062  8.030338 290.6271 321.9861
[116,] 323.6016  8.256817 307.0060 339.7571
[117,] 340.5971  9.174462 322.1809 358.4585
[118,] 357.5926 10.605352 336.4743 378.0439
[119,] 374.5881 12.372683 349.9800 398.4326
[120,] 391.5835 14.352703 363.1448 419.4406
[121,] 255.9149 12.365507 231.4766 280.3565
[122,] 263.4043 10.640134 242.3117 284.2935
[123,] 270.8937  9.203783 252.5134 289.0356
[124,] 278.3831  8.209585 262.3946 294.8310
[125,] 285.8725  7.827863 270.6631 301.8587
[126,] 293.3619  8.145187 277.4329 309.6689
[127,] 300.8514  9.088630 283.2988 318.8068
[128,] 308.3408 10.490605 288.1636 328.9043
[129,] 315.8302 12.193969 291.9924 339.7533
[130,] 323.3196 14.089836 295.5083 350.8540
[131,] 271.7351 12.533298 247.6843 297.1911
[132,] 285.8103 10.740469 265.0627 307.7121
[133,] 299.8855  9.222380 282.1696 318.3860
[134,] 313.9608  8.134338 298.2729 330.3614
[135,] 328.0360  7.661796 313.1060 343.3041
[136,] 342.1112  7.915763 326.5858 357.7003
[137,] 356.1864  8.833800 338.8116 373.5530
[138,] 370.2616 10.238811 350.2842 390.1694
[139,] 384.3368 11.960393 360.6698 407.1766
[140,] 398.4120 13.881256 371.0816 425.3079
[141,] 254.5696 12.529886 230.3938 279.4398
[142,] 265.9051 10.755134 244.9997 287.1387
[143,] 277.2407  9.272755 258.5993 295.4543
[144,] 288.5762  8.242043 271.8208 304.8007
[145,] 299.9118  7.843135 284.3693 315.0049
[146,] 311.2473  8.169117 295.0829 326.9660
[147,] 322.5829  9.142777 304.9275 340.5634
[148,] 333.9184 10.586902 313.1192 354.1715
[149,] 345.2540 12.337374 320.9702 369.0602
[150,] 356.5896 14.281993 328.9734 383.8301
[151,] 226.2432 13.627065 198.3060 251.4289
[152,] 241.4386 11.628211 218.2468 262.8598
[153,] 256.6339  9.905732 236.2194 275.4479
[154,] 271.8292  8.626795 254.0294 288.1615
[155,] 287.0246  8.006841 271.1116 302.7202
[156,] 302.2199  8.196784 286.0516 318.0840
[157,] 317.4153  9.146303 299.5205 335.2876
[158,] 332.6106 10.654215 312.1984 353.5127
[159,] 347.8059 12.520366 323.8257 372.8546
[160,] 363.0013 14.608103 334.6896 392.9528
[161,] 251.9756 12.422891 227.3333 276.6497
[162,] 261.5000 10.677846 240.6811 282.7465
[163,] 271.0244  9.217258 253.0359 289.1786
[164,] 280.5489  8.194669 264.4628 296.5839
[165,] 290.0733  7.784643 275.0718 305.1761
[166,] 299.5977  8.080967 283.8581 314.9944
[167,] 309.1222  9.014249 291.9715 326.5729
[168,] 318.6466 10.414636 298.6421 338.8435
[169,] 328.1710 12.121299 304.7852 351.6964
[170,] 337.6955 14.022854 310.5069 364.5961
[171,] 263.1756 12.185744 239.3554 287.4951
[172,] 275.0061 10.491628 254.4687 295.8603
[173,] 286.8366  9.086099 268.9223 304.9035
[174,] 298.6670  8.120417 282.9434 314.7401
[175,] 310.4975  7.760553 295.2251 325.6756
[176,] 322.3280  8.087783 306.3534 337.9429
[177,] 334.1584  9.027697 316.4524 351.8029
[178,] 345.9889 10.415729 326.0815 366.4113
[179,] 357.8194 12.098618 334.5735 381.7161
[180,] 369.6498 13.970209 342.7064 397.5282</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.5436981 12.744687  -28.78042986  21.0006747
  [2,]  -14.9901984 10.925524  -35.93108241   7.3230495
  [3,]  -42.4854986  9.390476  -60.70277536 -23.8688442
  [4,]    8.5625011  8.298734   -7.66299286  24.9297061
  [5,]   24.3834008  7.837786    8.98933175  39.5891877
  [6,]   62.6304005  8.115834   46.44242183  78.2609235
  [7,]   10.5529002  9.065130   -7.44442833  27.7238886
  [8,] -101.0935000 10.505254 -121.78316719 -81.4894563
  [9,]   19.7519997 12.264506   -4.55871609  43.4137051
 [10,]   35.9289994 14.224971    7.82335476  63.3596449
 [11,]   11.4362361 13.170790  -13.49005300  37.5027466
 [12,]   -7.7727838 11.284967  -29.39614398  14.6988957
 [13,]  -11.8017036  9.669981  -30.07192640   6.8340662
 [14,]  -11.8134234  8.481974  -28.08435254   5.0012307
 [15,]  -10.5452433  7.915586  -26.05836314   4.6205199
 [16,]   -4.0404631  8.102247  -20.05266666  11.7546148
 [17,]   -8.1128829  8.995198  -25.76356207   9.6284974
 [18,]   -5.7569028 10.414320  -26.08306034  15.1020936
 [19,]   -0.9293226 12.177020  -24.56729823  23.3546861
 [20,]   10.3482576 14.155524  -16.90158138  38.6603717
 [21,]  -14.0018807 13.014612  -39.29524349  11.6725583
 [22,]  -23.5988828 11.081508  -45.12165945  -1.9467553
 [23,]   11.5136150  9.409600   -6.71561930  29.9602343
 [24,]    5.1599129  8.161027  -10.54234279  21.0569208
 [25,]   -3.2495892  7.548855  -18.04181155  11.4090680
 [26,]  -16.9743914  7.725872  -32.45797888  -1.7158855
 [27,]   -6.8867935  8.643728  -23.93916983  10.1561918
 [28,]    8.5682044 10.102475  -11.21920641  28.4466359
 [29,]    8.9543022 11.904916  -14.57459685  32.0781935
 [30,]   -9.4181999 13.918157  -36.91873570  17.8225989
 [31,]   46.7535472 13.237629   20.56959316  71.5143844
 [32,]   19.9724899 11.303885   -2.19945160  40.9759087
 [33,]   -2.2098674  9.662002  -21.29307747  16.0054020
 [34,]   -6.5720248  8.483174  -22.92508986   9.4825621
 [35,]  -11.5463821  7.975442  -27.08238289   3.8326147
 [36,]   -5.3968394  8.263449  -21.32412761  10.9218150
 [37,]  -28.3813967  9.273348  -46.53943681  -9.8982905
 [38,]    4.0016460 10.804576  -17.35041336  25.6214620
 [39,]  -14.5488114 12.669500  -39.14870746  10.5359392
 [40,]   28.5117313 14.742018   -0.47930545  58.1340029
 [41,]   14.3039422 12.989318  -11.30070741  39.0127770
 [42,]    4.2467771 11.131187  -17.29697477  25.2157796
 [43,]   13.6181120  9.543994   -4.73237030  31.7641538
 [44,]   24.4635470  8.383071    8.45359985  40.7420329
 [45,]   13.1762819  7.840120   -2.24170612  28.5615594
 [46,]  -17.2315832  8.041309  -33.01544088  -1.4331094
 [47,]  -27.9245483  8.936518  -45.46869952 -10.2812773
 [48,]    9.3688866 10.347155  -11.13425249  29.4845589
 [49,]  -39.1511785 12.094191  -62.95002070 -15.1458997
 [50,]   31.2337564 14.052716    3.85158522  58.9414943
 [51,]  -25.2749225 11.869830  -48.95297798  -2.2823789
 [52,]  -27.5410914 10.253637  -47.73104529  -7.2621952
 [53,]   -7.6089602  8.932666  -25.15775877   9.9122237
 [54,]   18.9811709  8.053524    3.37107148  34.8513255
 [55,]   16.4579021  7.767705    1.12959398  31.8212154
 [56,]   -1.2247668  8.137965  -17.64041109  14.8352130
 [57,]  132.7221644  9.084436  114.68585045 150.9444949
 [58,]   15.1739955 10.451734   -5.31696339  35.9844068
 [59,]  -11.5741733 12.098007  -35.28012088  12.3141346
 [60,]  -98.2274422 13.924656 -125.76719982 -70.9756898
 [61,]   16.1361175 12.451593   -8.51379725  39.4528409
 [62,]   11.5167818 10.735389   -9.86984819  31.8667874
 [63,]  -11.6008540  9.310899  -29.61353410   6.2242328
 [64,]    1.1076103  8.329163  -15.09902067  17.3027020
 [65,]  -11.8630255  7.955812  -27.04919937   3.7156167
 [66,]   18.8005388  8.273620    2.83884809  35.1382895
 [67,]    2.3286030  9.211324  -15.48770872  20.3091506
 [68,]    8.8100673 10.605755  -11.82538110  29.6106556
 [69,]  -17.0017685 12.302579  -40.87936983   6.6808737
 [70,]    1.3490958 14.193756  -26.15716215  28.8340076
 [71,]   20.9545220 12.281330   -2.82089424  45.1482372
 [72,]   20.1869458 10.608133   -0.47930975  40.9848814
 [73,]  -24.1452304  9.219020  -42.21984457  -6.0217507
 [74,]  -24.3333066  8.258607  -40.65525876  -8.2529910
 [75,]  -11.4768828  7.885131  -26.85292220   4.1100523
 [76,]  -17.8057590  8.179391  -34.24085041  -1.4252497
 [77,]   -7.9678353  9.076674  -25.83106821  10.3469231
 [78,]    6.5345885 10.422380  -13.74431667  27.6549393
 [79,]   -0.7370877 12.067412  -24.52558908  23.5394339
 [80,]   29.3193361 13.905945    2.10228447  56.9841755
 [81,]   -9.2733016 13.468376  -36.65568964  17.3563970
 [82,]   23.3295511 11.489157   -0.08502894  45.7860307
 [83,]    4.1370038  9.781206  -15.38352619  23.1531309
 [84,]   20.7123565  8.509461    4.20124832  37.1000760
 [85,]    1.6261092  7.887809  -13.47509902  17.0447367
 [86,]    5.0743619  8.067949  -10.47378792  21.2104060
 [87,]   -3.8455854  9.001875  -21.01424312  14.0001600
 [88,]  -13.7229326 10.490156  -33.82576118   6.9289799
 [89,]  -13.0158799 12.333720  -36.76231681  11.2317032
 [90,]  -11.2594272 14.396722  -39.14373611  17.1801030
 [91,]   26.2082902 13.048781    0.88771108  51.0119351
 [92,]    8.5282645 11.188758  -13.29309131  30.1097454
 [93,]  -32.7855612  9.612346  -51.86687185 -14.3979393
 [94,]    2.6062131  8.479231  -14.40117006  19.2348044
 [95,]    3.0971874  7.980525  -12.60366849  18.8719935
 [96,]   10.0840618  8.232343   -6.10049944  25.9190059
 [97,]    3.3864361  9.173082  -14.91226541  21.0854716
 [98,]   -3.3005896 10.621236  -24.63355765  17.4323822
 [99,]   16.7521847 12.400288   -8.15898906  40.9618016
[100,]    0.6853590 14.388013  -28.27720405  28.3981584
[101,]    9.7222659 12.851636  -14.43454755  36.2893853
[102,]   -7.6724396 11.022378  -28.19734703  15.0352733
[103,]  -10.6717451  9.463411  -28.79662634   8.3712907
[104,]   -6.2835506  8.327936  -22.43537728   9.9634332
[105,]  -22.1034562  7.803073  -37.23660426  -7.0550470
[106,]  -14.6475617  8.009771  -30.44259136   0.6879525
[107,]  -14.4653672  8.897189  -31.64729899   2.4765061
[108,]    0.4636273 10.290703  -19.70919472  20.2736092
[109,]   17.0340218 12.015500   -6.34958908  40.0709134
[110,]   20.7903163 13.949227   -6.55874592  47.0618649
[111,]   17.6725503 13.145411   -7.18509433  43.9448678
[112,]  -12.1654258 11.281064  -33.53523497  10.4604034
[113,]  -16.4106018  9.696908  -35.10318227   2.9542056
[114,]  -34.0835779  8.550127  -50.36248810 -17.0427272
[115,]  -37.6896540  8.030338  -53.06963583 -21.7105756
[116,]    6.1230700  8.256817  -10.03243934  22.7186811
[117,]   38.8473939  9.174462   20.98602660  57.2636056
[118,]    5.3258178 10.605352  -15.12546251  26.4440550
[119,]   19.8991418 12.372683   -3.94539614  44.5071890
[120,]   -2.5308343 14.352703  -30.38792056  25.9079498
[121,]   -5.3883503 12.365507  -29.82996330  19.0499038
[122,]   36.6533328 10.640134   15.76409717  57.7459246
[123,]   -0.9997842  9.203783  -19.14171332  17.3804501
[124,]    2.2059988  8.209585  -14.24188520  18.1944618
[125,]  -14.0451182  7.827863  -30.03130531   1.1642989
[126,]   11.2716648  8.145187   -5.03528856  27.2007422
[127,]  -13.1047521  9.088630  -31.06016265   4.4477690
[128,]  -41.7452691 10.490605  -62.30875027 -21.5681123
[129,]    5.7116139 12.193969  -18.21148791  29.5494479
[130,]   24.2458969 14.089836   -3.28846715  52.0571870
[131,]  -50.0580351 12.533298  -75.51395643 -26.0072013
[132,]   12.3835583 10.740469   -9.51821691  33.1312432
[133,]   26.9929517  9.222380    8.49245566  44.7089109
[134,]   32.8947451  8.134338   16.49405892  48.5825683
[135,]   20.7042385  7.661796    5.43613163  35.6341645
[136,]   10.7175319  7.915763   -4.87156592  26.2428973
[137,]   -1.7597748  8.833800  -19.12641201  15.6149798
[138,]   -9.8289814 10.238811  -29.73678935  10.1484411
[139,]   -8.6961880 11.960393  -31.53604205  14.9708384
[140,]   -9.8702946 13.881256  -36.76615530  17.4600640
[141,]   17.3539401 12.529886   -7.51633067  41.5296931
[142,]    2.5317854 10.755134  -18.70175995  23.4372117
[143,]  -19.9982692  9.272755  -38.21190914  -1.3568618
[144,]  -10.9196239  8.242043  -27.14410893   5.8357809
[145,]   14.9104214  7.843135   -0.18269140  30.4528808
[146,]    5.9661667  8.169117   -9.75252449  22.1306097
[147,]  -24.4475879  9.142777  -42.42808552  -6.7921805
[148,]   14.2044574 10.586902   -6.04862435  35.0036847
[149,]   -4.9739973 12.337374  -28.78019452  19.3098042
[150,]    9.9235480 14.281993  -17.31695888  37.5396999
[151,]   -0.9792424 13.627065  -26.16491617  26.9579660
[152,]   -6.9150781 11.628211  -28.33633489  16.2767197
[153,]  -17.7331137  9.905732  -36.54709409   2.6813585
[154,]  -31.3562494  8.626795  -47.68851211 -13.5564475
[155,]  -19.4872850  8.006841  -35.18292328  -3.5743213
[156,]   41.9737793  8.196784   26.10971619  58.1420787
[157,]  -36.2671563  9.146303  -54.13951257 -18.3723920
[158,]   14.9749080 10.654215   -5.92723551  35.3870522
[159,]   17.3570723 12.520366   -7.69162618  41.3373304
[160,]    9.2275367 14.608103  -20.72403686  37.5391882
[161,]   17.9048212 12.422891   -6.76934917  42.5471399
[162,]   10.9427879 10.677846  -10.30365425  31.7617038
[163,]    6.8744547  9.217258  -11.27968463  24.8629770
[164,]    1.2406214  8.194669  -14.79441752  17.3266954
[165,]  -10.9028118  7.784643  -26.00561055   4.0986664
[166,]  -15.0857451  8.080967  -30.48235485   0.6538763
[167,]  -49.8563783  9.014249  -67.30707503 -32.7056643
[168,]  -14.0160116 10.414636  -34.21289551   5.9885350
[169,]   22.6096552 12.121299   -0.91568743  45.9954743
[170,]   31.7737219 14.022854    4.87310727  58.9623167
[171,]    6.2360529 12.185744  -18.08338374  30.0563005
[172,]   -1.5321138 10.491628  -22.38632046  19.0052662
[173,]   10.7602195  9.086099   -7.30674625  28.6745044
[174,]   11.9645527  8.120417   -4.10851878  27.6881589
[175,]  -23.3249140  7.760553  -38.50296029  -8.0524554
[176,]    7.2796193  8.087783   -8.33534960  23.2542485
[177,]    0.3233526  9.027697  -17.32106543  18.0293805
[178,]   -2.7690142 10.415729  -23.19140875  17.1383771
[179,]   11.3223191 12.098618  -12.57435627  34.5681931
[180,]   -5.5262476 13.970209  -33.40458783  21.4172039</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1770.0 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   370       
 (0.5, 0.7]   (ok)         1    0.6%   106       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.3 22.1
p_loo        33.4  8.1
looic      1720.7 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   799       
 (0.5, 0.7]   (ok)         5    2.8%   464       
   (0.7, 1]   (bad)        3    1.7%   36        
   (1, Inf)   (very bad)   1    0.6%   16        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.7      11.5  
fit_sleep1 -93.0      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1770.0 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   370       
 (0.5, 0.7]   (ok)         1    0.6%   106       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.3 22.1
p_loo        33.4  8.1
looic      1720.7 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   799       
 (0.5, 0.7]   (ok)         5    2.8%   464       
   (0.7, 1]   (bad)        3    1.7%   36        
   (1, Inf)   (very bad)   1    0.6%   16        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.3     22.1        33.4    8.1   1720.7
fit_sleep2  -24.7      11.5  -885.0     14.4        19.5    3.4   1770.0
fit_sleep1  -93.0      20.8  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.2  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
3.930121e-41 1.931506e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.53     0.44      5.4       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.53    -3.16     2.82       5.32      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.26 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.5      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.3         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.0          
 [52] processx_3.8.1       pkgbuild_1.4.0       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.0        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.0         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-1       
 [85] grid_4.3.0           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.31       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
