<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.90      6.70    15.98    42.30 1.00     1630     2400
sd(Days)                6.63      1.55     4.12    10.12 1.00     1371     2181
cor(Intercept,Days)     0.07      0.29    -0.49     0.65 1.00      925     1472

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.02      7.44   235.70   265.42 1.00     1539     2490
Days         10.41      1.70     7.07    13.83 1.00     1386     1941

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.53    23.12    29.05 1.00     3471     2962

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.4690  13.19385 227.3075 278.8514
309 211.8103  12.96653 186.5205 237.7611
310 212.9636  13.09822 186.6484 237.8114
330 274.5766  13.31386 250.0316 301.6603
331 273.3711  13.05267 248.6219 299.9381
332 260.4908  12.44425 236.1893 285.1675
333 268.0204  12.30721 244.2639 292.8476
334 244.3584  12.26063 220.4367 268.1694
335 251.1963  13.55238 225.9798 279.0286
337 285.7514  12.87523 261.2525 311.3721
349 226.5264  13.20336 200.2216 251.5718
350 238.8214  12.87473 213.0913 263.4712
351 255.8476  12.47334 231.9012 280.0354
352 272.1042  12.72639 247.6772 298.1938
369 254.8865  12.19586 231.0516 279.1721
370 226.1114  13.52140 198.2707 252.5432
371 252.0971  12.12928 228.2123 276.2409
372 263.7840  12.57745 239.5585 288.6185

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.7311195  2.531046 14.9553161 24.735012
309  1.6955704  2.477870 -3.1555294  6.553236
310  4.9588405  2.442969  0.2327805  9.794516
330  5.7054500  2.496408  0.4048850 10.374970
331  7.4649988  2.467992  2.6207810 12.201711
332 10.2185863  2.378753  5.4284397 14.923360
333 10.2712491  2.341201  5.4260166 14.709175
334 11.5125200  2.361194  6.9529180 16.156755
335 -0.2970142  2.605555 -5.4887612  4.762341
337 19.2069298  2.470033 14.3174894 24.114103
349 11.5856102  2.439905  6.9363823 16.408615
350 17.0251234  2.504085 12.1674613 21.974013
351  7.4585424  2.374946  2.7295988 12.084096
352 14.0301901  2.391621  9.2293074 18.764071
369 11.3193914  2.356824  6.6600800 15.907380
370 15.2534291  2.533007 10.3608981 20.340154
371  9.4623526  2.329568  5.0378631 14.150161
372 11.8052256  2.369437  7.1320240 16.301789</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.4690 13.193847 227.3075 278.8514
  [2,] 273.2001 11.258439 251.0714 294.9047
  [3,] 292.9312  9.604150 274.3781 311.5628
  [4,] 312.6624  8.398769 296.2565 328.9627
  [5,] 332.3935  7.851837 317.3816 347.7703
  [6,] 352.1246  8.097885 336.6741 367.8188
  [7,] 371.8557  9.072625 354.3625 389.3986
  [8,] 391.5868 10.576469 371.1095 412.1073
  [9,] 411.3180 12.418666 387.7955 435.3139
 [10,] 431.0491 14.470563 403.5154 459.5467
 [11,] 211.8103 12.966526 186.5205 237.7611
 [12,] 213.5059 11.111445 191.8183 235.7165
 [13,] 215.2015  9.543442 196.6644 234.3748
 [14,] 216.8970  8.424372 200.7247 233.6880
 [15,] 218.5926  7.946226 202.9997 234.4312
 [16,] 220.2882  8.221596 204.3710 236.9150
 [17,] 221.9837  9.182944 203.7081 240.1700
 [18,] 223.6793 10.646030 202.5970 244.2992
 [19,] 225.3749 12.434997 200.4584 249.6562
 [20,] 227.0705 14.429138 198.7635 255.4640
 [21,] 212.9636 13.098221 186.6484 237.8114
 [22,] 217.9225 11.289082 195.2540 239.2962
 [23,] 222.8813  9.760101 203.0302 241.2919
 [24,] 227.8401  8.660944 210.2209 244.3503
 [25,] 232.7990  8.167038 216.4860 248.5214
 [26,] 237.7578  8.386017 221.1230 254.1187
 [27,] 242.7167  9.267483 224.4185 260.8760
 [28,] 247.6755 10.648164 226.6848 268.3179
 [29,] 252.6343 12.361907 228.2035 277.1348
 [30,] 257.5932 14.289377 229.2422 286.3700
 [31,] 274.5766 13.313861 250.0316 301.6603
 [32,] 280.2820 11.391963 258.9594 303.5381
 [33,] 285.9875  9.734415 267.5181 305.9093
 [34,] 291.6929  8.497351 275.0424 308.5821
 [35,] 297.3984  7.881321 281.7257 312.6173
 [36,] 303.1038  8.030540 286.8522 318.7984
 [37,] 308.8093  8.906629 290.7913 326.0688
 [38,] 314.5147 10.326210 293.3882 334.2540
 [39,] 320.2202 12.099475 295.9323 343.1318
 [40,] 325.9256 14.093547 298.1184 352.8576
 [41,] 273.3711 13.052671 248.6219 299.9381
 [42,] 280.8361 11.165113 259.6254 303.7262
 [43,] 288.3011  9.546164 270.3264 307.5255
 [44,] 295.7661  8.353485 279.7135 312.7463
 [45,] 303.2311  7.785509 288.2084 318.3729
 [46,] 310.6961  7.976813 294.6165 326.1185
 [47,] 318.1611  8.878453 300.4792 335.3812
 [48,] 325.6261 10.305642 305.2346 345.6411
 [49,] 333.0911 12.073424 309.4795 356.2842
 [50,] 340.5561 14.053855 313.3713 368.0260
 [51,] 260.4908 12.444249 236.1893 285.1675
 [52,] 270.7094 10.731939 249.5573 291.5300
 [53,] 280.9280  9.317007 262.4488 298.9311
 [54,] 291.1466  8.351987 274.4165 307.2501
 [55,] 301.3651  8.001354 285.3723 316.8580
 [56,] 311.5837  8.342937 295.2925 327.7529
 [57,] 321.8023  9.300777 303.8486 339.9781
 [58,] 332.0209 10.710800 311.2023 352.7246
 [59,] 342.2395 12.419942 317.9264 366.2836
 [60,] 352.4581 14.321509 324.3149 380.0552
 [61,] 268.0204 12.307207 244.2639 292.8476
 [62,] 278.2916 10.631850 257.4112 299.3676
 [63,] 288.5629  9.250273 270.1971 306.4761
 [64,] 298.8341  8.310314 282.4811 314.9801
 [65,] 309.1054  7.969788 293.1433 324.2980
 [66,] 319.3766  8.302782 302.7790 335.4807
 [67,] 329.6479  9.236736 311.4567 347.3669
 [68,] 339.9191 10.614181 319.0007 360.4929
 [69,] 350.1904 12.286856 326.2856 373.8899
 [70,] 360.4616 14.150452 332.7637 387.8880
 [71,] 244.3584 12.260627 220.4367 268.1694
 [72,] 255.8710 10.568685 235.4368 276.8158
 [73,] 267.3835  9.177239 249.6595 285.6776
 [74,] 278.8960  8.239951 263.0547 295.4018
 [75,] 290.4085  7.919744 274.9495 306.1385
 [76,] 301.9210  8.288448 285.6527 318.2840
 [77,] 313.4336  9.264171 294.7856 331.5504
 [78,] 324.9461 10.681846 303.6100 345.4495
 [79,] 336.4586 12.390693 311.8597 361.0904
 [80,] 347.9711 14.286609 319.5996 376.3373
 [81,] 251.1963 13.552380 225.9798 279.0286
 [82,] 250.8993 11.539723 228.8955 274.5782
 [83,] 250.6023  9.810262 231.7894 270.7244
 [84,] 250.3052  8.537863 233.9168 267.6164
 [85,] 250.0082  7.945238 234.9409 265.7170
 [86,] 249.7112  8.181463 234.1197 266.0084
 [87,] 249.4142  9.182793 231.8312 268.4259
 [88,] 249.1172 10.737266 228.2218 270.7508
 [89,] 248.8202 12.642465 224.2155 274.1142
 [90,] 248.5232 14.763224 219.9140 277.7532
 [91,] 285.7514 12.875229 261.2525 311.3721
 [92,] 304.9584 11.043528 283.9715 327.0927
 [93,] 324.1653  9.505242 305.7828 343.0101
 [94,] 343.3722  8.422699 327.0013 359.8870
 [95,] 362.5792  7.983497 346.4583 378.3288
 [96,] 381.7861  8.290520 365.1697 397.9873
 [97,] 400.9930  9.269915 382.5156 419.0481
 [98,] 420.1999 10.739277 399.2816 440.8862
 [99,] 439.4069 12.527367 415.0759 463.8060
[100,] 458.6138 14.516884 430.0540 487.1455
[101,] 226.5264 13.203358 200.2216 251.5718
[102,] 238.1120 11.336294 215.2906 259.7258
[103,] 249.6976  9.726292 230.4679 268.3388
[104,] 261.2832  8.520341 244.6605 277.7831
[105,] 272.8689  7.905565 257.2666 288.4812
[106,] 284.4545  8.019100 268.7799 300.4298
[107,] 296.0401  8.832907 279.4407 313.8821
[108,] 307.6257 10.180413 288.2013 328.2445
[109,] 319.2113 11.881399 296.3365 343.1683
[110,] 330.7969 13.805823 303.9878 358.6520
[111,] 238.8214 12.874728 213.0913 263.4712
[112,] 255.8465 10.997643 233.6994 276.8549
[113,] 272.8716  9.416930 253.9807 290.8081
[114,] 289.8967  8.303605 272.9754 306.1154
[115,] 306.9218  7.858882 291.2469 322.4579
[116,] 323.9470  8.192380 307.7831 339.8981
[117,] 340.9721  9.220034 322.6527 359.1135
[118,] 357.9972 10.744480 336.7501 379.0361
[119,] 375.0223 12.586484 350.2071 399.5044
[120,] 392.0475 14.626557 363.2408 420.7556
[121,] 255.8476 12.473341 231.9012 280.0354
[122,] 263.3062 10.717376 242.8585 284.1806
[123,] 270.7647  9.242338 253.1132 288.8006
[124,] 278.2232  8.201231 262.5955 294.0327
[125,] 285.6818  7.770477 270.5087 300.7033
[126,] 293.1403  8.048675 277.5161 308.9174
[127,] 300.5989  8.970103 282.9570 318.1957
[128,] 308.0574 10.364607 287.5634 328.4290
[129,] 315.5160 12.069305 291.5551 339.4708
[130,] 322.9745 13.971110 294.7981 350.7012
[131,] 272.1042 12.726387 247.6772 298.1938
[132,] 286.1344 10.948257 265.2161 308.5593
[133,] 300.1646  9.444968 281.8322 318.8375
[134,] 314.1948  8.366016 297.8871 330.3081
[135,] 328.2250  7.887504 312.8772 343.4401
[136,] 342.2552  8.116336 326.1863 358.1263
[137,] 356.2854  8.998712 338.6601 373.5986
[138,] 370.3156 10.369108 349.6209 390.5062
[139,] 384.3457 12.062326 360.5197 407.7971
[140,] 398.3759 13.961400 370.5211 425.4251
[141,] 254.8865 12.195864 231.0516 279.1721
[142,] 266.2058 10.494554 245.5082 287.2934
[143,] 277.5252  9.090735 259.6230 295.3980
[144,] 288.8446  8.139810 272.5637 305.0473
[145,] 300.1640  7.809020 284.8397 315.7097
[146,] 311.4834  8.174002 295.4776 327.6856
[147,] 322.8028  9.151890 305.0495 340.6576
[148,] 334.1222 10.573982 313.9522 355.1818
[149,] 345.4416 12.286999 321.8295 369.7216
[150,] 356.7610 14.185939 329.2128 384.6464
[151,] 226.1114 13.521400 198.2707 252.5432
[152,] 241.3649 11.570618 217.7899 263.9706
[153,] 256.6183  9.887487 236.4717 275.6815
[154,] 271.8717  8.630054 254.8741 288.6899
[155,] 287.1252  8.001594 271.2273 303.0236
[156,] 302.3786  8.148953 286.3752 318.4303
[157,] 317.6320  9.034247 299.8541 335.3628
[158,] 332.8854 10.471965 312.2812 353.4907
[159,] 348.1389 12.269422 324.3922 371.8177
[160,] 363.3923 14.291523 335.4801 390.9220
[161,] 252.0971 12.129282 228.2123 276.2409
[162,] 261.5595 10.419063 241.1290 282.0910
[163,] 271.0218  8.991554 253.3301 288.6935
[164,] 280.4842  7.999561 265.1299 296.2042
[165,] 289.9465  7.615228 275.1566 304.8793
[166,] 299.4089  7.927432 284.0885 314.5258
[167,] 308.8712  8.862869 291.6809 325.9128
[168,] 318.3336 10.252340 298.5325 337.9388
[169,] 327.7959 11.938353 304.4505 351.1462
[170,] 337.2583 13.812742 310.1408 364.3111
[171,] 263.7840 12.577445 239.5585 288.6185
[172,] 275.5893 10.822645 254.9383 296.8739
[173,] 287.3945  9.343213 269.3858 305.7758
[174,] 299.1997  8.287948 283.4285 315.3525
[175,] 311.0049  7.830262 295.7615 326.1349
[176,] 322.8102  8.072446 307.1164 338.8785
[177,] 334.6154  8.957915 316.7126 352.1089
[178,] 346.4206 10.322430 325.8962 366.2988
[179,] 358.2258 12.003722 334.5602 381.3982
[180,] 370.0311 13.887210 342.7126 396.7122</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -3.9089951 13.193847  -29.2913941  22.2524906
  [2,]  -14.4954146 11.258439  -36.1999609   7.6333270
  [3,]  -42.1306341  9.604150  -60.7621719 -23.5774915
  [4,]    8.7774464  8.398769   -7.5228505  25.1832757
  [5,]   24.4584268  7.851837    9.0815880  39.4703400
  [6,]   62.5655073  8.097885   46.8712551  78.0159907
  [7,]   10.3480878  9.072625   -7.1947831  27.8412695
  [8,] -101.4382317 10.576469 -121.9586874 -80.9608522
  [9,]   19.2673488 12.418666   -4.7285730  42.7898375
 [10,]   35.3044292 14.470563    6.8068465  62.8381333
 [11,]   10.9235750 12.966526  -15.0271842  36.2134494
 [12,]   -8.2400954 11.111445  -30.4506838  13.4474879
 [13,]  -12.2236657  9.543442  -31.3969587   6.3134328
 [14,]  -12.1900361  8.424372  -28.9809920   3.9822739
 [15,]  -10.8765064  7.946226  -26.7151318   4.7163947
 [16,]   -4.3263768  8.221596  -20.9531778  11.5908247
 [17,]   -8.3534472  9.182944  -26.5396551   9.9222320
 [18,]   -5.9521175 10.646030  -26.5720259  15.1302436
 [19,]   -1.0791879 12.434997  -25.3605178  23.8373308
 [20,]   10.2437418 14.429138  -18.1498040  38.5507186
 [21,]  -13.9097250 13.098221  -38.7575232  12.4054801
 [22,]  -23.5902655 11.289082  -44.9639971  -0.9217511
 [23,]   11.4386940  9.760101   -6.9719183  31.2897690
 [24,]    5.0014535  8.660944  -11.5087295  22.6207051
 [25,]   -3.4915870  8.167038  -19.2139759  12.8214397
 [26,]  -17.2999275  8.386017  -33.6607595  -0.6650622
 [27,]   -7.2958680  9.267483  -25.4552300  11.0023009
 [28,]    8.0755915 10.648164  -12.5667563  29.0663044
 [29,]    8.3781510 12.361907  -16.1223123  32.8090054
 [30,]  -10.0778895 14.289377  -38.8547188  18.2731179
 [31,]   46.9660244 13.313861   19.8822763  71.5110308
 [32,]   20.1181744 11.391963   -3.1378751  41.4407804
 [33,]   -2.1309755  9.734415  -22.0527906  16.3383617
 [34,]   -6.5599255  8.497351  -23.4491415  10.0905979
 [35,]  -11.6010755  7.881321  -26.8200399   4.0715980
 [36,]   -5.5183254  8.030540  -21.2128775  10.7332503
 [37,]  -28.5696754  8.906629  -45.8292458 -10.5517104
 [38,]    3.7465746 10.326210  -15.9927334  24.8730559
 [39,]  -14.8706753 12.099475  -37.7822995   9.4171635
 [40,]   28.1230747 14.093547    1.1910583  55.9303431
 [41,]   14.2367683 13.052671  -12.3302264  38.9860116
 [42,]    4.1638694 11.165113  -18.7261928  25.3746023
 [43,]   13.5194706  9.546164   -5.7048940  31.4942145
 [44,]   24.3491718  8.353485    7.3689890  40.4017787
 [45,]   13.0461730  7.785509   -2.0955869  28.0688771
 [46,]  -17.3774259  7.976813  -32.7998430  -1.2977537
 [47,]  -28.0861247  8.878453  -45.3061706 -10.4041581
 [48,]    9.1915765 10.305642  -10.8233690  29.5830752
 [49,]  -39.3442223 12.073424  -62.5372912 -15.7325764
 [50,]   31.0249788 14.053855    3.5550998  58.2098404
 [51,]  -25.6301980 12.444249  -50.3068974  -1.3286864
 [52,]  -27.8975842 10.731939  -48.7181843  -6.7454958
 [53,]   -7.9666705  9.317007  -25.9697836  10.5125420
 [54,]   18.6222432  8.351987    2.5187191  35.3523425
 [55,]   16.0977569  8.001354    0.6048620  32.0906199
 [56,]   -1.5861294  8.342937  -17.7553124  14.7051386
 [57,]  132.3595844  9.300777  114.1837556 150.3132972
 [58,]   14.8101981 10.710800   -5.8935220  35.6288099
 [59,]  -11.9391882 12.419942  -35.9832512  12.3738876
 [60,]  -98.5936745 14.321509 -126.1908427 -70.4505113
 [61,]   15.8220244 12.307207   -9.0051772  39.5784853
 [62,]   11.2633752 10.631850   -9.8125644  32.1438218
 [63,]  -11.7935739  9.250273  -29.7067507   6.5722348
 [64,]    0.9755770  8.310314  -15.1704388  17.3286480
 [65,]  -11.9343722  7.969788  -27.1270158   4.0277049
 [66,]   18.7898787  8.302782    2.6858065  35.3875384
 [67,]    2.3786295  9.236736  -15.3403732  20.5698187
 [68,]    8.9207804 10.614181  -11.6530198  29.8391932
 [69,]  -16.8303687 12.286856  -40.5298692   7.0744078
 [70,]    1.5811821 14.150452  -25.8452205  29.2791433
 [71,]   21.1146611 12.260627   -2.6962867  45.0364051
 [72,]   20.3302411 10.568685   -0.6145987  40.7643668
 [73,]  -24.0187789  9.177239  -42.3129116  -6.2947963
 [74,]  -24.2236988  8.239951  -40.7295478  -8.3823655
 [75,]  -11.3841188  7.919744  -27.1140670   4.0748766
 [76,]  -17.7298387  8.288448  -34.0927576  -1.4615108
 [77,]   -7.9087587  9.264171  -26.0256460  10.7391555
 [78,]    6.5768213 10.681846  -13.9266477  27.9129128
 [79,]   -0.7116986 12.390693  -25.3434614  23.8872083
 [80,]   29.3278814 14.286609    0.9616528  57.6994148
 [81,]   -9.5879786 13.552380  -37.4203489  15.6285071
 [82,]   23.0479356 11.539723   -0.6309942  45.0517258
 [83,]    3.8884498  9.810262  -16.2337177  22.7013391
 [84,]   20.4968641  8.537863    3.1856673  36.8853467
 [85,]    1.4436783  7.945238  -14.2651468  16.5110247
 [86,]    4.9249925  8.181463  -11.3722283  20.5164951
 [87,]   -3.9618932  9.182793  -22.9736347  13.6211065
 [88,]  -13.8061790 10.737266  -35.4398476   7.0892263
 [89,]  -13.0660648 12.642465  -38.3601096  11.5386429
 [90,]  -11.2765506 14.763224  -40.5065898  17.3325811
 [91,]   26.6151674 12.875229    0.9944878  51.1141103
 [92,]    8.8474376 11.043528  -13.2868783  29.8343108
 [93,]  -32.5540922  9.505242  -51.3989389 -14.1716416
 [94,]    2.7499780  8.422699  -13.7648106  19.1208607
 [95,]    3.1532482  7.983497  -12.5963919  19.2740704
 [96,]   10.0524184  8.290520   -6.1488267  26.6688440
 [97,]    3.2670885  9.269915  -14.7880311  21.7445303
 [98,]   -3.5076413 10.739277  -24.1938958  17.4106799
 [99,]   16.4574289 12.527367   -7.9417395  40.7883545
[100,]    0.3028991 14.516884  -28.2287708  28.8627296
[101,]    9.5767880 13.203358  -15.4686140  35.8816044
[102,]   -7.7953222 11.336294  -29.4090728  15.0260530
[103,]  -10.7720324  9.726292  -29.4132330   8.4576916
[104,]   -6.3612427  8.520341  -22.8611447  10.2615462
[105,]  -22.1585529  7.905565  -37.7709189  -6.5563212
[106,]  -14.6800632  8.019100  -30.6553706   0.9944988
[107,]  -14.4752734  8.832907  -32.3172790   2.1241273
[108,]    0.4763163 10.180413  -20.1425378  19.9007133
[109,]   17.0693061 11.881399   -6.8876615  39.9440899
[110,]   20.8481958 13.805823   -7.0068915  47.6572617
[111,]   17.4754438 12.874728   -7.1743790  43.2054851
[112,]  -12.3921796 10.997643  -33.4006046   9.7549079
[113,]  -16.6670029  9.416930  -34.6034744   2.2238634
[114,]  -34.3696263  8.303605  -50.5882625 -17.4482954
[115,]  -38.0053496  7.858882  -53.5413503 -22.3304006
[116,]    5.7777270  8.192380  -10.1733561  21.9416496
[117,]   38.4724036  9.220034   20.3310248  56.7918350
[118,]    4.9211803 10.744480  -16.1176795  26.1682501
[119,]   19.4648569 12.586484   -5.0172452  44.2801302
[120,]   -2.9947664 14.626557  -31.7029000  25.8118556
[121,]   -5.3211225 12.473341  -29.5089357  18.6252955
[122,]   36.7514350 10.717376   15.8769815  57.1990543
[123,]   -0.8708074  9.242338  -18.9066768  16.7807493
[124,]    2.3658502  8.201231  -13.4436480  17.9936452
[125,]  -13.8543922  7.770477  -28.8759362   1.3187160
[126,]   11.4932654  8.048675   -4.2838036  27.1174547
[127,]  -12.8522771  8.970103  -30.4490685   4.7896398
[128,]  -41.4619195 10.364607  -61.8334772 -20.9678611
[129,]    6.0258381 12.069305  -17.9290141  29.9867052
[130,]   24.5909957 13.971110   -3.1357295  52.7674140
[131,]  -50.4271266 12.726387  -76.5166565 -26.0000587
[132,]   12.0594833 10.948257  -10.3653807  32.9777604
[133,]   26.7138932  9.444968    8.0410388  45.0462973
[134,]   32.6607031  8.366016   16.5474339  48.9683969
[135,]   20.5152130  7.887504    5.3000778  35.8630441
[136,]   10.5735229  8.116336   -5.2975874  26.6423621
[137,]   -1.8587672  8.998712  -19.1719866  15.7664904
[138,]   -9.8829573 10.369108  -30.0736141  10.8116610
[139,]   -8.7051474 12.062326  -32.1565369  15.1209038
[140,]   -9.8342375 13.961400  -36.8833747  18.0206447
[141,]   17.0370436 12.195864   -7.2485910  40.8719229
[142,]    2.2310522 10.494554  -18.8564850  22.9286739
[143,]  -20.2828392  9.090735  -38.1555747  -2.3805547
[144,]  -11.1880307  8.139810  -27.3906670   5.0929141
[145,]   14.6581779  7.809020   -0.8875044  29.9825005
[146,]    5.7300865  8.174002  -10.4720979  21.7358738
[147,]  -24.6675050  9.151890  -42.5222676  -6.9141641
[148,]   14.0007036 10.573982   -7.0589039  34.1707433
[149,]   -5.1615878 12.286999  -29.4416217  18.4504948
[150,]    9.7521208 14.185939  -18.1332810  37.3003289
[151,]   -0.8474337 13.521400  -27.2791920  26.9932981
[152,]   -6.8413628 11.570618  -29.4470942  16.7336068
[153,]  -17.7174919  9.887487  -36.7807107   2.4291089
[154,]  -31.3987210  8.630054  -48.2169094 -14.4011304
[155,]  -19.5878502  8.001594  -35.4862513  -3.6900407
[156,]   41.8151207  8.148953   25.7634430  57.8184928
[157,]  -36.4839084  9.034247  -54.2146930 -18.7060189
[158,]   14.7000625 10.471965   -5.9051959  35.3043028
[159,]   17.0241333 12.269422   -6.6546528  40.7708032
[160,]    8.8365042 14.291523  -18.6932489  36.7486506
[161,]   17.7832711 12.129282   -6.3605060  41.6680838
[162,]   10.8833185 10.419063   -9.6481782  31.3138337
[163,]    6.8770658  8.991554  -10.7945525  24.5687872
[164,]    1.3053132  7.999561  -14.4147096  16.6595766
[165,]  -10.7760394  7.615228  -25.7088296   4.0139042
[166,]  -14.8968920  7.927432  -30.0138171   0.4235199
[167,]  -49.6054446  8.862869  -66.6470347 -32.4151107
[168,]  -13.7029972 10.252340  -33.3081606   6.0980647
[169,]   22.9847501 11.938353   -0.3655353  46.3302439
[170,]   32.2108975 13.812742    5.1581223  59.3284142
[171,]    5.6276750 12.577445  -19.2068466  29.8532106
[172,]   -2.1152506 10.822645  -23.3999130  18.5356868
[173,]   10.2023238  9.343213   -8.1789816  28.2110326
[174,]   11.4318982  8.287948   -4.7209407  27.2031157
[175,]  -23.8323273  7.830262  -38.9622993  -8.5889387
[176,]    6.7974471  8.072446   -9.2708532  22.4911662
[177,]   -0.1335785  8.957915  -17.6271033  17.7692422
[178,]   -3.2007041 10.322430  -23.0789457  17.3237464
[179,]   10.9158703 12.003722  -12.2565081  34.5815028
[180,]   -5.9074552 13.887210  -32.5885501  21.4109714</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.5
p_loo        19.6  3.5
looic      1770.0 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1162      
 (0.5, 0.7]   (ok)         1    0.6%   492       
   (0.7, 1]   (bad)        1    0.6%   64        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.3
p_loo        33.8  8.5
looic      1721.4 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   603       
 (0.5, 0.7]   (ok)         7    3.9%   61        
   (0.7, 1]   (bad)        1    0.6%   16        
   (1, Inf)   (very bad)   1    0.6%   23        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.6  
fit_sleep1 -92.6      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.5
p_loo        19.6  3.5
looic      1770.0 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1162      
 (0.5, 0.7]   (ok)         1    0.6%   492       
   (0.7, 1]   (bad)        1    0.6%   64        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.3
p_loo        33.8  8.5
looic      1721.4 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   603       
 (0.5, 0.7]   (ok)         7    3.9%   61        
   (0.7, 1]   (bad)        1    0.6%   16        
   (1, Inf)   (very bad)   1    0.6%   23        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.7     22.3        33.8    8.5   1721.4
fit_sleep2  -24.3      11.6  -885.0     14.5        19.6    3.5   1770.0
fit_sleep1  -92.6      21.0  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.7  
fit_sleep2   28.9  
fit_sleep1   21.1  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.251843e-41 2.721795e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.82      1.61     0.17     5.43       0.05      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.18      1.61    -3.58      2.9        5.8      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0.1       tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
