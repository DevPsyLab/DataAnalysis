<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.
Running the chains for more iterations may help. See
https://mc-stan.org/misc/warnings.html#bulk-ess</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.01      6.91    15.46    42.68 1.00     1558     2505
sd(Days)                6.58      1.52     4.14     9.97 1.00     1329     2006
cor(Intercept,Days)     0.08      0.30    -0.48     0.65 1.00      983     1522

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.26      7.44   236.50   265.85 1.00     1853     2020
Days         10.37      1.72     6.84    13.67 1.00     1438     1712

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.57    23.10    29.26 1.00     3058     2925

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7404  13.36914 227.1564 279.0517
309 211.6536  13.15907 185.7710 236.8925
310 213.0047  13.64695 186.6030 239.9726
330 274.6979  13.51008 249.3795 302.4811
331 273.3497  13.25479 248.3040 299.7507
332 260.2929  12.23121 236.4277 284.9458
333 267.8848  12.32471 244.0052 292.8655
334 244.3205  12.26558 220.1248 268.1514
335 250.6302  13.48731 224.5975 277.3452
337 285.7421  13.41851 259.0812 311.9559
349 226.8770  12.91317 202.2197 251.6565
350 238.3464  13.12638 211.3566 263.5648
351 255.7316  12.52421 231.5177 280.5641
352 271.8274  12.59312 247.1027 296.2657
369 254.6542  12.16803 230.6374 278.2996
370 226.4287  13.68514 198.7408 252.0057
371 251.8899  12.29145 228.1621 276.3078
372 263.6125  12.44493 239.6950 288.5185

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6373874  2.560209 14.76077839 24.880996
309  1.7563550  2.512021 -3.27440719  6.562025
310  4.8908455  2.560758 -0.07440646 10.012827
330  5.6585721  2.544565  0.61133075 10.484475
331  7.4654721  2.507446  2.53106998 12.317251
332 10.2340679  2.359051  5.62335519 14.767038
333 10.3014111  2.337014  5.59230304 14.797912
334 11.5212770  2.354542  6.87976037 16.253043
335 -0.2007626  2.570220 -5.37841796  4.795383
337 19.2166897  2.515202 14.36935172 24.201716
349 11.5017581  2.438336  6.82909273 16.313634
350 17.0707879  2.480624 12.39688578 22.093300
351  7.4837103  2.373522  2.65096174 12.066032
352 14.1142720  2.390835  9.45523010 18.802397
369 11.2988587  2.317379  6.65214196 15.914154
370 15.1371850  2.552309 10.14185534 20.152937
371  9.4990415  2.330386  4.88132783 14.021751
372 11.8021712  2.368850  7.04896780 16.419797</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7404 13.369137 227.1564 279.0517
  [2,] 273.3778 11.410823 251.0790 295.3514
  [3,] 293.0151  9.735977 273.8704 311.6254
  [4,] 312.6525  8.513577 295.8328 329.2949
  [5,] 332.2899  7.955002 316.3709 347.6802
  [6,] 351.9273  8.197102 335.6681 367.3770
  [7,] 371.5647  9.176723 353.5758 389.1535
  [8,] 391.2021 10.693052 370.3978 412.4671
  [9,] 410.8395 12.553080 386.2749 435.7206
 [10,] 430.4769 14.626265 402.4066 459.4421
 [11,] 211.6536 13.159069 185.7710 236.8925
 [12,] 213.4100 11.276365 191.3285 234.8846
 [13,] 215.1663  9.683605 196.1073 233.9771
 [14,] 216.9227  8.544501 200.2101 233.8850
 [15,] 218.6790  8.053899 202.6023 234.5852
 [16,] 220.4354  8.327220 204.1505 236.5148
 [17,] 222.1917  9.297331 204.3942 240.2051
 [18,] 223.9481 10.777692 202.6926 244.5561
 [19,] 225.7044 12.589576 201.0692 249.9291
 [20,] 227.4608 14.610158 199.0722 255.4917
 [21,] 213.0047 13.646947 186.6030 239.9726
 [22,] 217.8955 11.640519 195.3529 240.7668
 [23,] 222.7864  9.893391 203.6867 241.7587
 [24,] 227.6772  8.565724 210.8293 244.2051
 [25,] 232.5680  7.872677 216.7048 247.6422
 [26,] 237.4589  7.981317 221.7286 253.0520
 [27,] 242.3497  8.862210 224.8942 259.5349
 [28,] 247.2406 10.319452 227.4177 267.6996
 [29,] 252.1314 12.147360 228.4673 276.0352
 [30,] 257.0223 14.203542 228.9120 285.1874
 [31,] 274.6979 13.510078 249.3795 302.4811
 [32,] 280.3565 11.536304 258.6016 303.7329
 [33,] 286.0150  9.828530 266.9960 305.7214
 [34,] 291.6736  8.547709 274.8035 308.6920
 [35,] 297.3322  7.904194 281.8288 313.2783
 [36,] 302.9907  8.052258 287.1879 319.2125
 [37,] 308.6493  8.952712 291.2423 326.3036
 [38,] 314.3079 10.412151 293.9340 334.7152
 [39,] 319.9665 12.232102 296.1856 343.8327
 [40,] 325.6250 14.275342 297.3355 353.8963
 [41,] 273.3497 13.254794 248.3040 299.7507
 [42,] 280.8152 11.359635 259.4342 303.3458
 [43,] 288.2806  9.745135 269.8378 307.8012
 [44,] 295.7461  8.571380 279.6947 312.9060
 [45,] 303.2116  8.033929 287.8207 319.0337
 [46,] 310.6771  8.257969 294.7784 326.8809
 [47,] 318.1425  9.187963 300.4021 336.3814
 [48,] 325.6080 10.640388 305.0804 347.2996
 [49,] 333.0735 12.433487 309.0070 358.1390
 [50,] 340.5389 14.440912 312.2765 369.6616
 [51,] 260.2929 12.231210 236.4277 284.9458
 [52,] 270.5270 10.501491 250.4156 291.5475
 [53,] 280.7611  9.060375 263.3893 298.9591
 [54,] 290.9952  8.064101 275.4754 306.8472
 [55,] 301.2292  7.687606 286.2530 316.0934
 [56,] 311.4633  8.018672 295.2218 327.0061
 [57,] 321.6974  8.979375 303.9740 339.0241
 [58,] 331.9314 10.396609 311.4729 352.6958
 [59,] 342.1655 12.111153 318.7127 366.4086
 [60,] 352.3996 14.014308 325.1479 380.6033
 [61,] 267.8848 12.324709 244.0052 292.8655
 [62,] 278.1862 10.615114 257.6410 299.6295
 [63,] 288.4876  9.186192 270.6863 306.9712
 [64,] 298.7890  8.186261 282.9936 314.8080
 [65,] 309.0904  7.782472 293.8455 324.2229
 [66,] 319.3918  8.064871 303.6921 335.2575
 [67,] 329.6932  8.968873 312.1742 347.6574
 [68,] 339.9947 10.332593 319.8270 360.4642
 [69,] 350.2961 12.000315 327.1242 373.9575
 [70,] 360.5975 13.862752 334.0485 387.9701
 [71,] 244.3205 12.265579 220.1248 268.1514
 [72,] 255.8417 10.555984 235.2263 276.4036
 [73,] 267.3630  9.137882 249.6157 285.2267
 [74,] 278.8843  8.164602 263.2377 294.8069
 [75,] 290.4056  7.804377 274.9942 305.5353
 [76,] 301.9269  8.139018 285.5636 317.7009
 [77,] 313.4481  9.092121 295.7476 330.7927
 [78,] 324.9694 10.496545 304.1045 345.0737
 [79,] 336.4907 12.197376 312.1614 360.1603
 [80,] 348.0120 14.087663 320.1036 375.4288
 [81,] 250.6302 13.487307 224.5975 277.3452
 [82,] 250.4294 11.484798 227.9909 272.9914
 [83,] 250.2287  9.752219 231.1127 269.2855
 [84,] 250.0279  8.457128 233.3324 266.4357
 [85,] 249.8272  7.819995 234.2566 264.7677
 [86,] 249.6264  7.999605 233.9181 265.0676
 [87,] 249.4256  8.946905 231.3442 266.8017
 [88,] 249.2249 10.455266 228.1233 269.7318
 [89,] 249.0241 12.320313 224.0082 273.0614
 [90,] 248.8233 14.404156 219.6174 277.2211
 [91,] 285.7421 13.418507 259.0812 311.9559
 [92,] 304.9588 11.518991 282.5865 327.9606
 [93,] 324.1755  9.898002 304.9613 344.0006
 [94,] 343.3922  8.712419 326.2828 361.1129
 [95,] 362.6089  8.154417 346.4833 378.9912
 [96,] 381.8256  8.350766 365.3824 398.5352
 [97,] 401.0423  9.253569 382.8329 419.3602
 [98,] 420.2590 10.685237 399.5248 441.1413
 [99,] 439.4757 12.464851 415.6032 464.0669
[100,] 458.6923 14.464550 431.1517 487.2380
[101,] 226.8770 12.913168 202.2197 251.6565
[102,] 238.3787 11.063050 216.7093 259.8635
[103,] 249.8805  9.482784 231.5503 268.1267
[104,] 261.3822  8.327443 244.9581 277.2240
[105,] 272.8840  7.788476 257.3827 288.1965
[106,] 284.3858  7.991583 268.4586 299.9255
[107,] 295.8875  8.886022 278.2283 313.4489
[108,] 307.3893 10.293122 287.0633 327.3947
[109,] 318.8910 12.034379 295.0070 342.3405
[110,] 330.3928 13.985535 302.3875 357.7426
[111,] 238.3464 13.126384 211.3566 263.5648
[112,] 255.4172 11.244416 232.4199 277.1303
[113,] 272.4880  9.637366 252.9033 291.2447
[114,] 289.5588  8.463319 272.5140 306.0974
[115,] 306.6296  7.917303 290.7425 322.1764
[116,] 323.7004  8.126906 307.7131 339.5805
[117,] 340.7712  9.039718 322.9336 358.6628
[118,] 357.8420 10.473462 337.0963 378.6766
[119,] 374.9127 12.246521 351.1614 399.0342
[120,] 391.9835 14.232644 364.6324 419.9185
[121,] 255.7316 12.524212 231.5177 280.5641
[122,] 263.2154 10.785796 242.6882 284.6646
[123,] 270.6991  9.331566 252.5866 289.2676
[124,] 278.1828  8.312044 262.1220 294.6677
[125,] 285.6665  7.897419 270.2968 301.2109
[126,] 293.1502  8.180196 276.8389 308.9905
[127,] 300.6339  9.095559 282.7425 318.0061
[128,] 308.1176 10.479026 287.4637 328.4640
[129,] 315.6013 12.172018 291.7972 339.0290
[130,] 323.0850 14.063187 296.0004 349.7360
[131,] 271.8274 12.593116 247.1027 296.2657
[132,] 285.9417 10.818642 264.5042 307.0925
[133,] 300.0559  9.323714 281.4136 318.0692
[134,] 314.1702  8.261504 297.6370 330.1785
[135,] 328.2845  7.810597 312.4365 343.0735
[136,] 342.3987  8.074070 326.1062 357.6662
[137,] 356.5130  8.989324 338.7672 373.6011
[138,] 370.6273 10.385446 350.2791 390.8784
[139,] 384.7416 12.097074 361.0556 408.5649
[140,] 398.8558 14.009036 371.4070 426.2357
[141,] 254.6542 12.168026 230.6374 278.2996
[142,] 265.9531 10.516395 245.3605 286.1444
[143,] 277.2519  9.157988 259.2511 294.8678
[144,] 288.5508  8.239139 272.2736 304.7228
[145,] 299.8496  7.914454 284.0519 315.5673
[146,] 311.1485  8.254346 294.7901 327.5393
[147,] 322.4474  9.185335 304.3726 340.7045
[148,] 333.7462 10.552110 312.9091 354.8269
[149,] 345.0451 12.209183 321.0978 369.2255
[150,] 356.3439 14.054244 328.8676 384.2059
[151,] 226.4287 13.685136 198.7408 252.0057
[152,] 241.5659 11.726216 218.1426 263.4969
[153,] 256.7031 10.037625 236.9018 275.5232
[154,] 271.8402  8.776801 254.5802 288.0575
[155,] 286.9774  8.144884 271.0207 302.3993
[156,] 302.1146  8.287013 285.8353 317.9549
[157,] 317.2518  9.167258 298.9112 335.0076
[158,] 332.3890 10.603358 311.2854 352.7563
[159,] 347.5262 12.403723 323.1766 371.3512
[160,] 362.6634 14.432673 334.7031 390.5678
[161,] 251.8899 12.291454 228.1621 276.3078
[162,] 261.3890 10.615955 240.7838 282.2572
[163,] 270.8880  9.229224 252.6256 288.7641
[164,] 280.3870  8.277683 263.9225 296.5430
[165,] 289.8861  7.919778 274.2702 305.3218
[166,] 299.3851  8.233295 283.3289 315.5569
[167,] 308.8842  9.149469 290.8492 326.8656
[168,] 318.3832 10.511890 297.7329 339.3576
[169,] 327.8822 12.171617 303.9038 352.1256
[170,] 337.3813 14.023484 310.0920 365.4971
[171,] 263.6125 12.444934 239.6950 288.5185
[172,] 275.4147 10.686031 254.7853 296.4966
[173,] 287.2168  9.204838 269.3045 305.4060
[174,] 299.0190  8.154123 282.6471 314.9802
[175,] 310.8212  7.711894 295.5906 326.3053
[176,] 322.6233  7.979962 307.0767 338.3983
[177,] 334.4255  8.894334 317.2127 351.9959
[178,] 346.2277 10.284040 326.0667 366.7320
[179,] 358.0299 11.984852 334.9684 381.7247
[180,] 369.8320 13.882895 342.7192 396.9455</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error       Q2.5      Q97.5
  [1,]   -4.61616508  29.34675  -63.90685  53.272872
  [2,]  -14.49689046  28.69715  -71.05169  41.269418
  [3,]  -43.36774649  28.07854  -98.38572  12.419597
  [4,]    8.38669898  27.24577  -43.72129  62.444652
  [5,]   25.06372885  26.71033  -26.72031  76.497818
  [6,]   62.92777449  27.18597   10.41299 116.398173
  [7,]   10.25232804  27.29798  -42.15763  64.850149
  [8,] -101.39372603  27.98988 -156.14485 -45.364376
  [9,]   19.95782303  28.74770  -35.83133  76.818645
 [10,]   35.54181095  29.63920  -21.22587  93.248403
 [11,]   11.01166019  29.14747  -45.71445  68.152732
 [12,]   -7.67704096  28.64451  -63.57570  48.203805
 [13,]  -12.43086003  28.06284  -67.73075  42.250004
 [14,]  -11.43024821  27.67921  -64.70294  43.014138
 [15,]  -10.62597280  26.97955  -63.18491  41.870171
 [16,]   -4.71986640  26.90033  -57.93284  47.939989
 [17,]   -8.30753580  27.66817  -63.52593  45.581085
 [18,]   -6.81205996  27.74627  -60.08907  47.188104
 [19,]   -0.99170865  28.84708  -59.14805  56.117899
 [20,]   10.06792427  29.82015  -47.79946  67.504478
 [21,]  -14.22546534  29.54063  -72.39182  42.908932
 [22,]  -23.78939468  28.59659  -79.33885  33.861506
 [23,]   11.22838741  27.65880  -42.30510  65.657716
 [24,]    5.06915009  27.12192  -49.20187  58.276919
 [25,]   -3.39519088  27.20963  -57.07144  49.983338
 [26,]  -16.93777556  26.86080  -69.83953  35.802468
 [27,]   -6.89905450  27.47306  -61.68705  45.758771
 [28,]    8.47936665  28.24935  -45.84201  63.005455
 [29,]    8.91862785  28.58135  -46.74002  65.508311
 [30,]  -10.07032627  29.48381  -66.87121  49.076774
 [31,]   47.14131842  29.02346   -8.78791 105.813414
 [32,]   20.63877223  28.56148  -35.29574  76.199248
 [33,]   -1.60488381  27.79569  -55.55259  55.058921
 [34,]   -7.04511330  27.77754  -62.75521  46.849572
 [35,]  -12.37703844  26.66685  -64.66192  40.768221
 [36,]   -5.78516154  26.96641  -58.77709  46.834113
 [37,]  -28.72960500  27.33655  -83.21994  24.800900
 [38,]    4.19809034  27.78280  -48.96883  60.021028
 [39,]  -14.44551159  28.08829  -68.49576  39.915237
 [40,]   28.16176758  30.43303  -32.31714  88.231566
 [41,]   14.02143812  28.95927  -42.19546  70.425177
 [42,]    4.26935022  28.46029  -50.95186  60.853660
 [43,]   13.75285865  27.64929  -39.65967  68.532736
 [44,]   24.05222609  27.29600  -29.05096  77.416615
 [45,]   12.22338034  27.36266  -41.23396  65.498634
 [46,]  -17.24495689  27.62411  -72.45543  38.024068
 [47,]  -28.78221581  27.26570  -81.86920  25.650436
 [48,]    9.08175343  27.82888  -44.53592  63.156111
 [49,]  -39.14240696  28.73677  -96.56220  17.819354
 [50,]   31.67388022  29.67437  -27.11635  89.303150
 [51,]  -25.30391094  28.90600  -81.49116  31.944251
 [52,]  -27.20829717  27.49901  -80.32758  27.590904
 [53,]   -8.50715214  27.89282  -62.44281  46.596690
 [54,]   18.51995303  27.42674  -36.68631  71.235537
 [55,]   16.41707972  26.87957  -35.44593  69.377528
 [56,]   -1.74640421  26.88804  -55.55385  50.434899
 [57,]  132.36698626  27.01401   79.88129 185.013077
 [58,]   14.59757553  27.66615  -42.47715  67.450378
 [59,]  -11.93540495  29.25192  -69.46440  45.643147
 [60,]  -97.94056063  29.45310 -155.38177 -38.359876
 [61,]   16.06416275  28.47145  -39.95147  72.499778
 [62,]   11.40669839  28.75725  -45.65592  68.229920
 [63,]  -11.90684980  27.35682  -63.69114  40.035852
 [64,]    1.13328328  27.08802  -51.09786  55.800715
 [65,]  -11.45888324  27.18472  -63.39979  43.126673
 [66,]   18.72868048  27.11315  -35.45610  71.840933
 [67,]    2.29077995  28.48398  -54.13274  58.650553
 [68,]    9.66986241  28.15900  -45.17841  63.647728
 [69,]  -17.05477082  29.52704  -76.73584  39.546819
 [70,]    2.06927784  29.12870  -56.49284  58.201480
 [71,]   21.59762972  28.99985  -35.50216  77.832003
 [72,]   20.41432006  28.58942  -35.53135  76.068970
 [73,]  -23.85954247  27.06237  -76.55343  29.063370
 [74,]  -25.00264212  26.36738  -76.72575  27.240755
 [75,]  -11.55169048  27.45649  -66.07839  42.874127
 [76,]  -17.29432811  26.78556  -69.86939  37.040412
 [77,]   -7.30539044  28.15186  -62.89826  48.729929
 [78,]    6.12049041  27.67581  -49.76760  58.959646
 [79,]   -0.47509767  28.29452  -56.43109  56.275377
 [80,]   29.38159568  29.77271  -29.23819  88.963066
 [81,]   -9.70738104  29.15984  -65.18749  48.659796
 [82,]   23.36468695  28.41042  -31.45553  79.971154
 [83,]    3.85926275  28.28249  -51.19292  61.034736
 [84,]   21.11592243  27.26648  -30.64934  73.266318
 [85,]    1.54676681  26.77016  -49.25943  55.085601
 [86,]    4.29700586  26.76540  -47.43172  55.481380
 [87,]   -4.15196885  27.53802  -59.19424  49.918572
 [88,]  -14.61492335  28.43666  -70.48268  41.316906
 [89,]  -12.85515955  28.99126  -69.60715  42.968683
 [90,]  -12.12452756  29.60277  -71.84873  46.051341
 [91,]   27.01214447  29.36197  -29.51889  86.394550
 [92,]    9.04748777  28.51082  -46.25880  64.322753
 [93,]  -32.45176968  27.36264  -84.58139  22.090943
 [94,]    3.26385861  27.15285  -49.52904  56.746316
 [95,]    3.16204089  27.54193  -52.86546  56.013041
 [96,]    9.55171003  27.56400  -43.56272  63.119409
 [97,]    3.36240696  27.30758  -51.23836  55.264028
 [98,]   -3.90597089  27.70380  -56.43342  49.590060
 [99,]   15.61013877  28.89027  -43.30273  72.688657
[100,]    0.26248192  29.15389  -55.46313  56.320849
[101,]    8.92635107  29.47027  -48.12725  66.651006
[102,]   -8.44857933  27.69151  -63.04783  44.570046
[103,]  -10.66793466  27.34801  -64.60878  42.479450
[104,]   -6.19197967  27.46620  -60.67316  45.703845
[105,]  -22.11834725  27.13823  -75.05643  31.253805
[106,]  -14.87130604  27.30812  -69.43079  38.021906
[107,]  -14.29678926  27.09395  -67.18847  37.600824
[108,]    0.25715327  27.91161  -55.13287  55.637454
[109,]   17.69410527  28.97878  -38.81593  74.220005
[110,]   20.68974648  30.05592  -38.38783  79.817016
[111,]   18.63909450  28.90554  -39.79774  75.756812
[112,]  -11.91134445  28.73137  -68.04393  45.647252
[113,]  -16.41614449  27.50650  -69.54546  37.466958
[114,]  -33.61564755  27.13247  -88.77857  18.789481
[115,]  -38.37759707  27.66283  -93.82968  15.950401
[116,]    6.81162611  27.33630  -47.71804  58.435624
[117,]   39.07903361  27.37860  -12.94294  91.875231
[118,]    4.81453792  28.31761  -50.05126  59.845145
[119,]   20.04591905  28.93894  -35.93843  77.003681
[120,]   -3.09890293  29.76391  -60.96777  56.010611
[121,]   -5.21484584  29.17904  -62.28804  51.212640
[122,]   37.23452934  28.18264  -18.61060  91.908300
[123,]   -0.84610454  27.26873  -53.78223  51.056165
[124,]    3.12958589  26.75765  -48.40792  56.707054
[125,]  -14.36773097  27.14680  -67.09650  38.078046
[126,]   10.95657666  27.29853  -40.29215  64.965100
[127,]  -12.68760045  27.77292  -68.75369  41.176096
[128,]  -41.25976146  27.95093  -95.02060  13.283423
[129,]    5.75812456  28.46927  -50.61252  61.178091
[130,]   24.07253839  30.05713  -35.09012  82.375078
[131,]  -50.02517925  28.94567 -105.46272   7.171850
[132,]   12.30429450  28.04030  -42.40776  67.043830
[133,]   28.45270937  27.55528  -25.35358  82.494581
[134,]   32.43616581  26.77123  -20.01438  85.737958
[135,]   20.88272744  27.13619  -33.11770  74.521033
[136,]   10.70308638  27.33999  -42.71526  63.474676
[137,]   -2.60668298  26.74686  -54.90276  50.753877
[138,]   -9.59051311  28.11579  -63.98836  46.507370
[139,]   -9.35185717  28.68071  -64.89992  46.271376
[140,]  -10.01356800  28.60006  -65.64960  46.017541
[141,]   17.09449531  28.59552  -38.24813  74.460043
[142,]    2.54433894  27.52680  -52.70084  56.220704
[143,]  -20.65829046  27.22304  -75.60793  31.649415
[144,]  -10.77650309  27.00914  -62.68259  42.069304
[145,]   15.12839591  26.97525  -37.64923  66.610963
[146,]    6.29361803  27.23902  -46.25361  60.433815
[147,]  -24.90823914  27.55420  -79.30973  27.781913
[148,]   14.39755243  27.87014  -41.33500  69.733140
[149,]   -5.03483968  28.45486  -60.69044  51.303229
[150,]    9.97806563  29.70463  -47.43564  67.168827
[151,]   -1.89599233  28.94449  -57.96008  55.837098
[152,]   -7.60417340  28.45158  -62.00361  48.558870
[153,]  -17.71214121  27.47953  -71.15518  34.936326
[154,]  -31.83855469  28.05081  -88.82679  23.311018
[155,]  -19.86255347  26.76159  -73.41148  34.014822
[156,]   43.31625105  26.70063  -10.50019  97.103714
[157,]  -36.18359167  27.61664  -91.48805  17.886924
[158,]   15.09002989  28.19162  -42.08278  69.363722
[159,]   18.13868138  28.95948  -38.93889  75.339332
[160,]    9.92063434  29.58817  -47.76710  68.636496
[161,]   17.71474339  28.67870  -37.97506  73.966985
[162,]   11.35823673  27.55764  -42.82537  64.842693
[163,]    6.61684586  27.64868  -47.33212  61.012579
[164,]    1.75825234  27.24217  -51.10206  54.386766
[165,]  -10.28288787  27.01868  -63.63504  43.287659
[166,]  -14.63964136  27.32983  -68.73468  38.721261
[167,]  -49.54476239  27.30208 -102.94725   4.585033
[168,]  -14.52167088  27.62636  -68.23351  38.651020
[169,]   22.81051352  28.16937  -33.94359  76.864218
[170,]   32.51191993  29.28512  -24.59170  88.771089
[171,]    5.70166091  28.95027  -49.70298  61.963859
[172,]   -2.04281624  27.94136  -56.96541  52.579296
[173,]    9.93360783  27.53262  -44.50112  62.556312
[174,]   11.47049976  27.46075  -42.64529  65.036377
[175,]  -23.53335186  26.97518  -77.46569  30.738555
[176,]    6.35460812  27.00259  -46.14699  59.305349
[177,]    0.05250512  27.40385  -54.57886  52.371952
[178,]   -2.61646852  28.15673  -58.75431  51.416816
[179,]   10.23867631  28.90428  -49.04283  66.397918
[180,]   -5.78141655  29.47664  -62.90057  52.826019</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.5  3.3
looic      1770.1 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1437      
 (0.5, 0.7]   (ok)         2    1.1%   207       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.6 22.0
p_loo        33.5  8.1
looic      1721.2 44.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   523       
 (0.5, 0.7]   (ok)         3    1.7%   480       
   (0.7, 1]   (bad)        4    2.2%   23        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.4      11.4  
fit_sleep1 -92.7      20.7  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.5  3.3
looic      1770.1 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1437      
 (0.5, 0.7]   (ok)         2    1.1%   207       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.6 22.0
p_loo        33.5  8.1
looic      1721.2 44.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   523       
 (0.5, 0.7]   (ok)         3    1.7%   480       
   (0.7, 1]   (bad)        4    2.2%   23        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.6     22.0        33.5    8.1   1721.2
fit_sleep2  -24.4      11.4  -885.0     14.3        19.5    3.3   1770.1
fit_sleep1  -92.7      20.7  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.1  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
5.676269e-41 2.486947e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(
  set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
  set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
  set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))

bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.83      1.56     0.26     5.36       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.17      1.56    -3.34      2.8       5.55      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.20.1         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-1       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.3       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.1       rmarkdown_2.24      
 [22] markdown_1.8         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.40            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.1          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.1         tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.2          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.5         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.29              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.3        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.3.0   mvtnorm_1.2-3       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.3          V8_4.3.3            
 [94] gtable_0.3.4         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.6     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoCiAgc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogIHNldF9wcmlvcigibGtqKDIpIiwgY2xhc3MgPSAiY29yIikpCgpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
