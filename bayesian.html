<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing adapt_delta
above 0.8 may help. See http://mc-stan.org/misc/warnings.html#divergent-
transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.70      6.96    15.44    42.86 1.00     1362     2221
sd(Days)                6.55      1.50     4.19     9.96 1.00     1425     2062
cor(Intercept,Days)     0.08      0.30    -0.49     0.68 1.00      743     1542

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.76      7.43   237.61   266.47 1.00     1606     2080
Days         10.47      1.64     7.22    13.67 1.00     1345     1847

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.93      1.56    23.14    29.19 1.00     4065     2811

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0958  13.12024 227.5718 278.9856
309 211.6751  13.17679 184.7356 236.8109
310 213.2713  13.28239 185.9391 239.4842
330 274.6302  13.43531 249.4430 302.4663
331 273.1157  12.83090 248.4181 299.2455
332 260.2625  12.26345 237.0269 284.2305
333 267.7590  12.46139 243.8711 293.1234
334 244.6167  12.26447 220.8601 268.6072
335 251.0700  13.53011 225.7051 277.4204
337 285.8001  12.84642 260.0443 311.2652
349 226.6127  12.97982 200.4018 251.3677
350 238.9286  12.78811 213.2717 262.6207
351 255.9606  12.21279 231.9973 280.1825
352 272.4501  12.57774 248.0930 298.0133
369 254.8662  12.31926 230.8833 279.1036
370 226.5711  13.70872 199.0847 252.6240
371 252.2146  12.38911 227.3905 277.3569
372 263.3076  12.56509 239.0237 289.0026

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.5550014  2.547035 14.57454153 24.675075
309  1.7333273  2.507490 -3.10675593  6.789243
310  4.8699616  2.425369  0.05511029  9.707342
330  5.7286059  2.552557  0.77211955 10.592467
331  7.4890716  2.422478  2.65570241 12.221692
332 10.2081757  2.333731  5.52385261 14.676269
333 10.2992840  2.400718  5.50409522 14.810865
334 11.4830451  2.367276  6.86275243 16.284883
335 -0.2351907  2.615827 -5.54175823  4.757384
337 19.2261281  2.446596 14.40277400 24.103610
349 11.5498846  2.404627  7.02675631 16.413348
350 16.9937035  2.415192 12.42121523 21.882328
351  7.4605827  2.335918  2.78250553 11.981998
352 13.9516044  2.374125  9.16975267 18.675749
369 11.3338330  2.363343  6.77099710 16.024721
370 15.1592688  2.577993 10.25218710 20.509787
371  9.4558764  2.355621  4.72212666 14.034296
372 11.8293285  2.337423  7.23314483 16.231599</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0958 13.120238 227.5718 278.9856
  [2,] 273.6508 11.199298 251.2251 294.7811
  [3,] 293.2058  9.575108 274.1001 311.3676
  [4,] 312.7608  8.421156 295.6294 328.7082
  [5,] 332.3158  7.945051 317.0056 347.5566
  [6,] 351.8708  8.264779 335.9960 367.9197
  [7,] 371.4258  9.298606 353.4539 389.7221
  [8,] 390.9808 10.844186 370.0053 412.5848
  [9,] 410.5358 12.716266 385.8181 435.5972
 [10,] 430.0908 14.791391 401.5531 458.8752
 [11,] 211.6751 13.176790 184.7356 236.8109
 [12,] 213.4084 11.271892 190.5568 234.9463
 [13,] 215.1418  9.646675 195.7564 233.5869
 [14,] 216.8751  8.463812 200.3375 232.9265
 [15,] 218.6084  7.923945 203.0186 233.8360
 [16,] 220.3417  8.155778 204.2526 236.2260
 [17,] 222.0751  9.100523 204.2940 240.0943
 [18,] 223.8084 10.568696 203.2333 244.7795
 [19,] 225.5417 12.375385 201.1257 250.0332
 [20,] 227.2750 14.393679 199.1352 255.5456
 [21,] 213.2713 13.282392 185.9391 239.4842
 [22,] 218.1413 11.441636 194.8593 240.5745
 [23,] 223.0113  9.857229 203.1496 242.2004
 [24,] 227.8812  8.670855 210.9620 244.5754
 [25,] 232.7512  8.060230 217.2581 248.3843
 [26,] 237.6211  8.155718 221.5877 253.6857
 [27,] 242.4911  8.934707 224.8336 259.8989
 [28,] 247.3611 10.242416 226.8974 267.4593
 [29,] 252.2310 11.905881 228.3671 275.3963
 [30,] 257.1010 13.797020 229.6463 283.7268
 [31,] 274.6302 13.435309 249.4430 302.4663
 [32,] 280.3588 11.436717 258.9506 303.7635
 [33,] 286.0874  9.701574 267.2558 305.6296
 [34,] 291.8160  8.394861 275.4604 308.3872
 [35,] 297.5446  7.736791 282.4406 312.3181
 [36,] 303.2732  7.891342 287.4613 318.5896
 [37,] 309.0018  8.815879 291.5832 326.0916
 [38,] 314.7304 10.305205 294.5355 335.0221
 [39,] 320.4590 12.153431 296.5088 344.4952
 [40,] 326.1876 14.221308 298.5778 354.3951
 [41,] 273.1157 12.830895 248.4181 299.2455
 [42,] 280.6048 11.012004 259.1737 302.7227
 [43,] 288.0938  9.467491 269.5182 306.8247
 [44,] 295.5829  8.351007 279.0945 312.0590
 [45,] 303.0720  7.847424 287.8078 318.4193
 [46,] 310.5610  8.072274 294.8774 326.0328
 [47,] 318.0501  8.970949 300.6060 336.2826
 [48,] 325.5392 10.369718 305.4206 346.4977
 [49,] 333.0283 12.096321 309.3004 357.5329
 [50,] 340.5173 14.030242 312.8754 368.5392
 [51,] 260.2625 12.263446 237.0269 284.2305
 [52,] 270.4707 10.578847 250.3941 290.9995
 [53,] 280.6789  9.182839 263.0549 298.2931
 [54,] 290.8871  8.223724 274.7977 306.9476
 [55,] 301.0952  7.863037 285.5933 316.7814
 [56,] 311.3034  8.180322 295.2898 327.8014
 [57,] 321.5116  9.104977 303.6807 339.1919
 [58,] 331.7198 10.477410 311.4075 352.0056
 [59,] 341.9280 12.146779 318.5123 365.2327
 [60,] 352.1361 14.007319 324.8585 378.8741
 [61,] 267.7590 12.461395 243.8711 293.1234
 [62,] 278.0583 10.688801 257.6442 299.6939
 [63,] 288.3576  9.205513 270.9396 306.5933
 [64,] 298.6569  8.170641 283.0829 315.2040
 [65,] 308.9562  7.765575 293.6334 324.5537
 [66,] 319.2555  8.085532 303.4422 335.4656
 [67,] 329.5547  9.053971 312.0472 347.4297
 [68,] 339.8540 10.492847 319.5587 360.5307
 [69,] 350.1533 12.237327 325.9244 374.0610
 [70,] 360.4526 14.175028 332.1892 388.1261
 [71,] 244.6167 12.264470 220.8601 268.6072
 [72,] 256.0997 10.561716 235.3690 276.8814
 [73,] 267.5828  9.159172 249.9267 285.7401
 [74,] 279.0658  8.212126 263.5372 295.6021
 [75,] 290.5488  7.886418 275.4069 306.2115
 [76,] 302.0319  8.255916 285.9820 318.3521
 [77,] 313.5149  9.237570 295.3052 331.6071
 [78,] 324.9980 10.663641 303.7122 346.1253
 [79,] 336.4810 12.381509 311.8843 360.9260
 [80,] 347.9641 14.286297 319.8302 375.8760
 [81,] 251.0700 13.530113 225.7051 277.4204
 [82,] 250.8348 11.508268 228.8321 273.3209
 [83,] 250.5996  9.772492 231.8568 269.7567
 [84,] 250.3644  8.499886 233.6530 267.3967
 [85,] 250.1292  7.917047 234.9360 265.5742
 [86,] 249.8940  8.172900 233.8298 265.8908
 [87,] 249.6588  9.197721 231.6108 267.7327
 [88,] 249.4236 10.774272 228.5191 270.2665
 [89,] 249.1885 12.698697 225.0411 273.6480
 [90,] 248.9533 14.836239 220.2406 277.6047
 [91,] 285.8001 12.846424 260.0443 311.2652
 [92,] 305.0262 11.046287 283.3197 326.5821
 [93,] 324.2523  9.538448 305.6745 343.1136
 [94,] 343.4785  8.480281 326.7130 360.3459
 [95,] 362.7046  8.051089 347.1573 378.7468
 [96,] 381.9307  8.348447 366.0132 398.3536
 [97,] 401.1568  9.302943 383.4416 419.4845
 [98,] 420.3830 10.740792 399.7283 441.5520
 [99,] 439.6091 12.496245 415.7033 464.5133
[100,] 458.8352 14.454043 430.8601 488.1925
[101,] 226.6127 12.979820 200.4018 251.3677
[102,] 238.1626 11.168949 215.5177 259.9535
[103,] 249.7125  9.621828 230.5127 268.7990
[104,] 261.2624  8.483996 244.8504 278.1585
[105,] 272.8122  7.933553 257.6601 288.5271
[106,] 284.3621  8.091279 268.3195 300.6672
[107,] 295.9120  8.919685 278.1988 313.7351
[108,] 307.4619 10.257545 287.3781 327.9339
[109,] 319.0118 11.934745 296.0061 342.8178
[110,] 330.5617 13.828359 303.7778 357.7147
[111,] 238.9286 12.788105 213.2717 262.6207
[112,] 255.9223 10.975576 234.1972 276.4262
[113,] 272.9160  9.437012 253.7433 290.9137
[114,] 289.9097  8.325709 273.1904 306.3009
[115,] 306.9034  7.825853 291.6989 322.3443
[116,] 323.8971  8.052131 308.2639 339.8505
[117,] 340.8908  8.949635 323.4748 358.8141
[118,] 357.8845 10.345115 337.3931 378.4242
[119,] 374.8782 12.067028 351.3486 398.5857
[120,] 391.8719 13.995400 364.9813 419.9531
[121,] 255.9606 12.212795 231.9973 280.1825
[122,] 263.4211 10.562933 242.7176 283.8425
[123,] 270.8817  9.214758 253.2460 289.1221
[124,] 278.3423  8.316310 262.4458 294.7837
[125,] 285.8029  8.020179 270.4348 301.4802
[126,] 293.2635  8.390384 277.3644 310.0542
[127,] 300.7241  9.348094 282.6123 319.0594
[128,] 308.1846 10.737233 287.3067 329.0005
[129,] 315.6452 12.413804 291.4760 339.9263
[130,] 323.1058 14.276901 295.2240 351.1130
[131,] 272.4501 12.577744 248.0930 298.0133
[132,] 286.4017 10.835433 265.5205 307.9869
[133,] 300.3533  9.374781 282.2192 319.0878
[134,] 314.3050  8.345021 298.0175 330.8813
[135,] 328.2566  7.916133 312.6809 343.9208
[136,] 342.2082  8.183146 326.4363 358.1642
[137,] 356.1598  9.084908 338.6425 374.0780
[138,] 370.1114 10.458496 349.4380 390.7561
[139,] 384.0630 12.144863 360.4295 407.8654
[140,] 398.0146 14.031684 370.3766 425.7981
[141,] 254.8662 12.319264 230.8833 279.1036
[142,] 266.2000 10.581278 245.4581 287.1089
[143,] 277.5339  9.128715 259.9405 295.6798
[144,] 288.8677  8.116291 273.4184 304.9842
[145,] 300.2015  7.719179 285.2498 315.4870
[146,] 311.5354  8.029199 296.0494 327.4736
[147,] 322.8692  8.973357 305.6719 340.5779
[148,] 334.2030 10.380030 314.2265 354.7567
[149,] 345.5369 12.088824 322.1064 370.2706
[150,] 356.8707 13.989464 329.6921 385.0370
[151,] 226.5711 13.708721 199.0847 252.6240
[152,] 241.7303 11.714154 218.6001 264.1392
[153,] 256.8896  9.990290 237.2152 275.9665
[154,] 272.0489  8.699567 255.0326 289.0300
[155,] 287.2082  8.053021 271.7242 303.1042
[156,] 302.3674  8.204385 286.5066 318.3440
[157,] 317.5267  9.113990 299.7526 335.1997
[158,] 332.6860 10.588191 311.3187 353.3610
[159,] 347.8452 12.427666 322.9063 372.1046
[160,] 363.0045 14.494001 334.3003 391.5247
[161,] 252.2146 12.389113 227.3905 277.3569
[162,] 261.6705 10.698128 240.6258 282.7289
[163,] 271.1264  9.300950 252.6001 289.2670
[164,] 280.5822  8.346454 264.2006 297.1010
[165,] 290.0381  7.994799 274.2950 305.3053
[166,] 299.4940  8.322755 283.0629 315.5336
[167,] 308.9499  9.258379 290.5227 326.6030
[168,] 318.4057 10.642594 296.8682 338.7973
[169,] 327.8616 12.325175 303.1420 351.5129
[170,] 337.3175 14.200457 309.0672 364.4431
[171,] 263.3076 12.565086 239.0237 289.0026
[172,] 275.1369 10.838913 254.2552 297.2777
[173,] 286.9662  9.381353 268.7369 305.6689
[174,] 298.7956  8.334543 282.7596 315.2366
[175,] 310.6249  7.864257 295.3690 326.2566
[176,] 322.4542  8.071900 306.6039 338.5188
[177,] 334.2835  8.910201 316.5938 352.3098
[178,] 346.1129 10.225209 325.7289 366.4417
[179,] 357.9422 11.859393 334.7042 381.1066
[180,] 369.7715 13.699000 342.9528 396.5067</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.53580586 13.120238  -29.4256224  21.9882054
  [2,]  -14.94610725 11.199298  -36.0764447   7.4795801
  [3,]  -42.40520864  9.575108  -60.5669577 -23.2995080
  [4,]    8.67898998  8.421156   -7.2683532  25.8104164
  [5,]   24.53608859  7.945051    9.2952856  39.8462743
  [6,]   62.81928720  8.264779   46.7704385  78.6940649
  [7,]   10.77798581  9.298606   -7.5183449  28.7498788
  [8,] -100.83221558 10.844186 -122.4361728 -79.8567379
  [9,]   20.04948303 12.716266   -5.0119107  44.7672214
 [10,]   36.26268165 14.791391    7.4782782  64.8003780
 [11,]   11.05879889 13.176790  -14.0770183  37.9982742
 [12,]   -8.14262845 11.271892  -29.6804515  14.7090385
 [13,]  -12.16395578  9.646675  -30.6091171   7.2214216
 [14,]  -12.16808311  8.463812  -28.2194991   4.3695077
 [15,]  -10.89231045  7.923945  -26.1198763   4.6975446
 [16,]   -4.37993778  8.155778  -20.2641831  11.7091847
 [17,]   -8.44476512  9.100523  -26.4639891   9.3362609
 [18,]   -6.08119245 10.568696  -27.0522881  14.4939309
 [19,]   -1.24601978 12.375385  -25.7374784  23.1700333
 [20,]   10.03915288 14.393679  -18.2313593  38.1790147
 [21,]  -14.21743215 13.282392  -40.4303306  13.1147957
 [22,]  -23.80909373 11.441636  -46.2423333  -0.5271425
 [23,]   11.30874469  9.857229   -7.8804164  31.1703605
 [24,]    4.96038312  8.670855  -11.7337596  21.8796175
 [25,]   -3.44377846  8.060230  -19.0769121  12.0493493
 [26,]  -17.16324004  8.155718  -33.2278081  -1.1297791
 [27,]   -7.07030161  8.934707  -24.4781468  10.5871997
 [28,]    8.39003681 10.242416  -11.7082325  28.8536652
 [29,]    8.78147523 11.905881  -14.3838222  32.6453598
 [30,]   -9.58568634 13.797020  -36.2114657  17.8689926
 [31,]   46.91243165 13.435309   19.0762951  72.0996356
 [32,]   20.04142577 11.436717   -3.3633417  41.4495963
 [33,]   -2.23088010  9.701574  -21.7730985  16.6007195
 [34,]   -6.68298598  8.394861  -23.2541813   9.6725767
 [35,]  -11.74729185  7.736791  -26.5208180   3.3566575
 [36,]   -5.68769773  7.891342  -21.0040752  10.1241889
 [37,]  -28.76220360  8.815879  -45.8519982 -11.3436212
 [38,]    3.53089052 10.305205  -16.7607718  23.7258383
 [39,]  -15.10951535 12.153431  -39.1456869   8.8407421
 [40,]   27.86107877 14.221308   -0.3463530  55.4709200
 [41,]   14.49221002 12.830895  -11.6376134  39.1897909
 [42,]    4.39523840 11.012004  -17.7227095  25.8262721
 [43,]   13.72676677  9.467491   -5.0041152  32.3024027
 [44,]   24.53239515  8.351007    8.0563186  41.0208065
 [45,]   13.20532352  7.847424   -2.1419855  28.4694935
 [46,]  -17.24234810  8.072274  -32.7141288  -1.5586532
 [47,]  -27.97511973  8.970949  -46.2075779 -10.5309642
 [48,]    9.27850865 10.369718  -11.6799779  29.3971397
 [49,]  -39.28136297 12.096321  -63.7859936 -15.5534655
 [50,]   31.06376540 14.030242    3.0419121  58.7056955
 [51,]  -25.40194610 12.263446  -49.3698591  -2.1663188
 [52,]  -27.65892181 10.578847  -48.1877285  -7.5823188
 [53,]   -7.71759752  9.182839  -25.3318488   9.9063552
 [54,]   18.88172677  8.223724    2.8211705  34.9710950
 [55,]   16.36765106  7.863037    0.6815192  31.8695948
 [56,]   -1.30582465  8.180322  -17.8038384  14.7078104
 [57,]  132.65029964  9.104977  114.9700472 150.4812161
 [58,]   15.11132392 10.477410   -5.1744835  35.4236435
 [59,]  -11.62765179 12.146779  -34.9323688  11.7879862
 [60,]  -98.27172750 14.007319 -125.0097175 -70.9941161
 [61,]   16.08335543 12.461395   -9.2809807  39.9713029
 [62,]   11.49667142 10.688801  -10.1388743  31.9108346
 [63,]  -11.58831259  9.205513  -29.8239707   5.8297249
 [64,]    1.15280340  8.170641  -15.3943309  16.7268467
 [65,]  -11.78518061  7.765575  -27.3827139   3.5375525
 [66,]   18.91103538  8.085532    2.7008603  34.7242954
 [67,]    2.47175137  9.053971  -15.4032269  19.9793113
 [68,]    8.98586736 10.492847  -11.6908100  29.2812161
 [69,]  -16.79331665 12.237327  -40.7010095   7.4355520
 [70,]    1.59019934 14.175028  -26.0833329  29.8535821
 [71,]   20.85643182 12.264470   -3.1341173  44.6130471
 [72,]   20.10148667 10.561716   -0.6802025  40.8322148
 [73,]  -24.21805848  9.159172  -42.3753791  -6.5620386
 [74,]  -24.39350363  8.212126  -40.9298203  -8.8649386
 [75,]  -11.52444878  7.886418  -27.1871284   3.6175409
 [76,]  -17.84069393  8.255916  -34.1609125  -1.7907644
 [77,]   -7.99013908  9.237570  -26.0823071  10.2195824
 [78,]    6.52491577 10.663641  -14.6023795  27.8106723
 [79,]   -0.73412938 12.381509  -25.1790641  23.8625991
 [80,]   29.33492547 14.286297    1.4229678  57.4687874
 [81,]   -9.46168106 13.530113  -35.8120919  15.9032223
 [82,]   23.11240965 11.508268    0.6263040  45.1150915
 [83,]    3.89110036  9.772492  -15.2660349  22.6338810
 [84,]   20.43769107  8.499886    3.4054090  37.1490957
 [85,]    1.32268178  7.917047  -14.1223150  16.5158951
 [86,]    4.74217249  8.172900  -11.2545746  20.8064274
 [87,]   -4.20653680  9.197721  -22.2803963  13.8415104
 [88,]  -14.11264609 10.774272  -34.9555014   6.7919463
 [89,]  -13.43435538 12.698697  -37.8939207  10.7130490
 [90,]  -11.70666467 14.836239  -40.3581361  17.0059687
 [91,]   26.56652127 12.846424    1.1013865  52.3222533
 [92,]    8.77959320 11.046287  -12.7762544  30.4861453
 [93,]  -32.64113487  9.538448  -51.5024300 -14.0632939
 [94,]    2.64373706  8.480281  -14.2237312  19.4091859
 [95,]    3.02780898  8.051089  -13.0144222  18.5751463
 [96,]    9.90778091  8.348447   -6.5151258  25.8252841
 [97,]    3.10325284  9.302943  -15.2244213  20.8184717
 [98,]   -3.69067523 10.740792  -24.8597114  16.9639716
 [99,]   16.25519670 12.496245   -8.6490219  40.1609964
[100,]    0.08146863 14.454043  -29.2758475  28.0565833
[101,]    9.49048907 12.979820  -15.2645235  35.7014348
[102,]   -7.84589557 11.168949  -29.6368386  14.7989838
[103,]  -10.78688021  9.621828  -29.8734231   8.4128577
[104,]   -6.34036485  8.483996  -23.2364765  10.0715587
[105,]  -22.10194950  7.933553  -37.8168053  -6.9497538
[106,]  -14.58773414  8.091279  -30.8927852   1.4548521
[107,]  -14.34721878  8.919685  -32.1703419   3.3660273
[108,]    0.64009658 10.257545  -19.8319283  20.7238803
[109,]   17.26881193 11.934745   -6.5371878  40.2745091
[110,]   21.08342729 13.828359   -6.0695852  47.8673386
[111,]   17.36824974 12.788105   -6.3238946  43.0250616
[112,]  -12.46795375 10.975576  -32.9718856   9.2570867
[113,]  -16.71135724  9.437012  -34.7090998   2.4613022
[114,]  -34.38256073  8.325709  -50.7737730 -17.6632662
[115,]  -37.98686423  7.825853  -53.4277604 -22.7824479
[116,]    5.82763228  8.052131  -10.1258152  21.4608375
[117,]   38.55372879  8.949635   20.6304244  55.9696693
[118,]    5.03392530 10.345115  -15.5058312  25.5253076
[119,]   19.60902181 12.067028   -4.0985246  43.1386152
[120,]   -2.81918169 13.995400  -30.9004159  24.0713873
[121,]   -5.43406303 12.212795  -29.6559887  18.5291969
[122,]   36.63645425 10.562933   16.2150851  57.3399535
[123,]   -0.98782847  9.214758  -19.2282374  16.6479254
[124,]    2.24678882  8.316310  -14.1945513  18.1432853
[125,]  -13.97549390  8.020179  -29.6527720   1.3925574
[126,]   11.37012338  8.390384   -5.4206288  27.2691507
[127,]  -12.97745934  9.348094  -31.3128083   5.1343366
[128,]  -41.58914206 10.737233  -62.4050315 -20.7112477
[129,]    5.89657523 12.413804  -18.3844539  30.0657772
[130,]   24.45969251 14.276901   -3.5474752  52.3414960
[131,]  -50.77303873 12.577744  -76.3361816 -26.4158557
[132,]   11.79215691 10.835433   -9.7930384  32.6734016
[133,]   26.52515255  9.374781    7.7906998  44.6592612
[134,]   32.55054818  8.345021   15.9741731  48.8379510
[135,]   20.48364382  7.916133    4.8193997  36.0593244
[136,]   10.62053946  8.183146   -5.3354752  26.3924393
[137,]   -1.73316491  9.084908  -19.6513556  15.7840971
[138,]   -9.67876927 10.458496  -30.3234579  10.9945970
[139,]   -8.42237363 12.144863  -32.2248325  15.2111370
[140,]   -9.47287800 14.031684  -37.2564426  18.1651402
[141,]   17.05729986 12.319264   -7.1800669  41.0401704
[142,]    2.23686683 10.581278  -18.6719783  22.9787744
[143,]  -20.29146620  9.128715  -38.4373848  -2.6980996
[144,]  -11.21109923  8.116291  -27.3276492   4.2382201
[145,]   14.62066774  7.719179   -0.6648023  29.5723831
[146,]    5.67813471  8.029199  -10.2600895  21.1640563
[147,]  -24.73389832  8.973357  -42.4426168  -7.5366319
[148,]   13.91986865 10.380030   -6.6337618  33.8963544
[149,]   -5.25686438 12.088824  -29.9905541  18.1735622
[150,]    9.64240259 13.989464  -18.5239343  36.8210464
[151,]   -1.30707656 13.708721  -27.3600342  26.1792522
[152,]   -7.20684534 11.714154  -29.6156509  15.9233964
[153,]  -17.98881412  9.990290  -37.0656791   1.6856342
[154,]  -31.57588289  8.699567  -48.5570316 -14.5596458
[155,]  -19.67085167  8.053021  -35.5669373  -4.1869290
[156,]   41.82627955  8.204385   25.8496502  57.6871112
[157,]  -36.37858923  9.113990  -54.0516083 -18.6045169
[158,]   14.89954199 10.588191   -5.7755186  36.2668323
[159,]   17.31777321 12.427666   -6.9415551  42.2567436
[160,]    9.22430443 14.494001  -19.2958761  37.9284587
[161,]   17.66578692 12.389113   -7.4764605  42.4899232
[162,]   10.77231056 10.698128  -10.2860533  31.8169659
[163,]    6.77253420  9.300950  -11.3680578  25.2987940
[164,]    1.20725784  8.346454  -15.3114866  17.5888580
[165,]  -10.86761852  7.994799  -26.1347959   4.8754999
[166,]  -14.98199488  8.322755  -31.0216363   1.4490684
[167,]  -49.68407125  9.258379  -67.3371558 -31.2569498
[168,]  -13.77514761 10.642594  -34.1666522   7.7623744
[169,]   22.91907603 12.325175   -0.7321534  47.6386840
[170,]   32.15169967 14.200457    5.0260645  60.4019972
[171,]    6.10412934 12.565086  -19.5908509  30.3880042
[172,]   -1.66289917 10.838913  -23.8037193  19.2188216
[173,]   10.63057233  9.381353   -8.0720898  28.8599382
[174,]   11.83604382  8.334543   -4.6049963  27.8720215
[175,]  -23.45228469  7.864257  -39.0840379  -8.1963506
[176,]    7.15338680  8.071900   -8.9112445  23.0036501
[177,]    0.19825830  8.910201  -17.8280414  17.8879953
[178,]   -2.89297021 10.225209  -23.2217766  17.4909603
[179,]   11.19950128 11.859393  -11.9648970  34.4375391
[180,]   -5.64792722 13.699000  -32.3830845  21.1707935</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.3  3.3
looic      1769.5 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   410       
 (0.5, 0.7]   (ok)         1    0.6%   226       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.1
p_loo        33.8  8.2
looic      1721.6 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   612       
 (0.5, 0.7]   (ok)         5    2.8%   281       
   (0.7, 1]   (bad)        3    1.7%   25        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.9      11.5  
fit_sleep1 -92.5      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.3  3.3
looic      1769.5 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   410       
 (0.5, 0.7]   (ok)         1    0.6%   226       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.1
p_loo        33.8  8.2
looic      1721.6 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   612       
 (0.5, 0.7]   (ok)         5    2.8%   281       
   (0.7, 1]   (bad)        3    1.7%   25        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.8     22.1        33.8    8.2   1721.6
fit_sleep2  -23.9      11.5  -884.7     14.3        19.3    3.3   1769.5
fit_sleep1  -92.5      20.8  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.3  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.839149e-41 4.037115e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.84      1.64      0.1     5.45       0.05      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.16      1.64    -3.54     2.91       5.07      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
