<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.83      6.68    15.59    41.78 1.00     2138     2961
sd(Days)                6.64      1.55     4.19    10.28 1.00     1341     1860
cor(Intercept,Days)     0.08      0.29    -0.46     0.67 1.01      933     1724

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.00      7.41   235.83   265.21 1.00     1730     2365
Days         10.39      1.72     7.01    13.73 1.00     1350     1716

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.54    23.07    29.04 1.00     3246     2750

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9434  13.15595 227.3775 279.3361
309 211.6039  13.30073 184.8093 236.7615
310 212.9112  13.21508 186.9826 238.8443
330 274.7895  13.19345 249.4545 301.2142
331 273.1021  12.87322 248.9361 299.0820
332 260.0823  12.59215 235.8385 285.8505
333 267.9595  12.50464 244.4044 292.7093
334 244.6304  12.36995 219.7715 267.6871
335 251.0000  13.12467 225.6511 276.6293
337 285.5956  12.96920 261.0437 311.6983
349 226.1774  13.26636 199.7099 251.1581
350 238.4889  13.23391 211.8452 263.3853
351 255.6177  12.35734 231.0624 280.6814
352 271.8932  12.82455 247.2083 297.4617
369 254.8900  12.08730 231.1306 279.2022
370 226.3417  13.63239 198.7929 252.3361
371 252.2509  12.23245 228.0943 276.5557
372 263.4306  12.34002 240.3846 288.1987

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6622386  2.513620 14.8023425 24.705633
309  1.7384603  2.470987 -3.1089615  6.550802
310  4.9704064  2.473467  0.1206630  9.797599
330  5.7012945  2.529187  0.6981532 10.566666
331  7.5192056  2.428591  2.5950948 12.187201
332 10.2495559  2.397886  5.3723001 14.830328
333 10.2822191  2.392661  5.6160890 14.731684
334 11.4882301  2.328035  6.9452626 16.075322
335 -0.2840365  2.508667 -5.3419229  4.616955
337 19.2011567  2.463270 14.3651675 24.021775
349 11.6214533  2.491541  6.8525068 16.586765
350 17.0384448  2.529887 12.2560125 22.049734
351  7.4856734  2.384419  2.8187642 12.161142
352 14.0613301  2.437475  9.0653201 18.712027
369 11.3113225  2.315806  6.6539905 15.788383
370 15.2049665  2.555014 10.2684157 20.277200
371  9.4330582  2.338785  4.8887578 14.059661
372 11.7792999  2.364535  7.1323129 16.338128</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9434 13.155954 227.3775 279.3361
  [2,] 273.6057 11.231344 250.6651 295.4844
  [3,] 293.2679  9.583507 273.9054 311.9718
  [4,] 312.9302  8.377392 296.2107 328.9890
  [5,] 332.5924  7.820126 317.1467 347.4480
  [6,] 352.2546  8.047646 336.7362 367.6462
  [7,] 371.9169  9.000635 354.3838 389.3916
  [8,] 391.5791 10.483073 371.3826 412.1079
  [9,] 411.2413 12.305071 387.2420 435.7508
 [10,] 430.9036 14.337758 403.0290 459.3293
 [11,] 211.6039 13.300725 184.8093 236.7615
 [12,] 213.3424 11.400392 190.4234 234.8608
 [13,] 215.0808  9.759106 195.4103 233.5520
 [14,] 216.8193  8.527772 199.7699 233.1197
 [15,] 218.5577  7.900456 202.8139 233.8542
 [16,] 220.2962  8.020166 204.5632 236.0433
 [17,] 222.0347  8.856663 204.6677 239.1889
 [18,] 223.7731 10.235695 203.7931 243.8450
 [19,] 225.5116 11.971214 201.6879 248.6754
 [20,] 227.2501 13.930615 199.4328 254.3517
 [21,] 212.9112 13.215078 186.9826 238.8443
 [22,] 217.8816 11.338258 195.7379 240.1008
 [23,] 222.8520  9.731906 203.5611 241.9527
 [24,] 227.8224  8.549851 211.2212 244.1495
 [25,] 232.7928  7.982857 217.0516 248.3448
 [26,] 237.7632  8.160155 221.5799 253.8169
 [27,] 242.7336  9.038049 224.7336 260.6289
 [28,] 247.7041 10.441293 227.2808 268.4551
 [29,] 252.6745 12.189790 228.9411 276.2490
 [30,] 257.6449 14.156179 229.7748 285.4729
 [31,] 274.7895 13.193453 249.4545 301.2142
 [32,] 280.4908 11.273197 258.9282 303.0627
 [33,] 286.1921  9.638273 267.6809 305.3614
 [34,] 291.8934  8.455838 275.1442 308.4370
 [35,] 297.5947  7.930931 282.0004 312.8671
 [36,] 303.2960  8.190953 286.9338 318.9795
 [37,] 308.9973  9.169369 290.7857 326.7211
 [38,] 314.6986 10.670356 293.9295 335.6337
 [39,] 320.3999 12.507168 296.2801 344.8702
 [40,] 326.1012 14.553198 298.1548 354.5825
 [41,] 273.1021 12.873220 248.9361 299.0820
 [42,] 280.6213 11.057170 259.6020 303.0467
 [43,] 288.1405  9.518316 269.8259 307.0837
 [44,] 295.6597  8.410218 279.4993 312.0517
 [45,] 303.1789  7.915890 287.6089 318.5266
 [46,] 310.6981  8.147820 294.7638 326.5118
 [47,] 318.2174  9.050344 300.3073 336.3444
 [48,] 325.7366 10.451153 305.3741 346.2050
 [49,] 333.2558 12.179515 309.2665 356.9331
 [50,] 340.7750 14.115618 312.6023 368.3874
 [51,] 260.0823 12.592150 235.8385 285.8505
 [52,] 270.3319 10.839005 249.3133 292.1617
 [53,] 280.5814  9.375796 262.4618 299.5250
 [54,] 290.8310  8.356242 274.3956 307.4720
 [55,] 301.0805  7.952844 285.6373 316.4959
 [56,] 311.3301  8.256416 295.1265 327.8070
 [57,] 321.5796  9.197217 303.8330 339.8906
 [58,] 331.8292 10.607022 311.5375 352.8578
 [59,] 342.0788 12.325938 318.1823 366.0327
 [60,] 352.3283 14.242482 324.4188 379.7535
 [61,] 267.9595 12.504639 244.4044 292.7093
 [62,] 278.2418 10.741753 257.9946 299.6693
 [63,] 288.5240  9.265752 270.7731 306.9513
 [64,] 298.8062  8.232419 283.0095 315.2327
 [65,] 309.0884  7.819266 293.8945 324.5857
 [66,] 319.3706  8.121501 303.6115 335.5963
 [67,] 329.6529  9.067871 312.1769 347.7345
 [68,] 339.9351 10.485392 319.6746 360.5981
 [69,] 350.2173 12.211071 326.0225 374.0602
 [70,] 360.4995 14.132470 332.6943 388.0661
 [71,] 244.6304 12.369953 219.7715 267.6871
 [72,] 256.1186 10.660396 234.5681 276.4143
 [73,] 267.6068  9.225608 249.3126 285.2040
 [74,] 279.0951  8.210916 262.9281 294.9154
 [75,] 290.5833  7.782412 275.5186 305.6445
 [76,] 302.0715  8.034440 286.3815 317.5370
 [77,] 313.5598  8.909433 296.0916 330.5222
 [78,] 325.0480 10.249063 304.7197 344.4379
 [79,] 336.5362 11.897397 313.2356 358.6445
 [80,] 348.0245 13.743811 320.4636 374.0201
 [81,] 251.0000 13.124668 225.6511 276.6293
 [82,] 250.7159 11.210721 228.5125 272.4606
 [83,] 250.4319  9.575513 231.0288 269.0617
 [84,] 250.1479  8.383761 233.0236 266.5825
 [85,] 249.8638  7.840361 234.1897 265.2132
 [86,] 249.5798  8.077245 233.5840 265.7971
 [87,] 249.2958  9.033235 231.7555 267.3978
 [88,] 249.0117 10.513972 228.4810 270.1801
 [89,] 248.7277 12.331856 224.7976 273.3396
 [90,] 248.4436 14.359407 220.2857 277.2627
 [91,] 285.5956 12.969202 261.0437 311.6983
 [92,] 304.7968 11.140077 283.2511 327.2295
 [93,] 323.9979  9.598845 305.2818 343.1827
 [94,] 343.1991  8.503513 326.8420 360.1045
 [95,] 362.4003  8.038472 346.5344 378.2176
 [96,] 381.6014  8.310219 364.8980 398.3951
 [97,] 400.8026  9.254072 382.4732 419.6953
 [98,] 420.0037 10.693520 398.8530 441.1514
 [99,] 439.2049 12.457940 414.7703 463.7953
[100,] 458.4060 14.428603 430.5188 486.8950
[101,] 226.1774 13.266357 199.7099 251.1581
[102,] 237.7988 11.389339 215.2956 259.2887
[103,] 249.4203  9.790475 229.5510 268.1208
[104,] 261.0417  8.625852 243.5226 277.5514
[105,] 272.6632  8.085344 256.6965 288.2529
[106,] 284.2846  8.291913 267.6039 300.4813
[107,] 295.9061  9.195346 277.4760 313.8173
[108,] 307.5275 10.619252 286.4900 328.2624
[109,] 319.1490 12.385402 294.5294 343.2201
[110,] 330.7704 14.368139 302.0047 359.0076
[111,] 238.4889 13.233914 211.8452 263.3853
[112,] 255.5274 11.332323 232.8339 277.4911
[113,] 272.5658  9.721486 253.0154 291.3991
[114,] 289.6043  8.567012 273.1731 306.3628
[115,] 306.6427  8.067265 291.3274 322.1645
[116,] 323.6812  8.340772 307.6512 339.8260
[117,] 340.7196  9.319703 322.6625 358.7618
[118,] 357.7580 10.814153 336.1737 378.6761
[119,] 374.7965 12.642611 349.5336 399.0433
[120,] 391.8349 14.680803 362.5123 420.3036
[121,] 255.6177 12.357343 231.0624 280.6814
[122,] 263.1033 10.605767 242.1229 284.7623
[123,] 270.5890  9.145030 252.3326 289.0791
[124,] 278.0747  8.133373 261.7503 294.4325
[125,] 285.5604  7.748732 269.9283 300.7943
[126,] 293.0460  8.081141 276.8189 308.9099
[127,] 300.5317  9.051947 282.5794 318.3511
[128,] 308.0174 10.485301 287.4177 328.3962
[129,] 315.5031 12.219503 291.1468 339.6840
[130,] 322.9887 14.144323 294.3451 350.5961
[131,] 271.8932 12.824550 247.2083 297.4617
[132,] 285.9546 10.966466 264.6714 307.9711
[133,] 300.0159  9.377645 281.7461 318.3746
[134,] 314.0772  8.215818 297.9423 330.1445
[135,] 328.1385  7.677348 313.2226 343.0720
[136,] 342.1999  7.890897 326.8614 357.5074
[137,] 356.2612  8.801898 338.7760 373.5784
[138,] 370.3225 10.225612 350.1820 390.1257
[139,] 384.3839 11.980627 360.5810 407.7727
[140,] 398.4452 13.942392 370.7050 425.5154
[141,] 254.8900 12.087297 231.1306 279.2022
[142,] 266.2014 10.469749 245.5888 287.0708
[143,] 277.5127  9.157208 259.7445 295.3319
[144,] 288.8240  8.295732 272.6771 304.9895
[145,] 300.1353  8.031799 284.5020 315.6919
[146,] 311.4467  8.421778 295.3341 327.6503
[147,] 322.7580  9.384498 304.5377 341.4303
[148,] 334.0693 10.767412 312.8593 355.3790
[149,] 345.3806 12.431067 320.6253 369.6353
[150,] 356.6919 14.277661 328.1440 384.4304
[151,] 226.3417 13.632387 198.7929 252.3361
[152,] 241.5466 11.679286 217.8144 263.8346
[153,] 256.7516 10.001283 236.4296 275.8237
[154,] 271.9566  8.757956 254.4328 289.0251
[155,] 287.1615  8.150713 270.9798 303.2008
[156,] 302.3665  8.320015 285.9692 318.6512
[157,] 317.5715  9.223198 299.5078 335.4912
[158,] 332.7764 10.675593 311.5189 353.4989
[159,] 347.9814 12.487010 323.4912 372.3093
[160,] 363.1864 14.523730 334.7026 391.8728
[161,] 252.2509 12.232446 228.0943 276.5557
[162,] 261.6840 10.553368 240.8543 282.3845
[163,] 271.1170  9.168111 253.0950 289.5194
[164,] 280.5501  8.226467 264.2510 296.9690
[165,] 289.9831  7.888923 274.6334 305.3735
[166,] 299.4162  8.230144 283.4715 315.3779
[167,] 308.8493  9.174708 290.9422 326.4610
[168,] 318.2823 10.561965 297.2421 338.2522
[169,] 327.7154 12.242335 303.9602 351.1173
[170,] 337.1484 14.111494 309.7241 364.4839
[171,] 263.4306 12.340023 240.3846 288.1987
[172,] 275.2099 10.634965 255.1795 296.5895
[173,] 286.9892  9.225554 269.4072 305.3823
[174,] 298.7685  8.264458 283.0767 315.1170
[175,] 310.5478  7.916675 295.2306 326.1913
[176,] 322.3271  8.260041 306.0128 338.7279
[177,] 334.1064  9.217639 315.4742 352.0706
[178,] 345.8857 10.624665 324.7079 366.5998
[179,] 357.6650 12.328187 333.4572 381.6571
[180,] 369.4443 14.222059 341.6504 396.7653</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.3834404 13.155954  -29.7761034  22.1825213
  [2,]  -14.9009790 11.231344  -36.7796529   8.0396301
  [3,]  -42.4673176  9.583507  -61.1712369 -23.1048301
  [4,]    8.5096437  8.377392   -7.5492199  25.2291391
  [5,]   24.2595051  7.820126    9.4039202  39.7051979
  [6,]   62.4354665  8.047646   47.0438912  77.9539409
  [7,]   10.2869279  9.000635   -7.1878203  27.8200308
  [8,] -101.4305107 10.483073 -121.9593362 -81.2340365
  [9,]   19.3439506 12.305071   -5.1654798  43.3432866
 [10,]   35.4499120 14.337758    7.0242195  63.3245228
 [11,]   11.1299915 13.300725  -14.0276110  37.9246248
 [12,]   -8.0765688 11.400392  -29.5949677  14.8423940
 [13,]  -12.1030290  9.759106  -30.5741781   7.5675281
 [14,]  -12.1122893  8.527772  -28.4126689   4.9370708
 [15,]  -10.8416496  7.900456  -26.1381417   4.9021581
 [16,]   -4.3344098  8.020166  -20.0814537  11.3985846
 [17,]   -8.4043701  8.856663  -25.5586244   8.9626470
 [18,]   -6.0459304 10.235695  -26.1177924  13.9341222
 [19,]   -1.2158906 11.971214  -24.3797333  22.6078213
 [20,]   10.0641491 13.930615  -17.0375298  37.8814156
 [21,]  -13.8573105 13.215078  -39.7903882  12.0713470
 [22,]  -23.5494170 11.338258  -45.7685689  -1.4056881
 [23,]   11.4679766  9.731906   -7.6326650  30.7588721
 [24,]    5.0191702  8.549851  -11.3079081  21.6204123
 [25,]   -3.4854363  7.982857  -19.0374229  12.2558138
 [26,]  -17.3053427  8.160155  -33.3590127  -1.1219947
 [27,]   -7.3128492  9.038049  -25.2080638  10.6872332
 [28,]    8.0470444 10.441293  -12.7039525  28.4703251
 [29,]    8.3380380 12.189790  -15.2364629  32.0713960
 [30,]  -10.1295685 14.156179  -37.9576090  17.7405072
 [31,]   46.7530994 13.193453   20.3283703  72.0880513
 [32,]   19.9094049 11.273197   -2.6625007  41.4719558
 [33,]   -2.3355896  9.638273  -21.5048639  16.1755875
 [34,]   -6.7603842  8.455838  -23.3039723   9.9888433
 [35,]  -11.7973787  7.930931  -27.0697590   3.7969181
 [36,]   -5.7104732  8.190953  -21.3939600  10.6516687
 [37,]  -28.7576678  9.169369  -46.4815216 -10.5461290
 [38,]    3.5627377 10.670356  -17.3723875  24.3317656
 [39,]  -15.0503568 12.507168  -39.5206551   9.0694336
 [40,]   27.9475487 14.553198   -0.5338321  55.8939020
 [41,]   14.5057793 12.873220  -11.4740705  38.6717830
 [42,]    4.3786737 11.057170  -18.0466907  25.3980322
 [43,]   13.6800681  9.518316   -5.2631460  31.9946829
 [44,]   24.4555624  8.410218    8.0635751  40.6160190
 [45,]   13.0983568  7.915890   -2.2492777  28.6684474
 [46,]  -17.3794488  8.147820  -33.1930894  -1.4451011
 [47,]  -28.1423544  9.050344  -46.2693708 -10.2322981
 [48,]    9.0811399 10.451153  -11.3873067  29.4435597
 [49,]  -39.5088657 12.179515  -63.1861666 -15.5195647
 [50,]   30.8061287 14.115618    3.1936872  58.9787963
 [51,]  -25.2217136 12.592150  -50.9898597  -0.9779136
 [52,]  -27.5200695 10.839005  -49.3499004  -6.5014704
 [53,]   -7.6201254  9.375796  -26.5637168  10.4994870
 [54,]   18.9378187  8.356242    2.2968106  35.3731922
 [55,]   16.3823628  7.952844    0.9669698  31.8256297
 [56,]   -1.3324931  8.256416  -17.8093922  14.8710840
 [57,]  132.5822510  9.197217  114.2713292 150.3288956
 [58,]   15.0018951 10.607022   -6.0267376  35.2935602
 [59,]  -11.7784608 12.325938  -35.7323529  12.1179565
 [60,]  -98.4639168 14.242482 -125.8891076 -70.5543621
 [61,]   15.8828527 12.504639   -8.8668821  39.4379572
 [62,]   11.3132337 10.741753  -10.1142931  31.5604368
 [63,]  -11.7546854  9.265752  -30.1819831   5.9962088
 [64,]    1.0034956  8.232419  -15.4229586  16.8002164
 [65,]  -11.9174235  7.819266  -27.4147309   3.2764543
 [66,]   18.7958575  8.121501    2.5701900  34.5549816
 [67,]    2.3736384  9.067871  -15.7080261  19.8495845
 [68,]    8.9048194 10.485392  -11.7582161  29.1653465
 [69,]  -16.8572997 12.211071  -40.7002105   7.3374535
 [70,]    1.5432813 14.132470  -26.0232924  29.3484621
 [71,]   20.8427202 12.369953   -2.2139974  45.7016261
 [72,]   20.0825901 10.660396   -0.2131426  41.6331091
 [73,]  -24.2421400  9.225608  -41.8392606  -5.9478733
 [74,]  -24.4227701  8.210916  -40.2431055  -8.2558397
 [75,]  -11.5589002  7.782412  -26.6200764   3.5058434
 [76,]  -17.8803303  8.034440  -33.3458401  -2.1903422
 [77,]   -8.0349604  8.909433  -24.9973820   9.4331943
 [78,]    6.4749095 10.249063  -12.9149945  26.8032092
 [79,]   -0.7893206 11.897397  -22.8976031  22.5113234
 [80,]   29.2745493 13.743811    3.2788905  56.8353706
 [81,]   -9.3916717 13.124668  -35.0209518  15.9571549
 [82,]   23.2312648 11.210721    1.4866490  45.4347440
 [83,]    4.0588012  9.575513  -14.5710326  23.4618876
 [84,]   20.6542377  8.383761    4.2195643  37.7785146
 [85,]    1.5880742  7.840361  -13.7612732  17.2621533
 [86,]    5.0564106  8.077245  -11.1608661  21.0522489
 [87,]   -3.8434529  9.033235  -21.9454941  13.6968292
 [88,]  -13.7007164 10.513972  -34.8690847   6.8299751
 [89,]  -12.9735799 12.331856  -37.5855250  10.9564620
 [90,]  -11.1970435 14.359407  -40.0160727  16.9609347
 [91,]   26.7709640 12.969202    0.6682961  51.3229373
 [92,]    9.0090073 11.140077  -13.4237359  30.5546762
 [93,]  -32.3867494  9.598845  -51.5715434 -13.6706395
 [94,]    2.9230939  8.503513  -13.9823396  19.2801806
 [95,]    3.3321372  8.038472  -12.4852399  19.1980076
 [96,]   10.2370805  8.310219   -6.5566343  26.9404905
 [97,]    3.4575238  9.254072  -15.4351560  21.7869396
 [98,]   -3.3114329 10.693520  -24.4590976  17.8393310
 [99,]   16.6594104 12.457940   -7.9309844  41.0939520
[100,]    0.5106537 14.428603  -27.9782850  28.3979114
[101,]    9.9258346 13.266357  -15.0548627  36.3932918
[102,]   -7.4821187 11.389339  -28.9720082  15.0210624
[103,]  -10.4946719  9.790475  -29.1951924   9.3745839
[104,]   -6.1197252  8.625852  -22.6293585  11.3993826
[105,]  -21.9528784  8.085344  -37.5425713  -5.9861724
[106,]  -14.5102317  8.291913  -30.7069225   2.1704946
[107,]  -14.3412849  9.195346  -32.2524906   4.0888312
[108,]    0.5744618 10.619252  -20.1603680  21.6120113
[109,]   17.1316085 12.385402   -6.9394831  41.7511913
[110,]   20.8746553 14.368139   -7.3624836  49.6404286
[111,]   17.8078689 13.233914   -7.0884605  44.4515812
[112,]  -12.0730759 11.332323  -34.0367748  10.6204028
[113,]  -16.3612207  9.721486  -35.1944623   3.1891704
[114,]  -34.0771654  8.567012  -50.8357435 -17.6459726
[115,]  -37.7262102  8.067265  -53.2479815 -22.4109472
[116,]    6.0435450  8.340772  -10.1012876  22.0734955
[117,]   38.7249002  9.319703   20.6827095  56.7819588
[118,]    5.1603554 10.814153  -15.7577106  26.7447158
[119,]   19.6907106 12.642611   -4.5560796  44.9535533
[120,]   -2.7822342 14.680803  -31.2508825  26.5404279
[121,]   -5.0911645 12.357343  -30.1548800  19.4640933
[122,]   36.9542621 10.605767   15.2953164  57.9346628
[123,]   -0.6951114  9.145030  -19.1852374  17.5612636
[124,]    2.5144152  8.133373  -13.8433768  18.8387922
[125,]  -13.7329583  7.748732  -28.9669299   1.8990515
[126,]   11.5875683  8.081141   -4.2762829  27.8147154
[127,]  -12.7851051  9.051947  -30.6045413   5.1671561
[128,]  -41.4218786 10.485301  -61.8007158 -20.8221619
[129,]    6.0387480 12.219503  -18.1422291  30.3950389
[130,]   24.5767746 14.144323   -3.0305697  53.2204318
[131,]  -50.2161287 12.824550  -75.7846461 -25.5312180
[132,]   12.2393412 10.966466   -9.7771638  33.5225313
[133,]   26.8626111  9.377645    8.5039147  45.1324100
[134,]   32.7782810  8.215818   16.7109967  48.9131579
[135,]   20.6016508  7.677348    5.6681596  35.5176471
[136,]   10.6288207  7.890897   -4.6787102  25.9673154
[137,]   -1.8346094  8.801898  -19.1517596  15.6505508
[138,]   -9.8899395 10.225612  -29.6930525  10.2506261
[139,]   -8.7432696 11.980627  -32.1320774  15.0595783
[140,]   -9.9034997 13.942392  -36.9736698  17.8366790
[141,]   17.0334528 12.087297   -7.2786796  40.7929487
[142,]    2.2355303 10.469749  -18.6339436  22.8481343
[143,]  -20.2702922  9.157208  -38.0895135  -2.5020951
[144,]  -11.1674147  8.295732  -27.3328623   4.9794633
[145,]   14.6868627  8.031799   -0.8696711  30.3202180
[146,]    5.7668402  8.421778  -10.4368444  21.8793502
[147,]  -24.6226823  9.384498  -43.2949525  -6.4023715
[148,]   14.0535952 10.767412   -7.2560504  35.2636348
[149,]   -5.1006273 12.431067  -29.3553423  19.6547451
[150,]    9.8211502 14.277661  -17.9172922  38.3691164
[151,]   -1.0776555 13.632387  -27.0720947  26.4710799
[152,]   -7.0231220 11.679286  -29.3110997  16.7091096
[153,]  -17.8507885 10.001283  -36.9229349   2.4712066
[154,]  -31.4835550  8.757956  -48.5521352 -13.9597672
[155,]  -19.6242215  8.150713  -35.6634817  -3.4425399
[156,]   41.8272120  8.320015   25.5425465  58.2244634
[157,]  -36.4233545  9.223198  -54.3431161 -18.3597054
[158,]   14.8090790 10.675593   -5.9134338  36.0666456
[159,]   17.1816125 12.487010   -7.1462839  41.6718278
[160,]    9.0424460 14.523730  -19.6440249  37.5261597
[161,]   17.6294870 12.232446   -6.6752853  41.7860559
[162,]   10.7588288 10.553368   -9.9417091  31.5884827
[163,]    6.7818707  9.168111  -11.6204625  24.8039091
[164,]    1.2394125  8.226467  -15.1795164  17.5384859
[165,]  -10.8126456  7.888923  -26.2029891   4.5370563
[166,]  -14.9042038  8.230144  -30.8659308   1.0405080
[167,]  -49.5834619  9.174708  -67.1952218 -31.6764062
[168,]  -13.6517201 10.561965  -33.6215987   7.3884981
[169,]   23.0653218 12.242335   -0.3365639  46.8204868
[170,]   32.3207636 14.111494    4.9853424  59.7450634
[171,]    5.9811456 12.340023  -18.7869785  29.0270881
[172,]   -1.7358543 10.634965  -23.1155253  18.2945331
[173,]   10.6076459  9.225554   -7.7854715  28.1895726
[174,]   11.8631460  8.264458   -4.4854060  27.5548988
[175,]  -23.3751538  7.916675  -39.0186715  -8.0580350
[176,]    7.2805463  8.260041   -9.1202944  23.5947831
[177,]    0.3754465  9.217639  -17.5887861  19.0075592
[178,]   -2.6657534 10.624665  -23.3799104  18.5120103
[179,]   11.4767468 12.328187  -12.5153870  35.6844524
[180,]   -5.3206531 14.222059  -32.6417439  22.4732476</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.4  3.4
looic      1770.1 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   533       
 (0.5, 0.7]   (ok)         2    1.1%   104       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.1
p_loo        33.9  8.3
looic      1721.4 44.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   770       
 (0.5, 0.7]   (ok)         4    2.2%   271       
   (0.7, 1]   (bad)        2    1.1%   55        
   (1, Inf)   (very bad)   1    0.6%   17        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.4  
fit_sleep1 -92.6      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.4  3.4
looic      1770.1 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   533       
 (0.5, 0.7]   (ok)         2    1.1%   104       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.1
p_loo        33.9  8.3
looic      1721.4 44.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   770       
 (0.5, 0.7]   (ok)         4    2.2%   271       
   (0.7, 1]   (bad)        2    1.1%   55        
   (1, Inf)   (very bad)   1    0.6%   17        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.7     22.1        33.9    8.3   1721.4
fit_sleep2  -24.3      11.4  -885.1     14.3        19.4    3.4   1770.1
fit_sleep1  -92.6      20.8  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.1  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.319993e-41 2.696938e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.89      1.55     0.34     5.39       0.04      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.11      1.55    -3.27     2.87       5.02      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.62.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.2          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        ggridges_0.5.4       callr_3.7.3         
 [34] stringr_1.4.1        digest_0.6.30        minqa_1.2.5         
 [37] rmarkdown_2.18       base64enc_0.1-3      pkgconfig_2.0.3     
 [40] htmltools_0.5.3      highr_0.9            fastmap_1.1.0       
 [43] htmlwidgets_1.5.4    rlang_1.0.6          shiny_1.7.3         
 [46] jquerylib_0.1.4      farver_2.1.1         generics_0.1.3      
 [49] zoo_1.8-11           jsonlite_1.8.3       gtools_3.9.3        
 [52] crosstalk_1.2.0      dplyr_1.0.10         distributional_0.3.1
 [55] inline_0.3.19        magrittr_2.0.3       loo_2.5.1           
 [58] bayesplot_1.9.0      munsell_0.5.0        fansi_1.0.3         
 [61] abind_1.4-5          lifecycle_1.0.3      stringi_1.7.8       
 [64] yaml_2.3.6           MASS_7.3-58.1        plyr_1.8.8          
 [67] pkgbuild_1.3.1       grid_4.2.2           parallel_4.2.2      
 [70] promises_1.2.0.1     crayon_1.5.2         miniUI_0.1.1.1      
 [73] lattice_0.20-45      splines_4.2.2        knitr_1.40          
 [76] ps_1.7.2             pillar_1.8.1         igraph_1.3.5        
 [79] boot_1.3-28          markdown_1.3         shinystan_2.6.0     
 [82] reshape2_1.4.4       codetools_0.2-18     stats4_4.2.2        
 [85] rstantools_2.2.0     glue_1.6.2           evaluate_0.18       
 [88] V8_4.2.1             RcppParallel_5.1.5   vctrs_0.5.0         
 [91] nloptr_2.0.3         httpuv_1.6.6         gtable_0.3.1        
 [94] assertthat_0.2.1     cachem_1.0.6         ggplot2_3.4.0       
 [97] xfun_0.34            mime_0.12            xtable_1.8-4        
[100] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[103] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
