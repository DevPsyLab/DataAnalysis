<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.94      6.76    15.58    41.70 1.00     1976     2389
sd(Days)                6.63      1.51     4.16    10.08 1.00     1556     2357
cor(Intercept,Days)     0.09      0.30    -0.48     0.67 1.00     1090     1634

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.41      7.34   236.99   265.95 1.00     1967     2344
Days         10.46      1.76     6.93    14.01 1.00     1362     1812

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.56    23.05    29.24 1.00     3545     2726

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9323  13.19972 227.8584 280.0642
309 211.7057  13.16025 186.2248 237.3602
310 212.8827  13.12481 186.7690 238.4216
330 274.3802  13.56260 248.9097 301.7332
331 273.4838  13.35131 248.7874 300.1040
332 260.0200  12.44468 235.8810 284.6499
333 267.6395  12.68669 244.1139 293.5501
334 244.2426  11.84299 220.5127 267.4895
335 250.8746  13.33193 225.6453 277.2418
337 285.9821  13.18219 260.6715 312.5275
349 226.6415  12.40037 201.5233 250.2888
350 238.6383  13.04569 212.6296 263.5193
351 255.8909  12.48310 231.8870 281.7300
352 272.1073  12.49982 248.0823 296.7352
369 254.3225  12.04283 230.8378 278.2454
370 226.1783  13.51479 199.2640 252.1111
371 252.0894  12.15305 228.5104 276.7330
372 263.7571  12.25375 240.1075 287.8657

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6270059  2.482291 14.7619952 24.623018
309  1.6872246  2.527324 -3.3397391  6.736352
310  4.9393471  2.420859  0.2638294  9.758163
330  5.7655307  2.544938  0.6337562 10.552512
331  7.4686741  2.467427  2.5233648 12.167556
332 10.2396441  2.401489  5.4695889 14.864987
333 10.3037418  2.387767  5.4877641 14.896635
334 11.5571735  2.275871  7.1050330 16.059419
335 -0.2583521  2.542099 -5.2195928  4.644281
337 19.1657152  2.496262 14.1699008 24.135434
349 11.5649629  2.351513  7.1624431 16.300547
350 17.0148620  2.481472 12.2253562 21.819345
351  7.4919499  2.371259  2.8018264 12.083889
352 14.0478728  2.353151  9.4197812 18.758417
369 11.4060047  2.263319  6.9419607 15.822774
370 15.2512740  2.550093 10.3726435 20.377160
371  9.4678321  2.325053  4.8154630 14.015754
372 11.7318665  2.327055  7.2296602 16.299619</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9323 13.199721 227.8584 280.0642
  [2,] 273.5593 11.330286 250.9216 295.5612
  [3,] 293.1863  9.738670 274.0072 312.2565
  [4,] 312.8133  8.580881 295.9168 329.6596
  [5,] 332.4404  8.046422 316.5616 348.1922
  [6,] 352.0674  8.257228 335.7544 368.8781
  [7,] 371.6944  9.162001 353.6192 389.4104
  [8,] 391.3214 10.584245 370.8918 411.8298
  [9,] 410.9484 12.346407 387.3000 435.3490
 [10,] 430.5754 14.323576 402.7174 458.8267
 [11,] 211.7057 13.160253 186.2248 237.3602
 [12,] 213.3929 11.261822 191.6034 235.5700
 [13,] 215.0801  9.656072 196.4497 234.1659
 [14,] 216.7674  8.510322 200.1338 233.3864
 [15,] 218.4546  8.024098 202.8010 234.2637
 [16,] 220.1418  8.313932 204.2946 236.3938
 [17,] 221.8290  9.307605 203.8864 240.0353
 [18,] 223.5163 10.812784 202.4607 244.6237
 [19,] 225.2035 12.648154 200.3486 250.1218
 [20,] 226.8907 14.690475 197.8665 255.7870
 [21,] 212.8827 13.124812 186.7690 238.4216
 [22,] 217.8221 11.332353 195.4311 239.8240
 [23,] 222.7614  9.813506 203.3221 241.7889
 [24,] 227.7008  8.712559 210.6385 244.7239
 [25,] 232.6401  8.199609 216.7824 248.7315
 [26,] 237.5795  8.383294 221.2827 254.1748
 [27,] 242.5188  9.222080 224.7480 260.6984
 [28,] 247.4582 10.561014 226.7903 268.4166
 [29,] 252.3975 12.237009 228.2562 276.6488
 [30,] 257.3369 14.130637 229.0741 285.5236
 [31,] 274.3802 13.562595 248.9097 301.7332
 [32,] 280.1458 11.565088 258.5794 303.2995
 [33,] 285.9113  9.824050 267.4234 305.6036
 [34,] 291.6768  8.498592 275.6105 308.8384
 [35,] 297.4424  7.803435 282.6463 313.2786
 [36,] 303.2079  7.906613 287.9862 319.3134
 [37,] 308.9734  8.780028 291.6869 326.5820
 [38,] 314.7390 10.228229 294.6170 334.9238
 [39,] 320.5045 12.045658 297.0414 343.6505
 [40,] 326.2700 14.090156 298.0663 353.3107
 [41,] 273.4838 13.351311 248.7874 300.1040
 [42,] 280.9525 11.477854 259.6196 303.8292
 [43,] 288.4211  9.869203 269.5197 308.1863
 [44,] 295.8898  8.673961 278.4879 312.6513
 [45,] 303.3585  8.077773 286.9365 319.0150
 [46,] 310.8272  8.212164 294.2680 326.6983
 [47,] 318.2958  9.044626 300.5602 335.8663
 [48,] 325.7645 10.408999 305.9380 346.0889
 [49,] 333.2332 12.127064 310.3670 356.8430
 [50,] 340.7018 14.069843 313.9672 368.1672
 [51,] 260.0200 12.444682 235.8810 284.6499
 [52,] 270.2596 10.692338 249.3816 291.1460
 [53,] 280.4993  9.236685 262.5911 298.1341
 [54,] 290.7389  8.236560 274.7188 306.5967
 [55,] 300.9786  7.867642 285.6303 316.3121
 [56,] 311.2182  8.215409 295.2733 327.4506
 [57,] 321.4578  9.198936 303.3485 339.3165
 [58,] 331.6975 10.643411 311.0617 352.7955
 [59,] 341.9371 12.388634 317.9755 366.2461
 [60,] 352.1768 14.325105 324.5189 380.1705
 [61,] 267.6395 12.686690 244.1139 293.5501
 [62,] 277.9432 10.897100 257.4533 299.9970
 [63,] 288.2469  9.377864 270.4438 307.5027
 [64,] 298.5507  8.279176 282.4679 315.0575
 [65,] 308.8544  7.781263 293.2974 324.0132
 [66,] 319.1582  7.997137 303.0657 334.7443
 [67,] 329.4619  8.874865 311.9308 347.3340
 [68,] 339.7656 10.245737 319.9661 360.6344
 [69,] 350.0694 11.941100 327.4241 374.7879
 [70,] 360.3731 13.842236 334.3305 388.4276
 [71,] 244.2426 11.842987 220.5127 267.4895
 [72,] 255.7998 10.223714 235.5128 275.7691
 [73,] 267.3570  8.896712 250.1563 284.7976
 [74,] 278.9142  8.008608 263.3868 294.6497
 [75,] 290.4713  7.712542 275.2767 305.4923
 [76,] 302.0285  8.073908 285.8573 317.6141
 [77,] 313.5857  9.013980 295.7537 331.1420
 [78,] 325.1429 10.376650 304.6480 345.1312
 [79,] 336.7000 12.019029 313.3730 360.4305
 [80,] 348.2572 13.841908 321.4374 375.5875
 [81,] 250.8746 13.331931 225.6453 277.2418
 [82,] 250.6163 11.381771 228.8999 273.0786
 [83,] 250.3579  9.709458 231.8842 269.4799
 [84,] 250.0996  8.480977 233.7918 267.0651
 [85,] 249.8412  7.906004 234.6426 265.6027
 [86,] 249.5829  8.124492 233.8219 265.7320
 [87,] 249.3245  9.079338 231.6612 267.3067
 [88,] 249.0662 10.572886 228.5537 269.9324
 [89,] 248.8078 12.412171 224.9110 273.6977
 [90,] 248.5495 14.465912 220.7689 276.9655
 [91,] 285.9821 13.182186 260.6715 312.5275
 [92,] 305.1478 11.283323 283.5497 327.8371
 [93,] 324.3135  9.660196 305.8156 344.0430
 [94,] 343.4792  8.472783 327.3428 360.2257
 [95,] 362.6449  7.919556 347.5192 378.2896
 [96,] 381.8107  8.131011 366.1371 397.8592
 [97,] 400.9764  9.053726 383.4918 418.6427
 [98,] 420.1421 10.501867 399.6763 440.6804
 [99,] 439.3078 12.291100 415.0647 463.0425
[100,] 458.4735 14.293904 430.2187 485.9359
[101,] 226.6415 12.400365 201.5233 250.2888
[102,] 238.2065 10.685778 216.7334 258.7904
[103,] 249.7714  9.255369 231.3837 267.8160
[104,] 261.3364  8.258154 245.1877 277.6779
[105,] 272.9013  7.860763 257.4139 288.0083
[106,] 284.4663  8.151399 268.2431 300.1485
[107,] 296.0313  9.064118 278.5207 313.5994
[108,] 307.5962 10.436973 287.2167 328.0214
[109,] 319.1612 12.114529 295.3094 343.0446
[110,] 330.7262 13.987582 303.0841 358.3990
[111,] 238.6383 13.045693 212.6296 263.5193
[112,] 255.6531 11.167583 233.5843 277.1866
[113,] 272.6680  9.568444 253.5553 291.0454
[114,] 289.6829  8.408968 273.5373 306.5418
[115,] 306.6977  7.885542 291.4744 322.8407
[116,] 323.7126  8.122082 308.1965 339.6348
[117,] 340.7275  9.059253 323.0789 358.7960
[118,] 357.7423 10.511295 337.0136 378.3711
[119,] 374.7572 12.297154 350.5689 398.6560
[120,] 391.7720 14.292238 363.7228 419.1447
[121,] 255.8909 12.483102 231.8870 281.7300
[122,] 263.3829 10.732773 242.7743 285.0942
[123,] 270.8748  9.262977 252.9150 289.6047
[124,] 278.3668  8.225496 262.3579 294.5650
[125,] 285.8587  7.794907 270.4815 300.8437
[126,] 293.3507  8.068959 277.4872 309.1554
[127,] 300.8426  8.983394 283.2733 318.4240
[128,] 308.3346 10.370168 288.0955 329.0181
[129,] 315.8265 12.067523 292.0861 340.2040
[130,] 323.3185 13.962650 295.9778 351.2468
[131,] 272.1073 12.499819 248.0823 296.7352
[132,] 286.1552 10.772465 265.7539 308.0112
[133,] 300.2031  9.323153 282.2047 318.9521
[134,] 314.2510  8.298854 298.0994 330.7959
[135,] 328.2988  7.867365 312.8975 343.9749
[136,] 342.3467  8.123700 326.6556 358.5614
[137,] 356.3946  9.009341 338.6249 374.4713
[138,] 370.4424 10.364197 349.9192 391.8232
[139,] 384.4903 12.030776 360.8860 409.5177
[140,] 398.5382 13.897381 371.3170 427.6224
[141,] 254.3225 12.042835 230.8378 278.2454
[142,] 265.7285 10.413278 245.4599 286.1911
[143,] 277.1345  9.060246 259.5012 294.7136
[144,] 288.5405  8.123114 272.7820 304.1952
[145,] 299.9465  7.754169 285.0218 314.5612
[146,] 311.3525  8.032092 295.7197 326.5298
[147,] 322.7585  8.896466 304.8665 340.0597
[148,] 334.1645 10.199261 313.8083 354.1506
[149,] 345.5705 11.796100 322.2340 368.5975
[150,] 356.9766 13.583676 329.8367 383.4610
[151,] 226.1783 13.514789 199.2640 252.1111
[152,] 241.4296 11.534130 218.6283 263.4330
[153,] 256.6808  9.819812 237.4868 275.4801
[154,] 271.9321  8.533887 255.4515 288.7271
[155,] 287.1834  7.888707 271.7163 302.7901
[156,] 302.4347  8.040031 286.2136 318.0311
[157,] 317.6859  8.947538 299.5169 335.2358
[158,] 332.9372 10.415409 311.9501 353.2346
[159,] 348.1885 12.243732 323.7249 372.1569
[160,] 363.4398 14.294865 335.2486 391.2662
[161,] 252.0894 12.153049 228.5104 276.7330
[162,] 261.5573 10.472102 241.6712 282.4153
[163,] 271.0251  9.079920 253.4656 289.1445
[164,] 280.4929  8.126299 264.7785 297.0161
[165,] 289.9608  7.774333 274.9054 305.5688
[166,] 299.4286  8.102809 283.4183 315.5211
[167,] 308.8964  9.037838 291.1463 326.8300
[168,] 318.3643 10.417354 297.9124 338.7513
[169,] 327.8321 12.090151 304.2935 351.6416
[170,] 337.2999 13.951128 310.3175 364.7640
[171,] 263.7571 12.253751 240.1075 287.8657
[172,] 275.4890 10.543694 255.2729 296.0909
[173,] 287.2208  9.111254 269.6917 304.8602
[174,] 298.9527  8.104984 282.9838 314.3544
[175,] 310.6846  7.693957 295.4509 325.3409
[176,] 322.4164  7.970794 306.5936 338.1076
[177,] 334.1483  8.871330 316.4138 351.5274
[178,] 345.8802 10.232196 325.6027 365.9773
[179,] 357.6120 11.896450 333.9873 381.2898
[180,] 369.3439 13.754403 342.4279 396.6443</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.3723269 13.199721  -30.5041936  21.7016234
  [2,]  -14.8546328 11.330286  -36.8564787   7.7831275
  [3,]  -42.3857386  9.738670  -61.4558502 -23.2065908
  [4,]    8.6264555  8.580881   -8.2197924  25.5229930
  [5,]   24.4115497  8.046422    8.6596572  40.2902539
  [6,]   62.6227438  8.257228   45.8119728  78.9356825
  [7,]   10.5094379  9.162001   -7.2066270  28.5845954
  [8,] -101.1727679 10.584245 -121.6812047 -80.7431869
  [9,]   19.6369262 12.346407   -4.7636698  43.2852705
 [10,]   35.7781203 14.323576    7.5268462  63.6361495
 [11,]   11.0282075 13.160253  -14.6262854  36.5091367
 [12,]   -8.1271170 11.261822  -30.3042170  13.6623952
 [13,]  -12.1023416  9.656072  -31.1880780   6.5281311
 [14,]  -12.0603661  8.510322  -28.6793720   4.5731511
 [15,]  -10.7384907  8.024098  -26.5475805   4.9151447
 [16,]   -4.1800153  8.313932  -20.4319823  11.6671739
 [17,]   -8.1987398  9.307605  -26.4050225   9.7438738
 [18,]   -5.7890644 10.812784  -26.8964684  15.2665489
 [19,]   -0.9077890 12.648154  -25.8260941  23.9470744
 [20,]   10.4234865 14.690475  -18.4728247  39.4477148
 [21,]  -13.8288491 13.124812  -39.3676669  12.2848863
 [22,]  -23.4898962 11.332353  -45.4918350  -1.0988668
 [23,]   11.5585566  9.813506   -7.4689028  30.9978748
 [24,]    5.1408095  8.712559  -11.8822835  22.2030766
 [25,]   -3.3327377  8.199609  -19.4240854  12.5250465
 [26,]  -17.1215848  8.383294  -33.7168857  -0.8247660
 [27,]   -7.0980319  9.222080  -25.2776406  10.6728170
 [28,]    8.2929209 10.561014  -12.6655152  28.9608390
 [29,]    8.6149738 12.237009  -15.6362953  32.7562659
 [30,]   -9.8215733 14.130637  -38.0082825  18.4411946
 [31,]   47.1623556 13.562595   19.8093718  72.6329170
 [32,]   20.2544249 11.565088   -2.8993166  41.8207946
 [33,]   -2.0548058  9.824050  -21.7470937  16.4331332
 [34,]   -6.5438365  8.498592  -23.7054312   9.5224789
 [35,]  -11.6450672  7.803435  -27.4813062   3.1509915
 [36,]   -5.6223978  7.906613  -21.7278915   9.5992578
 [37,]  -28.7338285  8.780028  -46.3424034 -11.4473375
 [38,]    3.5223408 10.228229  -16.6624666  23.6443411
 [39,]  -15.1549899 12.045658  -38.3010210   8.3080724
 [40,]   27.7786794 14.090156    0.7379600  55.9824391
 [41,]   14.1241166 13.351311  -12.4960554  38.8205392
 [42,]    4.0475426 11.477854  -18.8291762  25.3803714
 [43,]   13.3994685  9.869203   -6.3656765  32.3009073
 [44,]   24.2254944  8.673961    7.4640176  41.6274170
 [45,]   12.9188204  8.077773   -2.7376977  29.3408336
 [46,]  -17.5084537  8.212164  -33.3795717  -0.9493347
 [47,]  -28.2208277  9.044626  -45.7912544 -10.4852181
 [48,]    9.0531982 10.408999  -11.2712204  28.8797421
 [49,]  -39.4862758 12.127064  -63.0960725 -16.6200786
 [50,]   30.8792501 14.069843    3.4139403  57.6138715
 [51,]  -25.1593765 12.444682  -49.7892756  -1.0203869
 [52,]  -27.4478207 10.692338  -48.3342094  -6.5698319
 [53,]   -7.5379648  9.236685  -25.1728257  10.3702408
 [54,]   19.0298911  8.236560    3.1721117  35.0500086
 [55,]   16.4843470  7.867642    1.1508499  31.8325692
 [56,]   -1.2205971  8.215409  -17.4530196  14.7242714
 [57,]  132.7040588  9.198936  114.8453546 150.8134041
 [58,]   15.1336146 10.643411   -5.9643970  35.7694422
 [59,]  -11.6368295 12.388634  -35.9458351  12.3247668
 [60,]  -98.3123736 14.325105 -126.3060968 -70.6545185
 [61,]   16.2029425 12.686690   -9.7077252  39.7285118
 [62,]   11.6118007 10.897100  -10.4419950  32.1016929
 [63,]  -11.4776411  9.377864  -30.7334391   6.3255268
 [64,]    1.2590172  8.279176  -15.2477805  17.3418314
 [65,]  -11.6834246  7.781263  -26.8421954   3.8735957
 [66,]   19.0083336  7.997137    3.4221529  35.1008445
 [67,]    2.5645918  8.874865  -15.3075130  20.0957022
 [68,]    9.0742501 10.245737  -11.7945442  28.8738008
 [69,]  -16.7093917 11.941100  -41.4279257   5.9359448
 [70,]    1.6696665 13.842236  -26.3847586  27.7122641
 [71,]   21.2304588 11.842987   -2.0164303  44.9604274
 [72,]   20.4013854 10.223714    0.4321046  40.6884418
 [73,]  -23.9922881  8.896712  -41.4329149  -6.7916294
 [74,]  -24.2418616  8.008608  -39.9774446  -8.7145264
 [75,]  -11.4469351  7.712542  -26.4679386   3.7476620
 [76,]  -17.8373086  8.073908  -33.4229062  -1.6660542
 [77,]   -8.0608821  9.013980  -25.6171813   9.7711395
 [78,]    6.3800444 10.376650  -13.6082863  26.8748745
 [79,]   -0.9531291 12.019029  -24.6836338  22.3739055
 [80,]   29.0417974 13.841908    1.7114524  55.8615698
 [81,]   -9.2663462 13.331931  -35.6334910  15.9630266
 [82,]   23.3309058 11.381771    0.8686403  45.0472815
 [83,]    4.1327579  9.709458  -14.9892457  22.6064712
 [84,]   20.7025100  8.480977    3.7370179  37.0102601
 [85,]    1.6106621  7.906004  -14.1507935  16.8093440
 [86,]    5.0533141  8.124492  -11.0958357  20.8142619
 [87,]   -3.8722338  9.079338  -21.8544496  13.7911209
 [88,]  -13.7551817 10.572886  -34.6214218   6.7573239
 [89,]  -13.0537297 12.412171  -37.9435614  10.8431081
 [90,]  -11.3028776 14.465912  -39.7188873  16.4776613
 [91,]   26.3845170 13.182186   -0.1608663  51.6951460
 [92,]    8.6580018 11.283323  -14.0312894  30.2561279
 [93,]  -32.7023134  9.660196  -52.4318263 -14.2044459
 [94,]    2.6429715  8.472783  -14.1034666  18.7793953
 [95,]    3.0874563  7.919556  -12.5572032  18.2131692
 [96,]   10.0278411  8.131011   -6.0206717  25.7013928
 [97,]    3.2837259  9.053726  -14.3826448  20.7682706
 [98,]   -3.4497892 10.501867  -23.9881222  17.0159663
 [99,]   16.5564956 12.291100   -7.1781571  40.7995602
[100,]    0.4431804 14.293904  -27.0192132  28.6980448
[101,]    9.4617107 12.400365  -14.1855638  34.5799303
[102,]   -7.8897522 10.685778  -28.4736750  13.5832567
[103,]  -10.8458151  9.255369  -28.8903716   7.5419038
[104,]   -6.4143781  8.258154  -22.7558912   9.7342684
[105,]  -22.1910410  7.860763  -37.2980069  -6.7035860
[106,]  -14.6919040  8.151399  -30.3741075   1.5312852
[107,]  -14.4664669  9.064118  -32.0345921   3.0441281
[108,]    0.5057702 10.436973  -19.9194390  20.8852699
[109,]   17.1194072 12.114529   -6.7640355  40.9711703
[110,]   20.9189443 13.987582   -6.7538548  48.5610214
[111,]   17.6585180 13.045693   -7.2224597  43.6671946
[112,]  -12.1988440 11.167583  -33.7323268   9.8700232
[113,]  -16.4634060  9.568444  -34.8408387   2.6492742
[114,]  -34.1557680  8.408968  -51.0147329 -18.0102396
[115,]  -37.7812300  7.885542  -53.9241749 -22.5578980
[116,]    6.0121081  8.122082   -9.9100591  21.5282271
[117,]   38.7170461  9.059253   20.6485319  56.3656053
[118,]    5.1760841 10.511295  -15.4527203  25.9048305
[119,]   19.7300221 12.297154   -4.1688333  43.9182641
[120,]   -2.7193399 14.292238  -30.0919880  25.3299135
[121,]   -5.3644431 12.483102  -31.2034835  18.6394770
[122,]   36.6747070 10.732773   14.9634309  57.2833091
[123,]   -0.9809428  9.262977  -19.7108424  16.9789293
[124,]    2.2223073  8.225496  -13.9758538  18.2311602
[125,]  -14.0313426  7.794907  -29.0162547   1.3458584
[126,]   11.2829075  8.068959   -4.5218380  27.1464467
[127,]  -13.0960424  8.983394  -30.6773666   4.4733163
[128,]  -41.7390923 10.370168  -62.4225529 -21.4999918
[129,]    5.7152578 12.067523  -18.6622104  29.4557106
[130,]   24.2470080 13.962650   -3.6812539  51.5877307
[131,]  -50.4302335 12.499819  -75.0580653 -26.4052029
[132,]   12.0386937 10.772465   -9.8172957  32.4399792
[133,]   26.6754209  9.323153    7.9263860  44.6737962
[134,]   32.6045481  8.298854   16.0596404  48.7560562
[135,]   20.4413752  7.867365    4.7653405  35.8426938
[136,]   10.4820024  8.123700   -5.7326821  26.1731120
[137,]   -1.9679704  9.009341  -20.0446878  15.8017142
[138,]  -10.0098432 10.364197  -31.3905701  10.5133645
[139,]   -8.8497161 12.030776  -33.8770729  14.7546097
[140,]   -9.9964889 13.897381  -39.0806906  17.2247378
[141,]   17.6009923 12.042835   -6.3219043  41.0856782
[142,]    2.7083875 10.413278  -17.7542417  22.9769610
[143,]  -19.8921172  9.060246  -37.4712238  -2.2588279
[144,]  -10.8839219  8.123114  -26.5386088   4.8746163
[145,]   14.8756733  7.754169    0.2610116  29.8003841
[146,]    5.8609686  8.032092   -9.3162933  21.4937930
[147,]  -24.6232361  8.896466  -41.9244354  -6.7311970
[148,]   13.9583591 10.199261   -6.0277365  34.3146310
[149,]   -5.2905456 11.796100  -28.3175298  18.0459780
[150,]    9.5365497 13.583676  -16.9478920  36.6764475
[151,]   -0.9142974 13.514789  -26.8470748  25.9999856
[152,]   -6.9060714 11.534130  -28.9094561  15.8952433
[153,]  -17.7800455  9.819812  -36.5793210   1.4140343
[154,]  -31.4591195  8.533887  -48.2541171 -14.9785341
[155,]  -19.6460936  7.888707  -35.2528324  -4.1790251
[156,]   41.7590324  8.040031   26.1626213  57.9801124
[157,]  -36.5378417  8.947538  -54.0876994 -18.3687828
[158,]   14.6482843 10.415409   -5.6491325  35.6353800
[159,]   16.9745102 12.243732   -6.9939442  41.4380837
[160,]    8.7890362 14.294865  -19.0374499  36.9801862
[161,]   17.7909614 12.153049   -6.8525634  41.3699590
[162,]   10.8855292 10.472102   -9.9725439  30.7715871
[163,]    6.8737971  9.079920  -11.2456035  24.4332774
[164,]    1.2965650  8.126299  -15.2265671  17.0110408
[165,]  -10.7902671  7.774333  -26.3982869   4.2651080
[166,]  -14.9165993  8.102809  -31.0091391   1.0936942
[167,]  -49.6306314  9.037838  -67.5642083 -31.8804850
[168,]  -13.7336635 10.417354  -34.1206869   6.7182407
[169,]   22.9486043 12.090151   -0.8609377  46.4871735
[170,]   32.1692722 13.951128    4.7052328  59.1516660
[171,]    5.6546086 12.253751  -18.4540105  29.3042268
[172,]   -2.0149579 10.543694  -22.6168695  18.2010931
[173,]   10.3759756  9.111254   -7.2633901  27.9051215
[174,]   11.6789091  8.104984   -3.7227671  27.6478196
[175,]  -23.5119574  7.693957  -38.1683109  -8.2783267
[176,]    7.1911761  7.970794   -8.4999622  23.0139529
[177,]    0.3335096  8.871330  -17.0456433  18.0679957
[178,]   -2.6602569 10.232196  -22.7573860  17.6172277
[179,]   11.5296766 11.896450  -12.1481252  35.1544233
[180,]   -5.2202899 13.754403  -32.5206679  21.6957248</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 5 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.4
looic      1769.6 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   526       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   154       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.5 22.3
p_loo        33.7  8.4
looic      1721.0 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   968       
 (0.5, 0.7]   (ok)         3    1.7%   1145      
   (0.7, 1]   (bad)        4    2.2%   24        
   (1, Inf)   (very bad)   1    0.6%   19        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.5  
fit_sleep1 -92.8      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 5 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.4
looic      1769.6 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   526       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   154       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.5 22.3
p_loo        33.7  8.4
looic      1721.0 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   968       
 (0.5, 0.7]   (ok)         3    1.7%   1145      
   (0.7, 1]   (bad)        4    2.2%   24        
   (1, Inf)   (very bad)   1    0.6%   19        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.5     22.3        33.7    8.4   1721.0
fit_sleep2  -24.3      11.5  -884.8     14.4        19.3    3.4   1769.6
fit_sleep1  -92.8      20.9  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.5  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
5.142357e-41 2.882154e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.93      1.55      0.4     5.44       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.07      1.55    -3.17     2.85        5.7      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.17      
[4] StanHeaders_2.26.17 lme4_1.1-32         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.13.0          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.4.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.1        htmlwidgets_1.6.1    rlang_1.1.0         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.1         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.3.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.7  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.9        
 [91] gtable_0.3.1         cachem_1.0.7         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.2.0        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
