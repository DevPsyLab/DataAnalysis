<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.69      6.73    15.44    42.42 1.00     1741     2526
sd(Days)                6.59      1.62     4.17    10.57 1.00     1293     1436
cor(Intercept,Days)     0.09      0.30    -0.48     0.69 1.00      868     1511

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.36      7.31   237.31   265.59 1.00     1688     2805
Days         10.48      1.79     7.00    13.93 1.00     1244     1620

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.54    23.15    29.17 1.00     2692     2486

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9758  13.12331 228.0018 279.5263
309 211.6790  13.28806 186.0159 237.8595
310 213.1747  13.08005 187.5060 238.6533
330 274.3712  13.35633 248.5052 300.9378
331 272.8583  13.23712 247.8675 299.2074
332 260.2246  12.24565 236.7884 285.7113
333 267.5751  12.44708 243.6002 293.1385
334 244.0035  12.45086 219.0160 267.9576
335 250.4171  13.23194 225.5774 277.8523
337 286.0324  13.04894 259.9242 311.7235
349 226.6114  13.06399 200.5223 251.2578
350 239.1155  13.31408 212.6610 265.2353
351 255.7918  12.58071 231.2600 280.8310
352 271.8976  12.24253 248.0335 297.3125
369 254.7283  12.25668 230.4991 278.3886
370 226.5657  13.75433 198.9852 252.4038
371 252.0246  11.97168 228.2323 276.4306
372 263.5398  12.43302 238.9955 288.3088

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6234428  2.514324 14.8097378 24.572529
309  1.6960146  2.504983 -3.1721760  6.732970
310  4.8745926  2.427515  0.1198216  9.656477
330  5.7745194  2.529112  0.6135383 10.533211
331  7.5347187  2.506025  2.4865902 12.303682
332 10.2009456  2.335199  5.5426064 14.751297
333 10.3540349  2.345460  5.6678538 14.848943
334 11.5580338  2.406495  6.8537658 16.270623
335 -0.1754053  2.561620 -5.2676743  4.618575
337 19.2012700  2.494059 14.2990734 24.058460
349 11.5737046  2.462584  6.9361220 16.492519
350 16.9823353  2.506565 12.0714963 21.919188
351  7.4534874  2.398246  2.6451825 11.964383
352 14.0996041  2.322800  9.4356287 18.685562
369 11.3095811  2.329515  6.8613904 15.989769
370 15.1343687  2.621182 10.0684602 20.345931
371  9.4904463  2.305451  4.9865173 14.090984
372 11.7652386  2.353174  7.1676091 16.368853</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9758 13.123311 228.0018 279.5263
  [2,] 273.5992 11.190827 251.5936 295.9513
  [3,] 293.2227  9.533708 274.6083 312.4325
  [4,] 312.8461  8.318186 296.7217 329.4728
  [5,] 332.4696  7.754772 317.3918 347.9800
  [6,] 352.0930  7.982758 335.9162 367.4701
  [7,] 371.7164  8.941813 353.5853 388.8055
  [8,] 391.3399 10.432222 370.6012 411.4300
  [9,] 410.9633 12.261735 386.9111 434.8188
 [10,] 430.5868 14.300793 402.8076 458.4358
 [11,] 211.6790 13.288063 186.0159 237.8595
 [12,] 213.3750 11.397653 191.6006 236.2098
 [13,] 215.0710  9.787250 196.2070 234.4832
 [14,] 216.7670  8.615329 199.9450 233.9883
 [15,] 218.4630  8.075110 202.6228 234.5977
 [16,] 220.1591  8.291006 204.2125 236.5938
 [17,] 221.8551  9.209997 204.3201 240.3675
 [18,] 223.5511 10.651628 203.4729 245.0175
 [19,] 225.2471 12.435441 201.7573 249.8296
 [20,] 226.9431 14.435133 199.3489 255.3238
 [21,] 213.1747 13.080048 187.5060 238.6533
 [22,] 218.0493 11.246951 196.0021 239.6387
 [23,] 222.9239  9.679142 204.2644 242.2438
 [24,] 227.7985  8.524280 211.7041 244.8146
 [25,] 232.6731  7.964079 217.7420 248.4956
 [26,] 237.5477  8.122525 221.9619 253.7255
 [27,] 242.4223  8.961580 225.3156 260.1631
 [28,] 247.2969 10.316496 227.4541 268.2581
 [29,] 252.1715 12.013988 229.2608 276.2694
 [30,] 257.0461 13.929372 231.2551 284.6008
 [31,] 274.3712 13.356326 248.5052 300.9378
 [32,] 280.1457 11.420964 257.8112 302.3481
 [33,] 285.9203  9.761055 266.7048 304.8224
 [34,] 291.6948  8.538781 275.2038 308.3932
 [35,] 297.4693  7.958403 282.1675 312.8735
 [36,] 303.2438  8.158088 287.6545 318.8905
 [37,] 309.0183  9.086552 291.4297 326.5004
 [38,] 314.7929 10.553164 294.0140 335.1225
 [39,] 320.5674 12.367940 296.3061 343.9615
 [40,] 326.3419 14.399840 297.8303 353.6343
 [41,] 272.8583 13.237120 247.8675 299.2074
 [42,] 280.3930 11.311183 259.2660 302.8015
 [43,] 287.9277  9.655294 270.0171 306.4964
 [44,] 295.4624  8.430116 279.3943 311.7154
 [45,] 302.9971  7.840239 287.4235 318.0717
 [46,] 310.5319  8.026964 294.4159 325.9530
 [47,] 318.0666  8.941771 300.1802 335.1624
 [48,] 325.6013 10.394168 305.4040 345.8358
 [49,] 333.1360 12.193543 309.1192 356.2154
 [50,] 340.6707 14.208680 312.9202 367.9526
 [51,] 260.2246 12.245651 236.7884 285.7113
 [52,] 270.4256 10.578600 250.6231 292.4922
 [53,] 280.6265  9.206729 263.0394 299.6843
 [54,] 290.8275  8.278120 274.9465 307.5309
 [55,] 301.0284  7.949653 285.7305 316.3904
 [56,] 311.2293  8.292948 295.5063 327.7408
 [57,] 321.4303  9.233380 303.6510 339.3188
 [58,] 331.6312 10.613385 310.8992 352.3145
 [59,] 341.8322 12.285718 317.6331 365.4677
 [60,] 352.0331 14.147088 323.9674 379.5019
 [61,] 267.5751 12.447081 243.6002 293.1385
 [62,] 277.9291 10.751177 256.8552 299.8221
 [63,] 288.2832  9.340671 269.9452 306.8217
 [64,] 298.6372  8.361270 282.5296 314.7320
 [65,] 308.9912  7.973450 293.5700 324.5186
 [66,] 319.3453  8.260953 303.4022 335.4051
 [67,] 329.6993  9.160411 312.0037 347.8872
 [68,] 340.0533 10.515955 320.1772 360.7290
 [69,] 350.4074 12.176200 327.3709 374.5203
 [70,] 360.7614 14.033415 333.8532 388.8329
 [71,] 244.0035 12.450860 219.0160 267.9576
 [72,] 255.5615 10.691435 233.9910 276.3112
 [73,] 267.1196  9.228872 248.9008 285.0403
 [74,] 278.6776  8.223126 262.4743 294.8981
 [75,] 290.2356  7.851749 274.8471 305.3927
 [76,] 301.7937  8.201376 285.5384 317.3187
 [77,] 313.3517  9.190082 294.9533 330.8907
 [78,] 324.9097 10.641197 303.8797 345.3552
 [79,] 336.4678 12.393344 311.8935 360.3954
 [80,] 348.0258 14.336573 319.8615 375.6593
 [81,] 250.4171 13.231939 225.5774 277.8523
 [82,] 250.2417 11.266143 229.2228 273.4102
 [83,] 250.0662  9.586006 231.5913 269.4777
 [84,] 249.8908  8.365455 233.5599 266.7515
 [85,] 249.7154  7.822657 234.2807 265.0180
 [86,] 249.5400  8.095114 233.3455 265.4230
 [87,] 249.3646  9.109971 231.2012 267.1326
 [88,] 249.1892 10.657207 227.9459 269.5614
 [89,] 249.0138 12.541305 223.8982 272.6790
 [90,] 248.8384 14.632717 219.7052 276.5094
 [91,] 286.0324 13.048935 259.9242 311.7235
 [92,] 305.2336 11.190213 283.2615 327.3392
 [93,] 324.4349  9.623289 305.7116 343.2051
 [94,] 343.6362  8.510885 327.1950 360.3831
 [95,] 362.8374  8.043835 347.1164 378.3172
 [96,] 382.0387  8.331391 365.6156 397.8774
 [97,] 401.2400  9.303845 383.1854 419.5735
 [98,] 420.4412 10.777367 399.4148 441.3469
 [99,] 439.6425 12.577059 415.1608 464.2955
[100,] 458.8438 14.582655 430.2193 487.0814
[101,] 226.6114 13.063986 200.5223 251.2578
[102,] 238.1851 11.208615 215.8911 259.5271
[103,] 249.7588  9.629487 230.4322 268.2339
[104,] 261.3325  8.482311 244.3996 277.8982
[105,] 272.9062  7.956182 257.5367 288.3919
[106,] 284.4799  8.171946 268.5984 300.3192
[107,] 296.0536  9.076850 278.5373 313.7910
[108,] 307.6273 10.494110 287.4033 328.1497
[109,] 319.2010 12.247127 296.0499 343.3131
[110,] 330.7747 14.212197 303.4513 358.7935
[111,] 239.1155 13.314080 212.6610 265.2353
[112,] 256.0978 11.406210 232.9072 278.5962
[113,] 273.0801  9.772628 253.2930 291.9817
[114,] 290.0625  8.571617 272.9888 306.3469
[115,] 307.0448  8.000421 291.3987 322.2887
[116,] 324.0271  8.191861 307.9472 340.2253
[117,] 341.0095  9.097922 323.2596 359.1764
[118,] 357.9918 10.535820 337.4079 378.8002
[119,] 374.9741 12.320738 351.2443 399.4527
[120,] 391.9565 14.323525 363.9142 420.1197
[121,] 255.7918 12.580714 231.2600 280.8310
[122,] 263.2453 10.782757 242.1644 284.7168
[123,] 270.6987  9.260912 252.5190 289.1223
[124,] 278.1522  8.170943 262.2535 294.1399
[125,] 285.6057  7.698525 270.4306 300.5037
[126,] 293.0592  7.954460 277.5094 308.5207
[127,] 300.5127  8.875965 283.0967 318.0436
[128,] 307.9662 10.285682 287.4157 328.0032
[129,] 315.4197 12.012947 291.2767 338.5088
[130,] 322.8732 13.940220 295.1650 349.2369
[131,] 271.8976 12.242527 248.0335 297.3125
[132,] 285.9972 10.537511 265.2262 307.6581
[133,] 300.0968  9.109864 282.5366 318.4977
[134,] 314.1964  8.107458 298.0568 330.4216
[135,] 328.2960  7.698243 313.1007 343.5175
[136,] 342.3956  7.974071 326.6086 357.7273
[137,] 356.4952  8.871272 339.2161 373.7073
[138,] 370.5948 10.227606 351.0735 391.1250
[139,] 384.6944 11.886933 361.6740 408.6671
[140,] 398.7940 13.739914 372.0031 426.4405
[141,] 254.7283 12.256681 230.4991 278.3886
[142,] 266.0379 10.579612 245.0697 286.5374
[143,] 277.3474  9.191488 259.2243 295.7240
[144,] 288.6570  8.239659 272.2231 304.9870
[145,] 299.9666  7.883768 284.4232 315.7497
[146,] 311.2762  8.201761 295.0203 327.3551
[147,] 322.5858  9.123446 304.5127 340.1610
[148,] 333.8954 10.490897 313.5749 353.9272
[149,] 345.2049 12.154582 321.5486 368.4967
[150,] 356.5145 14.009357 329.1697 383.7851
[151,] 226.5657 13.754330 198.9852 252.4038
[152,] 241.7001 11.731042 218.1124 263.8777
[153,] 256.8345  9.989708 237.0795 276.0312
[154,] 271.9688  8.701286 254.4496 288.7695
[155,] 287.1032  8.085275 271.0892 303.1351
[156,] 302.2376  8.292898 286.1043 318.8060
[157,] 317.3719  9.268971 298.7898 335.9908
[158,] 332.5063 10.807251 311.9975 354.1526
[159,] 347.6407 12.705146 323.0781 372.4753
[160,] 362.7750 14.825180 334.2254 391.7587
[161,] 252.0246 11.971675 228.2323 276.4306
[162,] 261.5151 10.296873 241.5777 282.6812
[163,] 271.0055  8.908444 253.9553 289.0711
[164,] 280.4959  7.957725 265.3771 296.6485
[165,] 289.9864  7.610558 275.2642 305.2412
[166,] 299.4768  7.946447 284.1176 315.5913
[167,] 308.9673  8.888287 291.4508 327.5638
[168,] 318.4577 10.270710 298.0792 339.5594
[169,] 327.9482 11.941672 304.5161 351.9363
[170,] 337.4386 13.796731 310.5572 364.8638
[171,] 263.5398 12.433019 238.9955 288.3088
[172,] 275.3051 10.744742 254.4710 296.8167
[173,] 287.0703  9.348467 268.5510 305.9155
[174,] 298.8356  8.391248 282.0853 315.3378
[175,] 310.6008  8.031631 294.3553 326.3701
[176,] 322.3660  8.347216 305.7647 338.7829
[177,] 334.1313  9.269293 315.9190 352.4556
[178,] 345.8965 10.641354 325.3092 366.9050
[179,] 357.6617 12.313890 333.6436 382.1867
[180,] 369.4270 14.180980 341.8377 397.4587</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.41578181 13.123311  -29.9663475  21.5582037
  [2,]  -14.89452464 11.190827  -37.2465937   7.1110982
  [3,]  -42.42206747  9.533708  -61.6318784 -23.8077431
  [4,]    8.59368970  8.318186   -8.0329556  24.7180992
  [5,]   24.38234688  7.754772    8.8719158  39.4601081
  [6,]   62.59710405  7.982758   47.2199986  78.7739474
  [7,]   10.48736122  8.941813   -6.6017146  28.6185215
  [8,] -101.19128161 10.432222 -121.2814379 -80.4526361
  [9,]   19.62197557 12.261735   -4.2334662  43.6742075
 [10,]   35.76673274 14.300793    7.9176569  63.5459157
 [11,]   11.05491525 13.288063  -15.1255723  36.7179942
 [12,]   -8.10919937 11.397653  -30.9440044  13.6651789
 [13,]  -12.09321398  9.787250  -31.5053598   6.7707895
 [14,]  -12.06002859  8.615329  -29.2813014   4.7620071
 [15,]  -10.74694320  8.075110  -26.8816308   5.0933135
 [16,]   -4.19725782  8.291006  -20.6319506  11.7493229
 [17,]   -8.22477243  9.209997  -26.7372101   9.3101976
 [18,]   -5.82388704 10.651628  -27.2902952  14.2542651
 [19,]   -0.95140165 12.435441  -25.5338560  22.5384248
 [20,]   10.37108373 14.435133  -18.0096473  37.9652752
 [21,]  -14.12084932 13.080048  -39.5994454  11.5478583
 [22,]  -23.71714194 11.246951  -45.3065068  -1.6699456
 [23,]   11.39606544  9.679142   -7.9237521  30.0556241
 [24,]    5.04307282  8.524280  -11.9730397  21.1374858
 [25,]   -3.36571980  7.964079  -19.1881813  11.5654035
 [26,]  -17.08981242  8.122525  -33.2675591  -1.5040143
 [27,]   -7.00150503  8.961580  -24.7422932  10.1052362
 [28,]    8.45420235 10.316496  -12.5070430  28.2970070
 [29,]    8.84100973 12.013988  -15.2568773  31.7516910
 [30,]   -9.53078289 13.929372  -37.0855259  16.2601705
 [31,]   47.17138161 13.356326   20.6048413  73.0373727
 [32,]   20.25446224 11.420964   -1.9478679  42.5889816
 [33,]   -2.06375714  9.761055  -20.9659399  17.1517115
 [34,]   -6.56177652  8.538781  -23.2602076   9.9292137
 [35,]  -11.67199590  7.958403  -27.0762428   3.6298012
 [36,]   -5.65831528  8.158088  -21.3050004   9.9310086
 [37,]  -28.77873466  9.086552  -46.2607668 -11.1901007
 [38,]    3.46844597 10.553164  -16.8612075  24.2472556
 [39,]  -15.21787341 12.367940  -38.6119563   9.0434470
 [40,]   27.70680721 14.399840    0.4143617  56.2184435
 [41,]   14.74962734 13.237120  -11.5994788  39.7403895
 [42,]    4.60700860 11.311183  -17.8014564  25.7340200
 [43,]   13.89288986  9.655294   -4.6758033  31.8034841
 [44,]   24.65287112  8.430116    8.3999404  40.7210304
 [45,]   13.28015238  7.840239   -1.7943915  28.8538298
 [46,]  -17.21316635  8.026964  -32.6343431  -1.0972349
 [47,]  -27.99158509  8.941771  -45.0874261 -10.1051933
 [48,]    9.21639617 10.394168  -11.0181258  29.4136581
 [49,]  -39.38912257 12.193543  -62.4685070 -15.3722843
 [50,]   30.91035869 14.208680    3.6284835  58.6608940
 [51,]  -25.36401722 12.245651  -50.8506715  -1.9278461
 [52,]  -27.61376280 10.578600  -49.6803827  -7.8113295
 [53,]   -7.66520838  9.206729  -26.7230299   9.9219382
 [54,]   18.94134604  8.278120    2.2379495  34.8222647
 [55,]   16.43450046  7.949653    1.0725163  31.7323910
 [56,]   -1.23174511  8.292948  -17.7432428  14.4913261
 [57,]  132.73160931  9.233380  114.8430607 150.5109252
 [58,]   15.19986373 10.613385   -5.4834283  35.9319128
 [59,]  -11.53188185 12.285718  -35.1673919  12.6672494
 [60,]  -98.16872743 14.147088 -125.6374709 -70.1029727
 [61,]   16.26729444 12.447081   -9.2960846  40.2422007
 [62,]   11.62585957 10.751177  -10.2671294  32.6997644
 [63,]  -11.51387531  9.340671  -30.0524022   6.8241472
 [64,]    1.17248982  8.361270  -14.9222801  17.2801126
 [65,]  -11.82024506  7.973450  -27.3475758   3.6010290
 [66,]   18.82122006  8.260953    2.7613689  34.7642970
 [67,]    2.32718519  9.160411  -15.8606828  20.0227879
 [68,]    8.78655031 10.515955  -11.8890604  28.6627083
 [69,]  -17.04738456 12.176200  -41.1603210   5.9890805
 [70,]    1.28138056 14.033415  -26.7900899  28.1896081
 [71,]   21.46958707 12.450860   -2.4845425  46.4571022
 [72,]   20.63965329 10.691435   -0.1100493  42.2101877
 [73,]  -23.75488049  9.228872  -41.6755767  -5.5360676
 [74,]  -24.00531427  8.223126  -40.2258276  -7.8019888
 [75,]  -11.21124805  7.851749  -26.3683027   4.1772876
 [76,]  -17.60248183  8.201376  -33.1274601  -1.3472069
 [77,]   -7.82691561  9.190082  -25.3658794  10.5714544
 [78,]    6.61315061 10.641197  -13.8323207  27.6432423
 [79,]   -0.72088317 12.393344  -24.6484650  23.8534132
 [80,]   29.27318305 14.336573    1.6397450  57.4375130
 [81,]   -8.80875705 13.231939  -36.2439552  16.0308603
 [82,]   23.70554830 11.266143    0.5369839  44.7244481
 [83,]    4.42445364  9.586006  -14.9870023  22.8994287
 [84,]   20.91125898  8.365455    4.0505894  37.2422047
 [85,]    1.73646432  7.822657  -13.5660687  17.1711942
 [86,]    5.09616966  8.095114  -10.7867745  21.2907214
 [87,]   -3.91232500  9.109971  -21.6802523  14.2511159
 [88,]  -13.87821966 10.657207  -34.2504299   7.3650619
 [89,]  -13.25971431 12.541305  -36.9249031  11.8559399
 [90,]  -11.59180897 14.632717  -39.2627980  17.5413697
 [91,]   26.33424278 13.048935    0.6431016  52.4424476
 [92,]    8.57217283 11.190213  -13.5333623  30.5443078
 [93,]  -32.82369712  9.623289  -51.5939289 -14.1003948
 [94,]    2.48603292  8.510885  -14.2608591  18.9272030
 [95,]    2.89496297  8.043835  -12.5847529  18.6159784
 [96,]    9.79979302  8.331391   -6.0389004  26.2228943
 [97,]    3.02012307  9.303845  -15.3134088  21.0747256
 [98,]   -3.74894688 10.777367  -24.6546118  17.2774612
 [99,]   16.22178316 12.577059   -8.4312010  40.7035218
[100,]    0.07291321 14.582655  -28.1646990  28.6974469
[101,]    9.49180073 13.063986  -15.1546012  35.5808512
[102,]   -7.86840390 11.208615  -29.2104455  14.4255562
[103,]  -10.83320852  9.629487  -29.3083391   8.4933625
[104,]   -6.41051314  8.482311  -22.9761947  10.5224115
[105,]  -22.19591777  7.956182  -37.6816051  -6.8264269
[106,]  -14.70552239  8.171946  -30.5448376   1.1760187
[107,]  -14.48882701  9.076850  -32.2261787   3.0275316
[108,]    0.47466836 10.494110  -20.0476890  20.6986855
[109,]   17.07956374 12.247127   -7.0324947  40.2307000
[110,]   20.87035911 14.212197   -7.1483832  48.1937830
[111,]   17.18134306 13.314080   -8.9384640  43.6358476
[112,]  -12.64349226 11.406210  -35.1419344  10.5471317
[113,]  -16.87552758  9.772628  -35.7771401   2.9115787
[114,]  -34.53536290  8.571617  -50.8197574 -17.4617297
[115,]  -38.12829822  8.000421  -53.3721846 -22.4822380
[116,]    5.69756646  8.191861  -10.5006472  21.7774776
[117,]   38.43503114  9.097922   20.2681323  56.1849244
[118,]    4.92659582 10.535820  -15.8818183  25.5105056
[119,]   19.51306050 12.320738   -4.9654942  43.2428785
[120,]   -2.90377482 14.323525  -31.0669812  25.1385389
[121,]   -5.26526599 12.580714  -30.3045327  19.2664862
[122,]   36.81234665 10.782757   15.3408381  57.8931916
[123,]   -0.80484070  9.260912  -19.2284217  17.3748545
[124,]    2.43687194  8.170943  -13.5507669  18.3356262
[125,]  -13.77831541  7.698525  -28.6763263   1.3968206
[126,]   11.57439723  7.954460   -3.8870717  27.1241724
[127,]  -12.76609012  8.875965  -30.2969807   4.6498870
[128,]  -41.37067748 10.285682  -61.4076551 -20.8202496
[129,]    6.12213517 12.012947  -16.9669641  30.2651273
[130,]   24.69234781 13.940220   -1.6713684  52.4004752
[131,]  -50.22051098 12.242527  -75.6353612 -26.3564057
[132,]   12.19668490 10.537511   -9.4641647  32.9677221
[133,]   26.78168077  9.109864    8.3808187  44.3419276
[134,]   32.65907665  8.107458   16.4339479  48.7987064
[135,]   20.44417252  7.698243    5.2227186  35.6395352
[136,]   10.43306840  7.974071   -4.8986434  26.2201087
[137,]   -2.06863573  8.871272  -19.2807156  15.2104837
[138,]  -10.16223985 10.227606  -30.6923511   9.3590958
[139,]   -9.05384398 11.886933  -33.0264625  13.9665798
[140,]  -10.25234810 13.739914  -37.8987590  16.5386460
[141,]   17.19521595 12.256681   -6.4650549  41.4243702
[142,]    2.39903489 10.579612  -18.1004712  23.3672427
[143,]  -20.10504616  9.191488  -38.4815710  -1.9818603
[144,]  -11.00042722  8.239659  -27.3303513   5.4334699
[145,]   14.85559173  7.883768   -0.9274947  30.3990402
[146,]    5.93731067  8.201761  -10.1415711  22.1932228
[147,]  -24.45047038  9.123446  -42.0257327  -6.3774098
[148,]   14.22754856 10.490897   -5.8043463  34.5480033
[149,]   -4.92493249 12.154582  -28.2167355  18.7313997
[150,]    9.99858645 14.009357  -17.2719977  37.3434302
[151,]   -1.30171637 13.754330  -27.1397934  26.2787932
[152,]   -7.17658505 11.731042  -29.3542019  16.4110779
[153,]  -17.93365374  9.989708  -37.1303886   1.8213248
[154,]  -31.49582243  8.701286  -48.2964768 -13.9765736
[155,]  -19.56589112  8.085275  -35.5977780  -3.5518964
[156,]   41.95614019  8.292898   25.3876980  58.0893860
[157,]  -36.22382850  9.268971  -54.8426547 -17.6416715
[158,]   15.07920281 10.807251   -6.5670633  35.5880427
[159,]   17.52233412 12.705146   -7.3122913  42.0849414
[160,]    9.45376544 14.825180  -19.5299234  38.0034243
[161,]   17.85578998 11.971675   -6.5502273  41.6480872
[162,]   10.92774369 10.296873  -10.2383941  30.8650802
[163,]    6.89339741  8.908444  -11.1722365  23.9436187
[164,]    1.29355113  7.957725  -14.8590293  16.4124107
[165,]  -10.81589516  7.610558  -26.0707211   3.9063145
[166,]  -14.96484144  7.946447  -31.0793172   0.3943723
[167,]  -49.70148773  8.888287  -68.2979612 -32.1849609
[168,]  -13.82713401 10.270710  -34.9287800   6.5514247
[169,]   22.83251971 11.941672   -1.1555842  46.2646428
[170,]   32.03057342 13.796731    4.6054179  58.9120356
[171,]    5.87186186 12.433019  -18.8971299  30.4162288
[172,]   -1.83107677 10.744742  -23.3427480  19.0030137
[173,]   10.52648460  9.348467   -8.3187247  29.0458092
[174,]   11.79604596  8.391248   -4.7061857  28.5462964
[175,]  -23.42819267  8.031631  -39.1974738  -7.1826924
[176,]    7.24156870  8.347216   -9.1752625  23.8428954
[177,]    0.35053007  9.269293  -17.9738422  18.5628476
[178,]   -2.67660856 10.641354  -23.6850911  17.9106966
[179,]   11.47995281 12.313890  -13.0449930  35.4980562
[180,]   -5.30338583 14.180980  -33.3351029  22.2858880</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.5
p_loo        19.8  3.4
looic      1770.5 29.0
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1227      
 (0.5, 0.7]   (ok)         2    1.1%   85        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.3
p_loo        34.0  8.5
looic      1722.3 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     168   93.3%   747       
 (0.5, 0.7]   (ok)         9    5.0%   453       
   (0.7, 1]   (bad)        2    1.1%   57        
   (1, Inf)   (very bad)   1    0.6%   4         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.1      11.6  
fit_sleep1 -92.1      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.5
p_loo        19.8  3.4
looic      1770.5 29.0
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1227      
 (0.5, 0.7]   (ok)         2    1.1%   85        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.3
p_loo        34.0  8.5
looic      1722.3 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     168   93.3%   747       
 (0.5, 0.7]   (ok)         9    5.0%   453       
   (0.7, 1]   (bad)        2    1.1%   57        
   (1, Inf)   (very bad)   1    0.6%   4         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.2     22.3        34.0    8.5   1722.3
fit_sleep2  -24.1      11.6  -885.3     14.5        19.8    3.4   1770.5
fit_sleep1  -92.1      21.0  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.6  
fit_sleep2   29.0  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.009666e-40 3.440536e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.58     0.32     5.44       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.58    -3.18     2.93       5.28      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-33         Matrix_1.5-4.1     

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.1       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.32       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
