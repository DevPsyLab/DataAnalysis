<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.03      6.77    16.04    42.83 1.00     1816     2417
sd(Days)                6.61      1.56     4.08    10.32 1.00     1207     1713
cor(Intercept,Days)     0.07      0.31    -0.50     0.65 1.00      795     1588

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.22      7.41   236.61   266.30 1.00     1558     2038
Days         10.39      1.75     6.87    13.87 1.00     1150     1770

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.56    23.09    29.15 1.00     3638     3024

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.4753  12.92077 227.6217 278.5681
309 211.8352  13.64694 184.6850 238.9829
310 213.0949  13.19772 187.0097 238.2632
330 274.6531  13.53073 248.9211 301.8503
331 273.4523  13.07161 248.0982 299.5913
332 260.2782  12.34959 235.7507 284.1702
333 268.1590  12.59696 243.9183 292.4480
334 244.2306  12.23644 219.5498 267.4306
335 251.0963  13.71527 224.6421 278.0826
337 285.8117  13.14982 260.5271 312.3652
349 226.7126  12.82419 200.7314 251.1360
350 238.2450  13.21388 211.4299 263.7622
351 255.5288  12.69321 230.6449 281.0463
352 272.2461  12.56288 248.4681 297.3837
369 255.0650  12.16599 231.9541 279.5944
370 225.9803  13.45646 199.4986 251.8944
371 252.1529  12.12666 228.2673 275.9105
372 264.0941  12.30494 240.1285 288.3305

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6761870  2.487274 14.8413506 24.581225
309  1.6933634  2.555098 -3.2857098  6.703824
310  4.9219616  2.496386  0.2171001  9.827297
330  5.7267876  2.577193  0.6448066 10.658485
331  7.4234568  2.487931  2.4233693 12.252795
332 10.2301491  2.378034  5.5338731 14.915616
333 10.2798189  2.430670  5.4703941 15.123179
334 11.5485642  2.346592  7.0786702 16.394018
335 -0.3040396  2.629114 -5.5820833  4.834742
337 19.1853428  2.487398 14.2235094 24.084253
349 11.5648797  2.441678  7.0424600 16.464867
350 17.0556288  2.542556 12.2417246 22.085703
351  7.5302886  2.406663  2.6778408 12.135659
352 14.0432596  2.373285  9.1948329 18.640150
369 11.3078986  2.319530  6.6421217 15.754260
370 15.2463971  2.538907 10.5325304 20.368016
371  9.4581783  2.365925  4.9635997 14.241675
372 11.6588992  2.345976  6.9357222 16.212593</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.4753 12.920771 227.6217 278.5681
  [2,] 273.1515 11.051401 251.1841 294.8557
  [3,] 292.8276  9.470673 274.3142 311.6736
  [4,] 312.5038  8.344274 296.1414 329.1760
  [5,] 332.1800  7.869766 316.7484 347.8574
  [6,] 351.8562  8.161655 335.7492 367.7134
  [7,] 371.5324  9.146861 353.5051 389.3570
  [8,] 391.2086 10.634406 370.2508 411.7696
  [9,] 410.8848 12.445448 385.9384 435.1456
 [10,] 430.5610 14.458935 401.9819 458.8382
 [11,] 211.8352 13.646943 184.6850 238.9829
 [12,] 213.5285 11.698119 190.0102 236.7334
 [13,] 215.2219 10.025466 195.3612 235.3655
 [14,] 216.9153  8.788118 199.5922 234.1992
 [15,] 218.6086  8.185908 202.1940 234.3800
 [16,] 220.3020  8.357286 204.0797 236.5673
 [17,] 221.9954  9.259396 203.7517 239.8057
 [18,] 223.6887 10.709139 202.4196 244.1593
 [19,] 225.3821 12.517665 200.1597 249.1425
 [20,] 227.0755 14.551814 197.6278 255.2851
 [21,] 213.0949 13.197721 187.0097 238.2632
 [22,] 218.0168 11.300526 195.4589 239.4209
 [23,] 222.9388  9.679247 203.6835 241.7228
 [24,] 227.8607  8.493389 211.4507 244.2290
 [25,] 232.7827  7.940489 217.7837 248.2529
 [26,] 237.7047  8.150397 222.0406 253.4235
 [27,] 242.6266  9.070307 225.0122 260.1464
 [28,] 247.5486 10.515505 226.7326 267.8514
 [29,] 252.4705 12.302240 228.1834 276.1416
 [30,] 257.3925 14.303085 228.9921 285.1707
 [31,] 274.6531 13.530731 248.9211 301.8503
 [32,] 280.3799 11.548166 258.3191 303.3809
 [33,] 286.1067  9.844971 267.2407 305.8464
 [34,] 291.8335  8.588983 274.9554 308.8749
 [35,] 297.5603  7.993850 281.7902 313.0329
 [36,] 303.2871  8.204664 287.3002 319.3189
 [37,] 309.0139  9.165983 291.1113 326.7500
 [38,] 314.7406 10.676976 293.9159 335.1710
 [39,] 320.4674 12.540504 296.1240 344.5441
 [40,] 326.1942 14.622398 297.6841 354.0851
 [41,] 273.4523 13.071615 248.0982 299.5913
 [42,] 280.8757 11.150726 259.1400 303.1004
 [43,] 288.2992  9.496835 269.9436 306.8432
 [44,] 295.7226  8.271678 279.5336 312.1665
 [45,] 303.1461  7.683166 287.9044 317.9935
 [46,] 310.5696  7.875343 295.3696 325.8691
 [47,] 317.9930  8.797194 301.3166 335.6208
 [48,] 325.4165 10.253770 306.0162 345.7748
 [49,] 332.8399 12.052742 310.0726 356.5114
 [50,] 340.2634 14.063320 313.6318 368.1459
 [51,] 260.2782 12.349592 235.7507 284.1702
 [52,] 270.5083 10.599451 249.6321 291.0623
 [53,] 280.7385  9.137527 262.8382 298.6617
 [54,] 290.9686  8.120992 274.9623 307.1443
 [55,] 301.1988  7.727660 286.1108 316.8377
 [56,] 311.4289  8.049412 295.9043 327.2829
 [57,] 321.6591  9.009962 304.3461 339.5965
 [58,] 331.8892 10.434361 311.8764 352.5075
 [59,] 342.1194 12.160693 318.3499 365.9030
 [60,] 352.3495 14.078320 324.2377 379.9018
 [61,] 268.1590 12.596959 243.9183 292.4480
 [62,] 278.4388 10.810348 257.4086 299.5736
 [63,] 288.7186  9.319882 270.4182 306.9074
 [64,] 298.9984  8.286923 282.3109 315.2968
 [65,] 309.2783  7.893180 293.3710 324.5100
 [66,] 319.5581  8.230905 302.9158 335.5325
 [67,] 329.8379  9.220067 311.7083 347.9241
 [68,] 340.1177 10.681188 319.1719 360.8292
 [69,] 350.3975 12.449186 326.2751 374.5736
 [70,] 360.6773 14.411558 332.6276 388.6502
 [71,] 244.2306 12.236438 219.5498 267.4306
 [72,] 255.7791 10.524725 234.2923 275.8407
 [73,] 267.3277  9.100674 248.7336 284.6890
 [74,] 278.8762  8.117123 262.7714 294.6997
 [75,] 290.4248  7.743777 275.6572 305.1214
 [76,] 301.9734  8.065822 286.6562 317.2135
 [77,] 313.5219  9.008988 296.6327 330.9120
 [78,] 325.0705 10.405732 305.0694 345.1972
 [79,] 336.6191 12.099984 313.1981 360.0993
 [80,] 348.1676 13.984026 321.5284 375.6856
 [81,] 251.0963 13.715270 224.6421 278.0826
 [82,] 250.7923 11.666835 228.2972 274.0307
 [83,] 250.4882  9.896764 231.1445 270.5072
 [84,] 250.1842  8.579121 233.1951 266.9170
 [85,] 249.8801  7.942366 234.0293 265.0940
 [86,] 249.5761  8.147731 233.5374 265.2946
 [87,] 249.2721  9.138619 231.5067 266.7331
 [88,] 248.9680 10.698956 228.6059 269.8831
 [89,] 248.6640 12.619250 224.5741 273.5148
 [90,] 248.3599 14.759666 219.5824 277.7624
 [91,] 285.8117 13.149821 260.5271 312.3652
 [92,] 304.9970 11.266048 283.2418 328.0057
 [93,] 324.1824  9.659409 305.1945 343.7419
 [94,] 343.3677  8.488747 327.1183 360.3582
 [95,] 362.5531  7.949074 347.6779 378.0939
 [96,] 381.7384  8.166458 365.9554 397.5725
 [97,] 400.9238  9.086726 383.1860 418.6279
 [98,] 420.1091 10.527129 399.3606 440.3648
 [99,] 439.2944 12.306365 414.6929 462.9464
[100,] 458.4798 14.298499 430.0472 485.7463
[101,] 226.7126 12.824195 200.7314 251.1360
[102,] 238.2775 10.999989 215.8810 259.1257
[103,] 249.8424  9.458497 230.6119 268.1686
[104,] 261.4073  8.357639 244.7498 277.8004
[105,] 272.9721  7.884205 257.5498 288.2315
[106,] 284.5370  8.148303 268.4178 300.5902
[107,] 296.1019  9.085845 277.8612 313.5521
[108,] 307.6668 10.518265 286.7906 327.8598
[109,] 319.2317 12.273501 295.0751 342.9207
[110,] 330.7965 14.232615 303.2824 358.2837
[111,] 238.2450 13.213878 211.4299 263.7622
[112,] 255.3006 11.267482 232.6727 276.8898
[113,] 272.3562  9.603902 253.3021 290.7545
[114,] 289.4118  8.393025 272.9069 305.6684
[115,] 306.4675  7.847291 290.5262 321.9662
[116,] 323.5231  8.102239 307.4083 339.5030
[117,] 340.5787  9.090751 322.3503 358.3166
[118,] 357.6344 10.609731 336.3484 378.2227
[119,] 374.6900 12.466765 350.3897 399.0315
[120,] 391.7456 14.532833 363.2223 420.1159
[121,] 255.5288 12.693211 230.6449 281.0463
[122,] 263.0591 10.917521 241.4282 284.9172
[123,] 270.5893  9.426081 251.9840 289.5479
[124,] 278.1196  8.372202 261.5964 294.3613
[125,] 285.6499  7.932250 270.0291 300.7836
[126,] 293.1802  8.205576 276.8748 309.5056
[127,] 300.7105  9.128330 282.8243 318.8965
[128,] 308.2408 10.531163 287.9434 329.4223
[129,] 315.7711 12.250242 291.7984 340.2189
[130,] 323.3014 14.170940 295.4981 351.4411
[131,] 272.2461 12.562883 248.4681 297.3837
[132,] 286.2894 10.827685 265.8575 308.4113
[133,] 300.3326  9.376379 282.7105 318.9025
[134,] 314.3759  8.358178 298.3383 330.7760
[135,] 328.4191  7.941458 312.9059 344.0563
[136,] 342.4624  8.218232 326.5227 359.0069
[137,] 356.5057  9.125617 338.9766 374.6904
[138,] 370.5489 10.501399 349.9857 391.4710
[139,] 384.5922 12.187980 360.6090 408.5544
[140,] 398.6354 14.074064 370.4170 426.1596
[141,] 255.0650 12.165991 231.9541 279.5944
[142,] 266.3729 10.483884 246.4813 287.2457
[143,] 277.6808  9.086954 260.3245 296.2998
[144,] 288.9887  8.123675 273.1289 305.5783
[145,] 300.2966  7.757312 285.1068 316.1104
[146,] 311.6045  8.069580 295.5245 327.4607
[147,] 322.9124  8.990039 304.8982 340.2839
[148,] 334.2203 10.357795 313.7363 353.9981
[149,] 345.5282 12.021127 321.2501 368.4441
[150,] 356.8361 13.874130 328.6590 382.8689
[151,] 225.9803 13.456464 199.4986 251.8944
[152,] 241.2267 11.502406 218.4502 263.1805
[153,] 256.4731  9.819692 237.1832 275.2839
[154,] 271.7195  8.569683 255.1362 288.3693
[155,] 286.9659  7.958937 271.2740 302.4875
[156,] 302.2123  8.132773 286.5043 318.0826
[157,] 317.4587  9.046071 300.1516 335.2762
[158,] 332.7051 10.507755 313.0095 354.0338
[159,] 347.9515 12.324226 324.3841 372.6765
[160,] 363.1979 14.361485 336.2005 391.7181
[161,] 252.1529 12.126660 228.2673 275.9105
[162,] 261.6111 10.400789 241.2425 281.9332
[163,] 271.0693  8.971742 253.5264 288.4007
[164,] 280.5274  8.000193 265.0664 295.8665
[165,] 289.9856  7.662194 275.1373 304.8358
[166,] 299.4438  8.038069 283.6211 315.1968
[167,] 308.9020  9.039198 291.0464 326.6014
[168,] 318.3602 10.488033 297.6510 339.0992
[169,] 327.8183 12.226437 304.1899 351.8428
[170,] 337.2765 14.148071 310.0968 365.4926
[171,] 264.0941 12.304938 240.1285 288.3305
[172,] 275.7530 10.586710 255.2688 296.9855
[173,] 287.4119  9.151644 269.7108 305.4137
[174,] 299.0708  8.150703 283.3071 315.0854
[175,] 310.7297  7.753872 295.7067 325.8782
[176,] 322.3886  8.050983 306.9264 338.0516
[177,] 334.0475  8.973368 316.4811 351.9791
[178,] 345.7064 10.355266 325.3166 366.3807
[179,] 357.3653 12.039475 333.6228 381.1686
[180,] 369.0242 13.916666 341.8853 396.5480</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -3.9152721 12.920771  -29.00807967  21.9383384
  [2,]  -14.4467591 11.051401  -36.15104867   7.5205715
  [3,]  -42.0270461  9.470673  -60.87296552 -23.5135999
  [4,]    8.9359669  8.344274   -7.73617438  25.2984406
  [5,]   24.6718800  7.869766    8.99450085  40.1034749
  [6,]   62.8338930  8.161655   46.97666357  78.9409195
  [7,]   10.6714060  9.146861   -7.15319787  28.6986850
  [8,] -101.0599810 10.634406 -121.62097890 -80.1021572
  [9,]   19.7005320 12.445448   -4.56029130  44.6468538
 [10,]   35.7925450 14.458935    7.51531482  64.3715628
 [11,]   10.8987191 13.646943  -16.24895091  38.0488878
 [12,]   -8.2627443 11.698119  -31.46761838  15.2556348
 [13,]  -12.2441076 10.025466  -32.38771178   7.6165535
 [14,]  -12.2082710  8.788118  -29.49221971   5.1147835
 [15,]  -10.8925344  8.185908  -26.66392059   5.5221016
 [16,]   -4.3401977  8.357286  -20.60545474  11.8821465
 [17,]   -8.3650611  9.259396  -26.17538423   9.8786468
 [18,]   -5.9615244 10.709139  -26.43208629  15.3076391
 [19,]   -1.0863878 12.517665  -24.84679001  24.1359719
 [20,]   10.2387488 14.551814  -17.97088715  39.6864175
 [21,]  -14.0409569 13.197721  -39.20934793  12.0442353
 [22,]  -23.6846185 11.300526  -45.08871779  -1.1266939
 [23,]   11.3812200  9.679247   -7.40283822  30.6365121
 [24,]    4.9808584  8.493389  -11.38743772  21.3909296
 [25,]   -3.4753031  7.940489  -18.94553926  11.5237201
 [26,]  -17.2467647  8.150397  -32.96557482  -1.5826734
 [27,]   -7.2058263  9.070307  -24.72557787  10.4085755
 [28,]    8.2025122 10.515505  -12.10027052  29.0185392
 [29,]    8.5419506 12.302240  -15.12908205  32.8290635
 [30,]   -9.8772109 14.303085  -37.65538846  18.5231878
 [31,]   46.8894737 13.530731   19.69230950  72.6215271
 [32,]   20.0202862 11.548166   -2.98072129  42.0810530
 [33,]   -2.2502014  9.844971  -21.98989830  16.6158338
 [34,]   -6.7004889  8.588983  -23.74190491  10.1775897
 [35,]  -11.7629765  7.993850  -27.23557362   4.0071399
 [36,]   -5.7015640  8.204664  -21.73340066  10.2852600
 [37,]  -28.7742516  9.165983  -46.51040415 -10.8716554
 [38,]    3.5206608 10.676976  -16.90968707  24.3454024
 [39,]  -15.1179267 12.540504  -39.19463645   9.2254663
 [40,]   27.8544857 14.622398   -0.03643485  56.3645712
 [41,]   14.1556253 13.071615  -11.98337546  39.5097032
 [42,]    4.1242685 11.150726  -18.10037409  25.8599666
 [43,]   13.5214117  9.496835   -5.02256699  31.8770307
 [44,]   24.3926549  8.271678    7.94884747  40.5817103
 [45,]   13.1311980  7.683166   -1.71624379  28.3728763
 [46,]  -17.2508588  7.875343  -32.55044934  -2.0509208
 [47,]  -27.9180156  8.797194  -45.54581059 -11.2415529
 [48,]    9.4012276 10.253770  -10.95713420  28.8015347
 [49,]  -39.0930293 12.052742  -62.76450434 -16.3256703
 [50,]   31.3177139 14.063320    3.43517915  57.9492779
 [51,]  -25.4175852 12.349592  -49.30964680  -0.8901175
 [52,]  -27.6965344 10.599451  -48.25054444  -6.8203015
 [53,]   -7.7771835  9.137527  -25.70040475  10.1230756
 [54,]   18.8001674  8.120992    2.62453269  34.8064511
 [55,]   16.2641182  7.727660    0.62519119  31.3520756
 [56,]   -1.4313309  8.049412  -17.28525148  14.0932998
 [57,]  132.5028199  9.009962  114.56535542 149.8157849
 [58,]   14.9418708 10.434361   -5.67640683  34.9546678
 [59,]  -11.8190784 12.160693  -35.60268534  11.9504319
 [60,]  -98.4851275 14.078320 -126.03740909 -70.3733096
 [61,]   15.6834226 12.596959   -8.60564225  39.9241299
 [62,]   11.1162036 10.810348  -10.01856163  32.1463704
 [63,]  -11.9493153  9.319882  -30.13806033   6.3510709
 [64,]    0.8112658  8.286923  -15.48706605  17.4988075
 [65,]  -12.1072531  7.893180  -27.33898613   3.8000209
 [66,]   18.6084279  8.230905    2.63397618  35.2507286
 [67,]    2.1886090  9.220067  -15.89764702  20.3181789
 [68,]    8.7221901 10.681188  -11.98931320  29.6680344
 [69,]  -17.0375288 12.449186  -41.21363184   7.0848962
 [70,]    1.3654522 14.411558  -26.60742413  29.4152362
 [71,]   21.2425469 12.236438   -1.95748018  45.9232567
 [72,]   20.4220827 10.524725    0.36045372  41.9088997
 [73,]  -23.9629815  9.100674  -41.32434516  -5.3689380
 [74,]  -24.2039457  8.117123  -40.02736079  -8.0990671
 [75,]  -11.4004099  7.743777  -26.09701803   3.3672274
 [76,]  -17.7821741  8.065822  -33.02226179  -2.4650059
 [77,]   -7.9971383  9.008988  -25.38724905   8.8921236
 [78,]    6.4523975 10.405732  -13.67434426  26.4535170
 [79,]   -0.8721667 12.099984  -24.35242402  22.5488315
 [80,]   29.1313691 13.984026    1.61335516  55.7706205
 [81,]   -9.4879911 13.715270  -36.47431110  16.9662210
 [82,]   23.1549485 11.666835   -0.08351101  45.6499830
 [83,]    4.0024881  9.896764  -16.01648517  23.3461684
 [84,]   20.6179276  8.579121    3.88509442  37.6070244
 [85,]    1.5717672  7.942366  -13.64211367  17.4226351
 [86,]    5.0601068  8.147731  -10.65841564  21.0988356
 [87,]   -3.8197536  9.138619  -21.28080535  13.9455744
 [88,]  -13.6570140 10.698956  -34.57207292   6.7051457
 [89,]  -12.9098744 12.619250  -37.76070828  11.1800062
 [90,]  -11.1133348 14.759666  -40.51584141  17.6642035
 [91,]   26.5549038 13.149821    0.00144396  51.8395416
 [92,]    8.8087610 11.266048  -14.19990586  30.5640115
 [93,]  -32.5711819  9.659409  -52.13070295 -13.5832630
 [94,]    2.7544753  8.488747  -14.23599431  19.0038591
 [95,]    3.1793325  7.949074  -12.36153338  18.0545482
 [96,]   10.1000897  8.166458   -5.73402154  25.8831151
 [97,]    3.3363468  9.086726  -14.36783377  21.0741292
 [98,]   -3.4167960 10.527129  -23.67246826  17.3316903
 [99,]   16.5698612 12.306365   -7.08209120  41.1713598
[100,]    0.4369183 14.298499  -26.82957423  28.8695008
[101,]    9.3905731 12.824195  -15.03278966  35.3717769
[102,]   -7.9608066 10.999989  -28.80897766  14.4357057
[103,]  -10.9167863  9.458497  -29.24295476   8.3136771
[104,]   -6.4852660  8.357639  -22.87837161  10.1721921
[105,]  -22.2618457  7.884205  -37.52119507  -6.8395403
[106,]  -14.7626254  8.148303  -30.81581433   1.3566382
[107,]  -14.5371051  9.085845  -31.98731542   3.7036401
[108,]    0.4352153 10.518265  -19.75782225  21.3113843
[109,]   17.0489356 12.273501   -6.64008347  41.2054679
[110,]   20.8485559 14.232615   -6.63857801  48.3627369
[111,]   18.0518460 13.213878   -7.46541785  44.8669431
[112,]  -11.8462827 11.267482  -33.43546326  10.7815957
[113,]  -16.1516115  9.603902  -34.54991421   2.9025053
[114,]  -33.8847403  8.393025  -50.14133944 -17.3798444
[115,]  -37.5509690  7.847291  -53.04966537 -21.6097160
[116,]    6.2016022  8.102239   -9.77828374  22.3164432
[117,]   38.8657734  9.090751   21.12785961  57.0941889
[118,]    5.2840447 10.609731  -15.30427616  26.5700251
[119,]   19.7972159 12.466765   -4.54425203  44.0975256
[120,]   -2.6929129 14.532833  -31.06319249  25.8303506
[121,]   -5.0022623 12.693211  -30.51980350  19.8816044
[122,]   36.9985491 10.917521   15.14041696  58.6293631
[123,]   -0.6954395  9.426081  -19.65398902  17.9098547
[124,]    2.4694719  8.372202  -13.77216271  18.9926620
[125,]  -13.8225167  7.932250  -28.95621340   1.7983468
[126,]   11.4533947  8.205576   -4.87196131  27.7587697
[127,]  -12.9638939  9.128330  -31.14988359   4.9223127
[128,]  -41.6452825 10.531163  -62.82682488 -21.3478783
[129,]    5.7707289 12.250242  -18.67714540  29.7433752
[130,]   24.2641403 14.170940   -3.87563213  52.0673866
[131,]  -50.5689940 12.562883  -75.70655076 -26.7909802
[132,]   11.9045464 10.827685  -10.21740248  32.3364211
[133,]   26.5458868  9.376379    7.97601364  44.1680135
[134,]   32.4796272  8.358178   16.07948180  48.5172050
[135,]   20.3210676  7.941458    4.68394052  35.8342748
[136,]   10.3663080  8.218232   -6.17823283  26.3059503
[137,]   -2.0790516  9.125617  -20.26377005  15.4500297
[138,]  -10.1163112 10.501399  -31.03844993  10.4469347
[139,]   -8.9515708 12.187980  -32.91376376  15.0316378
[140,]  -10.0937304 14.074064  -37.61785175  18.1246708
[141,]   16.8585214 12.165991   -7.67094438  39.9694105
[142,]    2.0640227 10.483884  -18.80875949  21.9555607
[143,]  -20.4383759  9.086954  -39.05737958  -3.0820514
[144,]  -11.3320745  8.123675  -27.92170616   4.5277208
[145,]   14.5256268  7.757312   -1.28820225  29.7154289
[146,]    5.6090282  8.069580  -10.24715025  21.6890269
[147,]  -24.7770705  8.990039  -42.14860075  -6.7629146
[148,]   13.9026309 10.357795   -5.87515427  34.3866206
[149,]   -5.2481678 12.021127  -28.16411891  19.0298591
[150,]    9.6770336 13.874130  -16.35576998  37.8540817
[151,]   -0.7163010 13.456464  -26.63036459  25.7653933
[152,]   -6.7031981 11.502406  -28.65697193  16.0732866
[153,]  -17.5722952  9.819692  -36.38310662   1.7175679
[154,]  -31.2464923  8.569683  -47.89634404 -14.6631522
[155,]  -19.4285894  7.958937  -34.95020448  -3.7366758
[156,]   41.9814135  8.132773   26.11105648  57.6894478
[157,]  -36.3105836  9.046071  -54.12808822 -19.0035492
[158,]   14.8804193 10.507755   -6.44832260  34.5759717
[159,]   17.2115222 12.324226   -7.51346417  40.7788812
[160,]    9.0309251 14.361485  -19.48932888  36.0283225
[161,]   17.7274914 12.126660   -6.03014661  41.6131068
[162,]   10.8317131 10.400789   -9.49040231  31.2003069
[163,]    6.8296349  8.971742  -10.50182826  24.3725055
[164,]    1.2620566  8.000193  -14.07696018  16.7231355
[165,]  -10.8151217  7.662194  -25.66528753   4.0331899
[166,]  -14.9317999  8.038069  -30.68484663   0.8909070
[167,]  -49.6361782  9.039198  -67.33559491 -31.7805674
[168,]  -13.7295564 10.488033  -34.46862687   6.9795863
[169,]   22.9623653 12.226437   -1.06214082  46.5908423
[170,]   32.1926870 14.148071    3.97663842  59.3724117
[171,]    5.3175936 12.304938  -18.91876799  29.2832263
[172,]   -2.2790056 10.586710  -23.51153267  18.2052262
[173,]   10.1848951  9.151644   -7.81687009  27.8860082
[174,]   11.5607959  8.150703   -4.45378912  27.3245403
[175,]  -23.5571034  7.753872  -38.70559659  -8.5340977
[176,]    7.2189974  8.050983   -8.44400527  22.6812226
[177,]    0.4342981  8.973368  -17.49733482  18.0007000
[178,]   -2.4865011 10.355266  -23.16084101  17.9033006
[179,]   11.7763996 12.039475  -12.02688607  35.5189051
[180,]   -4.9005996 13.916666  -32.42439795  22.2383126</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.4  3.3
looic      1769.7 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   558       
 (0.5, 0.7]   (ok)         3    1.7%   238       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.3
p_loo        33.9  8.4
looic      1721.7 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   1029      
 (0.5, 0.7]   (ok)         5    2.8%   359       
   (0.7, 1]   (bad)        3    1.7%   14        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.0      11.6  
fit_sleep1 -92.5      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.4  3.3
looic      1769.7 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   558       
 (0.5, 0.7]   (ok)         3    1.7%   238       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.3
p_loo        33.9  8.4
looic      1721.7 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   1029      
 (0.5, 0.7]   (ok)         5    2.8%   359       
   (0.7, 1]   (bad)        3    1.7%   14        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.8     22.3        33.9    8.4   1721.7
fit_sleep2  -24.0      11.6  -884.9     14.4        19.4    3.3   1769.7
fit_sleep1  -92.5      20.9  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   44.5  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.782525e-41 3.665307e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.89      1.61     0.22     5.45       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.11      1.61    -3.33     3.02       5.01      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.5.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.19      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.0   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.19        V8_4.2.2            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.7         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
