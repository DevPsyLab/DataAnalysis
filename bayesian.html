<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.65      6.76    15.46    41.93 1.00     1648     2526
sd(Days)                6.61      1.58     4.16    10.40 1.00     1474     1812
cor(Intercept,Days)     0.08      0.30    -0.47     0.68 1.00     1022     1195

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.45      7.31   237.40   265.67 1.00     1666     2451
Days         10.46      1.79     6.91    14.01 1.00     1349     1618

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.93      1.59    23.07    29.33 1.00     3699     2510

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7715  12.89707 228.1898 278.8768
309 211.6868  13.61894 184.9691 237.6056
310 213.1137  13.04227 187.7174 237.8613
330 274.5821  13.61839 248.8381 302.7187
331 273.0583  13.09868 248.1682 298.0594
332 260.2135  12.29807 236.4973 284.4453
333 267.9579  12.83345 243.6691 293.2578
334 244.4821  12.48590 219.8106 268.3420
335 250.9602  13.34106 225.3263 277.2567
337 286.0030  12.97622 260.2981 312.0460
349 226.6388  13.13116 200.4084 252.6538
350 238.8586  12.79270 212.4126 263.5521
351 255.9918  12.28260 232.8197 281.1651
352 271.8948  12.79893 247.5634 296.9194
369 254.6432  12.31583 230.7377 279.0844
370 226.5184  13.55462 199.3653 252.3518
371 252.2746  12.05131 228.7808 276.6139
372 263.6724  12.39427 239.4578 288.1811

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6566871  2.526441 14.79931926 24.718059
309  1.7622774  2.552984 -3.19800236  6.804084
310  4.9060233  2.464975  0.02490581  9.739384
330  5.7230455  2.535493  0.66036843 10.538477
331  7.4895019  2.472210  2.66462523 12.007437
332 10.2207078  2.330023  5.66113508 14.662818
333 10.2935097  2.445910  5.39142610 15.045128
334 11.4755346  2.394129  6.78967404 16.166592
335 -0.2827487  2.578310 -5.42590662  4.696957
337 19.1655048  2.481997 14.30468158 23.947368
349 11.5452018  2.470764  6.83866665 16.566714
350 16.9754155  2.454392 12.23045537 21.821361
351  7.4556980  2.335494  2.75131149 11.986831
352 14.0771035  2.426402  9.53650846 18.948563
369 11.3499307  2.362611  6.83712184 16.089112
370 15.1842788  2.579893 10.21979254 20.282129
371  9.4405600  2.319750  4.89820391 13.874853
372 11.7331178  2.375814  7.03299268 16.286949</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7715 12.897071 228.1898 278.8768
  [2,] 273.4282 11.017488 251.8516 295.0127
  [3,] 293.0848  9.444652 274.6350 311.7777
  [4,] 312.7415  8.353662 296.6701 329.2238
  [5,] 332.3982  7.945545 317.2184 348.0150
  [6,] 352.0549  8.321389 336.1678 368.3346
  [7,] 371.7116  9.387500 353.6695 390.2317
  [8,] 391.3683 10.943976 369.7443 412.3646
  [9,] 411.0250 12.813348 385.8389 436.1607
 [10,] 430.6816 14.878136 401.3689 459.5234
 [11,] 211.6868 13.618938 184.9691 237.6056
 [12,] 213.4491 11.657196 190.6603 235.9212
 [13,] 215.2113  9.966967 195.8207 234.6270
 [14,] 216.9736  8.707818 199.9432 233.8732
 [15,] 218.7359  8.083763 203.1294 234.4716
 [16,] 220.4982  8.240376 204.5362 236.9425
 [17,] 222.2605  9.137606 204.1390 240.3821
 [18,] 224.0227 10.588831 203.1446 245.0357
 [19,] 225.7850 12.401060 201.4935 250.6846
 [20,] 227.5473 14.439000 199.1895 256.3309
 [21,] 213.1137 13.042268 187.7174 237.8613
 [22,] 218.0198 11.173509 196.1052 239.4897
 [23,] 222.9258  9.578416 204.3009 241.4994
 [24,] 227.8318  8.414095 211.0168 244.5464
 [25,] 232.7378  7.874017 217.2318 248.6342
 [26,] 237.6438  8.084274 221.6887 253.6996
 [27,] 242.5499  8.992388 225.0866 259.7382
 [28,] 247.4559 10.417427 226.7839 267.6452
 [29,] 252.3619 12.179275 227.9612 275.3647
 [30,] 257.2679 14.152699 229.0871 284.2311
 [31,] 274.5821 13.618390 248.8381 302.7187
 [32,] 280.3052 11.636348 258.3037 304.0901
 [33,] 286.0282  9.909899 266.7544 306.4165
 [34,] 291.7513  8.594479 275.4046 308.9820
 [35,] 297.4743  7.898195 281.7207 313.3249
 [36,] 303.1974  7.984694 287.2076 319.2864
 [37,] 308.9204  8.831006 291.0475 326.8158
 [38,] 314.6434 10.250631 293.9791 335.3709
 [39,] 320.3665 12.042494 296.2650 344.5260
 [40,] 326.0895 14.065039 298.1624 354.2383
 [41,] 273.0583 13.098679 248.1682 298.0594
 [42,] 280.5478 11.226894 259.2865 301.9365
 [43,] 288.0373  9.629878 269.1405 306.2156
 [44,] 295.5268  8.464609 278.4822 311.6081
 [45,] 303.0163  7.923907 287.0151 318.4296
 [46,] 310.5058  8.133304 294.5087 326.4619
 [47,] 317.9953  9.040830 300.0892 335.5718
 [48,] 325.4848 10.466433 304.6236 345.9028
 [49,] 332.9743 12.230269 308.4111 356.6107
 [50,] 340.4638 14.206913 312.1569 368.1268
 [51,] 260.2135 12.298070 236.4973 284.4453
 [52,] 270.4343 10.632825 249.7640 291.4526
 [53,] 280.6550  9.259019 262.6680 299.1174
 [54,] 290.8757  8.322253 274.6820 307.4078
 [55,] 301.0964  7.977994 285.5922 316.7524
 [56,] 311.3171  8.300294 295.3196 327.2979
 [57,] 321.5378  9.219512 303.5126 339.1254
 [58,] 331.7585 10.581206 311.1510 352.1827
 [59,] 341.9792 12.238565 317.8770 365.5096
 [60,] 352.1999 14.087619 324.0316 379.1092
 [61,] 267.9579 12.833449 243.6691 293.2578
 [62,] 278.2514 10.994691 257.1676 299.9913
 [63,] 288.5449  9.435784 270.6062 307.2487
 [64,] 298.8384  8.315634 282.7265 315.3533
 [65,] 309.1319  7.824990 294.0929 324.4685
 [66,] 319.4254  8.079364 303.8716 335.2860
 [67,] 329.7190  9.015916 312.5089 347.4614
 [68,] 340.0125 10.452861 320.0492 360.7445
 [69,] 350.3060 12.214861 326.2821 374.2736
 [70,] 360.5995 14.181266 332.5747 388.1882
 [71,] 244.4821 12.485903 219.8106 268.3420
 [72,] 255.9576 10.725413 234.6597 276.4019
 [73,] 267.4331  9.253912 249.2565 285.3184
 [74,] 278.9087  8.227940 262.9447 294.5471
 [75,] 290.3842  7.824756 275.3182 305.3801
 [76,] 301.8597  8.137465 286.1630 317.7210
 [77,] 313.3353  9.092500 295.7584 331.0670
 [78,] 324.8108 10.516296 304.6643 345.5039
 [79,] 336.2864 12.246433 312.4626 360.4939
 [80,] 347.7619 14.171149 319.9231 376.0031
 [81,] 250.9602 13.341059 225.3263 277.2567
 [82,] 250.6775 11.356700 228.7885 273.1132
 [83,] 250.3947  9.657161 232.1481 269.5596
 [84,] 250.1120  8.416784 234.2187 266.9395
 [85,] 249.8292  7.856150 234.8863 265.3704
 [86,] 249.5465  8.117346 233.9586 265.6430
 [87,] 249.2637  9.130109 231.1601 267.3777
 [88,] 248.9810 10.682782 227.7517 269.6739
 [89,] 248.6982 12.576968 223.9589 272.9214
 [90,] 248.4155 14.681069 219.8549 276.7774
 [91,] 286.0030 12.976221 260.2981 312.0460
 [92,] 305.1685 11.133224 283.5924 327.4827
 [93,] 324.3340  9.583094 305.6643 343.1274
 [94,] 343.4995  8.487833 327.2856 359.8203
 [95,] 362.6650  8.035642 346.9630 378.1772
 [96,] 381.8305  8.331891 365.1791 398.0927
 [97,] 400.9960  9.305369 382.6761 418.9680
 [98,] 420.1615 10.774043 399.2672 441.2007
 [99,] 439.3270 12.565458 415.0386 463.3759
[100,] 458.4925 14.560978 430.0573 486.0449
[101,] 226.6388 13.131161 200.4084 252.6538
[102,] 238.1840 11.231569 215.8150 260.2545
[103,] 249.7292  9.595740 230.5754 268.5385
[104,] 261.2744  8.379598 244.8207 277.7308
[105,] 272.8196  7.782444 257.6256 288.2197
[106,] 284.3648  7.945098 269.1897 300.2105
[107,] 295.9100  8.825648 279.1740 313.2212
[108,] 307.4552 10.240551 287.8449 328.2012
[109,] 319.0004 12.002295 295.8975 342.8571
[110,] 330.5456 13.980365 303.6214 358.3328
[111,] 238.8586 12.792695 212.4126 263.5521
[112,] 255.8340 10.963846 233.0521 276.7970
[113,] 272.8094  9.423739 253.1335 290.8057
[114,] 289.7848  8.334019 272.5738 305.8729
[115,] 306.7602  7.883715 291.0145 322.1345
[116,] 323.7357  8.179129 307.4512 339.9153
[117,] 340.7111  9.148301 322.9066 358.7135
[118,] 357.6865 10.608146 336.8485 378.3492
[119,] 374.6619 12.386371 350.6581 398.5672
[120,] 391.6373 14.365225 363.6749 419.8444
[121,] 255.9918 12.282602 232.8197 281.1651
[122,] 263.4475 10.588529 243.3413 284.7651
[123,] 270.9032  9.180450 252.9218 289.0876
[124,] 278.3589  8.206913 262.1546 294.3125
[125,] 285.8146  7.831683 270.0713 301.2869
[126,] 293.2703  8.137945 277.3298 308.9628
[127,] 300.7260  9.056826 283.1405 317.9128
[128,] 308.1817 10.427613 287.9256 328.1394
[129,] 315.6374 12.097652 291.5830 339.0161
[130,] 323.0931 13.959954 295.5124 350.0535
[131,] 271.8948 12.798932 247.5634 296.9194
[132,] 285.9719 10.990388 264.8394 307.7458
[133,] 300.0490  9.462530 281.7367 318.7043
[134,] 314.1261  8.370493 297.6323 330.7191
[135,] 328.2032  7.897196 312.7527 344.2454
[136,] 342.2803  8.151142 326.2179 358.6695
[137,] 356.3574  9.071459 338.7875 374.4015
[138,] 370.4345 10.484106 350.2732 390.9580
[139,] 384.5116 12.219511 361.7510 408.7206
[140,] 398.5887 14.159494 372.1919 427.0718
[141,] 254.6432 12.315827 230.7377 279.0844
[142,] 265.9931 10.599673 245.5429 287.0038
[143,] 277.3430  9.175534 259.7294 295.6632
[144,] 288.6930  8.197051 272.5127 304.6455
[145,] 300.0429  7.833053 284.3071 314.9773
[146,] 311.3928  8.166128 295.0280 327.1749
[147,] 322.7428  9.120221 304.9383 340.4995
[148,] 334.0927 10.527824 313.3993 354.5639
[149,] 345.4426 12.233380 321.8151 369.1387
[150,] 356.7926 14.129400 329.3415 384.3964
[151,] 226.5184 13.554623 199.3653 252.3518
[152,] 241.7027 11.549575 218.3987 263.8961
[153,] 256.8870  9.816785 236.9659 276.0437
[154,] 272.0713  8.523939 255.2705 288.7684
[155,] 287.2555  7.890342 271.9686 302.6665
[156,] 302.4398  8.072741 286.6852 318.2790
[157,] 317.6241  9.021778 300.0916 335.4955
[158,] 332.8084 10.532213 312.2542 353.2807
[159,] 347.9926 12.400574 323.6888 371.6385
[160,] 363.1769 14.489053 334.6504 390.6833
[161,] 252.2746 12.051309 228.7808 276.6139
[162,] 261.7152 10.394215 241.2315 282.4530
[163,] 271.1558  9.033706 253.5389 288.7980
[164,] 280.5963  8.120249 264.9450 296.6523
[165,] 290.0369  7.812269 274.6777 305.3991
[166,] 299.4774  8.178455 283.6253 315.5382
[167,] 308.9180  9.138117 290.8898 326.5334
[168,] 318.3586 10.530229 297.6523 339.2174
[169,] 327.7991 12.207734 303.5071 351.7180
[170,] 337.2397 14.068911 309.0949 365.0645
[171,] 263.6724 12.394270 239.4578 288.1811
[172,] 275.4055 10.636053 254.6318 296.7035
[173,] 287.1387  9.160912 269.4714 305.4825
[174,] 298.8718  8.124529 283.2101 314.7913
[175,] 310.6049  7.706012 295.5928 325.6574
[176,] 322.3380  8.002891 306.5098 337.9537
[177,] 334.0711  8.944209 316.1597 351.0270
[178,] 345.8043 10.355698 325.4175 365.9113
[179,] 357.5374 12.073569 333.8991 380.7274
[180,] 369.2705 13.985372 341.8290 396.2273</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.2114657 12.897071  -29.3168355  21.3701981
  [2,]  -14.7234528 11.017488  -36.3080421   6.8530521
  [3,]  -42.2842399  9.444652  -60.9771104 -23.8344145
  [4,]    8.6982730  8.353662   -7.7839777  24.7696769
  [5,]   24.4536859  7.945545    8.8368521  39.6335219
  [6,]   62.6351988  8.321389   46.3554588  78.5223383
  [7,]   10.4922117  9.387500   -8.0278667  28.5343273
  [8,] -101.2196754 10.943976 -122.2160478 -79.5956571
  [9,]   19.5603375 12.813348   -5.5754332  44.7464263
 [10,]   35.6718504 14.878136    6.8301283  64.9846315
 [11,]   11.0471052 13.618938  -14.8717390  37.7647529
 [12,]   -8.1832723 11.657196  -30.6553904  14.6054728
 [13,]  -12.2335497  9.966967  -31.6491883   7.1570825
 [14,]  -12.2666271  8.707818  -29.1662047   4.7638148
 [15,]  -11.0198046  8.083763  -26.7554728   4.5867176
 [16,]   -4.5363820  8.240376  -20.9806613  11.4255864
 [17,]   -8.6301594  9.137606  -26.7518386   9.4913423
 [18,]   -6.2955369 10.588831  -27.3084606  14.5825613
 [19,]   -1.4893143 12.401060  -26.3889384  22.8021967
 [20,]    9.7669083 14.439000  -19.0167031  38.1247376
 [21,]  -14.0598302 13.042268  -38.8074270  11.3364784
 [22,]  -23.6875536 11.173509  -45.1574550  -1.7729895
 [23,]   11.3942231  9.578416   -7.1793864  30.0190708
 [24,]    5.0097998  8.414095  -11.7048160  21.8247504
 [25,]   -3.4304235  7.874017  -19.3268122  12.0755797
 [26,]  -17.1859468  8.084274  -33.2417373  -1.2307896
 [27,]   -7.1290701  8.992388  -24.3173846  10.3341972
 [28,]    8.2952065 10.417427  -11.8940548  28.9672122
 [29,]    8.6505832 12.179275  -14.3522393  33.0513343
 [30,]   -9.7526401 14.152699  -36.7157678  18.4282158
 [31,]   46.9604753 13.618390   18.8238505  72.7044964
 [32,]   20.0950298 11.636348   -3.6898576  42.0965495
 [33,]   -2.1717157  9.909899  -22.5599868  17.1021135
 [34,]   -6.6182613  8.594479  -23.8489607   9.7284260
 [35,]  -11.6770068  7.898195  -27.5276267   4.0765985
 [36,]   -5.6118523  7.984694  -21.7009058  10.3779416
 [37,]  -28.6807978  8.831006  -46.5762306 -10.8078820
 [38,]    3.6178566 10.250631  -17.1095531  24.2821968
 [39,]  -15.0169889 12.042494  -39.1765485   9.0845178
 [40,]   27.9591656 14.065039   -0.1895615  55.8863211
 [41,]   14.5496313 13.098679  -10.4515119  39.4397374
 [42,]    4.4522294 11.226894  -16.9364698  25.7135443
 [43,]   13.7833275  9.629878   -4.3949580  32.6800663
 [44,]   24.5885257  8.464609    8.5072052  41.6330709
 [45,]   13.2610238  7.923907   -2.1523370  29.2622250
 [46,]  -17.1870781  8.133304  -33.1432048  -1.1900115
 [47,]  -27.9202800  9.040830  -45.4967720 -10.0141548
 [48,]    9.3329182 10.466433  -11.0851470  30.1941021
 [49,]  -39.2273837 12.230269  -62.8638354 -14.6642079
 [50,]   31.1173144 14.206913    3.4542622  59.4242409
 [51,]  -25.3529464 12.298070  -49.5847040  -1.6366728
 [52,]  -27.6224542 10.632825  -48.6408305  -6.9522038
 [53,]   -7.6936620  9.259019  -26.1561347  10.2933300
 [54,]   18.8931302  8.322253    2.3609933  35.0868373
 [55,]   16.3665225  7.977994    0.7105200  31.8706761
 [56,]   -1.3194853  8.300294  -17.3002850  14.6779888
 [57,]  132.6241069  9.219512  115.0364589 150.6492873
 [58,]   15.0725991 10.581206   -5.3516240  35.6801468
 [59,]  -11.6789087 12.238565  -35.2092993  12.4232670
 [60,]  -98.3355165 14.087619 -125.2448162 -70.1671758
 [61,]   15.8845016 12.833449   -9.4154121  40.1733222
 [62,]   11.3035919 10.994691  -10.4363283  32.3874005
 [63,]  -11.7756178  9.435784  -30.4794207   6.1630603
 [64,]    0.9712725  8.315634  -15.5436429  17.0831818
 [65,]  -11.9609372  7.824990  -27.2975117   3.0780536
 [66,]   18.7410531  8.079364    2.8805131  34.2949049
 [67,]    2.3075434  9.015916  -15.4348665  19.5175963
 [68,]    8.8274337 10.452861  -11.9045526  28.7906672
 [69,]  -16.9459760 12.214861  -40.9135881   7.0778886
 [70,]    1.4433143 14.181266  -26.1453770  29.4680968
 [71,]   20.9910262 12.485903   -2.8689290  45.6625380
 [72,]   20.2435916 10.725413   -0.2007185  41.5414856
 [73,]  -24.0684430  9.253912  -41.9536746  -5.8918228
 [74,]  -24.2363775  8.227940  -39.8748447  -8.2724011
 [75,]  -11.3598121  7.824756  -26.3556588   3.7061902
 [76,]  -17.6685467  8.137465  -33.5298264  -1.9718311
 [77,]   -7.8104813  9.092500  -25.5422342   9.7663602
 [78,]    6.7120841 10.516296  -13.9809906  26.8585567
 [79,]   -0.5394505 12.246433  -24.7469912  23.2843091
 [80,]   29.5371149 14.171149    1.2959413  57.3759346
 [81,]   -9.3519213 13.341059  -35.6483554  16.2819798
 [82,]   23.2697274 11.356700    0.8340239  45.1587063
 [83,]    4.0959761  9.657161  -15.0688738  22.3426217
 [84,]   20.6901249  8.416784    3.8626188  36.5834440
 [85,]    1.6226736  7.856150  -13.9184593  16.5655545
 [86,]    5.0897223  8.117346  -11.0067583  20.6775972
 [87,]   -3.8114290  9.130109  -21.9253698  14.2921809
 [88,]  -13.6699803 10.682782  -34.3629076   7.5593132
 [89,]  -12.9441315 12.576968  -37.1673209  11.7951634
 [90,]  -11.1688828 14.681069  -39.5307772  17.3916696
 [91,]   26.3636277 12.976221    0.3206402  52.0685266
 [92,]    8.6373229 11.133224  -13.6768573  30.2133932
 [93,]  -32.7227819  9.583094  -51.5162201 -14.0530632
 [94,]    2.6227133  8.487833  -13.6981244  18.8366243
 [95,]    3.0674085  8.035642  -12.4448100  18.7693639
 [96,]   10.0080037  8.331891   -6.2542099  26.6593640
 [97,]    3.2640989  9.305369  -14.7079465  21.5840226
 [98,]   -3.4692059 10.774043  -24.5083940  17.4251423
 [99,]   16.5372893 12.565458   -7.5116014  40.8257276
[100,]    0.4241845 14.560978  -27.1282281  28.8593767
[101,]    9.4643950 13.131161  -16.5505604  35.6947989
[102,]   -7.8673067 11.231569  -29.9377711  14.5016566
[103,]  -10.8036085  9.595740  -29.6129308   8.3501751
[104,]   -6.3524102  8.379598  -22.8088250  10.1012690
[105,]  -22.1093120  7.782444  -37.5093768  -6.9153219
[106,]  -14.5904137  7.945098  -30.4360756   0.5847318
[107,]  -14.3452155  8.825648  -31.6564090   2.3908176
[108,]    0.6467828 10.240551  -20.0991941  20.2570567
[109,]   17.2801810 12.002295   -6.5765323  40.3831126
[110,]   21.0994793 13.980365   -6.6877283  48.0237468
[111,]   17.4382139 12.792695   -7.2553423  43.8841698
[112,]  -12.3797016 10.963846  -33.3426506  10.4021738
[113,]  -16.6048171  9.423739  -34.6010636   3.0710787
[114,]  -34.2577327  8.334019  -50.3457834 -17.0467187
[115,]  -37.8437482  7.883715  -53.2180161 -22.0980433
[116,]    5.9890363  8.179129  -10.1905526  22.2734943
[117,]   38.7334208  9.148301   20.7309549  56.5379103
[118,]    5.2319053 10.608146  -15.4307815  26.0698663
[119,]   19.8252897 12.386371   -4.0800174  43.8290782
[120,]   -2.5846258 14.365225  -30.7916666  25.3777775
[121,]   -5.4652999 12.282602  -30.6385958  17.7067759
[122,]   36.6101021 10.588529   15.2925343  56.7162606
[123,]   -1.0092960  9.180450  -19.1936716  16.9721282
[124,]    2.2302060  8.206913  -13.7233801  18.4345190
[125,]  -13.9871920  7.831683  -29.4595363   1.7560624
[126,]   11.3633100  8.137945   -4.3291548  27.3037936
[127,]  -12.9793880  9.056826  -30.1661901   4.6061160
[128,]  -41.5861860 10.427613  -61.5439115 -21.3301066
[129,]    5.9044159 12.097652  -17.4742761  29.9587809
[130,]   24.4724179 13.959954   -2.4880093  52.0530793
[131,]  -50.2176671 12.798932  -75.2422918 -25.8862596
[132,]   12.2220293 10.990388   -9.5518856  33.3544738
[133,]   26.8295258  9.462530    8.1742222  45.1417893
[134,]   32.7294223  8.370493   16.1364086  49.2231905
[135,]   20.5370187  7.897196    4.4947542  35.9874685
[136,]   10.5484152  8.151142   -5.8407890  26.6107573
[137,]   -1.9307884  9.071459  -19.9749475  15.6390816
[138,]  -10.0018919 10.484106  -30.5254053  10.1593834
[139,]   -8.8709955 12.219511  -33.0799672  13.8896472
[140,]  -10.0469990 14.159494  -38.5300589  16.3497556
[141,]   17.2803252 12.315827   -7.1608841  41.1858007
[142,]    2.4437945 10.599673  -18.5668926  22.8940221
[143,]  -20.1006363  9.175534  -38.4207661  -2.4869780
[144,]  -11.0363670  8.197051  -26.9888968   5.1438955
[145,]   14.7793022  7.833053   -0.1551270  30.5150836
[146,]    5.8206715  8.166128   -9.9614182  22.1854680
[147,]  -24.6074593  9.120221  -42.3641886  -6.8030312
[148,]   14.0302100 10.527824   -6.4409666  34.7235878
[149,]   -5.1626208 12.233380  -28.8586709  18.4649111
[150,]    9.7205485 14.129400  -17.8832946  37.1715575
[151,]   -1.2544156 13.554623  -27.0877574  25.8986745
[152,]   -7.1791943 11.549575  -29.3726402  16.1247915
[153,]  -17.9861731  9.816785  -37.1428767   1.9348819
[154,]  -31.5982519  8.523939  -48.2953996 -14.7975495
[155,]  -19.7182306  7.890342  -35.1292427  -4.4313295
[156,]   41.7538906  8.072741   25.9146631  57.5084516
[157,]  -36.4759881  9.021778  -54.3473835 -18.9435320
[158,]   14.7771331 10.532213   -5.6952141  35.3313019
[159,]   17.1703543 12.400574   -6.4755059  41.4741983
[160,]    9.0518756 14.489053  -18.4544952  37.5783579
[161,]   17.6057685 12.051309   -6.7335363  41.0996227
[162,]   10.7276085 10.394215  -10.0101731  31.2112875
[163,]    6.7431485  9.033706  -10.8991261  24.3600392
[164,]    1.1931885  8.120249  -14.8627774  16.8444779
[165,]  -10.8663715  7.812269  -26.2286038   4.4927930
[166,]  -14.9654314  8.178455  -31.0262252   0.8867199
[167,]  -49.6521914  9.138117  -67.2675720 -31.6240054
[168,]  -13.7279514 10.530229  -34.5868026   6.9782552
[169,]   22.9815886 12.207734   -0.9373364  47.2735908
[170,]   32.2295286 14.068911    4.4047140  60.3743215
[171,]    5.7392739 12.394270  -18.7694078  29.9538971
[172,]   -1.9315439 10.636053  -23.2295472  18.8421879
[173,]   10.4581383  9.160912   -7.8856544  28.1254057
[174,]   11.7598205  8.124529   -4.1597032  27.4214917
[175,]  -23.4322973  7.706012  -38.4848371  -8.4201769
[176,]    7.2695849  8.002891   -8.3461304  23.0977591
[177,]    0.4106671  8.944209  -16.5451643  18.3220676
[178,]   -2.5843508 10.355698  -22.6914437  17.8023956
[179,]   11.6043314 12.073569  -11.5856674  35.2426267
[180,]   -5.1468864 13.985372  -32.1037098  22.2946165</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.3  3.3
looic      1769.5 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   682       
 (0.5, 0.7]   (ok)         1    0.6%   200       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.0 22.8
p_loo        35.1  9.0
looic      1723.9 45.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   438       
 (0.5, 0.7]   (ok)         4    2.2%   733       
   (0.7, 1]   (bad)        1    0.6%   31        
   (1, Inf)   (very bad)   2    1.1%   4         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -22.8      12.0  
fit_sleep1 -91.2      21.4  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.3  3.3
looic      1769.5 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   682       
 (0.5, 0.7]   (ok)         1    0.6%   200       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.0 22.8
p_loo        35.1  9.0
looic      1723.9 45.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   438       
 (0.5, 0.7]   (ok)         4    2.2%   733       
   (0.7, 1]   (bad)        1    0.6%   31        
   (1, Inf)   (very bad)   2    1.1%   4         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.0     22.8        35.1    9.0   1723.9
fit_sleep2  -22.8      12.0  -884.7     14.3        19.3    3.3   1769.5
fit_sleep1  -91.2      21.4  -953.2     10.5         3.1    0.5   1906.4
           se_looic
fit_sleep3   45.6  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
2.441969e-40 1.295526e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.91      1.59     0.33     5.41       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.09      1.59    -3.32     3.01       5.11      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.16      
[4] StanHeaders_2.26.16 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.13.0          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.4.0      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.1        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.1         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.7  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.9        
 [91] gtable_0.3.1         cachem_1.0.7         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.2.0        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
