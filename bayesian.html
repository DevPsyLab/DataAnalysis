<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.08      7.11    15.57    43.27 1.00     1715     2211
sd(Days)                6.57      1.56     4.14    10.18 1.00     1292     1338
cor(Intercept,Days)     0.10      0.30    -0.45     0.69 1.01      854     1662

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.08      7.57   235.61   266.44 1.00     1831     2118
Days         10.37      1.59     7.14    13.40 1.00     1444     2193

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.94      1.58    23.09    29.32 1.00     3072     2624

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.2550  12.94882 228.3909 279.2417
309 211.2584  13.25360 185.1471 235.9865
310 212.7386  13.24055 186.2499 238.2174
330 274.2466  13.52227 248.3739 300.6217
331 273.1760  13.04773 248.5338 299.8255
332 260.3376  12.56548 236.4456 285.6139
333 267.9226  12.40727 244.0446 292.2370
334 244.0616  12.53941 219.6913 268.2345
335 250.7073  13.01747 225.9287 276.5843
337 286.2699  13.02407 260.7769 311.8018
349 226.6768  13.01429 200.8772 251.6099
350 238.8547  13.21639 212.1584 264.0008
351 255.4374  12.51374 231.1604 280.3314
352 272.0396  12.33107 248.5519 296.3664
369 254.5428  12.28719 230.2787 278.8357
370 226.6388  13.44894 199.5159 251.9470
371 252.2366  12.34877 228.3404 276.8722
372 263.4286  12.61697 238.9546 289.1634

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5777714  2.499180 14.7942636 24.575186
309  1.7995570  2.537300 -3.0700500  6.792784
310  4.9532431  2.464085  0.1923558  9.800900
330  5.7460553  2.582088  0.5811516 10.639485
331  7.5042657  2.467485  2.5027644 12.243954
332 10.2464465  2.368231  5.6247372 14.821911
333 10.3205728  2.353306  5.6907819 14.741537
334 11.5241191  2.351145  6.8680103 16.137748
335 -0.2362872  2.539167 -5.3530237  4.627854
337 19.1157710  2.495369 14.1743858 23.933586
349 11.5189274  2.417279  6.7295975 16.307051
350 16.9383068  2.546005 12.1030429 22.061380
351  7.5397209  2.359459  2.8349910 12.206515
352 14.0212182  2.358902  9.3803121 18.826855
369 11.3168059  2.352691  6.6321941 15.946221
370 15.1256940  2.521897 10.2534762 20.081402
371  9.4770681  2.339050  4.8281235 14.117390
372 11.7553515  2.377145  7.0247550 16.398848</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.2550 12.948824 228.3909 279.2417
  [2,] 273.8327 11.097685 252.1615 295.0459
  [3,] 293.4105  9.546570 274.8614 312.1023
  [4,] 312.9883  8.462103 296.4539 329.7040
  [5,] 332.5660  8.035495 316.9527 348.4292
  [6,] 352.1438  8.367973 335.9741 368.3233
  [7,] 371.7216  9.379156 353.5512 389.9071
  [8,] 391.2994 10.881451 370.4542 412.2768
  [9,] 410.8771 12.701778 386.5715 435.2253
 [10,] 430.4549 14.722642 402.3005 459.0731
 [11,] 211.2584 13.253598 185.1471 235.9865
 [12,] 213.0579 11.330896 190.8191 234.5755
 [13,] 214.8575  9.695170 196.0552 233.4242
 [14,] 216.6571  8.513473 199.8183 233.1260
 [15,] 218.4566  7.989863 202.9907 234.1083
 [16,] 220.2562  8.250598 204.2752 236.4778
 [17,] 222.0557  9.229442 204.0775 240.6226
 [18,] 223.8553 10.731664 202.5858 245.1220
 [19,] 225.6548 12.571014 200.5866 250.2001
 [20,] 227.4544 14.620806 198.0140 255.6213
 [21,] 212.7386 13.240551 186.2499 238.2174
 [22,] 217.6918 11.410629 195.1804 239.1526
 [23,] 222.6451  9.860838 203.3275 241.1951
 [24,] 227.5983  8.741466 210.6578 244.4576
 [25,] 232.5515  8.230053 216.2738 248.3809
 [26,] 237.5048  8.437875 220.7443 253.9388
 [27,] 242.4580  9.316927 223.9622 260.5963
 [28,] 247.4113 10.703082 226.4797 268.4422
 [29,] 252.3645 12.427800 227.8649 276.8804
 [30,] 257.3178 14.369687 228.7877 285.6214
 [31,] 274.2466 13.522273 248.3739 300.6217
 [32,] 279.9926 11.536476 257.9032 302.4210
 [33,] 285.7387  9.831738 267.0653 304.9996
 [34,] 291.4847  8.577308 275.2066 308.4957
 [35,] 297.2308  7.988224 281.7085 312.9717
 [36,] 302.9768  8.208994 286.9066 319.1630
 [37,] 308.7229  9.181384 290.5152 326.5661
 [38,] 314.4690 10.702448 293.3884 334.8792
 [39,] 320.2150 12.574631 295.2664 344.5755
 [40,] 325.9611 14.664060 296.9269 353.7852
 [41,] 273.1760 13.047728 248.5338 299.8255
 [42,] 280.6803 11.190512 259.4922 303.4594
 [43,] 288.1845  9.611913 270.1143 307.5577
 [44,] 295.6888  8.469188 279.5551 312.6767
 [45,] 303.1931  7.952509 287.9635 318.6495
 [46,] 310.6973  8.181357 295.1623 326.4553
 [47,] 318.2016  9.099658 300.6386 336.0542
 [48,] 325.7058 10.528529 305.2351 346.5724
 [49,] 333.2101 12.291177 309.6573 357.4212
 [50,] 340.7144 14.264400 312.9887 368.6963
 [51,] 260.3376 12.565476 236.4456 285.6139
 [52,] 270.5841 10.813822 249.5369 292.1833
 [53,] 280.8305  9.338273 262.1523 299.3267
 [54,] 291.0770  8.287641 274.5128 307.1012
 [55,] 301.3234  7.834772 285.5202 316.3902
 [56,] 311.5698  8.080803 295.1649 327.1779
 [57,] 321.8163  8.968396 303.8971 339.3679
 [58,] 332.0627 10.333533 311.6498 352.5163
 [59,] 342.3092 12.014522 318.0505 365.8253
 [60,] 352.5556 13.897215 325.0101 379.8523
 [61,] 267.9226 12.407269 244.0446 292.2370
 [62,] 278.2432 10.668155 257.6717 299.1231
 [63,] 288.5637  9.206239 270.7160 306.9452
 [64,] 298.8843  8.171674 282.7912 315.3515
 [65,] 309.2049  7.737814 294.2529 324.5999
 [66,] 319.5254  8.002961 304.3489 335.4737
 [67,] 329.8460  8.904892 312.3816 347.1449
 [68,] 340.1666 10.277301 319.6684 360.4545
 [69,] 350.4872 11.959300 327.0214 373.7085
 [70,] 360.8077 13.838456 333.4975 387.7156
 [71,] 244.0616 12.539408 219.6913 268.2345
 [72,] 255.5857 10.816692 234.7369 276.9581
 [73,] 267.1098  9.371267 249.3201 285.3800
 [74,] 278.6339  8.348428 262.6062 294.7048
 [75,] 290.1580  7.913761 274.6687 305.6627
 [76,] 301.6822  8.161785 285.6391 317.9064
 [77,] 313.2063  9.036461 295.6704 331.2145
 [78,] 324.7304 10.380572 304.4491 344.7022
 [79,] 336.2545 12.037886 312.1597 359.2979
 [80,] 347.7786 13.896794 319.8336 375.1808
 [81,] 250.7073 13.017473 225.9287 276.5843
 [82,] 250.4710 11.087414 229.0091 272.1980
 [83,] 250.2347  9.449955 231.3269 268.5112
 [84,] 249.9984  8.280536 233.4193 265.5871
 [85,] 249.7622  7.792795 234.3748 264.8931
 [86,] 249.5259  8.110658 233.5594 265.7631
 [87,] 249.2896  9.150553 231.6287 267.3091
 [88,] 249.0533 10.704075 228.1886 270.1899
 [89,] 248.8170 12.582390 224.4362 274.1125
 [90,] 248.5807 14.661194 219.9680 278.2482
 [91,] 286.2699 13.024068 260.7769 311.8018
 [92,] 305.3857 11.133311 283.5878 327.0552
 [93,] 324.5015  9.525156 305.8042 342.7438
 [94,] 343.6172  8.364228 327.2868 359.7548
 [95,] 362.7330  7.851482 347.3191 378.3112
 [96,] 381.8488  8.110792 365.8319 397.6305
 [97,] 400.9645  9.076226 383.4376 418.3627
 [98,] 420.0803 10.555781 399.6203 440.2235
 [99,] 439.1961 12.366281 415.1360 463.2017
[100,] 458.3118 14.383290 430.5591 486.2390
[101,] 226.6768 13.014294 200.8772 251.6099
[102,] 238.1957 11.204674 216.0894 259.8779
[103,] 249.7147  9.664578 230.2329 268.7687
[104,] 261.2336  8.541071 244.4096 278.0269
[105,] 272.7525  8.011380 257.0768 288.4625
[106,] 284.2714  8.191520 268.4078 300.4644
[107,] 295.7904  9.039152 278.0174 313.9338
[108,] 307.3093 10.392210 286.6381 327.7282
[109,] 318.8282 12.082063 294.9110 342.1230
[110,] 330.3472 13.987171 302.9311 357.4104
[111,] 238.8547 13.216386 212.1584 264.0008
[112,] 255.7930 11.292646 233.1488 277.2024
[113,] 272.7313  9.661216 253.4847 290.9814
[114,] 289.6696  8.492270 273.0118 306.0693
[115,] 306.6079  7.991400 291.0134 322.1829
[116,] 323.5462  8.280736 306.9072 339.6105
[117,] 340.4846  9.286711 321.8007 358.4951
[118,] 357.4229 10.811091 336.0704 378.4319
[119,] 374.3612 12.668096 349.2120 399.1657
[120,] 391.2995 14.732478 362.2660 420.3179
[121,] 255.4374 12.513745 231.1604 280.3314
[122,] 262.9771 10.793698 241.7916 284.1574
[123,] 270.5168  9.356714 251.9932 288.7610
[124,] 278.0566  8.350232 261.5191 294.4313
[125,] 285.5963  7.939695 269.7986 301.1324
[126,] 293.1360  8.214938 277.1810 309.2830
[127,] 300.6757  9.114042 282.9037 318.8444
[128,] 308.2154 10.477615 288.0455 328.8373
[129,] 315.7552 12.150273 292.1703 339.6610
[130,] 323.2949 14.021839 296.2357 350.5750
[131,] 272.0396 12.331067 248.5519 296.3664
[132,] 286.0608 10.585576 265.7421 306.9113
[133,] 300.0820  9.120443 282.3356 318.2863
[134,] 314.1033  8.089460 298.3666 330.0184
[135,] 328.1245  7.669751 313.2088 342.8375
[136,] 342.1457  7.958621 326.4646 357.5063
[137,] 356.1669  8.887241 338.6217 373.6092
[138,] 370.1881 10.283739 350.0798 390.5818
[139,] 384.2093 11.985673 360.4503 408.3705
[140,] 398.2306 13.881148 370.7549 426.4905
[141,] 254.5428 12.287194 230.2787 278.8357
[142,] 265.8596 10.553671 244.9001 286.4850
[143,] 277.1764  9.102479 259.1582 295.1105
[144,] 288.4932  8.087062 272.8399 304.3400
[145,] 299.8100  7.682210 285.1652 314.8759
[146,] 311.1268  7.981380 295.8384 326.8562
[147,] 322.4436  8.913967 305.1402 340.3773
[148,] 333.7604 10.309486 313.4788 354.2664
[149,] 345.0772 12.007602 321.2986 369.3401
[150,] 356.3940 13.897835 328.8836 384.4342
[151,] 226.6388 13.448936 199.5159 251.9470
[152,] 241.7645 11.536001 218.3200 263.6350
[153,] 256.8902  9.899731 236.8686 275.5699
[154,] 272.0159  8.697700 254.3844 288.9268
[155,] 287.1416  8.124974 270.4150 302.9925
[156,] 302.2673  8.312663 285.4933 318.6333
[157,] 317.3930  9.214416 299.0635 335.3148
[158,] 332.5187 10.650375 311.5779 353.4295
[159,] 347.6444 12.436858 322.5493 372.2177
[160,] 362.7701 14.444387 334.0278 391.0011
[161,] 252.2366 12.348770 228.3404 276.8722
[162,] 261.7137 10.671274 241.4655 283.0808
[163,] 271.1908  9.284523 253.4289 289.6970
[164,] 280.6678  8.334924 264.4985 297.2936
[165,] 290.1449  7.980092 274.7528 306.5190
[166,] 299.6220  8.296691 283.7007 316.3607
[167,] 309.0990  9.215780 291.3358 327.5278
[168,] 318.5761 10.581515 298.0068 339.9257
[169,] 328.0532 12.245350 304.3682 352.6062
[170,] 337.5302 14.102166 310.1923 365.8767
[171,] 263.4286 12.616972 238.9546 289.1634
[172,] 275.1840 10.886650 253.9386 297.2524
[173,] 286.9393  9.442030 268.7035 305.9057
[174,] 298.6947  8.431272 282.3400 315.6004
[175,] 310.4500  8.020125 295.0541 326.2578
[176,] 322.2054  8.298198 306.2556 337.9931
[177,] 333.9607  9.203228 316.2294 351.6437
[178,] 345.7161 10.575460 324.9140 366.0584
[179,] 357.4714 12.258994 333.4385 381.3556
[180,] 369.2268 14.143095 341.1399 396.7008</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.6949605 12.948824  -29.68165789  21.1690859
  [2,]  -15.1280319 11.097685  -36.34116777   6.5431653
  [3,]  -42.6099032  9.546570  -61.30170485 -24.0608133
  [4,]    8.4515254  8.462103   -8.26416532  24.9859301
  [5,]   24.2858541  8.035495    8.42266394  39.8991740
  [6,]   62.5462827  8.367973   46.36675501  78.7160150
  [7,]   10.4822114  9.379156   -7.70328780  28.6526219
  [8,] -101.1507600 10.881451 -122.12816322 -80.3055712
  [9,]   19.7081687 12.701778   -4.64000588  44.0137605
 [10,]   35.8985973 14.722642    7.28037108  64.0529839
 [11,]   11.4755161 13.253598  -13.25259486  37.5867783
 [12,]   -7.7921409 11.330896  -29.30967938  14.4466554
 [13,]  -11.8796979  9.695170  -30.44639021   6.9226483
 [14,]  -11.9500548  8.513473  -28.41899594   4.8886674
 [15,]  -10.7405118  7.989863  -26.39219725   4.7254348
 [16,]   -4.2943687  8.250598  -20.51603504  11.6866468
 [17,]   -8.4254257  9.229442  -26.99232766   9.5528060
 [18,]   -6.1280827 10.731664  -27.39483757  15.1414295
 [19,]   -1.3591396 12.571014  -25.90442831  23.7090982
 [20,]    9.8598034 14.620806  -18.30705660  39.3001735
 [21,]  -13.6846700 13.240551  -39.16347682  12.8039873
 [22,]  -23.3596131 11.410629  -44.82038489  -0.8482500
 [23,]   11.6749439  9.860838   -6.87512769  30.9924914
 [24,]    5.2433008  8.741466  -11.61599024  22.1837618
 [25,]   -3.2441423  8.230053  -19.07348373  13.0335700
 [26,]  -17.0468854  8.437875  -33.48085671  -0.2864140
 [27,]   -7.0372285  9.316927  -25.17547999  11.4586049
 [28,]    8.3398284 10.703082  -12.69105278  29.2713968
 [29,]    8.6479853 12.427800  -15.86789883  33.1476384
 [30,]   -9.8024578 14.369687  -38.10608879  18.7275806
 [31,]   47.2960297 13.522273   20.92089600  73.1686792
 [32,]   20.4075744 11.536476   -2.02078387  42.4970324
 [33,]   -1.8821809  9.831738  -21.14311176  16.7911521
 [34,]   -6.3517362  8.577308  -23.36272488   9.9263734
 [35,]  -11.4334915  7.988224  -27.17439270   4.0888131
 [36,]   -5.3913468  8.208994  -21.57749027  10.6789139
 [37,]  -28.4833021  9.181384  -46.32645725 -10.2756007
 [38,]    3.7923426 10.702448  -16.61789042  24.8728913
 [39,]  -14.8655127 12.574631  -39.22603192  10.0830932
 [40,]   28.0876320 14.664060    0.26353708  57.1218023
 [41,]   14.4319116 13.047728  -12.21759287  39.0741439
 [42,]    4.3197459 11.190512  -18.45938523  25.5078427
 [43,]   13.6360802  9.611913   -5.73714390  31.7062521
 [44,]   24.4265146  8.469188    7.43858531  40.5601756
 [45,]   13.0842489  7.952509   -2.37218896  28.3137922
 [46,]  -17.3786168  8.181357  -33.13661667  -1.8435570
 [47,]  -28.1265824  9.099658  -45.97915205 -10.5636084
 [48,]    9.1118519 10.528529  -11.75474550  29.5826422
 [49,]  -39.4632137 12.291177  -63.67425783 -15.9104051
 [50,]   30.8667206 14.264400    2.88478559  58.5923779
 [51,]  -25.4770170 12.565476  -50.75325594  -1.5849907
 [52,]  -27.7722635 10.813822  -49.37153176  -6.7251446
 [53,]   -7.8692100  9.338273  -26.36540554  10.8090128
 [54,]   18.6918435  8.287641    2.66763191  35.2559941
 [55,]   16.1394969  7.834772    1.07273180  31.9427370
 [56,]   -1.5722496  8.080803  -17.18027036  14.8326956
 [57,]  132.3456039  8.968396  114.79401251 150.2647842
 [58,]   14.7683574 10.333533   -5.68524756  35.1812575
 [59,]  -12.0088891 12.014522  -35.52497947  12.2498435
 [60,]  -98.6912356 13.897215 -125.98787115 -71.1457271
 [61,]   15.9198172 12.407269   -8.39459530  39.7977580
 [62,]   11.3118444 10.668155   -9.56813015  31.8833303
 [63,]  -11.7944284  9.206239  -30.17585189   6.0533490
 [64,]    0.9253989  8.171674  -15.54175821  17.0185481
 [65,]  -12.0338739  7.737814  -27.42885485   2.9181464
 [66,]   18.6410533  8.002961    2.69281270  33.8175674
 [67,]    2.1804805  8.904892  -15.11841655  19.6448603
 [68,]    8.6733077 10.277301  -11.61455425  29.1715079
 [69,]  -17.1271651 11.959300  -40.34847550   6.3386417
 [70,]    1.2350621 13.838456  -25.67281619  28.5453205
 [71,]   21.4115340 12.539408   -2.76142770  45.7817895
 [72,]   20.6155150 10.816692   -0.75686986  41.4642940
 [73,]  -23.7451041  9.371267  -42.01531664  -5.9554126
 [74,]  -23.9616231  8.348428  -40.03251264  -7.9339305
 [75,]  -11.1336422  7.913761  -26.63832111   4.3557236
 [76,]  -17.4909612  8.161785  -33.71516168  -1.4478812
 [77,]   -7.6814803  9.036461  -25.68972402   9.8543926
 [78,]    6.7925006 10.380572  -13.17926734  27.0737685
 [79,]   -0.5076184 12.037886  -23.55097482  23.5871538
 [80,]   29.5203625 13.896794    2.11824870  57.4653583
 [81,]   -9.0990072 13.017473  -34.97595971  15.6796190
 [82,]   23.4761800 11.087414    1.74917378  44.9380999
 [83,]    4.2559672  9.449955  -14.02053071  23.1637612
 [84,]   20.8036545  8.280536    5.21503710  37.3827757
 [85,]    1.6897417  7.792795  -13.44124271  17.0771124
 [86,]    5.1103289  8.110658  -11.12687366  21.0768066
 [87,]   -3.8372838  9.150553  -21.85675369  13.8236491
 [88,]  -13.7422966 10.704075  -34.87887873   7.1223610
 [89,]  -13.0629093 12.582390  -38.35837252  11.3178966
 [90,]  -11.3341221 14.661194  -41.00161942  17.2786152
 [91,]   26.0966910 13.024068    0.56479478  51.5896724
 [92,]    8.4201200 11.133311  -13.24937748  30.2180148
 [93,]  -32.8902509  9.525156  -51.13263173 -14.1930242
 [94,]    2.5049781  8.364228  -13.63258540  18.8354167
 [95,]    2.9994071  7.851482  -12.57882210  18.4133404
 [96,]    9.9897362  8.110792   -5.79197441  26.0066087
 [97,]    3.2955652  9.076226  -14.10257701  20.8225389
 [98,]   -3.3880057 10.555781  -23.53115402  17.0719748
 [99,]   16.6682233 12.366281   -7.33736573  40.7283005
[100,]    0.6048523 14.383290  -27.32226889  28.3575958
[101,]    9.4263962 13.014294  -15.50667047  35.2260010
[102,]   -7.8790312 11.204674  -29.56119419  14.2273439
[103,]  -10.7890586  9.664578  -29.84307817   8.6927377
[104,]   -6.3115860  8.541071  -23.10487601  10.5124469
[105,]  -22.0422134  8.011380  -37.75220162  -6.3664748
[106,]  -14.4970408  8.191520  -30.69000374   1.3666176
[107,]  -14.2255682  9.039152  -32.36901419   3.5474121
[108,]    0.7927043 10.392210  -19.62622415  21.4638700
[109,]   17.4523769 12.082063   -5.84241839  41.3696044
[110,]   21.2979495 13.987171   -5.76530018  48.7140122
[111,]   17.4420884 13.216386   -7.70395702  44.1383500
[112,]  -12.3387185 11.292646  -33.74814889  10.3054969
[113,]  -16.5267253  9.661216  -34.77676454   2.7199351
[114,]  -34.1425321  8.492270  -50.54218535 -17.4847474
[115,]  -37.6914389  7.991400  -53.26642728 -22.0969254
[116,]    6.1784542  8.280736   -9.88578874  22.8174892
[117,]   38.9599474  9.286711   20.94940307  57.6438220
[118,]    5.4955406 10.811091  -15.51348492  26.8480078
[119,]   20.1260338 12.668096   -4.67846751  45.2752320
[120,]   -2.2467731 14.732478  -31.26517703  26.7867325
[121,]   -4.9108900 12.513745  -29.80488538  19.3660889
[122,]   37.0804891 10.793698   15.90018963  58.2659650
[123,]   -0.6229319  9.356714  -18.86706648  17.9006767
[124,]    2.5325472  8.350232  -13.84221477  19.0700288
[125,]  -13.7688738  7.939695  -29.30502215   2.0288072
[126,]   11.4976053  8.214938   -4.64937559  27.4525980
[127,]  -12.9291157  9.114042  -31.09775530   4.8428843
[128,]  -41.6199366 10.477615  -62.24184390 -21.4499725
[129,]    5.7866424 12.150273  -18.11922993  29.3714559
[130,]   24.2706215 14.021839   -3.00953479  51.3298144
[131,]  -50.3624970 12.331067  -74.68925066 -26.8748291
[132,]   12.1330848 10.585576   -8.71741392  32.4517736
[133,]   26.7964666  9.120443    8.59217254  44.5428698
[134,]   32.7522484  8.089460   16.83707421  48.4888992
[135,]   20.6157302  7.669751    5.90269786  35.5313948
[136,]   10.6830120  7.958621   -4.67756862  26.3640654
[137,]   -1.7403062  8.887241  -19.18262347  15.8048900
[138,]   -9.7555244 10.283739  -30.14916094  10.3528366
[139,]   -8.5687426 11.985673  -32.72986145  15.1902681
[140,]   -9.6888608 13.881148  -37.94877742  17.7867990
[141,]   17.3807227 12.287194   -6.91224763  41.6448472
[142,]    2.5773168 10.553671  -18.04809981  23.5368253
[143,]  -19.9339891  9.102479  -37.86808369  -1.9158367
[144,]  -10.8365950  8.087062  -26.68340112   4.8166652
[145,]   15.0121991  7.682210   -0.05365677  29.6570332
[146,]    6.0866933  7.981380   -9.64268032  21.3750885
[147,]  -24.3083126  8.913967  -42.24201388  -7.0048565
[148,]   14.3624815 10.309486   -6.14350306  34.6441475
[149,]   -4.7972244 12.007602  -29.06008408  18.9813931
[150,]   10.1190697 13.897835  -17.92110533  37.6294625
[151,]   -1.3748042 13.448936  -26.68299888  25.7481275
[152,]   -7.2409982 11.536001  -29.11148709  16.2034959
[153,]  -17.9893922  9.899731  -36.66905986   2.0321842
[154,]  -31.5428862  8.697700  -48.45375998 -13.9114279
[155,]  -19.6042802  8.124974  -35.45518314  -2.8776538
[156,]   41.9264258  8.312663   25.56040474  58.7004049
[157,]  -36.2448682  9.214416  -54.16673190 -17.9154409
[158,]   15.0668378 10.650375   -5.84399494  36.0075704
[159,]   17.5186437 12.436858   -7.05473660  42.6136754
[160,]    9.4587497 14.444387  -18.77228725  38.2009564
[161,]   17.6437699 12.348770   -6.99184683  41.5399963
[162,]   10.7291018 10.671274  -10.63803570  30.9772626
[163,]    6.7081336  9.284523  -11.79808165  24.4699928
[164,]    1.1216655  8.334924  -15.50410815  17.2910215
[165,]  -10.9744026  7.980092  -27.34854132   4.4177015
[166,]  -15.1099708  8.296691  -31.84865132   0.8113088
[167,]  -49.8332389  9.215780  -68.26202624 -32.0700278
[168,]  -13.9455070 10.581515  -35.29513749   6.6237856
[169,]   22.7275249 12.245350   -1.82550292  46.4125307
[170,]   31.9389567 14.102166    3.59253294  59.2769020
[171,]    5.9830800 12.616972  -19.75172685  30.4570810
[172,]   -1.7099716 10.886650  -23.77841543  19.5354166
[173,]   10.6574769  9.442030   -8.30886582  28.8933422
[174,]   11.9369253  8.431272   -4.96876392  28.2916050
[175,]  -23.2774262  8.020125  -39.08517695  -7.8814701
[176,]    7.4022222  8.298198   -8.38551000  23.3520296
[177,]    0.5210707  9.203228  -17.16186288  18.2524211
[178,]   -2.4961809 10.575460  -22.83854325  18.3059230
[179,]   11.6702676 12.258994  -12.21385073  35.7032500
[180,]   -5.1031840 14.143095  -32.57722172  22.9836647</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.6
p_loo        19.7  3.6
looic      1770.6 29.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   696       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   29        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.4 22.4
p_loo        34.3  8.5
looic      1722.8 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   690       
 (0.5, 0.7]   (ok)         4    2.2%   274       
   (0.7, 1]   (bad)        1    0.6%   86        
   (1, Inf)   (very bad)   2    1.1%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.9      11.5  
fit_sleep1 -92.0      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.6
p_loo        19.7  3.6
looic      1770.6 29.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   696       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   29        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.4 22.4
p_loo        34.3  8.5
looic      1722.8 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   690       
 (0.5, 0.7]   (ok)         4    2.2%   274       
   (0.7, 1]   (bad)        1    0.6%   86        
   (1, Inf)   (very bad)   2    1.1%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.4     22.4        34.3    8.5   1722.8
fit_sleep2  -23.9      11.5  -885.3     14.6        19.7    3.6   1770.6
fit_sleep1  -92.0      21.0  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.8  
fit_sleep2   29.1  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.154388e-40 4.203930e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.56     0.26     5.32       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.56    -3.41     2.82       5.51      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.25 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_0.63.0   compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.21      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.4      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.42           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.2         tidyselect_1.2.0    
 [46] abind_1.4-5          yaml_2.3.7           codetools_0.2-19    
 [49] miniUI_0.1.1.1       curl_5.0.0           processx_3.8.1      
 [52] pkgbuild_1.4.0       lattice_0.21-8       tibble_3.2.1        
 [55] plyr_1.8.8           shiny_1.7.4          withr_2.5.0         
 [58] bridgesampling_1.1-2 posterior_1.4.1      coda_0.19-4         
 [61] evaluate_0.21        RcppParallel_5.1.7   xts_0.13.1          
 [64] pillar_1.9.0         tensorA_0.36.2       checkmate_2.2.0     
 [67] DT_0.28              stats4_4.3.0         shinyjs_2.1.0       
 [70] distributional_0.3.2 generics_0.1.3       ggplot2_3.4.2       
 [73] rstantools_2.3.1     munsell_0.5.0        scales_1.2.1        
 [76] minqa_1.2.5          gtools_3.9.4         xtable_1.8-4        
 [79] glue_1.6.2           tools_4.3.0          shinystan_2.6.0     
 [82] colourpicker_1.2.0   mvtnorm_1.1-3        grid_4.3.0          
 [85] crosstalk_1.2.0      colorspace_2.1-0     nlme_3.1-162        
 [88] cli_3.6.1            fansi_1.0.4          Brobdingnag_1.2-9   
 [91] dplyr_1.1.2          V8_4.3.0             gtable_0.3.3        
 [94] sass_0.4.6           digest_0.6.31        htmlwidgets_1.6.2   
 [97] farver_2.1.1         htmltools_0.5.5      lifecycle_1.0.3     
[100] mime_0.12            shinythemes_1.2.0    MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
