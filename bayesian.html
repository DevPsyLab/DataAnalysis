<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.16      6.72    15.77    42.03 1.00     1942     2671
sd(Days)                6.65      1.53     4.20    10.14 1.00     1508     2164
cor(Intercept,Days)     0.07      0.29    -0.47     0.65 1.01      983     1128

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.40      7.43   237.06   266.41 1.00     1985     2394
Days         10.43      1.73     7.06    13.85 1.00     1525     1696

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.89      1.58    23.03    29.31 1.00     3107     2607

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.5348  12.66760 228.0044 277.7977
309 211.4996  13.32247 185.9019 237.5440
310 212.8718  13.18411 186.8954 237.9294
330 274.9269  13.06081 250.0739 300.8000
331 273.3650  12.91687 248.7574 299.1719
332 260.4258  12.63421 235.8366 285.3415
333 267.9156  12.75234 243.9413 293.3316
334 244.2958  12.29505 220.3019 268.1890
335 251.1276  13.31222 226.0659 277.3487
337 285.8356  12.96327 260.9310 311.8745
349 226.5660  12.96376 201.1578 250.9725
350 238.3469  13.07962 212.3100 263.0130
351 255.7017  12.63285 230.6477 280.7595
352 271.9185  12.51038 247.2065 295.9998
369 254.6397  12.31744 230.2879 278.8924
370 225.8699  13.61002 199.2782 252.2518
371 252.1403  11.99771 228.2614 276.2377
372 263.6384  12.53479 239.5363 287.9660

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6771668  2.435988 15.0059576 24.446272
309  1.7138611  2.496130 -3.0804831  6.718298
310  4.9658562  2.455904  0.2643619  9.929749
330  5.7097601  2.494229  0.6243790 10.487868
331  7.4524043  2.432136  2.5782370 12.128514
332 10.1739151  2.388266  5.4561187 14.776163
333 10.2892404  2.398406  5.4170668 14.860542
334 11.5152517  2.333060  7.1160050 16.298626
335 -0.3157564  2.589506 -5.4129619  4.655543
337 19.1677888  2.457986 14.3651209 24.108200
349 11.5528373  2.400041  6.9546221 16.178246
350 17.0763240  2.506330 12.3726493 22.115242
351  7.4797486  2.404583  2.6947820 12.295691
352 14.0095969  2.422015  9.2454675 18.805424
369 11.3761643  2.396852  6.5924202 16.177879
370 15.2812230  2.571826 10.3787313 20.298146
371  9.4631710  2.305486  4.8456301 13.926740
372 11.7863298  2.349379  7.0203837 16.301963</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.5348 12.667595 228.0044 277.7977
  [2,] 273.2119 10.861618 251.3974 294.2770
  [3,] 292.8891  9.346102 274.4008 311.4079
  [4,] 312.5663  8.282062 296.5545 329.5166
  [5,] 332.2434  7.855161 317.1428 348.3314
  [6,] 351.9206  8.165944 335.9124 367.8778
  [7,] 371.5978  9.139464 354.0071 389.2774
  [8,] 391.2749 10.594576 371.1112 412.0129
  [9,] 410.9521 12.362376 387.2837 435.1076
 [10,] 430.6293 14.327586 402.8047 458.7798
 [11,] 211.4996 13.322466 185.9019 237.5440
 [12,] 213.2135 11.431889 191.5065 235.5527
 [13,] 214.9273  9.815774 196.1245 234.0372
 [14,] 216.6412  8.629721 200.1532 233.6060
 [15,] 218.3550  8.065736 202.6394 234.0506
 [16,] 220.0689  8.252359 203.8282 236.1930
 [17,] 221.7828  9.143747 204.0696 239.8779
 [18,] 223.4966 10.562959 203.3381 244.7036
 [19,] 225.2105 12.329049 201.8612 250.3644
 [20,] 226.9243 14.314193 199.5657 255.9724
 [21,] 212.8718 13.184110 186.8954 237.9294
 [22,] 217.8376 11.335811 195.4676 239.3006
 [23,] 222.8035  9.759273 203.7067 241.6521
 [24,] 227.7693  8.605181 210.7753 244.7584
 [25,] 232.7352  8.057158 216.9028 248.8658
 [26,] 237.7011  8.237074 221.2387 253.9302
 [27,] 242.6669  9.101864 224.7805 260.7389
 [28,] 247.6328 10.483386 226.7498 268.0200
 [29,] 252.5986 12.207448 228.2936 276.1101
 [30,] 257.5645 14.149385 229.2966 285.1094
 [31,] 274.9269 13.060809 250.0739 300.8000
 [32,] 280.6366 11.172473 259.3664 302.6263
 [33,] 286.3464  9.565872 268.1307 305.2907
 [34,] 292.0561  8.404168 276.1640 308.6719
 [35,] 297.7659  7.886476 282.5867 313.6084
 [36,] 303.4757  8.136666 287.5926 320.1108
 [37,] 309.1854  9.091563 290.9588 327.4319
 [38,] 314.8952 10.561726 294.1278 336.0176
 [39,] 320.6049 12.364706 296.4673 345.0832
 [40,] 326.3147 14.375820 298.6036 354.8822
 [41,] 273.3650 12.916872 248.7574 299.1719
 [42,] 280.8174 11.089675 259.2881 302.8224
 [43,] 288.2698  9.536603 269.4462 306.8719
 [44,] 295.7222  8.410901 279.3935 312.0719
 [45,] 303.1746  7.897486 287.5903 318.3799
 [46,] 310.6270  8.113438 294.4019 326.3081
 [47,] 318.0794  9.006445 300.0653 335.9197
 [48,] 325.5318 10.403595 304.8581 346.1614
 [49,] 332.9842 12.131945 308.4704 357.1800
 [50,] 340.4366 14.069967 312.1800 368.0766
 [51,] 260.4258 12.634211 235.8366 285.3415
 [52,] 270.5997 10.854349 249.1842 292.1747
 [53,] 280.7736  9.349766 262.3939 299.1740
 [54,] 290.9475  8.272060 275.0141 306.7371
 [55,] 301.1214  7.800222 286.1044 316.2442
 [56,] 311.2954  8.041616 295.6100 327.1424
 [57,] 321.4693  8.938643 303.9764 339.0884
 [58,] 331.6432 10.321760 311.6290 352.1064
 [59,] 341.8171 12.024381 318.4349 365.5080
 [60,] 351.9910 13.929838 324.6166 379.3431
 [61,] 267.9156 12.752336 243.9413 293.3316
 [62,] 278.2048 10.984406 257.5314 300.3178
 [63,] 288.4940  9.497208 270.3708 307.3606
 [64,] 298.7833  8.440466 282.6028 315.4908
 [65,] 309.0725  7.986905 293.6461 324.4434
 [66,] 319.3618  8.236780 302.8749 335.2587
 [67,] 329.6510  9.132532 311.1994 347.0945
 [68,] 339.9402 10.510301 318.8673 359.7153
 [69,] 350.2295 12.207966 326.0143 373.3689
 [70,] 360.5187 14.110532 332.8079 387.4618
 [71,] 244.2958 12.295050 220.3019 268.1890
 [72,] 255.8110 10.613031 235.0571 276.7118
 [73,] 267.3263  9.219054 248.9807 285.5759
 [74,] 278.8415  8.260255 262.4511 294.8087
 [75,] 290.3568  7.896773 274.6235 305.7618
 [76,] 301.8720  8.208080 286.0053 317.9433
 [77,] 313.3873  9.125375 295.8432 331.9349
 [78,] 324.9025 10.490886 305.1022 346.4636
 [79,] 336.4178 12.154475 313.2658 361.4533
 [80,] 347.9330 14.010360 321.0841 376.6176
 [81,] 251.1276 13.312224 226.0659 277.3487
 [82,] 250.8118 11.336870 229.1770 273.3173
 [83,] 250.4961  9.656345 231.9439 269.6123
 [84,] 250.1803  8.448460 233.8741 266.9323
 [85,] 249.8646  7.932151 234.2246 265.5068
 [86,] 249.5488  8.238486 233.3373 265.5240
 [87,] 249.2331  9.286408 231.0509 267.4096
 [88,] 248.9173 10.863387 227.6256 269.9504
 [89,] 248.6015 12.774977 223.3000 273.4188
 [90,] 248.2858 14.892885 218.7176 277.0088
 [91,] 285.8356 12.963268 260.9310 311.8745
 [92,] 305.0034 11.152482 283.7261 327.2536
 [93,] 324.1711  9.632901 305.8136 343.1715
 [94,] 343.3389  8.561023 326.6370 359.7630
 [95,] 362.5067  8.116208 346.4801 378.4864
 [96,] 381.6745  8.398687 365.0065 397.7074
 [97,] 400.8423  9.342721 382.1608 418.7911
 [98,] 420.0101 10.775821 398.7044 441.0158
 [99,] 439.1779 12.531305 414.6392 463.4827
[100,] 458.3457 14.492491 429.8855 486.8882
[101,] 226.5660 12.963756 201.1578 250.9725
[102,] 238.1188 11.180287 216.5835 259.2453
[103,] 249.6717  9.667423 231.0459 268.0956
[104,] 261.2245  8.569697 244.4126 277.6445
[105,] 272.7773  8.058582 256.9402 288.7659
[106,] 284.3302  8.243917 267.8776 300.3358
[107,] 295.8830  9.083171 277.5263 313.3627
[108,] 307.4358 10.419511 286.7876 327.9330
[109,] 318.9887 12.089202 294.8387 342.8618
[110,] 330.5415 13.973253 302.7392 357.8837
[111,] 238.3469 13.079619 212.3100 263.0130
[112,] 255.4232 11.189738 233.5578 276.7351
[113,] 272.4995  9.586835 253.7764 291.2595
[114,] 289.5758  8.436112 272.9195 306.3079
[115,] 306.6522  7.936745 291.0510 322.1747
[116,] 323.7285  8.208487 307.6266 340.1480
[117,] 340.8048  9.183135 322.9323 359.0333
[118,] 357.8811 10.669773 336.9016 378.4225
[119,] 374.9574 12.486855 350.5470 398.9449
[120,] 392.0338 14.510768 363.2571 419.6858
[121,] 255.7017 12.632847 230.6477 280.7595
[122,] 263.1814 10.830298 241.6667 284.6137
[123,] 270.6612  9.304081 252.5115 288.9574
[124,] 278.1409  8.209782 262.1415 294.5479
[125,] 285.6207  7.732992 270.5131 300.8054
[126,] 293.1004  7.985102 277.3815 308.8386
[127,] 300.5802  8.904413 282.8798 318.0953
[128,] 308.0599 10.314035 287.7269 328.2410
[129,] 315.5397 12.043011 291.7526 339.0024
[130,] 323.0194 13.973294 295.0014 349.9120
[131,] 271.9185 12.510382 247.2065 295.9998
[132,] 285.9281 10.731587 264.9239 306.7488
[133,] 299.9377  9.249681 281.9136 317.9508
[134,] 313.9473  8.226696 297.6500 330.1444
[135,] 327.9569  7.844282 312.8138 342.9543
[136,] 341.9664  8.192638 325.8274 357.6887
[137,] 355.9760  9.189025 337.9626 373.8383
[138,] 369.9856 10.653138 348.9163 390.8419
[139,] 383.9952 12.420661 359.5764 408.5380
[140,] 398.0048 14.380146 370.1946 426.6848
[141,] 254.6397 12.317440 230.2879 278.8924
[142,] 266.0158 10.591213 245.0144 287.0706
[143,] 277.3920  9.171590 259.4765 295.4425
[144,] 288.7682  8.219010 272.5819 304.8318
[145,] 300.1443  7.904176 284.7327 315.4873
[146,] 311.5205  8.299981 295.4368 327.8109
[147,] 322.8966  9.316284 304.6637 341.2843
[148,] 334.2728 10.778981 313.1693 355.3668
[149,] 345.6490 12.532738 320.8240 369.7501
[150,] 357.0251 14.472125 328.6243 385.1898
[151,] 225.8699 13.610018 199.2782 252.2518
[152,] 241.1511 11.596460 218.1624 263.4977
[153,] 256.4323  9.846408 236.9702 275.3272
[154,] 271.7135  8.523743 254.7228 288.1175
[155,] 286.9948  7.847626 271.1934 301.6516
[156,] 302.2760  7.984037 286.4159 317.6985
[157,] 317.5572  8.895675 299.6042 335.0471
[158,] 332.8384 10.380261 312.1304 352.8475
[159,] 348.1197 12.230911 323.5238 371.8918
[160,] 363.4009 14.306261 335.0999 391.5556
[161,] 252.1403 11.997707 228.2614 276.2377
[162,] 261.6034 10.297955 241.4588 282.1150
[163,] 271.0666  8.875883 253.7589 288.5011
[164,] 280.5298  7.883227 265.1605 295.8930
[165,] 289.9929  7.492647 275.2560 304.4727
[166,] 299.4561  7.795177 284.1226 314.8825
[167,] 308.9193  8.718964 291.6915 326.1717
[168,] 318.3825 10.094871 298.2708 338.0554
[169,] 327.8456 11.765331 304.2395 350.9574
[170,] 337.3088 13.622414 310.2907 363.8199
[171,] 263.6384 12.534794 239.5363 287.9660
[172,] 275.4247 10.818725 254.2628 296.6353
[173,] 287.2111  9.381245 268.6581 305.4818
[174,] 298.9974  8.367189 282.6301 315.1614
[175,] 310.7837  7.940473 295.1132 326.4803
[176,] 322.5701  8.193384 306.4380 339.2595
[177,] 334.3564  9.069241 316.5720 353.0692
[178,] 346.1427 10.412007 325.6864 367.5415
[179,] 357.9290 12.066806 334.1478 381.9828
[180,] 369.7154 13.922820 342.8143 396.8607</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -3.9747725 12.667595  -28.2377436  21.5555557
  [2,]  -14.5072393 10.861618  -35.5722854   7.3072935
  [3,]  -42.0885062  9.346102  -60.6073052 -23.6002208
  [4,]    8.8735270  8.282062   -8.0768329  24.8853175
  [5,]   24.6084602  7.855161    8.5204504  39.7091043
  [6,]   62.7694934  8.165944   46.8123150  78.7776883
  [7,]   10.6060266  9.139464   -7.0736156  28.1967204
  [8,] -101.1263403 10.594576 -121.8642744 -80.9626450
  [9,]   19.6331929 12.362376   -4.5222864  43.3015553
 [10,]   35.7242261 14.327586    7.5736664  63.5488352
 [11,]   11.2343005 13.322466  -14.8100801  36.8319868
 [12,]   -7.9476606 11.431889  -30.2868641  13.7592643
 [13,]  -11.9495217  9.815774  -31.0594408   6.8532786
 [14,]  -11.9341827  8.629721  -28.8989648   4.5538096
 [15,]  -10.6389438  8.065736  -26.3345311   5.0766751
 [16,]   -4.1071049  8.252359  -20.2312310  12.1335892
 [17,]   -8.1524660  9.143747  -26.2476057   9.5606789
 [18,]   -5.7694270 10.562959  -26.9764166  14.3890554
 [19,]   -0.9147881 12.329049  -26.0687320  22.4344639
 [20,]   10.3898508 14.314193  -18.6582396  37.7484660
 [21,]  -13.8178797 13.184110  -38.8754677  12.1585385
 [22,]  -23.5054359 11.335811  -44.9683834  -1.1353863
 [23,]   11.5165079  9.759273   -7.3320933  30.6132857
 [24,]    5.0722517  8.605181  -11.9168161  22.0663062
 [25,]   -3.4278045  8.057158  -19.5583686  12.4045638
 [26,]  -17.2431608  8.237074  -33.4722608  -0.7808089
 [27,]   -7.2461170  9.101864  -25.3181249  10.6402664
 [28,]    8.1183268 10.483386  -12.2688585  29.0012618
 [29,]    8.4138706 12.207448  -15.0975918  32.7188744
 [30,]  -10.0491856 14.149385  -37.5941261  18.2187484
 [31,]   46.6157407 13.060809   20.7425634  71.4687178
 [32,]   19.7635806 11.172473   -2.2260581  41.0338144
 [33,]   -2.4898795  9.565872  -21.4341697  15.7257838
 [34,]   -6.9231396  8.404168  -23.5389146   8.9689749
 [35,]  -11.9685997  7.886476  -27.8111145   3.2106172
 [36,]   -5.8901598  8.136666  -22.5253420   9.9929344
 [37,]  -28.9458199  9.091563  -47.1923204 -10.7191602
 [38,]    3.3661200 10.561726  -17.7562567  24.1335110
 [39,]  -15.2554401 12.364706  -39.7337458   8.8821735
 [40,]   27.7339998 14.375820   -0.8335259  55.4451044
 [41,]   14.2429310 12.916872  -11.5639999  38.8505378
 [42,]    4.1826267 11.089675  -17.8223876  25.7119330
 [43,]   13.5508225  9.536603   -5.0512505  32.3744149
 [44,]   24.3931182  8.410901    8.0434374  40.7218344
 [45,]   13.1027140  7.897486   -2.1025992  28.6869959
 [46,]  -17.3082903  8.113438  -32.9894024  -1.0831647
 [47,]  -28.0043946  9.006445  -45.8447365  -9.9903277
 [48,]    9.2859012 10.403595  -11.3436908  29.9595906
 [49,]  -39.2373031 12.131945  -63.4331049 -14.7234555
 [50,]   31.1444927 14.069967    3.5045426  59.4011221
 [51,]  -25.5651750 12.634211  -50.4809431  -0.9760168
 [52,]  -27.7878901 10.854349  -49.3629240  -6.3724040
 [53,]   -7.8123053  9.349766  -26.2126978  10.5673668
 [54,]   18.8212796  8.272060    3.0316847  34.7547388
 [55,]   16.3414644  7.800222    1.2187040  31.3584714
 [56,]   -1.2977507  8.041616  -17.1447911  14.3876012
 [57,]  132.6926341  8.938643  115.0734646 150.1855250
 [58,]   15.1879190 10.321760   -5.2752700  35.2021142
 [59,]  -11.5167961 12.024381  -35.2077057  11.8654334
 [60,]  -98.1266113 13.929838 -125.4787337 -70.7521622
 [61,]   15.9268471 12.752336   -9.4892114  39.9011445
 [62,]   11.3502067 10.984406  -10.7628474  32.0235700
 [63,]  -11.7247337  9.497208  -30.5913484   6.3984575
 [64,]    1.0264259  8.440466  -15.6811065  17.2069017
 [65,]  -11.9015145  7.986905  -27.2724465   3.5249130
 [66,]   18.8047451  8.236780    2.9077712  35.2916002
 [67,]    2.3755047  9.132532  -15.0680496  20.8270779
 [68,]    8.8996643 10.510301  -10.8753622  29.9726295
 [69,]  -16.8694761 12.207966  -40.0088661   7.3456937
 [70,]    1.5240835 14.110532  -25.4189634  29.2349103
 [71,]   21.1773215 12.295050   -2.7158932  45.1712182
 [72,]   20.3901699 10.613031   -0.5106404  41.1441231
 [73,]  -23.9615818  9.219054  -42.2112240  -5.6160051
 [74,]  -24.1692335  8.260255  -40.1364063  -7.7787773
 [75,]  -11.3323852  7.896773  -26.7374167   4.4009297
 [76,]  -17.6808368  8.208080  -33.7521411  -1.8140932
 [77,]   -7.8624885  9.125375  -26.4101321   9.6816430
 [78,]    6.6203598 10.490886  -14.9407142  26.4207381
 [79,]   -0.6708919 12.154475  -25.7064283  22.4811398
 [80,]   29.3659564 14.010360    0.6813779  56.2148650
 [81,]   -9.5192910 13.312224  -35.7404014  15.5424152
 [82,]   23.1353654 11.336870    0.6298898  44.7701536
 [83,]    3.9946217  9.656345  -15.1216031  22.5467757
 [84,]   20.6217781  8.448460    3.8698026  36.9280428
 [85,]    1.5873345  7.932151  -14.0549418  17.2272879
 [86,]    5.0873908  8.238486  -10.8878342  21.2989000
 [87,]   -3.7807528  9.286408  -21.9572917  14.4014430
 [88,]  -13.6062964 10.863387  -34.6394232   7.6854168
 [89,]  -12.8474400 12.774977  -37.6646651  12.4540651
 [90,]  -11.0391837 14.892885  -39.7622434  18.5290350
 [91,]   26.5310338 12.963268    0.4921499  51.4356162
 [92,]    8.8024449 11.152482  -13.4477947  30.0796630
 [93,]  -32.5599439  9.632901  -51.5603190 -14.2024124
 [94,]    2.7832672  8.561023  -13.6407812  19.4851902
 [95,]    3.2256784  8.116208  -12.7540309  19.2523042
 [96,]   10.1639895  8.398687   -5.8688523  26.8319916
 [97,]    3.4178007  9.342721  -14.5310107  22.0993490
 [98,]   -3.3177882 10.775821  -24.3234604  17.9878695
 [99,]   16.6864230 12.531305   -7.6184191  41.2250529
[100,]    0.5710341 14.492491  -27.9715349  29.0312096
[101,]    9.5372157 12.963756  -14.8692771  34.9454311
[102,]   -7.8021216 11.180287  -28.9285528  13.7332068
[103,]  -10.7460589  9.667423  -29.1700209   7.8797182
[104,]   -6.3024963  8.569697  -22.7224855  10.5093837
[105,]  -22.0670336  8.058582  -38.0556321  -6.2299441
[106,]  -14.5557709  8.243917  -30.5613851   1.8967740
[107,]  -14.3182082  9.083171  -31.7979151   4.0385288
[108,]    0.6661544 10.419511  -19.8310256  21.3144022
[109,]   17.2919171 12.089202   -6.5811651  41.4419272
[110,]   21.1035798 13.973253   -6.2385700  48.9058549
[111,]   17.9499419 13.079619   -6.7161634  43.9868491
[112,]  -11.9688821 11.189738  -33.2807639   9.8965392
[113,]  -16.2949061  9.586835  -35.0549324   2.4282329
[114,]  -34.0487301  8.436112  -50.7807788 -17.3924226
[115,]  -37.7356540  7.936745  -53.2582435 -22.1344557
[116,]    5.9962220  8.208487  -10.4233405  22.0980843
[117,]   38.6396980  9.183135   20.4111611  56.5121812
[118,]    5.0372740 10.669773  -15.5041363  26.0167738
[119,]   19.5297500 12.486855   -4.4577366  43.9402463
[120,]   -2.9810740 14.510768  -30.6331113  25.7955592
[121,]   -5.1751966 12.632847  -30.2329943  19.8788375
[122,]   36.8761548 10.830298   15.4438869  58.3908740
[123,]   -0.7672938  9.304081  -19.0634953  17.3824252
[124,]    2.4481576  8.209782  -13.9588331  18.4475506
[125,]  -13.7932910  7.732992  -28.9780000   1.3142799
[126,]   11.5331604  7.985102   -4.2049819  27.2520810
[127,]  -12.8335882  8.904413  -30.3486722   4.8668392
[128,]  -41.4644368 10.314035  -61.6455341 -21.1313557
[129,]    6.0021146 12.043011  -17.4606175  29.7891712
[130,]   24.5460660 13.973294   -2.3465097  52.5641141
[131,]  -50.2413629 12.510382  -74.3227187 -25.5294013
[132,]   12.2658402 10.731587   -8.5549452  33.2700216
[133,]   26.9408433  9.249681    8.9277443  44.9648623
[134,]   32.9082464  8.226696   16.7110852  49.2055155
[135,]   20.7833496  7.844282    5.7859156  35.9264158
[136,]   10.8622527  8.192638   -4.8600234  27.0012905
[137,]   -1.5494442  9.189025  -19.4116598  16.4640372
[138,]   -9.5530411 10.653138  -30.4093356  11.5163014
[139,]   -8.3546380 12.420661  -32.8974398  16.0641770
[140,]   -9.4631349 14.380146  -38.1430714  18.3471433
[141,]   17.2838381 12.317440   -6.9689431  41.6356397
[142,]    2.4210738 10.591213  -18.6337373  23.4224868
[143,]  -20.1495906  9.171590  -38.2000794  -2.2340569
[144,]  -11.1115549  8.219010  -27.1751736   5.0747364
[145,]   14.6778808  7.904176   -0.6650703  30.0895102
[146,]    5.6930164  8.299981  -10.5974388  21.7766832
[147,]  -24.7613479  9.316284  -43.1490493  -6.5283872
[148,]   13.8500878 10.778981   -7.2438589  34.9535523
[149,]   -5.3689766 12.532738  -29.4701009  19.4559929
[150,]    9.4879591 14.472125  -18.6767051  37.8887844
[151,]   -0.6058678 13.610018  -26.9877762  25.9857831
[152,]   -6.6275908 11.596460  -28.9742289  16.3610549
[153,]  -17.5315138  9.846408  -36.4264430   1.9306208
[154,]  -31.2405369  8.523743  -47.6445489 -14.2498297
[155,]  -19.4574599  7.847626  -34.1143190  -3.6560837
[156,]   41.9177171  7.984037   26.4952078  57.7777911
[157,]  -36.4091059  8.895675  -53.8990350 -18.4560689
[158,]   14.7470711 10.380261   -5.2619894  35.4550802
[159,]   17.0433480 12.230911   -6.7288149  41.6391688
[160,]    8.8279250 14.306261  -19.3267939  37.1288673
[161,]   17.7401375 11.997707   -6.3572874  41.6189511
[162,]   10.8393666 10.297955   -9.6722469  30.9840483
[163,]    6.8322956  8.875883  -10.6021990  24.1399522
[164,]    1.2597247  7.883227  -14.1035324  16.6290470
[165,]  -10.8224463  7.492647  -25.3021691   3.9145256
[166,]  -14.9441172  7.795177  -30.3705322   0.3893896
[167,]  -49.6534882  8.718964  -66.9059457 -32.4257142
[168,]  -13.7518591 10.094871  -33.4247796   6.3597637
[169,]   22.9350699 11.765331   -0.1767269  46.5412212
[170,]   32.1603990 13.622414    5.6493169  59.1784575
[171,]    5.7732897 12.534794  -18.5542750  29.8753667
[172,]   -1.9507400 10.818725  -23.1612924  19.2111832
[173,]   10.3857302  9.381245   -7.8849620  28.9386928
[174,]   11.6342004  8.367189   -4.5297589  28.0014754
[175,]  -23.6111294  7.940473  -39.3077157  -7.9405577
[176,]    7.0375409  8.193384   -9.6518744  23.1696124
[177,]    0.1254111  9.069241  -18.5873663  17.9098483
[178,]   -2.9228187 10.412007  -24.3215769  17.5334995
[179,]   11.2126516 12.066806  -12.8410922  34.9939139
[180,]   -5.5917782 13.922820  -32.7371147  21.3093387</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.7  3.4
looic      1770.2 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   413       
 (0.5, 0.7]   (ok)         1    0.6%   183       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.4
p_loo        33.7  8.4
looic      1721.5 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   724       
 (0.5, 0.7]   (ok)         4    2.2%   728       
   (0.7, 1]   (bad)        2    1.1%   23        
   (1, Inf)   (very bad)   1    0.6%   12        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.7  
fit_sleep1 -92.6      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.7  3.4
looic      1770.2 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   413       
 (0.5, 0.7]   (ok)         1    0.6%   183       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.4
p_loo        33.7  8.4
looic      1721.5 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   724       
 (0.5, 0.7]   (ok)         4    2.2%   728       
   (0.7, 1]   (bad)        2    1.1%   23        
   (1, Inf)   (very bad)   1    0.6%   12        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.8     22.4        33.7    8.4   1721.5
fit_sleep2  -24.3      11.7  -885.1     14.4        19.7    3.4   1770.2
fit_sleep1  -92.6      21.1  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.9  
fit_sleep2   28.8  
fit_sleep1   21.1  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
5.963491e-41 2.709110e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9      1.61     0.16     5.48       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1      1.61    -3.39     3.05       5.19      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.6.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.19      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.1   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.19        V8_4.2.2            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.7         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
