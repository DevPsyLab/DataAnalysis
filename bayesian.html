<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.14      7.02    15.23    42.78 1.00     1729     2236
sd(Days)                6.50      1.48     4.17     9.88 1.00     1485     2424
cor(Intercept,Days)     0.10      0.30    -0.47     0.66 1.00     1137     1488

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.20      7.29   236.97   265.88 1.00     1849     2574
Days         10.30      1.70     6.79    13.60 1.00     1254     2013

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.88      1.56    23.01    28.98 1.00     3733     2691

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.2408  12.76748 228.5225 278.4647
309 211.3392  13.10743 185.2531 236.9501
310 212.8140  13.13711 186.6551 237.7553
330 274.4221  13.36616 249.2500 301.4913
331 273.3183  12.90235 248.8601 299.7182
332 260.3441  12.43459 235.4633 284.3178
333 268.0717  12.32463 244.8736 293.2147
334 244.5050  11.95842 220.6973 267.5739
335 250.3496  13.57366 224.8285 277.5316
337 286.1893  12.91496 261.2282 311.5214
349 226.8365  12.87327 201.8508 251.5615
350 239.2533  13.06806 213.1020 264.4725
351 255.9888  12.49615 231.5771 280.5390
352 272.3676  12.23724 248.2707 296.7689
369 254.5591  12.09157 231.0276 278.3257
370 226.3063  13.69354 198.9969 252.5357
371 251.9736  12.35921 228.1575 276.2417
372 263.7400  12.39126 239.8989 288.7648

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5622101  2.473743 14.8441906 24.471451
309  1.7852629  2.429804 -2.9759543  6.614395
310  4.9351553  2.454833  0.1637367  9.957908
330  5.7557043  2.527761  0.7859871 10.534996
331  7.4460702  2.458522  2.6371821 12.056402
332 10.2397654  2.343628  5.6572434 14.798121
333 10.2857365  2.368295  5.5123256 14.853281
334 11.4510628  2.289104  7.1453076 15.999314
335 -0.1659843  2.590738 -5.3136883  4.835220
337 19.1157842  2.431738 14.3664964 23.848283
349 11.5556344  2.472774  6.7082292 16.404704
350 16.9386689  2.508756 12.1757269 21.923182
351  7.4584603  2.315663  2.9240891 11.990528
352 13.9945609  2.319700  9.4667347 18.586068
369 11.3370808  2.352883  6.8206851 16.023918
370 15.2072108  2.572316 10.3135481 20.248231
371  9.4927018  2.332063  5.0196479 14.082764
372 11.7283410  2.399221  7.0156785 16.319646</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.2408 12.767482 228.5225 278.4647
  [2,] 273.8030 10.889113 251.5146 294.7901
  [3,] 293.3652  9.293858 274.3108 311.4653
  [4,] 312.9275  8.149701 296.4813 328.6708
  [5,] 332.4897  7.661478 317.1214 347.3759
  [6,] 352.0519  7.950956 335.9666 367.5262
  [7,] 371.6141  8.942927 353.5749 389.0057
  [8,] 391.1763 10.439014 370.0506 411.9059
  [9,] 410.7385 12.255974 386.0222 434.9039
 [10,] 430.3007 14.271776 401.1788 458.6995
 [11,] 211.3392 13.107432 185.2531 236.9501
 [12,] 213.1244 11.304156 190.6691 234.9681
 [13,] 214.9097  9.776043 196.1177 233.9892
 [14,] 216.6950  8.669831 200.2230 233.7505
 [15,] 218.4802  8.158973 202.4357 234.7885
 [16,] 220.2655  8.353419 203.7925 236.7924
 [17,] 222.0508  9.208597 203.9359 240.0025
 [18,] 223.8360 10.565264 203.2986 244.4042
 [19,] 225.6213 12.258029 201.8823 249.5328
 [20,] 227.4065 14.166920 199.9883 255.4656
 [21,] 212.8140 13.137108 186.6551 237.7553
 [22,] 217.7492 11.281986 195.2439 238.8036
 [23,] 222.6844  9.697175 203.3665 241.2611
 [24,] 227.6195  8.534613 210.8869 244.0719
 [25,] 232.5547  7.981005 216.7402 248.1079
 [26,] 237.4898  8.161231 221.3964 253.4921
 [27,] 242.4250  9.031463 224.7886 259.4735
 [28,] 247.3601 10.420239 226.9916 267.2602
 [29,] 252.2953 12.151043 228.7781 275.9179
 [30,] 257.2304 14.098465 229.7941 284.6364
 [31,] 274.4221 13.366158 249.2500 301.4913
 [32,] 280.1778 11.410177 258.5848 303.1582
 [33,] 285.9335  9.721588 267.4745 305.1833
 [34,] 291.6892  8.462006 275.2930 308.6375
 [35,] 297.4449  7.840979 282.2617 313.2142
 [36,] 303.2006  8.008466 287.7582 319.4346
 [37,] 308.9563  8.920159 291.3773 326.9284
 [38,] 314.7120 10.381816 293.8813 335.2119
 [39,] 320.4677 12.197299 295.9550 344.8321
 [40,] 326.2234 14.231840 297.7299 353.9874
 [41,] 273.3183 12.902352 248.8601 299.7182
 [42,] 280.7644 11.029396 259.5548 303.1122
 [43,] 288.2105  9.429374 270.1221 307.1256
 [44,] 295.6565  8.262402 279.5788 312.0989
 [45,] 303.1026  7.727234 287.9450 318.1959
 [46,] 310.5487  7.952462 294.8091 326.2012
 [47,] 317.9947  8.880418 300.6567 335.4813
 [48,] 325.4408 10.323306 305.4316 346.0532
 [49,] 332.8869 12.098270 309.0029 357.2404
 [50,] 340.3330 14.080280 312.3856 368.3291
 [51,] 260.3441 12.434591 235.4633 284.3178
 [52,] 270.5839 10.751499 249.4624 290.9984
 [53,] 280.8237  9.357114 262.5566 298.9235
 [54,] 291.0634  8.396524 274.9377 307.3349
 [55,] 301.3032  8.027007 285.3855 317.2453
 [56,] 311.5429  8.327619 295.4573 328.0825
 [57,] 321.7827  9.233138 303.6884 340.2348
 [58,] 332.0225 10.589504 311.4906 352.9886
 [59,] 342.2622 12.247839 318.6969 366.5571
 [60,] 352.5020 14.102011 325.3569 380.4158
 [61,] 268.0717 12.324633 244.8736 293.2147
 [62,] 278.3574 10.567350 258.4160 299.4627
 [63,] 288.6432  9.091692 271.4473 306.7583
 [64,] 298.9289  8.053972 283.3298 314.9316
 [65,] 309.2146  7.634902 294.2855 324.0810
 [66,] 319.5004  7.933135 303.9921 335.0805
 [67,] 329.7861  8.876666 312.7994 346.9833
 [68,] 340.0718 10.289480 319.7759 359.8076
 [69,] 350.3576 12.007050 326.5906 373.3956
 [70,] 360.6433 13.916994 332.7900 387.6111
 [71,] 244.5050 11.958423 220.6973 267.5739
 [72,] 255.9561 10.319792 235.8968 275.9099
 [73,] 267.4072  8.970637 249.9442 284.6464
 [74,] 278.8582  8.057700 263.0999 293.9885
 [75,] 290.3093  7.736973 274.9213 305.4002
 [76,] 301.7604  8.079292 286.0428 317.4137
 [77,] 313.2114  9.009393 295.8299 330.5525
 [78,] 324.6625 10.370311 304.6108 344.6609
 [79,] 336.1135 12.016553 312.8102 359.1294
 [80,] 347.5646 13.846724 320.5003 374.1145
 [81,] 250.3496 13.573657 224.8285 277.5316
 [82,] 250.1836 11.574207 228.2566 273.2411
 [83,] 250.0176  9.854147 230.7677 269.1970
 [84,] 249.8516  8.583123 232.6319 266.2297
 [85,] 249.6856  7.978700 233.9672 265.1615
 [86,] 249.5196  8.189819 233.5941 265.7193
 [87,] 249.3537  9.160266 231.7969 267.4822
 [88,] 249.1877 10.685113 228.9161 270.2589
 [89,] 249.0217 12.564102 224.8653 274.0920
 [90,] 248.8557 14.661703 220.5475 278.0824
 [91,] 286.1893 12.914957 261.2282 311.5214
 [92,] 305.3051 11.074390 284.0346 326.8162
 [93,] 324.4209  9.503412 305.8960 343.2996
 [94,] 343.5367  8.355492 327.2158 360.1052
 [95,] 362.6525  7.819229 347.3780 378.2775
 [96,] 381.7683  8.018301 366.2031 397.8390
 [97,] 400.8840  8.903519 383.7925 418.4196
 [98,] 419.9998 10.299459 399.9929 440.6100
 [99,] 439.1156 12.029619 415.5831 463.1687
[100,] 458.2314 13.970373 430.8498 486.4741
[101,] 226.8365 12.873269 201.8508 251.5615
[102,] 238.3922 11.010927 216.8742 259.6673
[103,] 249.9478  9.433409 231.1837 268.1303
[104,] 261.5035  8.304645 244.9315 277.5780
[105,] 273.0591  7.821398 257.2056 288.6290
[106,] 284.6147  8.100040 268.7081 300.5713
[107,] 296.1704  9.070625 278.2064 313.8714
[108,] 307.7260 10.543769 286.6221 328.2001
[109,] 319.2816 12.340791 294.4145 342.9898
[110,] 330.8373 14.340447 302.2214 358.7748
[111,] 239.2533 13.068060 213.1020 264.4725
[112,] 256.1919 11.184549 233.9426 277.8128
[113,] 273.1306  9.591758 254.6469 291.8039
[114,] 290.0693  8.455602 273.8083 306.5817
[115,] 307.0079  7.973727 291.7167 322.1752
[116,] 323.9466  8.261425 308.0374 339.8301
[117,] 340.8853  9.247144 322.5452 359.0765
[118,] 357.8240 10.740388 336.1885 379.0346
[119,] 374.7626 12.561445 349.6398 399.5564
[120,] 391.7013 14.588063 362.7548 420.5620
[121,] 255.9888 12.496147 231.5771 280.5390
[122,] 263.4473 10.784283 242.2899 284.9324
[123,] 270.9057  9.336617 252.8349 289.2907
[124,] 278.3642  8.292687 262.3110 294.7906
[125,] 285.8227  7.815977 270.5829 301.2418
[126,] 293.2811  8.008429 277.9690 309.0942
[127,] 300.7396  8.826379 283.3729 317.7829
[128,] 308.1980 10.119268 287.9852 328.1470
[129,] 315.6565 11.731104 292.5540 338.6537
[130,] 323.1150 13.548528 296.6028 349.5650
[131,] 272.3676 12.237237 248.2707 296.7689
[132,] 286.3622 10.549128 265.4060 307.5957
[133,] 300.3567  9.142223 282.6734 318.7163
[134,] 314.3513  8.163235 298.1196 330.4163
[135,] 328.3459  7.775512 313.2299 343.5552
[136,] 342.3404  8.064787 326.7107 358.2313
[137,] 356.3350  8.965768 338.6856 374.0614
[138,] 370.3295 10.319458 349.9313 390.7118
[139,] 384.3241 11.973281 360.6906 407.8768
[140,] 398.3187 13.819903 371.2584 425.3423
[141,] 254.5591 12.091574 231.0276 278.3257
[142,] 265.8961 10.403815 245.6146 286.4270
[143,] 277.2332  9.019130 259.7506 294.9599
[144,] 288.5703  8.094576 272.8312 304.3514
[145,] 299.9074  7.795622 284.8840 314.9770
[146,] 311.2445  8.191057 294.9892 327.1462
[147,] 322.5816  9.191694 304.3945 340.3189
[148,] 333.9186 10.627943 312.9060 354.1343
[149,] 345.2557 12.348734 320.8576 369.0041
[150,] 356.5928 14.251365 328.1380 384.0880
[151,] 226.3063 13.693537 198.9969 252.5357
[152,] 241.5135 11.664655 218.3002 263.7657
[153,] 256.7207  9.891865 237.1124 275.6466
[154,] 271.9280  8.536243 255.1458 288.6087
[155,] 287.1352  7.817896 271.8730 302.3506
[156,] 302.3424  7.912344 286.6742 317.9896
[157,] 317.5496  8.793434 300.3254 334.7484
[158,] 332.7568 10.260478 312.2039 352.8247
[159,] 347.9640 12.102229 324.0139 371.8141
[160,] 363.1712 14.173359 335.3454 391.1864
[161,] 251.9736 12.359215 228.1575 276.2417
[162,] 261.4663 10.685107 240.9305 282.3732
[163,] 270.9590  9.298917 253.0833 289.0033
[164,] 280.4517  8.345373 264.2715 296.6028
[165,] 289.9444  7.981082 274.2807 305.6478
[166,] 299.4371  8.284149 283.4990 315.7700
[167,] 308.9298  9.188777 291.2084 326.4594
[168,] 318.4225 10.541212 298.0646 339.1793
[169,] 327.9152 12.193347 304.6268 351.7840
[170,] 337.4079 14.039775 310.6045 365.1306
[171,] 263.7400 12.391262 239.8989 288.7648
[172,] 275.4684 10.635622 255.0828 296.9415
[173,] 287.1967  9.176169 269.3016 305.6354
[174,] 298.9250  8.173141 283.0659 315.4326
[175,] 310.6534  7.804544 295.2840 326.2609
[176,] 322.3817  8.156844 306.4170 338.9596
[177,] 334.1101  9.147122 316.1314 352.6066
[178,] 345.8384 10.598023 325.2091 367.1969
[179,] 357.5667 12.348233 334.0960 381.9987
[180,] 369.2951 14.288182 342.0510 397.3747</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.6808297 12.767482  -28.90472845  21.0374916
  [2,]  -15.0983398 10.889113  -36.08543691   7.1901118
  [3,]  -42.5646500  9.293858  -60.66470528 -23.5101537
  [4,]    8.5123399  8.149701   -7.23095191  24.9585159
  [5,]   24.3622297  7.661478    9.47604176  39.7304793
  [6,]   62.6382196  7.950956   47.16389835  78.7235173
  [7,]   10.5897095  8.942927   -6.80187881  28.6288750
  [8,] -101.0277007 10.439014 -121.75734297 -79.9019784
  [9,]   19.8467892 12.255974   -4.31863723  44.5630629
 [10,]   36.0527791 14.271776    7.65401844  65.1746636
 [11,]   11.3947240 13.107432  -14.21622546  37.4807687
 [12,]   -7.8586389 11.304156  -29.70227926  14.5966618
 [13,]  -11.9319017  9.776043  -31.01139280   6.8601391
 [14,]  -11.9879646  8.669831  -29.04346017   4.4839939
 [15,]  -10.7641274  8.158973  -27.07239171   5.2804307
 [16,]   -4.3036903  8.353419  -20.83059000  12.1693109
 [17,]   -8.4204532  9.208597  -26.37218734   9.6944104
 [18,]   -6.1088160 10.565264  -26.67698477  14.4285511
 [19,]   -1.3255789 12.258029  -25.23709959  22.4133580
 [20,]    9.9076583 14.166920  -18.15144594  37.3258852
 [21,]  -13.7601421 13.137108  -38.70141975  12.3988011
 [22,]  -23.4169974 11.281986  -44.47135483  -0.9117167
 [23,]   11.6356473  9.697175   -6.94114249  30.9534696
 [24,]    5.2220920  8.534613  -11.23030656  21.9547268
 [25,]   -3.2472633  7.981005  -18.80045106  12.5672097
 [26,]  -17.0319186  8.161231  -33.03418701  -0.9385324
 [27,]   -7.0041740  9.031463  -24.05270367  10.6322335
 [28,]    8.3909707 10.420239  -11.50908385  28.7595384
 [29,]    8.7172154 12.151043  -14.90543836  32.2344043
 [30,]   -9.7151399 14.098465  -37.12110546  17.7211693
 [31,]   47.1204995 13.366158   20.05132072  72.2926032
 [32,]   20.2223952 11.410177   -2.75797811  41.8153513
 [33,]   -2.0770091  9.721588  -21.32677570  16.3819705
 [34,]   -6.5562133  8.462006  -23.50453009   9.8399712
 [35,]  -11.6476176  7.840979  -27.41693290   3.5355712
 [36,]   -5.6151219  8.008466  -21.84909463   9.8273441
 [37,]  -28.7167262  8.920159  -46.68883029 -11.1377290
 [38,]    3.5492695 10.381816  -16.95064789  24.3799918
 [39,]  -15.1182347 12.197299  -39.48262268   9.3944803
 [40,]   27.8252610 14.231840    0.06131511  56.3188188
 [41,]   14.2895801 12.902352  -12.11034341  38.7477800
 [42,]    4.2356098 11.029396  -18.11222252  25.4451835
 [43,]   13.6101396  9.429374   -5.30495351  31.6985319
 [44,]   24.4587694  8.262402    8.01641067  40.5365433
 [45,]   13.1746991  7.727234   -1.91855428  28.3322994
 [46,]  -17.2299711  7.952462  -32.88254489  -1.4904288
 [47,]  -27.9197414  8.880418  -45.40626474 -10.5817196
 [48,]    9.3768884 10.323306  -11.23552376  29.3861346
 [49,]  -39.1399818 12.098270  -63.49352737 -15.2560284
 [50,]   31.2481479 14.080280    3.25198667  59.1955036
 [51,]  -25.4835230 12.434591  -49.45716161  -0.6027369
 [52,]  -27.7720884 10.751499  -48.18660847  -6.6506440
 [53,]   -7.8623538  9.357114  -25.96217794  10.4046536
 [54,]   18.7053808  8.396524    2.43388202  34.8310813
 [55,]   16.1597154  8.027007    0.21760226  32.0773860
 [56,]   -1.5453500  8.327619  -18.08490256  14.5403202
 [57,]  132.3791846  9.233138  113.92709893 150.4735059
 [58,]   14.8086192 10.589504   -6.15754758  35.3405414
 [59,]  -11.9619462 12.247839  -36.25682587  11.6034435
 [60,]  -98.6376116 14.102011 -126.55137474 -71.4925133
 [61,]   15.7707058 12.324633   -9.37232060  38.9687692
 [62,]   11.1975694 10.567350   -9.90766877  31.1390295
 [63,]  -11.8738671  9.091692  -29.98896081   5.3219832
 [64,]    0.8807964  8.053972  -15.12190106  16.4798888
 [65,]  -12.0436401  7.634902  -26.91002163   2.8854768
 [66,]   18.6661234  7.933135    3.08596226  34.1743814
 [67,]    2.2403869  8.876666  -14.95682119  19.2270634
 [68,]    8.7680504 10.289480  -10.96767062  29.0640223
 [69,]  -16.9975861 12.007050  -40.03555995   6.7693799
 [70,]    1.3994775 13.916994  -25.56829874  29.2527789
 [71,]   20.9680612 11.958423   -2.10078829  44.7757732
 [72,]   20.2450984 10.319792    0.29129342  40.3043842
 [73,]  -24.0424643  8.970637  -41.28170221  -6.5794524
 [74,]  -24.1859271  8.057700  -39.31621255  -8.4275931
 [75,]  -11.2848898  7.736973  -26.37576050   4.1031316
 [76,]  -17.5691526  8.079292  -33.22252254  -1.8516323
 [77,]   -7.6866153  9.009393  -25.02765906   9.6949378
 [78,]    6.8604219 10.370311  -13.13797326  26.9120676
 [79,]   -0.3666408 12.016553  -23.38252856  22.9367398
 [80,]   29.7343964 13.846724    3.18445476  56.7987202
 [81,]   -8.7412705 13.573657  -35.92325986  16.7798162
 [82,]   23.7636138 11.574207    0.70607301  45.6906207
 [83,]    4.4730980  9.854147  -14.70625664  23.7230444
 [84,]   20.9504823  8.583123    4.57238945  38.1702444
 [85,]    1.7662665  7.978700  -13.70961108  17.4846726
 [86,]    5.1165508  8.189819  -11.08314514  21.0421014
 [87,]   -3.9013650  9.160266  -22.02987450  13.6553847
 [88,]  -13.8766807 10.685113  -34.94790844   6.3948911
 [89,]  -13.2675964 12.564102  -38.33791043  10.8887992
 [90,]  -11.6091122 14.661703  -40.83575774  16.6991034
 [91,]   26.1772692 12.914957    0.84516023  51.1383682
 [92,]    8.5006851 11.074390  -13.01040331  29.7711985
 [93,]  -32.8096991  9.503412  -51.68844438 -14.2847799
 [94,]    2.5855168  8.355492  -13.98302555  18.9063884
 [95,]    3.0799326  7.819229  -12.54512126  18.3544334
 [96,]   10.0702484  8.018301   -6.00053680  25.6353708
 [97,]    3.3760643  8.903519  -14.15948924  20.4675638
 [98,]   -3.3075199 10.299459  -23.91767312  16.6993884
 [99,]   16.7486960 12.029619   -7.30442434  40.2812236
[100,]    0.6853118 13.970373  -27.55744043  28.0669069
[101,]    9.2666518 12.873269  -15.45829188  34.2524158
[102,]   -8.0754827 11.010927  -29.35062925  13.4424679
[103,]  -11.0222171  9.433409  -29.20466572   7.7419469
[104,]   -6.5814515  8.304645  -22.65599988   9.9904825
[105,]  -22.3487860  7.821398  -37.91871644  -6.4952573
[106,]  -14.8403204  8.100040  -30.79688362   1.0663347
[107,]  -14.6055548  9.070625  -32.30662874   3.3584253
[108,]    0.3760108 10.543769  -20.09805515  21.4799445
[109,]   16.9989763 12.340791   -6.70920655  41.8661311
[110,]   20.8078419 14.340447   -7.12965184  49.4237341
[111,]   17.0435258 13.068060   -8.17569945  43.1948486
[112,]  -12.7376431 11.184549  -34.35849187   9.5117206
[113,]  -16.9260119  9.591758  -35.59933467   1.5576650
[114,]  -34.5421808  8.455602  -51.05455014 -18.2812356
[115,]  -38.0914496  7.973727  -53.25868060 -22.8001607
[116,]    5.7780815  8.261425  -10.10539954  21.6872542
[117,]   38.5592126  9.247144   20.36800420  56.8992807
[118,]    5.0944438 10.740388  -16.11624398  26.7298584
[119,]   19.7245749 12.561445   -5.06916304  44.8474208
[120,]   -2.6485940 14.588063  -31.50927949  26.2978845
[121,]   -5.4623198 12.496147  -30.01250872  18.9494498
[122,]   36.6103198 10.784283   15.12524203  57.7676562
[123,]   -1.0118405  9.336617  -19.39677524  17.0590426
[124,]    2.2248992  8.292687  -14.20147598  18.2780524
[125,]  -13.9952612  7.815977  -29.41440654   1.2444801
[126,]   11.3524785  8.008429   -4.46058446  26.6646056
[127,]  -12.9929818  8.826379  -30.03627040   4.3737188
[128,]  -41.6025422 10.119268  -61.55154408 -21.3897113
[129,]    5.8852975 11.731104  -17.11193591  28.9878381
[130,]   24.4505372 13.548528   -1.99954307  50.9627214
[131,]  -50.6905173 12.237237  -75.09182302 -26.5936343
[132,]   11.8317217 10.549128   -9.40177292  32.7878986
[133,]   26.5217608  9.142223    8.16218264  44.2051214
[134,]   32.5041999  8.163235   16.43917339  48.7358791
[135,]   20.3943389  7.775512    5.18499130  35.5102864
[136,]   10.4882780  8.064787   -5.40256217  26.1180226
[137,]   -1.9083829  8.965768  -19.63477083  15.7410378
[138,]   -9.8969439 10.319458  -30.27922218  10.5012791
[139,]   -8.6835048 11.973281  -32.23615571  14.9499535
[140,]   -9.7769658 13.819903  -36.80063398  17.2833377
[141,]   17.3644343 12.091574   -6.40217568  40.8958557
[142,]    2.5407535 10.403815  -17.99012785  22.8223480
[143,]  -19.9908273  9.019130  -37.71745511  -2.5081699
[144,]  -10.9137081  8.094576  -26.69478149   4.8254370
[145,]   14.9148110  7.795622   -0.15479881  29.9382066
[146,]    5.9690302  8.191057   -9.93266362  22.2243227
[147,]  -24.4462506  9.191694  -42.18361362  -6.2592191
[148,]   14.2042686 10.627943   -6.01142555  35.2169249
[149,]   -4.9757123 12.348734  -28.72410044  19.4224191
[150,]    9.9203069 14.251365  -17.57485523  38.3751409
[151,]   -1.0423196 13.693537  -27.27167515  26.2670589
[152,]   -6.9900304 11.664655  -29.24223324  16.2232847
[153,]  -17.8199412  9.891865  -36.74580782   1.7883808
[154,]  -31.4549521  8.536243  -48.13572547 -14.6727533
[155,]  -19.5978629  7.817896  -34.81328962  -4.3357388
[156,]   41.8513263  7.912344   26.20413514  57.5195199
[157,]  -36.4014846  8.793434  -53.60029946 -19.1772943
[158,]   14.8287046 10.260478   -5.23923606  35.3815783
[159,]   17.1989938 12.102229   -6.65111234  41.1490826
[160,]    9.0575830 14.173359  -18.95759111  36.8834385
[161,]   17.9068352 12.359215   -6.36125799  41.7229246
[162,]   10.9765334 10.685107   -9.93036693  31.5122583
[163,]    6.9399316  9.298917  -11.10435819  24.8156238
[164,]    1.3378297  8.345373  -14.81330864  17.5179970
[165,]  -10.7738721  7.981082  -26.47731046   4.8897934
[166,]  -14.9250739  8.284149  -31.25800058   1.0130226
[167,]  -49.6639757  9.188777  -67.19360976 -31.9425714
[168,]  -13.7918775 10.541212  -34.54870795   6.5660168
[169,]   22.8655207 12.193347   -1.00326747  46.1539126
[170,]   32.0613188 14.039775    4.33860770  58.8647260
[171,]    5.6716845 12.391262  -19.35306677  29.5127712
[172,]   -1.9943565 10.635622  -23.46751588  18.3911509
[173,]   10.4001025  9.176169   -8.03858619  28.2951715
[174,]   11.7065616  8.173141   -4.80104966  27.5656750
[175,]  -23.4807794  7.804544  -39.08829142  -8.1114251
[176,]    7.2258796  8.156844   -9.35201393  23.1905564
[177,]    0.3717386  9.147122  -18.12480443  18.3503535
[178,]   -2.6185024 10.598023  -23.97704154  18.0107911
[179,]   11.5749566 12.348233  -12.85703089  35.0456661
[180,]   -5.1714843 14.288182  -33.25112778  22.0726136</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.3
p_loo        19.3  3.3
looic      1769.7 28.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   703       
 (0.5, 0.7]   (ok)         2    1.1%   1033      
   (0.7, 1]   (bad)        1    0.6%   128       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.5 22.3
p_loo        33.5  8.3
looic      1721.0 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   754       
 (0.5, 0.7]   (ok)         5    2.8%   770       
   (0.7, 1]   (bad)        3    1.7%   19        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.4      11.6  
fit_sleep1 -92.8      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.3
p_loo        19.3  3.3
looic      1769.7 28.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   703       
 (0.5, 0.7]   (ok)         2    1.1%   1033      
   (0.7, 1]   (bad)        1    0.6%   128       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.5 22.3
p_loo        33.5  8.3
looic      1721.0 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   754       
 (0.5, 0.7]   (ok)         5    2.8%   770       
   (0.7, 1]   (bad)        3    1.7%   19        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.5     22.3        33.5    8.3   1721.0
fit_sleep2  -24.4      11.6  -884.9     14.3        19.3    3.3   1769.7
fit_sleep1  -92.8      20.9  -953.3     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.6  
fit_sleep2   28.7  
fit_sleep1   21.1  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
4.901435e-41 2.659397e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9       1.6     0.21     5.44       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1       1.6    -3.43        3       4.88      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0.1       tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
