<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.78      6.82    15.58    42.87 1.00     1706     1961
sd(Days)                6.55      1.51     4.16    10.07 1.00     1267     1896
cor(Intercept,Days)     0.08      0.30    -0.49     0.68 1.00      930     1796

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.30      7.42   236.79   266.48 1.00     2020     2603
Days         10.40      1.67     7.17    13.79 1.00     1892     2164

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.94      1.59    23.15    29.29 1.00     3522     2439

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0158  13.01938 227.7426 278.9711
309 211.7139  13.59320 184.2352 237.9326
310 213.1536  13.42046 186.0448 238.2925
330 274.6200  13.67447 249.4892 302.3661
331 272.9732  13.14067 248.0435 299.7231
332 260.3426  12.07396 236.7629 284.4951
333 268.0126  12.48850 243.9168 293.3070
334 244.5591  12.56773 219.6166 269.3125
335 250.7151  13.50991 225.6441 278.1470
337 285.7619  13.31740 259.7435 312.7115
349 226.7883  12.80184 200.4878 250.6793
350 238.8470  13.13256 212.9290 264.6395
351 255.9963  12.62056 231.4480 282.0428
352 272.0317  12.28977 247.9225 296.1052
369 254.9650  12.08246 230.6946 278.8555
370 226.5980  13.73935 199.1905 252.3983
371 252.2570  12.09222 228.6412 276.1043
372 263.6172  12.39895 238.8216 288.3272

, , Days

     Estimate Est.Error       Q2.5     Q97.5
308 19.609303  2.517462 14.7245600 24.530466
309  1.729278  2.571735 -3.3019145  6.774538
310  4.888580  2.470025  0.1569067  9.915750
330  5.761912  2.540641  0.7288073 10.538722
331  7.520919  2.481201  2.4479450 12.188030
332 10.214957  2.308944  5.6996356 14.794023
333 10.280835  2.380280  5.4317797 14.813448
334 11.459809  2.368090  6.8920634 16.122263
335 -0.242557  2.614693 -5.4344421  4.906774
337 19.131711  2.522301 14.1478685 24.037594
349 11.533341  2.436571  6.8039339 16.459750
350 16.989052  2.501087 12.1113576 21.952802
351  7.434464  2.430099  2.5462258 12.094683
352 14.044420  2.365432  9.2878542 18.723189
369 11.284616  2.301019  6.7653231 15.873863
370 15.170405  2.576631 10.1681845 20.286891
371  9.458988  2.301392  4.8141074 14.037873
372 11.807424  2.399593  6.9743533 16.448742</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0158 13.019381 227.7426 278.9711
  [2,] 273.6251 11.124413 251.3068 294.6854
  [3,] 293.2344  9.522399 274.5644 311.3896
  [4,] 312.8437  8.383009 296.5301 329.1353
  [5,] 332.4530  7.908782 317.2659 348.2761
  [6,] 352.0623  8.215719 335.9968 368.4145
  [7,] 371.6716  9.226185 353.6965 389.9264
  [8,] 391.2809 10.743471 370.4187 412.1201
  [9,] 410.8902 12.585591 386.2412 435.1436
 [10,] 430.4995 14.630354 401.6181 458.8757
 [11,] 211.7139 13.593198 184.2352 237.9326
 [12,] 213.4432 11.604630 190.3856 235.6563
 [13,] 215.1725  9.888755 195.4116 234.4898
 [14,] 216.9017  8.610178 199.9583 233.8818
 [15,] 218.6310  7.981885 203.0097 234.0795
 [16,] 220.3603  8.155578 204.3983 236.4067
 [17,] 222.0896  9.085376 204.4950 240.0160
 [18,] 223.8188 10.573660 203.2174 244.8746
 [19,] 225.5481 12.421279 201.6043 249.6312
 [20,] 227.2774 14.491435 199.6008 255.3874
 [21,] 213.1536 13.420463 186.0448 238.2925
 [22,] 218.0422 11.566871 194.7151 239.9560
 [23,] 222.9308  9.983898 202.8522 242.1649
 [24,] 227.8194  8.818502 210.5835 244.9666
 [25,] 232.7079  8.249593 216.6949 248.8207
 [26,] 237.5965  8.399264 221.0760 254.0536
 [27,] 242.4851  9.232633 223.9635 260.1941
 [28,] 247.3737 10.589497 226.1611 267.6916
 [29,] 252.2623 12.297782 228.0586 275.8429
 [30,] 257.1508 14.231495 229.2601 284.5471
 [31,] 274.6200 13.674474 249.4892 302.3661
 [32,] 280.3820 11.709902 258.7317 304.4174
 [33,] 286.1439 10.008099 267.0992 306.6056
 [34,] 291.9058  8.724221 274.8673 309.1026
 [35,] 297.6677  8.060503 281.7631 313.4561
 [36,] 303.4296  8.169522 287.4788 319.8146
 [37,] 309.1915  9.023314 292.0837 327.0756
 [38,] 314.9534 10.440738 295.0158 336.0469
 [39,] 320.7153 12.227327 297.2694 344.9937
 [40,] 326.4773 14.244851 298.5974 354.5379
 [41,] 272.9732 13.140672 248.0435 299.7231
 [42,] 280.4941 11.258007 259.3336 302.8406
 [43,] 288.0150  9.649916 269.7158 307.4382
 [44,] 295.5359  8.474182 279.2260 312.1541
 [45,] 303.0569  7.925614 287.9740 318.6485
 [46,] 310.5778  8.132137 294.8448 326.6795
 [47,] 318.0987  9.042161 300.3899 335.3322
 [48,] 325.6196 10.473893 304.9365 345.9757
 [49,] 333.1405 12.245688 309.2657 356.5171
 [50,] 340.6615 14.231095 312.9383 368.1675
 [51,] 260.3426 12.073959 236.7629 284.4951
 [52,] 270.5576 10.388137 250.2471 291.3613
 [53,] 280.7725  8.983805 263.1201 298.9187
 [54,] 290.9875  8.010402 275.2968 306.8922
 [55,] 301.2025  7.634578 286.2640 316.2155
 [56,] 311.4174  7.941628 295.6995 327.0210
 [57,] 321.6324  8.860845 304.2171 339.0657
 [58,] 331.8473 10.228496 311.8973 352.1445
 [59,] 342.0623 11.890843 319.1604 365.8461
 [60,] 352.2772 13.741346 325.8114 379.4000
 [61,] 268.0126 12.488499 243.9168 293.3070
 [62,] 278.2934 10.755841 257.4745 299.8574
 [63,] 288.5743  9.313705 270.7570 307.1364
 [64,] 298.8551  8.314659 282.6634 315.2835
 [65,] 309.1359  7.928017 293.8737 324.8535
 [66,] 319.4168  8.240438 303.4953 335.3846
 [67,] 329.6976  9.180831 311.5965 347.6860
 [68,] 339.9784 10.583097 319.1014 360.5514
 [69,] 350.2593 12.290146 325.9799 374.2840
 [70,] 360.5401 14.192425 332.1746 388.0492
 [71,] 244.5591 12.567725 219.6166 269.3125
 [72,] 256.0189 10.821991 235.0034 277.3195
 [73,] 267.4787  9.354087 249.6109 285.6196
 [74,] 278.9385  8.312527 262.9030 295.0020
 [75,] 290.3984  7.868479 275.1203 305.9112
 [76,] 301.8582  8.120562 286.3036 317.9650
 [77,] 313.3180  9.010538 295.9980 331.2739
 [78,] 324.7778 10.375536 304.8301 345.1520
 [79,] 336.2376 12.055265 313.0079 359.8527
 [80,] 347.6974 13.936383 320.6697 375.0697
 [81,] 250.7151 13.509911 225.6441 278.1470
 [82,] 250.4726 11.516110 228.9999 273.7949
 [83,] 250.2300  9.818202 231.2653 269.8839
 [84,] 249.9875  8.593408 233.2940 266.8804
 [85,] 249.7449  8.060363 234.2837 265.4862
 [86,] 249.5024  8.352573 233.3630 265.7626
 [87,] 249.2598  9.393335 231.1175 267.3916
 [88,] 249.0172 10.971657 228.3268 270.4862
 [89,] 248.7747 12.891586 224.1332 273.8919
 [90,] 248.5321 15.022715 219.5718 277.6191
 [91,] 285.7619 13.317400 259.7435 312.7115
 [92,] 304.8936 11.411913 282.7255 327.7085
 [93,] 324.0253  9.789502 305.2787 343.4119
 [94,] 343.1570  8.611676 326.4880 360.6412
 [95,] 362.2887  8.075368 346.7201 378.3581
 [96,] 381.4204  8.305793 365.1836 397.4177
 [97,] 400.5521  9.245800 382.4959 418.4899
 [98,] 419.6838 10.710156 398.6606 440.4828
 [99,] 438.8155 12.516152 414.1268 463.0498
[100,] 457.9473 14.537011 428.9532 486.1726
[101,] 226.7883 12.801841 200.4878 250.6793
[102,] 238.3217 10.937706 215.9700 258.7079
[103,] 249.8550  9.340956 230.7775 267.6441
[104,] 261.3883  8.169900 245.2347 277.3754
[105,] 272.9217  7.623308 258.1331 287.8990
[106,] 284.4550  7.833017 269.6205 300.0820
[107,] 295.9884  8.744784 279.2071 313.2685
[108,] 307.5217 10.171533 287.7212 327.1446
[109,] 319.0550 11.929908 295.7896 341.9645
[110,] 330.5884 13.894570 303.4030 357.4907
[111,] 238.8470 13.132555 212.9290 264.6395
[112,] 255.8361 11.218473 233.5615 277.9742
[113,] 272.8251  9.578891 253.7726 291.8666
[114,] 289.8142  8.376577 273.4868 306.3960
[115,] 306.8032  7.815997 291.4178 322.0605
[116,] 323.7923  8.032649 308.1315 339.5381
[117,] 340.7813  8.970394 323.4566 358.5476
[118,] 357.7704 10.436636 337.2252 378.6194
[119,] 374.7594 12.242942 350.3139 399.0882
[120,] 391.7485 14.260672 363.3384 419.8826
[121,] 255.9963 12.620563 231.4480 282.0428
[122,] 263.4308 10.791827 242.6131 285.0742
[123,] 270.8653  9.244417 252.8590 289.5110
[124,] 278.2997  8.140375 262.2221 294.6302
[125,] 285.7342  7.673522 270.2410 301.2035
[126,] 293.1687  7.956817 277.1117 308.9597
[127,] 300.6031  8.919064 282.6867 318.4911
[128,] 308.0376 10.373005 287.2056 328.8174
[129,] 315.4721 12.143291 291.5672 339.4918
[130,] 322.9065 14.111364 294.8304 350.7596
[131,] 272.0317 12.289767 247.9225 296.1052
[132,] 286.0761 10.563396 265.0017 306.8402
[133,] 300.1206  9.128135 281.8330 318.0240
[134,] 314.1650  8.139465 298.1325 330.1495
[135,] 328.2094  7.769779 312.7626 342.9884
[136,] 342.2538  8.104233 325.7857 357.4407
[137,] 356.2982  9.065222 338.0002 373.3749
[138,] 370.3427 10.481815 349.5949 390.3694
[139,] 384.3871 12.196277 360.3095 407.6526
[140,] 398.4315 14.100370 370.6094 425.4663
[141,] 254.9650 12.082462 230.6946 278.8555
[142,] 266.2497 10.465336 245.3147 286.5469
[143,] 277.5343  9.146037 259.3478 295.2686
[144,] 288.8189  8.268380 272.3493 304.7430
[145,] 300.1035  7.979449 284.5398 315.6252
[146,] 311.3881  8.340653 295.2295 327.5032
[147,] 322.6727  9.276354 304.6111 340.8034
[148,] 333.9574 10.635995 313.4116 355.1312
[149,] 345.2420 12.279553 321.4479 370.0251
[150,] 356.5266 14.108147 329.1713 384.7790
[151,] 226.5980 13.739353 199.1905 252.3983
[152,] 241.7684 11.752960 218.2358 264.1106
[153,] 256.9388 10.038544 237.0656 276.0405
[154,] 272.1092  8.757324 254.8727 288.9035
[155,] 287.2796  8.117088 271.2531 302.9323
[156,] 302.4500  8.268106 286.2881 318.4455
[157,] 317.6204  9.171374 299.1544 334.9825
[158,] 332.7908 10.636948 311.5964 352.8663
[159,] 347.9612 12.468090 323.5236 371.8137
[160,] 363.1316 14.527214 335.0319 391.5028
[161,] 252.2570 12.092223 228.6412 276.1043
[162,] 261.7160 10.466228 242.0224 282.4393
[163,] 271.1750  9.135360 253.4151 288.8226
[164,] 280.6340  8.243815 264.6956 296.6450
[165,] 290.0929  7.940968 274.5941 305.7427
[166,] 299.5519  8.291578 283.6638 315.8301
[167,] 309.0109  9.221408 291.0894 327.1582
[168,] 318.4699 10.578813 297.8329 339.4128
[169,] 327.9289 12.222152 304.0524 352.5958
[170,] 337.3879 14.051461 309.7936 365.4722
[171,] 263.6172 12.398947 238.8216 288.3272
[172,] 275.4246 10.631846 254.5734 296.9716
[173,] 287.2320  9.157210 269.1644 305.8391
[174,] 299.0395  8.135659 283.1288 315.5683
[175,] 310.8469  7.748516 295.8664 326.2441
[176,] 322.6543  8.087406 306.7265 338.5397
[177,] 334.4617  9.071322 316.6044 352.0153
[178,] 346.2692 10.520823 325.7144 366.5272
[179,] 358.0766 12.272026 334.0019 381.9351
[180,] 369.8840 14.213854 342.0216 397.0228</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.45578901 13.019381  -29.4111468  21.8173736
  [2,]  -14.92039173 11.124413  -35.9807091   7.3979308
  [3,]  -42.43379445  9.522399  -60.5890451 -23.7637889
  [4,]    8.59610284  8.383009   -7.6955356  24.9097100
  [5,]   24.39890012  7.908782    8.5757541  39.5860169
  [6,]   62.62779740  8.215719   46.2756491  78.6932793
  [7,]   10.53219468  9.226185   -7.7225960  28.5073376
  [8,] -101.13230803 10.743471 -121.9715020 -80.2701233
  [9,]   19.69508925 12.585591   -4.5582782  44.3441369
 [10,]   35.85398653 14.630354    7.4778341  64.7353517
 [11,]   11.01999676 13.593198  -15.1987383  38.4987384
 [12,]   -8.17738119 11.604630  -30.3905490  14.8802160
 [13,]  -12.19465913  9.888755  -31.5119748   7.5661930
 [14,]  -12.19473708  8.610178  -29.1748424   4.7487101
 [15,]  -10.91491503  7.981885  -26.3634075   4.7064149
 [16,]   -4.39849298  8.155578  -20.4449423  11.5634702
 [17,]   -8.45927093  9.085376  -26.3856844   9.1353128
 [18,]   -6.09164888 10.573660  -27.1474160  14.5097727
 [19,]   -1.25242683 12.421279  -25.3355146  22.6913750
 [20,]   10.03679522 14.491435  -18.0732359  37.7134235
 [21,]  -14.09972081 13.420463  -39.2385772  13.0090746
 [22,]  -23.71000115 11.566871  -45.6238147  -0.3829350
 [23,]   11.38921851  9.983898   -7.8449296  31.4677658
 [24,]    5.02223817  8.818502  -12.1250288  22.2580797
 [25,]   -3.40054217  8.249593  -19.5133492  12.6125496
 [26,]  -17.13862251  8.399264  -33.5956825  -0.6180533
 [27,]   -7.06430285  9.232633  -24.7733116  11.4572932
 [28,]    8.37741681 10.589497  -11.9404965  29.5900290
 [29,]    8.75023648 12.297782  -14.8304385  32.9538849
 [30,]   -9.63554386 14.231495  -37.0317557  18.2551536
 [31,]   46.92255506 13.674474   19.1765471  72.0533579
 [32,]   20.01824256 11.709902   -4.0172127  41.6684669
 [33,]   -2.28736993 10.008099  -22.7490870  16.7573368
 [34,]   -6.77278243  8.724221  -23.9696408  10.2656850
 [35,]  -11.87039493  8.060503  -27.6587805   4.0342085
 [36,]   -5.84410742  8.169522  -22.2291429  10.1066608
 [37,]  -28.95191992  9.023314  -46.8360257 -11.8440824
 [38,]    3.30786758 10.440738  -17.7856445  23.2454738
 [39,]  -15.36584491 12.227327  -39.6441645   8.0801033
 [40,]   27.57144259 14.244851   -0.4892385  55.4512868
 [41,]   14.63471378 13.140672  -12.1151605  39.5644414
 [42,]    4.50589466 11.258007  -17.8406164  25.6664487
 [43,]   13.80557554  9.649916   -5.6176032  32.1047690
 [44,]   24.57935642  8.474182    7.9611914  40.8893035
 [45,]   13.22043729  7.925614   -2.3711742  28.3032803
 [46,]  -17.25908183  8.132137  -33.3608148  -1.5260705
 [47,]  -28.02370095  9.042161  -45.2571720 -10.3148817
 [48,]    9.19807993 10.473893  -11.1579817  29.8812155
 [49,]  -39.39363919 12.245688  -62.7702225 -15.5188267
 [50,]   30.91964168 14.231095    3.4136332  58.6427692
 [51,]  -25.48202597 12.073959  -49.6344677  -1.9022699
 [52,]  -27.74578287 10.388137  -48.5494749  -7.4353440
 [53,]   -7.81123976  8.983805  -25.9574384   9.8411889
 [54,]   18.78130334  8.010402    2.8766158  34.4719857
 [55,]   16.26044645  7.634578    1.2474332  31.1989158
 [56,]   -1.41981045  7.941628  -17.0234395  14.2980510
 [57,]  132.52953265  8.860845  115.0961827 149.9447796
 [58,]   14.98377576 10.228496   -5.3134278  34.9338436
 [59,]  -11.76198114 11.890843  -35.5458139  11.1399481
 [60,]  -98.41283803 13.741346 -125.5355935 -71.9469902
 [61,]   15.82981058 12.488499   -9.4646411  39.9256282
 [62,]   11.26157581 10.755841  -10.3023578  32.0805036
 [63,]  -11.80495896  9.313705  -30.3670735   6.0123375
 [64,]    0.95460626  8.314659  -15.4738287  17.1463451
 [65,]  -11.96492851  7.928017  -27.6825086   3.2972846
 [66,]   18.74973671  8.240438    2.7819116  34.6711779
 [67,]    2.32890194  9.180831  -15.6594915  20.4300184
 [68,]    8.86146716 10.583097  -11.7114727  29.7385067
 [69,]  -16.89926761 12.290146  -40.9240034   7.3801320
 [70,]    1.50269762 14.192425  -26.0064251  29.8682029
 [71,]   20.91397942 12.567725   -3.8394483  45.8565128
 [72,]   20.18227042 10.821991   -1.1182929  41.1977509
 [73,]  -24.11403858  9.354087  -42.2548884  -6.2461605
 [74,]  -24.26624758  8.312527  -40.3296677  -8.2307456
 [75,]  -11.37395658  7.868479  -26.8868176   3.9040822
 [76,]  -17.66696558  8.120562  -33.7737539  -2.1124134
 [77,]   -7.79317458  9.010538  -25.7490745   9.5267555
 [78,]    6.74511642 10.375536  -13.6290819  26.6928352
 [79,]   -0.49069259 12.055265  -24.1057795  22.7390195
 [80,]   29.60159841 13.936383    2.2292676  56.6293071
 [81,]   -9.10684797 13.509911  -36.5387147  15.9641659
 [82,]   23.47460904 11.516110    0.1522648  44.9473268
 [83,]    4.26066605  9.818202  -15.3932219  23.2254376
 [84,]   20.81462306  8.593408    3.9216884  37.5081324
 [85,]    1.70698007  8.060363  -14.0343156  17.1681719
 [86,]    5.13383709  8.352573  -11.1263749  21.2731963
 [87,]   -3.80750590  9.393335  -21.9392720  14.3348365
 [88,]  -13.70624889 10.971657  -35.1752494   6.9842422
 [89,]  -13.02059188 12.891586  -38.1378113  11.6208889
 [90,]  -11.28553487 15.022715  -40.3724698  17.6747619
 [91,]   26.60474982 13.317400   -0.3449386  52.6231108
 [92,]    8.91223838 11.411913  -13.9026778  31.0803251
 [93,]  -32.41407306  9.789502  -51.8006975 -13.6675472
 [94,]    2.96521550  8.611676  -14.5190058  19.6341812
 [95,]    3.44370406  8.075368  -12.6256518  19.0122923
 [96,]   10.41809261  8.305793   -5.5791828  26.6548799
 [97,]    3.70798117  9.245800  -14.2297787  21.7642106
 [98,]   -2.99153027 10.710156  -23.7904576  18.0317265
 [99,]   17.04875829 12.516152   -7.1855044  41.7374550
[100,]    0.96944685 14.537011  -27.2559304  29.9634798
[101,]    9.31488868 12.801841  -14.5760732  35.6153887
[102,]   -8.00495241 10.937706  -28.3911871  14.3466994
[103,]  -10.92939349  9.340956  -28.7184857   8.1481104
[104,]   -6.46633457  8.169900  -22.4534379   9.6872744
[105,]  -22.21137565  7.623308  -37.1887224  -7.4227887
[106,]  -14.68061673  7.833017  -30.3076417   0.1538782
[107,]  -14.42355781  8.744784  -31.7037153   2.3576888
[108,]    0.58030110 10.171533  -19.0425516  20.3807927
[109,]   17.22556002 11.929908   -5.6838830  40.4910335
[110,]   21.05671894 13.894570   -5.8455594  48.2420810
[111,]   17.44978197 13.132555   -8.3426828  43.3677960
[112,]  -12.38176997 11.218473  -34.5198762   9.8927915
[113,]  -16.62052191  9.578891  -35.6619733   2.4319622
[114,]  -34.28707386  8.376577  -50.8688651 -17.9596635
[115,]  -37.88672580  7.815997  -53.1439571 -22.5012614
[116,]    5.93242225  8.032649   -9.8133833  21.5931953
[117,]   38.66317031  8.970394   20.8968599  55.9879266
[118,]    5.14801837 10.436636  -15.7009943  25.6931815
[119,]   19.72776642 12.242942   -4.6010192  44.1733358
[120,]   -2.69578552 14.260672  -30.8298751  25.7142854
[121,]   -5.46983935 12.620563  -31.5162759  19.0784977
[122,]   36.62679649 10.791827   14.9834094  57.4444842
[123,]   -0.97136767  9.244417  -19.6171295  17.0349461
[124,]    2.28936817  8.140375  -14.0411252  18.3669990
[125,]  -13.90679599  7.673522  -29.3760634   1.5863640
[126,]   11.46493985  7.956817   -4.3261050  27.5218950
[127,]  -12.85652431  8.919064  -30.7445056   5.0599475
[128,]  -41.44208847 10.373005  -62.2218647 -20.6100972
[129,]    6.06974737 12.143291  -17.9499640  29.9745718
[130,]   24.65898321 14.111364   -3.1941379  52.7351077
[131,]  -50.35461201 12.289767  -74.4280622 -26.2454301
[132,]   12.11776822 10.563396   -8.6463278  33.1921714
[133,]   26.75794845  9.128135    8.8545398  45.0455159
[134,]   32.69052869  8.139465   16.7059823  48.7229798
[135,]   20.53080892  7.769779    5.7518423  35.9776133
[136,]   10.57488915  8.104233   -4.6120125  27.0430431
[137,]   -1.87163062  9.065222  -18.9482763  16.4263695
[138,]   -9.91005039 10.481815  -29.9368016  10.8377290
[139,]   -8.74647016 12.196277  -32.0119785  15.3310720
[140,]   -9.88978993 14.100370  -36.9246043  17.9322763
[141,]   16.95846062 12.082462   -6.9320499  41.2288667
[142,]    2.18724455 10.465336  -18.1100298  23.1221835
[143,]  -20.29187151  9.146037  -38.0262316  -2.1053949
[144,]  -11.16228757  8.268380  -27.0863849   5.3072908
[145,]   14.71869637  7.979449   -0.8030325  30.2823657
[146,]    5.82538031  8.340653  -10.2896506  21.9840260
[147,]  -24.53743576  9.276354  -42.6681115  -6.4758386
[148,]   14.16554818 10.635995   -7.0082831  34.7113109
[149,]   -4.96196788 12.279553  -29.7451338  18.8321200
[150,]    9.98651606 14.108147  -18.2659341  37.3418198
[151,]   -1.33399898 13.739353  -27.1342540  26.0735004
[152,]   -7.24490359 11.752960  -29.5870632  16.2876835
[153,]  -18.03800820 10.038544  -37.1397137   1.8351721
[154,]  -31.63621281  8.757324  -48.4305390 -14.3997451
[155,]  -19.74231742  8.117088  -35.3949553  -3.7158169
[156,]   41.74367797  8.268106   25.7481894  57.9056429
[157,]  -36.47232664  9.171374  -53.8343693 -18.0063110
[158,]   14.79466875 10.636948   -5.2808369  35.9890942
[159,]   17.20176414 12.468090   -6.6507070  41.6393733
[160,]    9.09715953 14.527214  -19.2739714  37.1968624
[161,]   17.62340746 12.092223   -6.2239401  41.2392151
[162,]   10.72681958 10.466228   -9.9965282  30.4203799
[163,]    6.72393171  9.135360  -10.9237411  24.4838083
[164,]    1.15554383  8.243815  -14.8555139  17.0938861
[165,]  -10.92244404  7.940968  -26.5721742   4.5764174
[166,]  -15.03993191  8.291578  -31.3180696   0.8481587
[167,]  -49.74511979  9.221408  -67.8924172 -31.8235571
[168,]  -13.83930766 10.578813  -34.7822235   6.7976840
[169,]   22.85180447 12.222152   -1.8151333  46.7283068
[170,]   32.08131659 14.051461    3.9970039  59.6755624
[171,]    5.79452041 12.398947  -18.9155153  30.5901192
[172,]   -1.95060401 10.631846  -23.4975642  18.9006294
[173,]   10.36477157  9.157210   -8.2423201  28.4323894
[174,]   11.59214715  8.135659   -4.9367448  27.5027631
[175,]  -23.67427727  7.748516  -39.0714983  -8.6938263
[176,]    6.95329830  8.087406   -8.9320865  22.8810561
[177,]    0.02007388  9.071322  -17.5335009  17.8773593
[178,]   -3.04925054 10.520823  -23.3072986  17.5054723
[179,]   11.06512504 12.272026  -12.7934440  35.1398231
[180,]   -5.76039938 14.213854  -32.8992084  22.1019599</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.5  3.4
looic      1770.1 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1440      
 (0.5, 0.7]   (ok)         2    1.1%   136       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.5 21.9
p_loo        33.3  8.0
looic      1720.9 43.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     168   93.3%   845       
 (0.5, 0.7]   (ok)         9    5.0%   651       
   (0.7, 1]   (bad)        2    1.1%   36        
   (1, Inf)   (very bad)   1    0.6%   29        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.6      11.3  
fit_sleep1 -92.9      20.6  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.5  3.4
looic      1770.1 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1440      
 (0.5, 0.7]   (ok)         2    1.1%   136       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.5 21.9
p_loo        33.3  8.0
looic      1720.9 43.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     168   93.3%   845       
 (0.5, 0.7]   (ok)         9    5.0%   651       
   (0.7, 1]   (bad)        2    1.1%   36        
   (1, Inf)   (very bad)   1    0.6%   29        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.5     21.9        33.3    8.0   1720.9
fit_sleep2  -24.6      11.3  -885.1     14.3        19.5    3.4   1770.1
fit_sleep1  -92.9      20.6  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   43.9  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
4.542597e-41 2.075699e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.91      1.58     0.32     5.46       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.09      1.58     -3.3     2.96       5.25      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.15      
[4] StanHeaders_2.26.15 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.0         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
