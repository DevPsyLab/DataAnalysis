<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.81      6.76    15.57    42.37 1.00     1739     2433
sd(Days)                6.56      1.48     4.17    10.03 1.00     1660     2166
cor(Intercept,Days)     0.09      0.29    -0.47     0.67 1.00     1081     1392

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.27      7.36   236.93   265.90 1.00     1871     2704
Days         10.45      1.71     7.02    13.79 1.00     1592     2045

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.88      1.59    23.09    29.31 1.00     3737     2934

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6609  12.93783 228.3286 278.2707
309 211.2420  13.21789 185.6096 236.6512
310 212.9765  12.92021 187.2537 237.8313
330 274.6292  13.08194 249.7445 300.0557
331 273.0740  12.87886 248.7558 299.4727
332 260.1646  12.01484 236.9261 284.0376
333 268.1819  12.47901 244.3655 293.0706
334 244.0182  12.41758 219.3823 268.1588
335 250.5791  13.21310 225.2211 277.0789
337 285.5237  13.03730 260.1645 310.8150
349 226.4584  12.82439 200.2996 251.1237
350 238.6766  13.08694 212.3169 263.5935
351 255.7248  12.41539 231.8501 280.0960
352 272.0160  12.57540 247.7917 297.0455
369 255.0087  12.54764 230.6958 279.6560
370 226.2480  13.50529 198.9371 251.5801
371 252.0032  12.04305 228.5631 275.9094
372 263.5625  11.83454 240.5002 287.1183

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6562961  2.444138 14.8040523 24.504410
309  1.7645348  2.524048 -3.2308967  6.760390
310  4.9158703  2.426268  0.2410133  9.730854
330  5.7134316  2.495702  0.7637916 10.458793
331  7.4687927  2.426838  2.6017647 12.225177
332 10.2402693  2.272544  5.8580827 14.781266
333 10.2563422  2.357306  5.6293358 14.797308
334 11.5393694  2.321481  7.0521309 16.037149
335 -0.2347766  2.556439 -5.1739944  4.659341
337 19.2061051  2.487951 14.3129044 24.190560
349 11.5790449  2.395721  6.9878271 16.390179
350 17.0184120  2.497408 12.2752195 22.048564
351  7.4811689  2.365768  2.7662999 12.174814
352 14.0061742  2.383480  9.3032283 18.549955
369 11.3392648  2.407381  6.6823888 16.117323
370 15.2536955  2.573886 10.3239264 20.422220
371  9.4861134  2.332717  4.7769867 14.075570
372 11.7901096  2.299224  7.1923072 16.260988</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6609 12.937831 228.3286 278.2707
  [2,] 273.3172 11.112143 252.0204 294.7970
  [3,] 292.9735  9.566588 274.5527 311.2902
  [4,] 312.6298  8.456188 296.8495 329.3715
  [5,] 332.2861  7.965063 317.2089 348.3758
  [6,] 351.9424  8.205179 335.9209 368.1123
  [7,] 371.5987  9.118953 353.5282 389.4028
  [8,] 391.2550 10.532486 369.9838 411.4313
  [9,] 410.9112 12.274317 386.1422 434.4649
 [10,] 430.5675 14.224347 401.7742 457.8026
 [11,] 211.2420 13.217892 185.6096 236.6512
 [12,] 213.0065 11.304125 190.9162 235.0482
 [13,] 214.7710  9.674475 196.0554 233.7280
 [14,] 216.5356  8.494076 200.3568 232.8975
 [15,] 218.3001  7.965225 203.2021 233.8891
 [16,] 220.0646  8.214739 204.2097 236.0106
 [17,] 221.8292  9.179362 204.1540 239.8426
 [18,] 223.5937 10.666822 202.9338 244.3794
 [19,] 225.3582 12.491722 200.9987 249.7542
 [20,] 227.1228 14.527450 198.8970 255.5822
 [21,] 212.9765 12.920209 187.2537 237.8313
 [22,] 217.8924 11.097269 195.3618 239.3885
 [23,] 222.8083  9.546754 203.6125 241.4390
 [24,] 227.7241  8.420522 210.7885 243.9811
 [25,] 232.6400  7.902116 217.1457 247.8418
 [26,] 237.5559  8.108960 222.0959 253.3799
 [27,] 242.4717  8.991140 225.6110 260.0844
 [28,] 247.3876 10.377837 227.6516 267.8690
 [29,] 252.3035 12.096775 229.1765 276.5916
 [30,] 257.2194 14.026332 230.6202 284.9214
 [31,] 274.6292 13.081939 249.7445 300.0557
 [32,] 280.3426 11.181353 259.0468 302.0259
 [33,] 286.0561  9.558516 267.4070 304.7100
 [34,] 291.7695  8.376446 275.3525 308.0320
 [35,] 297.4829  7.837188 282.0820 312.7052
 [36,] 303.1964  8.070641 287.6085 319.1439
 [37,] 308.9098  9.016986 291.7585 326.8717
 [38,] 314.6232 10.484936 294.1027 335.5784
 [39,] 320.3367 12.288970 296.1536 344.9061
 [40,] 326.0501 14.302473 298.0299 354.2431
 [41,] 273.0740 12.878864 248.7558 299.4727
 [42,] 280.5428 11.081050 259.1645 302.8455
 [43,] 288.0115  9.565212 269.4550 306.8199
 [44,] 295.4803  8.483865 278.9227 312.0285
 [45,] 302.9491  8.014845 286.9071 318.4512
 [46,] 310.4179  8.263086 293.6332 326.5858
 [47,] 317.8867  9.170524 299.4120 336.2413
 [48,] 325.3555 10.568705 304.0252 346.3444
 [49,] 332.8243 12.291282 308.2643 357.3410
 [50,] 340.2931 14.220858 312.6061 368.8824
 [51,] 260.1646 12.014844 236.9261 284.0376
 [52,] 270.4049 10.387950 250.7504 290.6343
 [53,] 280.6451  9.043863 263.2230 298.1786
 [54,] 290.8854  8.124181 275.3204 306.7205
 [55,] 301.1257  7.780879 286.0808 316.6696
 [56,] 311.3659  8.087691 295.4682 327.4760
 [57,] 321.6062  8.978214 304.2095 339.1745
 [58,] 331.8465 10.302175 312.0532 352.1713
 [59,] 342.0868 11.915964 319.0140 365.7487
 [60,] 352.3270 13.717671 325.7441 379.6689
 [61,] 268.1819 12.479011 244.3655 293.0706
 [62,] 278.4382 10.756699 258.1619 300.0292
 [63,] 288.6946  9.316718 271.2933 307.2845
 [64,] 298.9509  8.307205 283.4378 315.2732
 [65,] 309.2072  7.895053 293.9014 324.3191
 [66,] 319.4636  8.171159 303.4592 335.0452
 [67,] 329.7199  9.072906 312.1465 347.1592
 [68,] 339.9763 10.439405 319.4603 360.2305
 [69,] 350.2326 12.114392 326.2670 373.8437
 [70,] 360.4890 13.987481 332.7621 387.5010
 [71,] 244.0182 12.417577 219.3823 268.1588
 [72,] 255.5575 10.727988 234.5083 276.5570
 [73,] 267.0969  9.314601 248.8819 285.3558
 [74,] 278.6363  8.319399 262.2965 294.9223
 [75,] 290.1756  7.901996 274.9426 305.6094
 [76,] 301.7150  8.151640 285.6726 317.4654
 [77,] 313.2544  9.013073 295.0487 330.8172
 [78,] 324.7937 10.334422 303.9131 344.9279
 [79,] 336.3331 11.964264 312.4043 359.5735
 [80,] 347.8725 13.793676 320.0829 374.3420
 [81,] 250.5791 13.213102 225.2211 277.0789
 [82,] 250.3443 11.248496 229.2012 272.6229
 [83,] 250.1096  9.567759 231.8068 268.8501
 [84,] 249.8748  8.344227 233.6435 266.3811
 [85,] 249.6400  7.796216 234.3558 264.9983
 [86,] 249.4052  8.062668 233.3744 265.3410
 [87,] 249.1705  9.072099 230.9736 267.0788
 [88,] 248.9357 10.614618 228.2903 269.8559
 [89,] 248.7009 12.494319 224.3974 272.9285
 [90,] 248.4661 14.581381 220.5336 276.5317
 [91,] 285.5237 13.037303 260.1645 310.8150
 [92,] 304.7298 11.164217 283.0699 326.5044
 [93,] 323.9359  9.575386 305.3138 343.1224
 [94,] 343.1420  8.433035 326.7722 360.0349
 [95,] 362.3481  7.932462 347.0112 378.0470
 [96,] 381.5542  8.192169 365.4964 398.1536
 [97,] 400.7603  9.147628 382.4656 419.0021
 [98,] 419.9664 10.612557 399.1086 440.7944
 [99,] 439.1725 12.407798 414.4228 463.8415
[100,] 458.3786 14.410424 430.0229 486.8410
[101,] 226.4584 12.824390 200.2996 251.1237
[102,] 238.0374 11.028743 215.7716 259.0854
[103,] 249.6165  9.501595 230.6796 268.0311
[104,] 261.1955  8.390853 244.2551 277.4349
[105,] 272.7746  7.874737 257.2854 288.2921
[106,] 284.3536  8.068178 268.1015 300.4971
[107,] 295.9327  8.925160 278.0307 313.4446
[108,] 307.5117 10.281072 286.8699 328.2626
[109,] 319.0908 11.967512 295.6925 342.9827
[110,] 330.6698 13.864387 303.9289 358.1721
[111,] 238.6766 13.086942 212.3169 263.5935
[112,] 255.6950 11.196764 233.2563 277.2955
[113,] 272.7135  9.588591 253.7886 291.0399
[114,] 289.7319  8.425481 273.2209 306.5367
[115,] 306.7503  7.906356 291.1256 322.2649
[116,] 323.7687  8.155139 307.6032 339.7477
[117,] 340.7871  9.109129 322.8665 358.6748
[118,] 357.8055 10.579236 336.5754 377.9494
[119,] 374.8239 12.382986 350.1103 398.8782
[120,] 391.8423 14.395505 363.3728 419.8779
[121,] 255.7248 12.415389 231.8501 280.0960
[122,] 263.2059 10.669010 242.4657 284.3631
[123,] 270.6871  9.203661 252.6522 288.7241
[124,] 278.1683  8.171946 261.7874 294.4851
[125,] 285.6495  7.749048 270.2775 301.1303
[126,] 293.1306  8.031718 277.0034 309.3291
[127,] 300.6118  8.953377 283.0065 318.2309
[128,] 308.0930 10.344619 287.1148 328.8029
[129,] 315.5741 12.043797 291.3487 339.2419
[130,] 323.0553 13.938746 295.0469 350.2529
[131,] 272.0160 12.575399 247.7917 297.0455
[132,] 286.0222 10.869626 264.9332 307.7474
[133,] 300.0284  9.461439 281.7332 318.4789
[134,] 314.0346  8.500050 297.3451 330.6943
[135,] 328.0407  8.145232 311.9145 343.9571
[136,] 342.0469  8.473530 325.3925 358.8371
[137,] 356.0531  9.413744 337.5900 374.6805
[138,] 370.0593 10.807330 348.8148 391.4531
[139,] 384.0654 12.503605 359.4258 408.8664
[140,] 398.0716 14.395966 370.1709 426.0772
[141,] 255.0087 12.547636 230.6958 279.6560
[142,] 266.3480 10.778723 245.5419 287.4958
[143,] 277.6872  9.301051 259.7469 295.6361
[144,] 289.0265  8.272194 273.1534 304.8363
[145,] 300.3658  7.870185 285.0597 315.7255
[146,] 311.7050  8.187881 295.5601 327.8042
[147,] 323.0443  9.150626 304.8152 340.8838
[148,] 334.3836 10.583831 313.3024 354.9828
[149,] 345.7228 12.324446 321.3089 369.8088
[150,] 357.0621 14.260345 328.9085 385.0014
[151,] 226.2480 13.505295 198.9371 251.5801
[152,] 241.5017 11.536361 218.4096 263.0601
[153,] 256.7554  9.850485 237.2545 275.4074
[154,] 272.0091  8.615466 255.5361 288.8695
[155,] 287.2628  8.041781 271.7184 302.9317
[156,] 302.5165  8.268252 286.7073 318.7460
[157,] 317.7702  9.236207 300.2556 335.4175
[158,] 333.0239 10.747131 312.4940 353.6772
[159,] 348.2775 12.607296 324.4500 372.6215
[160,] 363.5312 14.684576 335.6458 392.4570
[161,] 252.0032 12.043053 228.5631 275.9094
[162,] 261.4893 10.348165 241.2667 282.0126
[163,] 270.9754  8.945224 253.4914 288.6641
[164,] 280.4615  7.989537 265.0662 295.8688
[165,] 289.9477  7.650588 274.9035 304.7907
[166,] 299.4338  8.007086 283.6209 314.6682
[167,] 308.9199  8.976553 291.1724 326.3668
[168,] 318.4060 10.388778 297.5914 338.6622
[169,] 327.8921 12.089585 303.6766 350.9533
[170,] 337.3782 13.973995 308.9493 364.5829
[171,] 263.5625 11.834538 240.5002 287.1183
[172,] 275.3526 10.178498 255.4794 295.5970
[173,] 287.1427  8.815906 269.8631 304.4168
[174,] 298.9328  7.900092 283.2632 314.4896
[175,] 310.7229  7.594443 295.5412 325.6468
[176,] 322.5131  7.969475 306.7663 338.0474
[177,] 334.3032  8.939931 316.8619 351.9651
[178,] 346.0933 10.339491 326.0504 366.2727
[179,] 357.8834 12.019177 334.5132 381.2377
[180,] 369.6735 13.877646 342.7951 396.6063</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.1008802 12.937831  -28.7106682  21.2314424
  [2,]  -14.6124763 11.112143  -36.0922732   6.6842717
  [3,]  -42.1728724  9.566588  -60.4896439 -23.7521282
  [4,]    8.8100315  8.456188   -7.9316801  24.5902677
  [5,]   24.5658354  7.965063    8.4760970  39.6430318
  [6,]   62.7477393  8.205179   46.5777631  78.7691989
  [7,]   10.6051432  9.118953   -7.1990317  28.6756171
  [8,] -101.1063529 10.532486 -121.2826785 -79.8352497
  [9,]   19.6740510 12.274317   -3.8795645  44.4430512
 [10,]   35.7859549 14.224347    8.5509183  64.5793483
 [11,]   11.4919436 13.217892  -13.9172571  37.1243254
 [12,]   -7.7406913 11.304125  -29.7824132  14.3496209
 [13,]  -11.7932261  9.674475  -30.7502275   6.9224011
 [14,]  -11.8285609  8.494076  -28.1905094   4.3501972
 [15,]  -10.5839958  7.965225  -26.1730330   4.5140168
 [16,]   -4.1028306  8.214739  -20.0487876  11.7520921
 [17,]   -8.1988655  9.179362  -26.2122806   9.4763214
 [18,]   -5.8665003 10.666822  -26.6522445  14.7933696
 [19,]   -1.0625352 12.491722  -25.4585391  23.2970317
 [20,]   10.1914300 14.527450  -18.2680244  38.4171676
 [21,]  -13.9226187 12.920209  -38.7773535  11.8002231
 [22,]  -23.5601890 11.097269  -45.0563241  -1.0295854
 [23,]   11.5117407  9.546754   -7.1190327  30.7075184
 [24,]    5.1174704  8.420522  -11.1394513  22.0531095
 [25,]   -3.3325999  7.902116  -18.5344490  12.1616947
 [26,]  -17.0979702  8.108960  -32.9220493  -1.6380315
 [27,]   -7.0509406  8.991140  -24.6635729   9.8097907
 [28,]    8.3634891 10.377837  -12.1179084  28.0994508
 [29,]    8.7090188 12.096775  -15.5790545  31.8359611
 [30,]   -9.7040515 14.026332  -37.4061071  16.8950597
 [31,]   46.9133868 13.081939   21.4868735  71.7981206
 [32,]   20.0575552 11.181353   -1.6256809  41.3533871
 [33,]   -2.1995764  9.558516  -20.8534618  16.4495123
 [34,]   -6.6365079  8.376446  -22.8990113   9.7804738
 [35,]  -11.6856395  7.837188  -26.9079174   3.7153457
 [36,]   -5.6108710  8.070641  -21.5584294   9.9769783
 [37,]  -28.6702026  9.016986  -46.6320971 -11.5189315
 [38,]    3.6380658 10.484936  -17.3171297  24.1585762
 [39,]  -14.9871657 12.288970  -39.5565855   9.1959242
 [40,]   27.9986027 14.302473   -0.1944124  56.0187726
 [41,]   14.5339383 12.878864  -11.8648108  38.8521018
 [42,]    4.4572455 11.081050  -17.8455412  25.8354524
 [43,]   13.8090528  9.565212   -4.9992538  32.3656411
 [44,]   24.6349600  8.483865    8.0868098  41.1925925
 [45,]   13.3281673  8.014845   -2.1738530  29.3702349
 [46,]  -17.0992254  8.263086  -33.2670986  -0.3145172
 [47,]  -27.8117182  9.170524  -46.1662918  -9.3370431
 [48,]    9.4621891 10.568705  -11.5267277  30.7925230
 [49,]  -39.0774036 12.291282  -63.5940786 -14.5173837
 [50,]   31.2880036 14.220858    2.6987419  58.9750085
 [51,]  -25.3040029 12.014844  -49.1769894  -2.0655432
 [52,]  -27.5930722 10.387950  -47.8224987  -7.9386172
 [53,]   -7.6838416  9.043863  -25.2172535   9.7382617
 [54,]   18.8833891  8.124181    3.0482524  34.4484154
 [55,]   16.3372198  7.780879    0.7933436  31.3820768
 [56,]   -1.3683496  8.087691  -17.4784391  14.5294192
 [57,]  132.5556811  8.978214  114.9874271 149.9523881
 [58,]   14.9846118 10.302175   -5.3402022  34.7778956
 [59,]  -11.7864575 11.915964  -35.4484338  11.2862753
 [60,]  -98.4626269 13.717671 -125.8045492 -71.8797351
 [61,]   15.6605195 12.479011   -9.2281691  39.4769429
 [62,]   11.1167773 10.756699  -10.4741526  31.3930822
 [63,]  -11.9252649  9.316718  -30.5152415   5.4760283
 [64,]    0.8587928  8.307205  -15.4635122  16.3719234
 [65,]  -12.0362494  7.895053  -27.1480916   3.2696356
 [66,]   18.7029084  8.171159    3.1212698  34.7072540
 [67,]    2.3065662  9.072906  -15.1326745  19.8799629
 [68,]    8.8636240 10.439405  -11.3905765  29.3796401
 [69,]  -16.8726183 12.114392  -40.4836910   7.0929898
 [70,]    1.5538395 13.987481  -25.4582472  29.2806789
 [71,]   21.4549435 12.417577   -2.6857325  46.0907514
 [72,]   20.6436741 10.727988   -0.3557716  41.6929198
 [73,]  -23.7321954  9.314601  -41.9910889  -5.5171572
 [74,]  -23.9639648  8.319399  -40.2499628  -7.6241931
 [75,]  -11.1512342  7.901996  -26.5849575   4.0818437
 [76,]  -17.5238036  8.151640  -33.2742236  -1.4814352
 [77,]   -7.7295731  9.013073  -25.2924487  10.4760594
 [78,]    6.7291575 10.334422  -13.4050191  27.6097717
 [79,]   -0.5862119 11.964264  -23.8266348  23.3426002
 [80,]   29.4265187 13.793676    2.9570089  57.2161051
 [81,]   -8.9708145 13.213102  -35.4706107  16.3871843
 [82,]   23.6028622 11.248496    1.3243478  44.7459584
 [83,]    4.3811388  9.567759  -14.3594320  22.6838768
 [84,]   20.9273154  8.344227    4.4210027  37.1586488
 [85,]    1.8118921  7.796216  -13.5464083  17.0961238
 [86,]    5.2309687  8.062668  -10.7048207  21.2617966
 [87,]   -3.7181546  9.072099  -21.6265237  14.4786827
 [88,]  -13.6246780 10.614618  -34.5448775   7.0207151
 [89,]  -12.9468014 12.494319  -37.1743827  11.3567171
 [90,]  -11.2195247 14.581381  -39.2851454  16.7130190
 [91,]   26.8429320 13.037303    1.5516262  52.2021351
 [92,]    9.0760269 11.164217  -12.6986169  30.7358728
 [93,]  -32.3246782  9.575386  -51.5112134 -13.7025635
 [94,]    2.9802167  8.433035  -13.9126826  19.3500359
 [95,]    3.3843116  7.932462  -12.3145768  18.7212145
 [96,]   10.2843065  8.192169   -6.3150853  26.3421362
 [97,]    3.4998013  9.147628  -14.7420419  21.7944952
 [98,]   -3.2741038 10.612557  -24.1021483  17.5836600
 [99,]   16.6917911 12.407798   -7.9772197  41.4415456
[100,]    0.5380860 14.410424  -27.9242750  28.8937546
[101,]    9.6448048 12.824390  -15.0204718  35.8036050
[102,]   -7.7207402 11.028743  -28.7687052  14.5451125
[103,]  -10.6908851  9.501595  -29.1055302   8.2459504
[104,]   -6.2735300  8.390853  -22.5128525  10.6668637
[105,]  -22.0642750  7.874737  -37.5817989  -6.5750651
[106,]  -14.5792199  8.068178  -30.7227374   1.6728592
[107,]  -14.3678648  8.925160  -31.8798143   3.5340796
[108,]    0.5902902 10.281072  -20.1605700  21.2320513
[109,]   17.1898453 11.967512   -6.7021083  40.5880892
[110,]   20.9753004 13.864387   -6.5269943  47.7161607
[111,]   17.6201630 13.086942   -7.2966645  43.9799482
[112,]  -12.2407490 11.196764  -33.8412075  10.1979698
[113,]  -16.5088610  9.588591  -34.8352719   2.4159895
[114,]  -34.2047730  8.425481  -51.0096054 -17.6937749
[115,]  -37.8337850  7.906356  -53.3484499 -22.2090998
[116,]    5.9560030  8.155139  -10.0229664  22.1215040
[117,]   38.6573910  9.109129   20.7696613  56.5779886
[118,]    5.1128790 10.579236  -15.0310149  26.3430083
[119,]   19.6632670 12.382986   -4.3909528  44.3768801
[120,]   -2.7896450 14.395505  -30.8251809  25.6798551
[121,]   -5.1982764 12.415389  -29.5695292  18.6764498
[122,]   36.8516547 10.669010   15.6945383  57.5919260
[123,]   -0.7932141  9.203661  -18.8302434  17.2416758
[124,]    2.4208170  8.171946  -13.8959623  18.8017117
[125,]  -13.8220519  7.749048  -29.3029251   1.5498694
[126,]   11.5029792  8.031718   -4.6955167  27.6302472
[127,]  -12.8651896  8.953377  -30.4843009   4.7401006
[128,]  -41.4974585 10.344619  -62.2074052 -20.5192908
[129,]    5.9676726 12.043797  -17.7001067  30.1930946
[130,]   24.5102037 13.938746   -2.6873626  52.5186460
[131,]  -50.3389399 12.575399  -75.3683951 -26.1145861
[132,]   12.1716859 10.869626   -9.5535148  33.2606856
[133,]   26.8501118  9.461439    8.3995594  45.1453188
[134,]   32.8209376  8.500050   16.1612486  49.5103634
[135,]   20.6994634  8.145232    4.7831091  36.8257383
[136,]   10.7817893  8.473530   -6.0083903  27.4362262
[137,]   -1.6264849  9.413744  -20.2539403  16.8365540
[138,]   -9.6266590 10.807330  -31.0204988  11.6178438
[139,]   -8.4248332 12.503605  -33.2257886  16.2148009
[140,]   -9.5299074 14.395966  -37.5354670  18.3707556
[141,]   16.9147937 12.547636   -7.7325166  41.2277388
[142,]    2.0889289 10.778723  -19.0589257  22.8949522
[143,]  -20.4448359  9.301051  -38.3937419  -2.5044613
[144,]  -11.3699008  8.272194  -27.1796529   4.5032335
[145,]   14.4564344  7.870185   -0.9033121  29.7624585
[146,]    5.5084696  8.187881  -10.5907210  21.6534138
[147,]  -24.9089953  9.150626  -42.7485099  -6.6799297
[148,]   13.7393399 10.583831   -6.8599420  34.8205383
[149,]   -5.4428249 12.324446  -29.5288456  18.9710971
[150,]    9.4510102 14.260345  -18.4882770  37.6046093
[151,]   -0.9839853 13.505295  -26.3161323  26.3268579
[152,]   -6.9781808 11.536361  -28.5366116  16.1139411
[153,]  -17.8545763  9.850485  -36.5065658   1.6463284
[154,]  -31.5360719  8.615466  -48.3965001 -15.0631390
[155,]  -19.7254674  8.041781  -35.3944122  -4.1810776
[156,]   41.6772371  8.268252   25.4476710  57.4863801
[157,]  -36.6220584  9.236207  -54.2693524 -19.1074617
[158,]   14.5616461 10.747131   -6.0916788  35.0915437
[159,]   16.8854505 12.607296   -7.4585371  40.7130156
[160,]    8.6975550 14.684576  -20.2282393  36.5829900
[161,]   17.8772002 12.043053   -6.0289860  41.3173147
[162,]   10.9534868 10.348165   -9.5698204  31.1761055
[163,]    6.9234734  8.945224  -10.7652356  24.4074764
[164,]    1.3279600  7.989537  -14.0793024  16.7233320
[165,]  -10.7771534  7.650588  -25.6201518   4.2669866
[166,]  -14.9217668  8.007086  -30.1562218   0.8911385
[167,]  -49.6540801  8.976553  -67.1010109 -31.9065784
[168,]  -13.7753935 10.388778  -34.0315684   7.0392144
[169,]   22.8885931 12.089585   -0.1726416  47.1040880
[170,]   32.0909797 13.973995    4.8862706  60.5198668
[171,]    5.8491889 11.834538  -17.7066146  28.9115108
[172,]   -1.8786206 10.178498  -22.1230381  17.9946045
[173,]   10.4540698  8.815906   -6.8199604  27.7336988
[174,]   11.6987602  7.900092   -3.8580123  27.3683717
[175,]  -23.5503494  7.594443  -38.4742479  -8.3685570
[176,]    7.0945410  7.969475   -8.4397718  22.8413234
[177,]    0.1786314  8.939931  -17.4833003  17.6199070
[178,]   -2.8733782 10.339491  -23.0527632  17.1695260
[179,]   11.2583123 12.019177  -12.0959963  34.6284584
[180,]   -5.5498973 13.877646  -32.4826813  21.3284854</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.4  3.3
looic      1769.6 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1303      
 (0.5, 0.7]   (ok)         2    1.1%   151       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.6
p_loo        34.5  8.7
looic      1722.6 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   689       
 (0.5, 0.7]   (ok)         3    1.7%   610       
   (0.7, 1]   (bad)        3    1.7%   16        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.5      11.9  
fit_sleep1 -92.0      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.4  3.3
looic      1769.6 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1303      
 (0.5, 0.7]   (ok)         2    1.1%   151       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.6
p_loo        34.5  8.7
looic      1722.6 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   689       
 (0.5, 0.7]   (ok)         3    1.7%   610       
   (0.7, 1]   (bad)        3    1.7%   16        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.3     22.6        34.5    8.7   1722.6
fit_sleep2  -23.5      11.9  -884.8     14.4        19.4    3.3   1769.6
fit_sleep1  -92.0      21.2  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   45.2  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.113746e-40 5.996885e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.64     0.19     5.45       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.64    -3.43     2.87       5.47      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.15      
[4] StanHeaders_2.26.15 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.13.0          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.4.0      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.0         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.9        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
