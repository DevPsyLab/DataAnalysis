<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.81      6.67    15.58    42.02 1.00     2169     2475
sd(Days)                6.52      1.50     4.18    10.09 1.00     1616     1864
cor(Intercept,Days)     0.10      0.30    -0.46     0.67 1.00     1008     1696

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.07      7.34   236.61   265.50 1.00     2111     2628
Days         10.44      1.71     7.18    13.82 1.00     1453     1863

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.56    23.12    29.20 1.00     4524     3343

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0887  12.96521 227.6860 278.8884
309 211.7363  13.60955 184.5680 238.4975
310 212.7702  13.07558 186.6987 238.3021
330 274.1761  13.47498 248.2084 300.8873
331 273.1019  12.88045 249.1842 299.5064
332 260.1685  12.24924 236.2113 284.9103
333 267.8877  12.84400 243.0335 294.7839
334 244.3138  12.38842 219.9056 268.1371
335 250.3553  13.26399 225.5334 277.0588
337 286.1392  13.47813 259.7915 312.4934
349 226.9613  13.04508 200.6460 251.8629
350 238.8180  13.55464 212.0977 264.4331
351 255.8091  12.53495 231.8417 280.9339
352 271.8967  12.48939 247.7956 297.1773
369 254.3714  12.21881 230.0380 278.2773
370 226.4051  13.81177 199.4381 252.6754
371 252.1212  12.14424 228.1773 276.4773
372 263.5179  12.10067 239.8381 287.4632

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6095712  2.472357 15.0207953 24.432928
309  1.7198575  2.552974 -3.2740205  6.735013
310  4.9715919  2.502607  0.0148349 10.077748
330  5.7976786  2.565872  0.6265074 10.708295
331  7.4771394  2.451218  2.4231892 12.189455
332 10.2233721  2.351689  5.6878455 14.937091
333 10.2976239  2.427141  5.6912120 15.007084
334 11.5263464  2.352687  6.9269397 16.079032
335 -0.1652855  2.564907 -5.3090007  4.674862
337 19.1228955  2.498304 14.2927117 24.033231
349 11.4931739  2.501760  6.7755417 16.489331
350 17.0030969  2.536840 12.2466785 22.060476
351  7.4526263  2.381219  2.7687549 12.124441
352 14.0839994  2.377695  9.2698832 18.722003
369 11.3737835  2.358002  6.7334751 16.084747
370 15.1315766  2.617458 10.1776478 20.385039
371  9.4375800  2.350426  4.7162342 14.043976
372 11.7638570  2.321600  7.1083343 16.264887</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0887 12.965211 227.6860 278.8884
  [2,] 273.6983 11.109487 251.5131 295.0094
  [3,] 293.3078  9.537810 274.2414 311.8025
  [4,] 312.9174  8.410947 296.5466 329.4626
  [5,] 332.5270  7.921070 317.0171 347.9648
  [6,] 352.1365  8.183384 336.1832 367.9384
  [7,] 371.7461  9.133306 353.6694 389.3877
  [8,] 391.3557 10.587346 370.1202 411.8683
  [9,] 410.9653 12.368978 386.3431 435.2800
 [10,] 430.5748 14.356756 402.6332 458.6117
 [11,] 211.7363 13.609546 184.5680 238.4975
 [12,] 213.4562 11.655078 190.3193 236.3473
 [13,] 215.1760  9.974834 195.8101 234.6832
 [14,] 216.8959  8.728638 199.9870 234.4444
 [15,] 218.6157  8.118885 202.8134 234.4629
 [16,] 220.3356  8.287268 204.2232 236.8916
 [17,] 222.0554  9.191120 203.9359 240.4397
 [18,] 223.7753 10.644713 202.9758 245.0050
 [19,] 225.4952 12.457066 201.0130 249.8457
 [20,] 227.2150 14.494220 198.7470 254.8640
 [21,] 212.7702 13.075579 186.6987 238.3021
 [22,] 217.7418 11.183362 195.4419 239.3728
 [23,] 222.7133  9.575515 203.9402 241.6683
 [24,] 227.6849  8.416618 211.5804 244.0379
 [25,] 232.6565  7.906613 217.4470 248.2004
 [26,] 237.6281  8.167966 221.5160 253.6366
 [27,] 242.5997  9.134709 224.9782 260.3929
 [28,] 247.5713 10.615847 226.9572 268.4801
 [29,] 252.5429 12.428821 228.2948 277.0488
 [30,] 257.5145 14.449259 229.0778 286.1732
 [31,] 274.1761 13.474979 248.2084 300.8873
 [32,] 279.9738 11.500522 257.4179 302.6910
 [33,] 285.7715  9.803894 266.2820 305.0433
 [34,] 291.5692  8.552081 274.6791 308.2061
 [35,] 297.3668  7.957842 281.4916 312.7615
 [36,] 303.1645  8.166015 286.6898 319.0978
 [37,] 308.9622  9.121828 291.0511 327.1753
 [38,] 314.7599 10.625399 294.0369 335.7723
 [39,] 320.5576 12.480299 295.9356 345.1123
 [40,] 326.3552 14.552801 297.2192 354.9036
 [41,] 273.1019 12.880449 249.1842 299.5064
 [42,] 280.5791 11.027662 259.8311 303.3896
 [43,] 288.0562  9.451437 270.0929 307.0058
 [44,] 295.5333  8.310650 279.6785 311.8175
 [45,] 303.0105  7.798788 287.9403 318.0177
 [46,] 310.4876  8.036929 294.7956 326.1284
 [47,] 317.9648  8.965506 300.4100 335.4000
 [48,] 325.4419 10.401217 305.3331 345.9371
 [49,] 332.9190 12.165824 309.0168 356.7391
 [50,] 340.3962 14.136696 312.7675 368.1428
 [51,] 260.1685 12.249244 236.2113 284.9103
 [52,] 270.3919 10.530498 250.0655 291.7355
 [53,] 280.6152  9.099434 263.4956 299.0197
 [54,] 290.8386  8.109802 275.5446 306.9885
 [55,] 301.0620  7.732978 285.9632 316.5918
 [56,] 311.2854  8.055427 295.1338 327.3282
 [57,] 321.5087  9.002317 303.5025 339.5438
 [58,] 331.7321 10.404539 311.4967 352.5597
 [59,] 341.9555 12.104875 318.1706 366.1057
 [60,] 352.1789 13.995087 324.4099 380.1197
 [61,] 267.8877 12.843997 243.0335 294.7839
 [62,] 278.1854 11.028579 256.9038 301.1042
 [63,] 288.4830  9.490673 270.1667 308.1204
 [64,] 298.7806  8.384404 282.4027 315.6518
 [65,] 309.0782  7.893391 294.0088 324.4837
 [66,] 319.3758  8.129885 303.5629 334.7117
 [67,] 329.6735  9.036951 311.7003 346.9000
 [68,] 339.9711 10.441262 319.3968 359.9762
 [69,] 350.2687 12.171913 326.0308 373.8269
 [70,] 360.5663 14.109323 332.3681 387.8525
 [71,] 244.3138 12.388424 219.9056 268.1371
 [72,] 255.8402 10.655230 235.2447 276.3087
 [73,] 267.3665  9.201361 249.6129 285.1474
 [74,] 278.8929  8.177191 263.0495 294.5096
 [75,] 290.4192  7.754878 275.3715 305.1955
 [76,] 301.9456  8.029949 286.0388 317.6643
 [77,] 313.4719  8.938249 296.2032 330.8151
 [78,] 324.9983 10.313815 304.8604 344.8423
 [79,] 336.5246 11.996980 313.4362 359.8402
 [80,] 348.0510 13.876259 321.2174 374.9591
 [81,] 250.3553 13.263995 225.5334 277.0588
 [82,] 250.1900 11.300829 228.5092 272.5931
 [83,] 250.0247  9.625042 231.4128 268.6873
 [84,] 249.8594  8.410208 233.3898 265.8354
 [85,] 249.6941  7.872692 233.9390 264.4937
 [86,] 249.5288  8.147665 233.5645 265.1367
 [87,] 249.3636  9.162266 231.7484 266.9051
 [88,] 249.1983 10.708281 228.1477 269.5481
 [89,] 249.0330 12.591463 224.2798 272.8967
 [90,] 248.8677 14.682646 220.3822 276.7190
 [91,] 286.1392 13.478128 259.7915 312.4934
 [92,] 305.2621 11.545922 282.5621 327.6719
 [93,] 324.3850  9.871156 304.8608 343.5103
 [94,] 343.5079  8.605475 326.8244 360.3461
 [95,] 362.6308  7.946805 347.3447 378.2975
 [96,] 381.7537  8.045637 366.2329 397.6676
 [97,] 400.8766  8.876705 383.8151 418.3496
 [98,] 419.9995 10.263653 400.0967 440.5428
 [99,] 439.1223 12.015502 415.6508 463.0709
[100,] 458.2452 13.995894 430.7922 485.9998
[101,] 226.9613 13.045082 200.6460 251.8629
[102,] 238.4545 11.156798 216.2898 259.9829
[103,] 249.9477  9.554669 231.0275 268.2900
[104,] 261.4408  8.403979 245.1422 277.9503
[105,] 272.9340  7.904407 257.3984 288.4438
[106,] 284.4272  8.176187 268.3019 300.1527
[107,] 295.9204  9.150849 277.7992 313.7112
[108,] 307.4135 10.636899 286.0863 328.1227
[109,] 318.9067 12.452584 294.1933 343.1959
[110,] 330.3999 14.474379 302.1404 358.7567
[111,] 238.8180 13.554645 212.0977 264.4331
[112,] 255.8211 11.611404 233.3765 278.0468
[113,] 272.8242  9.939422 253.7909 292.0383
[114,] 289.8273  8.696588 273.0861 306.5801
[115,] 306.8304  8.083333 290.4951 322.3070
[116,] 323.8335  8.241421 307.0354 339.6381
[117,] 340.8366  9.130875 322.3060 358.1226
[118,] 357.8397 10.568625 336.6662 377.9315
[119,] 374.8428 12.364866 350.3172 398.9515
[120,] 391.8459 14.385934 363.4670 419.9945
[121,] 255.8091 12.534948 231.8417 280.9339
[122,] 263.2617 10.785519 242.9694 284.7727
[123,] 270.7144  9.320426 252.7706 289.0235
[124,] 278.1670  8.291783 261.7394 294.2590
[125,] 285.6196  7.872572 270.3759 301.0289
[126,] 293.0722  8.157298 277.1619 309.0661
[127,] 300.5249  9.079981 282.5979 318.1462
[128,] 307.9775 10.473347 287.6539 328.2134
[129,] 315.4301 12.176878 292.0178 339.0548
[130,] 322.8828 14.078428 295.9578 350.4553
[131,] 271.8967 12.489392 247.7956 297.1773
[132,] 285.9807 10.773469 264.9850 307.3468
[133,] 300.0647  9.351857 281.6997 318.6026
[134,] 314.1487  8.375781 297.6815 330.5171
[135,] 328.2327  8.009809 312.2478 344.3168
[136,] 342.3167  8.334702 326.3803 359.1380
[137,] 356.4007  9.278164 338.9507 375.0729
[138,] 370.4847 10.677466 349.9925 392.0669
[139,] 384.5687 12.378978 360.6536 409.4413
[140,] 398.6527 14.275041 371.1326 426.9139
[141,] 254.3714 12.218812 230.0380 278.2773
[142,] 265.7452 10.492754 245.0363 286.2137
[143,] 277.1190  9.056311 259.2234 294.9528
[144,] 288.4928  8.065730 272.5311 304.5329
[145,] 299.8666  7.695166 284.8920 315.0516
[146,] 311.2404  8.030910 295.7059 327.0655
[147,] 322.6141  8.994208 304.9899 340.4035
[148,] 333.9879 10.412320 313.6473 354.6549
[149,] 345.3617 12.126722 321.8233 369.5843
[150,] 356.7355 14.029209 329.4963 384.6475
[151,] 226.4051 13.811770 199.4381 252.6754
[152,] 241.5366 11.780216 218.2937 264.2415
[153,] 256.6682 10.024180 237.0580 276.1556
[154,] 271.7998  8.711891 254.8310 288.7692
[155,] 286.9314  8.063007 270.9731 302.5587
[156,] 302.0629  8.235854 286.4357 318.1016
[157,] 317.1945  9.184153 299.4537 335.0433
[158,] 332.3261 10.703748 311.1257 353.5076
[159,] 347.4577 12.589438 322.3296 372.3734
[160,] 362.5893 14.701015 333.4903 391.7333
[161,] 252.1212 12.144241 228.1773 276.4773
[162,] 261.5588 10.448912 241.2424 282.4331
[163,] 270.9964  9.051295 253.1098 288.9205
[164,] 280.4339  8.106857 264.7052 296.3812
[165,] 289.8715  7.782373 274.6079 304.9721
[166,] 299.3091  8.152210 283.5062 315.2480
[167,] 308.7467  9.132401 291.2593 326.6354
[168,] 318.1843 10.554240 298.0094 338.7560
[169,] 327.6218 12.265081 303.8654 351.6435
[170,] 337.0594 14.160560 309.1475 364.7098
[171,] 263.5179 12.100669 239.8381 287.4632
[172,] 275.2818 10.428934 254.7180 295.7238
[173,] 287.0456  9.048691 269.1795 304.5445
[174,] 298.8095  8.110154 282.8381 314.4315
[175,] 310.5733  7.774962 295.3247 325.7692
[176,] 322.3372  8.118197 306.2416 338.1204
[177,] 334.1011  9.063105 315.8715 351.7358
[178,] 345.8649 10.447692 324.7255 365.7614
[179,] 357.6288 12.122224 332.8659 380.9283
[180,] 369.3926 13.982918 340.9412 396.1135</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5      Q97.5
  [1,]   -4.5286811 12.965211  -29.3283965  21.873980
  [2,]  -14.9935523 11.109487  -36.3046783   7.191569
  [3,]  -42.5072235  9.537810  -61.0019247 -23.440840
  [4,]    8.5224053  8.410947   -8.0228497  24.893225
  [5,]   24.3249340  7.921070    8.8870593  39.834816
  [6,]   62.5535628  8.183384   46.7517483  78.506888
  [7,]   10.4576916  9.133306   -7.1839054  28.534442
  [8,] -101.2070796 10.587346 -121.7196943 -79.971551
  [9,]   19.6200492 12.368978   -4.6946962  44.242174
 [10,]   35.7786779 14.356756    7.7418093  63.720299
 [11,]   10.9975959 13.609546  -15.7636279  38.165912
 [12,]   -8.1903615 11.655078  -31.0814758  14.946526
 [13,]  -12.1982190  9.974834  -31.7053937   7.167747
 [14,]  -12.1888764  8.728638  -29.7373785   4.719992
 [15,]  -10.8996339  8.118885  -26.7467675   4.902689
 [16,]   -4.3737913  8.287268  -20.9297510  11.738610
 [17,]   -8.4251488  9.191120  -26.8094444   9.694412
 [18,]   -6.0481062 10.644713  -27.2778328  14.751365
 [19,]   -1.1994637 12.457066  -25.5499757  23.282685
 [20,]   10.0991789 14.494220  -17.5497922  38.567162
 [21,]  -13.7162662 13.075579  -39.2482271  12.355169
 [22,]  -23.4095581 11.183362  -45.0406023  -1.109749
 [23,]   11.6066500  9.575515   -7.3482828  30.379753
 [24,]    5.1566582  8.416618  -11.1962801  21.261220
 [25,]   -3.3491337  7.906613  -18.8929667  11.860388
 [26,]  -17.1702255  8.167966  -33.1786795  -1.058095
 [27,]   -7.1789174  9.134709  -24.9721183  10.442616
 [28,]    8.1797907 10.615847  -12.7289699  28.793884
 [29,]    8.4695989 12.428821  -16.0362967  32.717656
 [30,]   -9.9991930 14.449259  -38.6579016  18.437545
 [31,]   47.3664776 13.474979   20.6552652  73.334246
 [32,]   20.4263990 11.500522   -2.2907599  42.982312
 [33,]   -1.9149796  9.803894  -21.1868315  17.574531
 [34,]   -6.4361581  8.552081  -23.0730929  10.453895
 [35,]  -11.5695367  7.957842  -26.9641513   4.305742
 [36,]   -5.5790153  8.166015  -21.5123153  10.895660
 [37,]  -28.7225939  9.121828  -46.9356650 -10.811464
 [38,]    3.5014276 10.625399  -17.5110016  24.224385
 [39,]  -15.2080510 12.480299  -39.7627786   9.413898
 [40,]   27.6934704 14.552801   -0.8548584  56.829529
 [41,]   14.5059837 12.880449  -11.8984938  38.423665
 [42,]    4.4209443 11.027662  -18.3895628  25.168915
 [43,]   13.7644049  9.451437   -5.1852456  31.727722
 [44,]   24.5819655  8.310650    8.2978158  40.436811
 [45,]   13.2668261  7.798788   -1.7404031  28.337043
 [46,]  -17.1689132  8.036929  -32.8097415  -1.476899
 [47,]  -27.8897526  8.965506  -45.3249803 -10.335024
 [48,]    9.3758080 10.401217  -11.1194205  29.484589
 [49,]  -39.1721314 12.165824  -62.9922217 -15.269907
 [50,]   31.1849292 14.136696    3.4383424  58.813568
 [51,]  -25.3079014 12.249244  -50.0497014  -1.350676
 [52,]  -27.5800735 10.530498  -48.9237268  -7.253680
 [53,]   -7.6539456  9.099434  -26.0583770   9.465669
 [54,]   18.9301823  8.109802    2.7802895  34.224215
 [55,]   16.4009103  7.732978    0.8710927  31.499735
 [56,]   -1.2877618  8.055427  -17.3305641  14.863804
 [57,]  132.6531661  9.002317  114.6180548 150.659356
 [58,]   15.0989941 10.404539   -5.7286146  35.334382
 [59,]  -11.6551780 12.104875  -35.8053516  12.129707
 [60,]  -98.3144501 13.995087 -126.2552569 -70.545465
 [61,]   15.9546737 12.843997  -10.9415313  40.808894
 [62,]   11.3696498 11.028579  -11.5492464  32.651223
 [63,]  -11.7136740  9.490673  -31.3511020   6.602637
 [64,]    1.0291021  8.384404  -15.8421418  17.406977
 [65,]  -11.9072218  7.893391  -27.3127348   3.162227
 [66,]   18.7906544  8.129885    3.4547611  34.603568
 [67,]    2.3530305  9.036951  -14.8735067  20.326156
 [68,]    8.8688066 10.441262  -11.1363359  29.443102
 [69,]  -16.9087172 12.171913  -40.4669126   7.329196
 [70,]    1.4764589 14.109323  -25.8096874  29.674666
 [71,]   21.1592659 12.388424   -2.6640109  45.567458
 [72,]   20.3610195 10.655230   -0.1074784  40.956526
 [73,]  -24.0018269  9.201361  -41.7827402  -6.248241
 [74,]  -24.2205733  8.177191  -39.8373085  -8.377183
 [75,]  -11.3948196  7.754878  -26.1711425   3.652915
 [76,]  -17.7543660  8.029949  -33.4730542  -1.847567
 [77,]   -7.9471124  8.938249  -25.2902842   9.321647
 [78,]    6.5246413 10.313815  -13.3194277  26.662531
 [79,]   -0.7777051 11.996980  -24.0933004  22.310689
 [80,]   29.2480485 13.876259    2.3398523  56.081634
 [81,]   -8.7469753 13.263995  -35.4504968  16.074941
 [82,]   23.7572102 11.300829    1.3541097  45.438022
 [83,]    4.4659957  9.625042  -14.1965545  23.077937
 [84,]   20.9426812  8.410208    4.9666904  37.412259
 [85,]    1.7577667  7.872692  -13.0418248  17.512924
 [86,]    5.1073523  8.147665  -10.5005237  21.071680
 [87,]   -3.9112622  9.162266  -21.4527887  13.703932
 [88,]  -13.8872767 10.708281  -34.2370956   7.163296
 [89,]  -13.2788912 12.591463  -37.1426358  11.474328
 [90,]  -11.6211057 14.682646  -39.4724039  16.864397
 [91,]   26.2274174 13.478128   -0.1267956  52.575081
 [92,]    8.5437220 11.545922  -13.8661091  31.243662
 [93,]  -32.7737735  9.871156  -51.8990610 -13.249558
 [94,]    2.6143310  8.605475  -14.2239372  19.297769
 [95,]    3.1016356  7.946805  -12.5651056  18.387674
 [96,]   10.0848401  8.045637   -5.8290510  25.605638
 [97,]    3.3835446  8.876705  -14.0895168  20.445011
 [98,]   -3.3071508 10.263653  -23.8504882  16.595569
 [99,]   16.7419537 12.015502   -7.2066120  40.213468
[100,]    0.6714582 13.995894  -27.0831232  28.124501
[101,]    9.1418804 13.045082  -15.7596658  35.457166
[102,]   -8.1377935 11.156798  -29.6662489  14.026920
[103,]  -11.0220674  9.554669  -29.3644196   7.898099
[104,]   -6.5188413  8.403979  -23.0283266   9.779828
[105,]  -22.2237152  7.904407  -37.7334687  -6.688087
[106,]  -14.6527891  8.176187  -30.3783272   1.472493
[107,]  -14.3555630  9.150849  -32.1463694   3.765611
[108,]    0.6884631 10.636899  -20.0207249  22.015669
[109,]   17.3738892 12.452584   -6.9153417  42.087347
[110,]   21.2452153 14.474379   -7.1115659  49.504692
[111,]   17.4788103 13.554645   -8.1362654  44.199095
[112,]  -12.3667866 11.611404  -34.5924616  10.077771
[113,]  -16.6195836  9.939422  -35.8337215   2.413705
[114,]  -34.3001805  8.696588  -51.0529631 -17.559039
[115,]  -37.9138774  8.083333  -53.3904936 -21.578630
[116,]    5.8912256  8.241421   -9.9134308  22.689255
[117,]   38.6079287  9.130875   21.3219209  57.138508
[118,]    5.0787317 10.568625  -15.0131419  26.252214
[119,]   19.6444348 12.364866   -4.4643018  44.169974
[120,]   -2.7931621 14.385934  -30.9418040  25.585729
[121,]   -5.2826177 12.534948  -30.4074200  18.684768
[122,]   36.7958560 10.785519   15.2849376  57.088188
[123,]   -0.8204704  9.320426  -19.1296009  17.123346
[124,]    2.4221033  8.291783  -13.6699386  18.849740
[125,]  -13.7922230  7.872572  -29.2015346   1.451481
[126,]   11.5613507  8.157298   -4.4324872  27.471666
[127,]  -12.7782756  9.079981  -30.3996296   5.148685
[128,]  -41.3820020 10.473347  -61.6178767 -21.058430
[129,]    6.1116717 12.176878  -17.5130068  29.524002
[130,]   24.6827454 14.078428   -2.8897619  51.607660
[131,]  -50.2195600 12.489392  -75.5001590 -26.118518
[132,]   12.2132406 10.773469   -9.1529176  33.208877
[133,]   26.8138412  9.351857    8.2758628  45.178812
[134,]   32.7068419  8.375781   16.3383577  49.174017
[135,]   20.5075425  8.009809    4.4234419  36.492403
[136,]   10.5120432  8.334702   -6.3092826  26.448417
[137,]   -1.9740562  9.278164  -20.6462845  15.475860
[138,]  -10.0520555 10.677466  -31.6342786  10.440119
[139,]   -8.9280549 12.378978  -33.8007092  14.987010
[140,]  -10.1109542 14.275041  -38.3721963  17.409072
[141,]   17.5520513 12.218812   -6.3537781  41.885461
[142,]    2.6916678 10.492754  -17.7768247  23.400613
[143,]  -19.8766157  9.056311  -37.7104373  -1.980990
[144,]  -10.8361992  8.065730  -26.8762765   5.125495
[145,]   14.9556173  7.695166   -0.2293596  29.930192
[146,]    5.9731339  8.030910   -9.8520233  21.507626
[147,]  -24.4788496  8.994208  -42.2682474  -6.854566
[148,]   14.1349669 10.412320   -6.5320002  34.475552
[149,]   -5.0817166 12.126722  -29.3042959  18.456653
[150,]    9.7775999 14.029209  -18.1344156  37.016801
[151,]   -1.1410622 13.811770  -27.4114124  25.825862
[152,]   -7.0131388 11.780216  -29.7180166  16.229828
[153,]  -17.7674154 10.024180  -37.2548185   1.842768
[154,]  -31.3267920  8.711891  -48.2962465 -14.358048
[155,]  -19.3940686  8.063007  -35.0213986  -3.435833
[156,]   42.1307548  8.235854   26.0920875  57.757969
[157,]  -36.0464218  9.184153  -53.8952495 -18.305571
[158,]   15.2594016 10.703748   -5.9221141  36.459821
[159,]   17.7053250 12.589438   -7.2104131  42.833447
[160,]    9.6395484 14.701015  -19.5044645  38.738463
[161,]   17.7592009 12.144241   -6.5968928  41.703132
[162,]   10.8840210 10.448912   -9.9903337  31.200399
[163,]    6.9025410  9.051295  -11.0216155  24.789130
[164,]    1.3555611  8.106857  -14.5916761  17.084348
[165,]  -10.7010189  7.782373  -25.8015680   4.562560
[166,]  -14.7970989  8.152210  -30.7360090   1.005757
[167,]  -49.4808788  9.132401  -67.3696242 -31.993527
[168,]  -13.5536588 10.554240  -34.1254285   6.621195
[169,]   23.1588613 12.265081   -0.8627882  46.915295
[170,]   32.4097813 14.160560    4.7593966  60.321746
[171,]    5.8937899 12.100669  -18.0514771  29.573580
[172,]   -1.8077671 10.428934  -22.2497541  18.756015
[173,]   10.5511759  9.048691   -6.9476523  28.417349
[174,]   11.8221189  8.110154   -3.7998667  27.793503
[175,]  -23.4007381  7.774962  -38.5966077  -8.152111
[176,]    7.2704049  8.118197   -8.5128099  23.366010
[177,]    0.3807479  9.063105  -17.2539970  18.610275
[178,]   -2.6450091 10.447692  -22.5414959  18.494365
[179,]   11.5129339 12.122224  -11.7865764  36.275777
[180,]   -5.2690232 13.982918  -31.9898706  23.182384</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.3  3.4
looic      1769.8 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   649       
 (0.5, 0.7]   (ok)         1    0.6%   4797      
   (0.7, 1]   (bad)        1    0.6%   129       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.6
p_loo        34.4  8.6
looic      1723.4 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   938       
 (0.5, 0.7]   (ok)         5    2.8%   526       
   (0.7, 1]   (bad)        2    1.1%   32        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.2      11.8  
fit_sleep1 -91.5      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.3  3.4
looic      1769.8 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   649       
 (0.5, 0.7]   (ok)         1    0.6%   4797      
   (0.7, 1]   (bad)        1    0.6%   129       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.6
p_loo        34.4  8.6
looic      1723.4 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   938       
 (0.5, 0.7]   (ok)         5    2.8%   526       
   (0.7, 1]   (bad)        2    1.1%   32        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.7     22.6        34.4    8.6   1723.4
fit_sleep2  -23.2      11.8  -884.9     14.4        19.3    3.4   1769.8
fit_sleep1  -91.5      21.2  -953.2     10.5         3.1    0.5   1906.4
           se_looic
fit_sleep3   45.2  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.829319e-40 8.355947e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9      1.59     0.32     5.54       0.04      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1      1.59    -3.21     2.99       5.38      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.5.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.19      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.6.0   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.19        V8_4.2.2            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.7         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
