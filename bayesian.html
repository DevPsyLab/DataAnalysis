<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.86      6.76    15.49    42.29 1.00     1551     2688
sd(Days)                6.62      1.61     4.13    10.52 1.00     1199     1332
cor(Intercept,Days)     0.08      0.31    -0.50     0.68 1.00      843     1471

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.27      7.54   236.62   266.75 1.00     1732     1595
Days         10.48      1.81     6.97    14.04 1.00     1224     1314

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.52    23.09    29.14 1.00     4092     3146

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7876  13.31355 227.6815 279.3870
309 211.2285  13.32792 185.0748 236.8417
310 213.3126  13.31402 185.7861 238.3559
330 274.6872  13.34875 249.1082 301.4227
331 273.2791  12.94142 248.9676 299.5632
332 260.2459  12.55914 235.4960 286.0391
333 268.1185  12.75929 243.8130 293.0220
334 244.6367  12.48176 219.4760 267.9864
335 250.3437  13.41521 224.4475 276.6478
337 286.0699  12.99391 260.9239 312.5772
349 226.5279  13.15842 200.0349 251.3117
350 238.7178  13.18377 212.5336 264.2947
351 255.8158  12.32332 231.9454 280.7333
352 271.9269  12.50661 247.0003 296.9976
369 254.2001  12.45005 230.1637 279.5899
370 226.5111  13.51283 199.3948 252.9245
371 252.2007  12.30935 228.5220 276.3189
372 263.5896  12.09117 239.7670 287.9202

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6452648  2.521559 14.69905947 24.648429
309  1.7542522  2.505764 -3.27169297  6.569020
310  4.8918607  2.515854 -0.04877417  9.908275
330  5.7218819  2.523551  0.65333467 10.425484
331  7.4770677  2.470761  2.53381098 12.105759
332 10.2154703  2.358383  5.60937942 14.695159
333 10.2702218  2.422610  5.39100127 14.867514
334 11.4902130  2.379465  6.92772091 16.372774
335 -0.1819636  2.564692 -5.38272852  4.641524
337 19.1602492  2.471385 14.33516255 24.001538
349 11.5652264  2.506086  6.80185694 16.592423
350 17.0135328  2.554124 12.05482875 22.067386
351  7.4590256  2.364643  2.77398748 12.017009
352 14.0239642  2.385960  9.33092835 18.701677
369 11.4301860  2.439042  6.65605190 16.288963
370 15.2102091  2.560254 10.41544618 20.363526
371  9.4898783  2.316535  4.84488579 13.867257
372 11.8117418  2.319041  7.15841093 16.368239</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7876 13.313550 227.6815 279.3870
  [2,] 273.4329 11.394092 251.4022 295.3625
  [3,] 293.0781  9.752771 274.1504 312.0862
  [4,] 312.7234  8.551274 296.4597 329.0260
  [5,] 332.3687  7.990529 316.9299 347.5711
  [6,] 352.0139  8.203007 336.1169 367.9011
  [7,] 371.6592  9.134913 353.7308 389.6549
  [8,] 391.3045 10.598135 370.8279 412.4109
  [9,] 410.9497 12.406079 386.9535 435.6764
 [10,] 430.5950 14.429750 402.5669 459.0281
 [11,] 211.2285 13.327920 185.0748 236.8417
 [12,] 212.9828 11.434082 190.0034 234.8598
 [13,] 214.7370  9.818387 195.0741 233.6311
 [14,] 216.4913  8.638341 199.2438 233.1910
 [15,] 218.2455  8.086954 202.3254 233.6221
 [16,] 219.9998  8.290623 203.7181 235.6932
 [17,] 221.7541  9.199334 203.3908 239.1987
 [18,] 223.5083 10.633850 202.2078 244.1333
 [19,] 225.2626 12.413198 200.5359 249.5408
 [20,] 227.0168 14.410202 197.8835 255.1759
 [21,] 213.3126 13.314020 185.7861 238.3559
 [22,] 218.2044 11.403194 194.8444 239.3735
 [23,] 223.0963  9.770446 203.1852 241.3927
 [24,] 227.9882  8.576096 210.9052 244.2471
 [25,] 232.8800  8.018497 216.7037 248.0940
 [26,] 237.7719  8.228135 221.3184 253.7331
 [27,] 242.6638  9.152440 224.7549 260.3393
 [28,] 247.5556 10.606185 226.8286 268.0740
 [29,] 252.4475 12.404605 227.8561 276.8452
 [30,] 257.3393 14.419304 229.2827 285.5835
 [31,] 274.6872 13.348745 249.1082 301.4227
 [32,] 280.4091 11.419464 258.4389 303.2629
 [33,] 286.1310  9.765035 267.3917 305.3274
 [34,] 291.8529  8.546596 275.1571 308.5384
 [35,] 297.5748  7.966762 281.7597 313.0082
 [36,] 303.2966  8.162775 286.7678 318.9359
 [37,] 309.0185  9.084554 291.0457 326.4713
 [38,] 314.7404 10.543433 294.1235 334.9808
 [39,] 320.4623 12.350523 296.5890 344.4902
 [40,] 326.1842 14.375100 298.1962 354.2854
 [41,] 273.2791 12.941416 248.9676 299.5632
 [42,] 280.7561 11.074608 259.4367 303.0421
 [43,] 288.2332  9.488042 270.0846 307.5174
 [44,] 295.7103  8.343157 279.4608 312.2112
 [45,] 303.1873  7.836001 287.6361 318.3790
 [46,] 310.6644  8.087451 294.7062 326.4225
 [47,] 318.1415  9.034387 300.2305 336.1238
 [48,] 325.6185 10.490127 305.2229 345.9152
 [49,] 333.0956 12.274962 308.7381 356.9311
 [50,] 340.5727 14.265901 311.9509 368.1717
 [51,] 260.2459 12.559136 235.4960 286.0391
 [52,] 270.4613 10.805062 249.4435 292.3291
 [53,] 280.6768  9.321523 262.3887 299.4249
 [54,] 290.8923  8.255673 274.8080 307.3458
 [55,] 301.1077  7.781095 285.8813 316.5416
 [56,] 311.3232  8.003665 295.7220 326.8650
 [57,] 321.5387  8.871067 303.8923 338.4190
 [58,] 331.7542 10.220417 311.6133 351.3087
 [59,] 341.9696 11.888733 318.3903 364.8751
 [60,] 352.1851 13.760485 325.4290 378.8217
 [61,] 268.1185 12.759286 243.8130 293.0220
 [62,] 278.3888 10.980950 257.6059 299.7644
 [63,] 288.6590  9.492165 270.5425 306.9179
 [64,] 298.9292  8.447439 282.3810 315.3014
 [65,] 309.1994  8.022177 293.1369 324.8611
 [66,] 319.4696  8.312009 303.1640 335.7234
 [67,] 329.7399  9.249959 311.6276 347.8517
 [68,] 340.0101 10.666399 319.1758 360.8547
 [69,] 350.2803 12.398406 325.9812 374.6217
 [70,] 360.5505 14.332025 332.1086 388.7218
 [71,] 244.6367 12.481760 219.4760 267.9864
 [72,] 256.1269 10.707460 234.5974 276.2541
 [73,] 267.6171  9.210252 249.3282 285.0011
 [74,] 279.1073  8.144416 263.2690 295.0272
 [75,] 290.5975  7.691422 275.8297 305.8624
 [76,] 302.0877  7.956641 286.9145 318.1209
 [77,] 313.5779  8.875923 296.4908 331.2950
 [78,] 325.0682 10.275193 305.2493 345.4483
 [79,] 336.5584 11.987530 313.0301 360.2978
 [80,] 348.0486 13.897693 321.1955 376.0352
 [81,] 250.3437 13.415213 224.4475 276.6478
 [82,] 250.1618 11.448117 227.4876 272.4464
 [83,] 249.9798  9.762486 230.6393 268.9605
 [84,] 249.7978  8.526908 232.6963 266.2780
 [85,] 249.6159  7.953960 234.0608 265.0347
 [86,] 249.4339  8.184015 233.8156 265.4617
 [87,] 249.2519  9.156747 231.7786 267.3244
 [88,] 249.0700 10.670952 228.5533 269.9447
 [89,] 248.8880 12.531868 224.7029 273.1819
 [90,] 248.7061 14.607584 220.7000 276.9426
 [91,] 286.0699 12.993910 260.9239 312.5772
 [92,] 305.2302 11.153283 283.6033 327.6296
 [93,] 324.3904  9.600273 305.6782 344.0154
 [94,] 343.5507  8.494131 326.5724 360.6955
 [95,] 362.7109  8.021892 346.9977 378.6770
 [96,] 381.8712  8.292572 365.7434 398.3527
 [97,] 401.0314  9.241116 382.7670 419.1941
 [98,] 420.1917 10.688554 399.1284 440.9244
 [99,] 439.3519 12.462248 414.8708 463.3488
[100,] 458.5122 14.442492 430.4221 486.2787
[101,] 226.5279 13.158422 200.0349 251.3117
[102,] 238.0931 11.268397 215.6292 259.5070
[103,] 249.6583  9.662835 230.5990 268.4124
[104,] 261.2236  8.504407 244.6681 277.9189
[105,] 272.7888  7.990020 257.5402 288.6719
[106,] 284.3540  8.241167 268.5277 300.5587
[107,] 295.9192  9.195335 278.5034 313.8273
[108,] 307.4845 10.665480 287.2560 328.0164
[109,] 319.0497 12.470431 295.2689 343.2168
[110,] 330.6149 14.485572 302.5384 358.9392
[111,] 238.7178 13.183772 212.5336 264.2947
[112,] 255.7314 11.248645 233.4343 277.7023
[113,] 272.7449  9.607251 253.3297 291.5715
[114,] 289.7584  8.432890 273.0999 306.7639
[115,] 306.7720  7.935685 291.0594 322.7661
[116,] 323.7855  8.239154 307.4990 340.6020
[117,] 340.7990  9.264951 322.4286 359.6980
[118,] 357.8126 10.809351 336.2936 379.9583
[119,] 374.8261 12.684318 349.7858 400.2907
[120,] 391.8396 14.764446 362.7265 421.2723
[121,] 255.8158 12.323324 231.9454 280.7333
[122,] 263.2749 10.564515 242.7603 284.4011
[123,] 270.7339  9.084972 253.3308 289.1903
[124,] 278.1929  8.040369 263.0246 294.3726
[125,] 285.6519  7.611926 271.2688 300.4936
[126,] 293.1110  7.900530 277.7865 308.2837
[127,] 300.5700  8.836199 283.1540 318.1248
[128,] 308.0290 10.243121 288.1402 328.1946
[129,] 315.4880 11.956074 292.1353 339.3483
[130,] 322.9471 13.862069 295.8572 350.4432
[131,] 271.9269 12.506612 247.0003 296.9976
[132,] 285.9509 10.766881 264.8524 307.7741
[133,] 299.9749  9.317818 281.8677 318.5816
[134,] 313.9988  8.312842 297.4292 330.5072
[135,] 328.0228  7.922788 311.7436 343.5180
[136,] 342.0468  8.235497 325.2100 358.2428
[137,] 356.0707  9.179426 338.0046 373.8834
[138,] 370.0947 10.587063 348.7459 390.9463
[139,] 384.1187 12.300227 359.3255 408.7546
[140,] 398.1426 14.208831 369.7568 426.4219
[141,] 254.2001 12.450049 230.1637 279.5899
[142,] 265.6303 10.667291 244.8675 287.0845
[143,] 277.0604  9.191100 259.3657 295.2204
[144,] 288.4906  8.188981 272.3185 304.7848
[145,] 299.9208  7.844765 284.3149 315.5343
[146,] 311.3510  8.241306 294.5603 327.5485
[147,] 322.7812  9.284168 303.8591 341.1175
[148,] 334.2114 10.787505 312.4949 355.6346
[149,] 345.6416 12.587399 320.3710 370.7516
[150,] 357.0718 14.574389 327.4543 385.7539
[151,] 226.5111 13.512826 199.3948 252.9245
[152,] 241.7213 11.548983 219.0214 264.1126
[153,] 256.9315  9.862624 237.8336 276.3976
[154,] 272.1417  8.618208 255.7643 289.0091
[155,] 287.3520  8.024055 271.8787 303.0731
[156,] 302.5622  8.222360 286.7116 318.4425
[157,] 317.7724  9.161809 299.6576 335.4544
[158,] 332.9826 10.648009 311.9174 353.6498
[159,] 348.1928 12.487243 323.6722 372.8319
[160,] 363.4030 14.546208 335.3246 392.0097
[161,] 252.2007 12.309348 228.5220 276.3189
[162,] 261.6906 10.623767 241.0829 282.6896
[163,] 271.1804  9.216370 253.4185 289.4757
[164,] 280.6703  8.231112 264.8217 297.3947
[165,] 290.1602  7.829023 275.3146 306.0688
[166,] 299.6501  8.097449 284.2310 316.0439
[167,] 309.1400  8.976437 291.9039 326.4668
[168,] 318.6298 10.311006 298.3761 338.5942
[169,] 328.1197 11.949474 304.3728 351.4071
[170,] 337.6096 13.783893 309.7820 364.2284
[171,] 263.5896 12.091172 239.7670 287.9202
[172,] 275.4014 10.448210 254.8564 296.5363
[173,] 287.2131  9.104375 269.4346 305.1108
[174,] 299.0249  8.207930 282.6931 315.2949
[175,] 310.8366  7.912426 295.1646 326.6961
[176,] 322.6483  8.282436 306.6877 339.2430
[177,] 334.4601  9.238340 316.9151 352.9006
[178,] 346.2718 10.623135 325.8956 367.3093
[179,] 358.0836 12.292721 334.4996 382.5618
[180,] 369.8953 14.146620 342.7461 398.3637</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.22761427 13.313550  -29.82701851  21.8785248
  [2,]  -14.72817904 11.394092  -36.65781276   7.3024596
  [3,]  -42.27754381  9.752771  -61.28564151 -23.3498199
  [4,]    8.71639142  8.551274   -7.58616356  24.9801397
  [5,]   24.48322664  7.990529    9.28075014  39.9219916
  [6,]   62.67616187  8.203007   46.78897579  78.5731901
  [7,]   10.54459710  9.134913   -7.45109668  28.4729890
  [8,] -101.15586767 10.598135 -122.26232734 -80.6793356
  [9,]   19.63556755 12.406079   -5.09110227  43.6317537
 [10,]   35.75850278 14.429750    7.32535208  63.7865946
 [11,]   11.50536180 13.327920  -14.10780806  37.6590854
 [12,]   -7.71699040 11.434082  -29.59399162  15.2624060
 [13,]  -11.75924261  9.818387  -30.65327807   7.9037020
 [14,]  -11.78429482  8.638341  -28.48404719   5.4631605
 [15,]  -10.52944702  8.086954  -25.90603033   5.3906805
 [16,]   -4.03799923  8.290623  -19.73140487  12.2437204
 [17,]   -8.12375143  9.199334  -25.56842418  10.2395304
 [18,]   -5.78110364 10.633850  -26.40607719  15.5193966
 [19,]   -0.96685585 12.413198  -25.24506388  23.7597855
 [20,]   10.29739195 14.410202  -17.86171943  39.4306807
 [21,]  -14.25868789 13.314020  -39.30197557  13.2677835
 [22,]  -23.87224857 11.403194  -45.04126962  -0.5122154
 [23,]   11.22369075  9.770446   -7.07267726  31.1347973
 [24,]    4.85343007  8.576096  -11.40554943  21.9364035
 [25,]   -3.57263061  8.018497  -18.78656991  12.6036577
 [26,]  -17.31399128  8.228135  -33.27523285  -0.8605009
 [27,]   -7.24295196  9.152440  -24.91848592  10.6659223
 [28,]    8.19548736 10.606185  -12.32285876  28.9224565
 [29,]    8.56502668 12.404605  -15.83273505  33.1563994
 [30,]   -9.82403400 14.419304  -38.06823990  18.2326092
 [31,]   46.85537139 13.348745   20.11989184  72.4343637
 [32,]   19.99108953 11.419464   -2.86272149  41.9613060
 [33,]   -2.27449233  9.765035  -21.47089361  16.4648170
 [34,]   -6.71987418  8.546596  -23.40540910   9.9758609
 [35,]  -11.77745604  7.966762  -27.21085849   4.0375758
 [36,]   -5.71113790  8.162775  -21.35042968  10.8177124
 [37,]  -28.77891975  9.084554  -46.23168756 -10.8061149
 [38,]    3.52089839 10.543433  -16.71950183  24.1377665
 [39,]  -15.11278347 12.350523  -39.14068051   8.7604604
 [40,]   27.86453468 14.375100   -0.23668900  55.8525278
 [41,]   14.32882919 12.941416  -11.95527525  38.6402960
 [42,]    4.24386147 11.074608  -18.04210113  25.5633485
 [43,]   13.58739375  9.488042   -5.69677323  31.7359724
 [44,]   24.40502602  8.343157    7.90409053  40.6544909
 [45,]   13.08995830  7.836001   -2.10166353  28.6412258
 [46,]  -17.34570942  8.087451  -33.10377459  -1.3874619
 [47,]  -28.06647715  9.034387  -46.04879438 -10.1554833
 [48,]    9.19915513 10.490127  -11.09746823  29.5948410
 [49,]  -39.34871259 12.274962  -63.18415372 -14.9912270
 [50,]   31.00841968 14.265901    3.40939494  59.6302264
 [51,]  -25.38526300 12.559136  -51.17849616  -0.6353971
 [52,]  -27.64953334 10.805062  -49.51728727  -6.6316705
 [53,]   -7.71550368  9.321523  -26.46357737  10.5725846
 [54,]   18.87652598  8.255673    2.42296093  34.9607850
 [55,]   16.35515564  7.781095    0.92129170  31.5816053
 [56,]   -1.32561470  8.003665  -16.86744987  14.2755528
 [57,]  132.62321497  8.871067  115.74291665 150.2696149
 [58,]   15.07694463 10.220417   -4.47757211  35.2178148
 [59,]  -11.66932571 11.888733  -34.57484087  11.9100130
 [60,]  -98.32069605 13.760485 -124.95728187 -71.5646495
 [61,]   15.72387136 12.759286   -9.17961252  40.0294370
 [62,]   11.16624961 10.980950  -10.20935873  31.9491334
 [63,]  -11.88967215  9.492165  -30.14858490   6.2267835
 [64,]    0.88050609  8.447439  -15.49174606  17.4287301
 [65,]  -12.02841567  8.022177  -27.69009214   4.0340533
 [66,]   18.69686257  8.312009    2.44312290  35.0025248
 [67,]    2.28664082  9.249959  -15.82520734  20.3988868
 [68,]    8.82981906 10.666399  -12.01475928  29.6640641
 [69,]  -16.92030270 12.398406  -41.26166523   7.3787529
 [70,]    1.49227554 14.332025  -26.67903106  29.9341671
 [71,]   20.83643941 12.481760   -2.51329225  45.9971150
 [72,]   20.07432639 10.707460   -0.05291401  41.6037743
 [73,]  -24.25238662  9.210252  -41.63635528  -5.9634670
 [74,]  -24.43499964  8.144416  -40.35491276  -8.5966621
 [75,]  -11.57311265  7.691422  -26.83796710   3.1947010
 [76,]  -17.89652567  7.956641  -33.92967703  -2.7232863
 [77,]   -8.05313868  8.875923  -25.77018217   9.0340252
 [78,]    6.45474830 10.275193  -13.92541495  26.2735996
 [79,]   -0.81146471 11.987530  -24.55087238  22.7167617
 [80,]   29.25042227 13.897693    1.26377743  56.1035383
 [81,]   -8.73542607 13.415213  -35.03953340  17.1607579
 [82,]   23.78543749 11.448117    1.50079419  46.4596415
 [83,]    4.51090106  9.762486  -14.46981263  23.8514187
 [84,]   21.00426462  8.526908    4.52414795  38.1058000
 [85,]    1.83602819  7.953960  -13.58275288  17.3910582
 [86,]    5.20229175  8.184015  -10.82548353  20.8205866
 [87,]   -3.79964468  9.156747  -21.87205069  13.6736806
 [88,]  -13.75898112 10.670952  -34.63365016   6.7576724
 [89,]  -13.13391756 12.531868  -37.42778780  11.0511503
 [90,]  -11.45945399 14.607584  -39.69596423  16.5465596
 [91,]   26.29665790 12.993910   -0.21058501  51.4427261
 [92,]    8.57560873 11.153283  -13.82382975  30.2024550
 [93,]  -32.77924045  9.600273  -52.40424478 -14.0669628
 [94,]    2.57151038  8.494131  -14.57332422  19.5498209
 [95,]    3.02146120  8.021892  -12.94457587  18.7347334
 [96,]    9.96731203  8.292572   -6.51415832  26.0950948
 [97,]    3.22866286  9.241116  -14.93401848  21.4931352
 [98,]   -3.49938632 10.688554  -24.23206427  17.5638756
 [99,]   16.51236451 12.462248   -7.48453073  40.9934638
[100,]    0.40451533 14.442492  -27.36201263  28.4946378
[101,]    9.57531827 13.158422  -15.20852776  36.0682538
[102,]   -7.77640814 11.268397  -29.19031292  14.6874990
[103,]  -10.73273454  9.662835  -29.48682010   8.3266347
[104,]   -6.30156094  8.504407  -22.99694112  10.2538552
[105,]  -22.07848734  7.990020  -37.96160487  -6.8298631
[106,]  -14.57961374  8.241167  -30.78425089   1.2467266
[107,]  -14.35444014  9.195335  -32.26250890   3.0613855
[108,]    0.61753346 10.665480  -19.91442512  20.8460252
[109,]   17.23090706 12.470431   -6.93623880  41.0116835
[110,]   21.03018065 14.485572   -7.29407514  49.1066832
[111,]   17.57896582 13.183772   -7.99791054  43.7631872
[112,]  -12.27706699 11.248645  -34.24796673  10.0200337
[113,]  -16.54029981  9.607251  -35.36686697   2.8749067
[114,]  -34.23133262  8.432890  -51.23682872 -17.5728400
[115,]  -37.85546544  7.935685  -53.84962304 -22.1429393
[116,]    5.93920175  8.239154  -10.87732922  22.2257023
[117,]   38.64546893  9.264951   19.74647842  57.0159183
[118,]    5.10583612 10.809351  -17.03991990  26.6247896
[119,]   19.66110330 12.684318   -5.80348176  44.7013921
[120,]   -2.78692951 14.764446  -32.21963581  26.3262060
[121,]   -5.28933948 12.323324  -30.20684760  18.5810915
[122,]   36.78273492 10.564515   15.65651408  57.2973268
[123,]   -0.83999067  9.084972  -19.29637812  16.5630765
[124,]    2.39618374  8.040369  -13.78352681  17.5645156
[125,]  -13.82454185  7.611926  -28.66624397   0.5585826
[126,]   11.52263256  7.900530   -3.65012728  26.8471363
[127,]  -12.82339304  8.836199  -30.37815048   4.5926246
[128,]  -41.43351863 10.243121  -61.59911678 -21.5447056
[129,]    6.05375578 11.956074  -17.80649153  29.4064599
[130,]   24.61843019 13.862069   -2.87770350  51.7082603
[131,]  -50.24984305 12.506612  -75.32050370 -25.3232181
[132,]   12.24299272 10.766881   -9.58024855  33.3414698
[133,]   26.90362849  9.317818    8.29688501  45.0107869
[134,]   32.85666426  8.312842   16.34832470  49.4263348
[135,]   20.71740002  7.922788    5.22220878  36.9966362
[136,]   10.78193579  8.235497   -5.41413240  27.6187408
[137,]   -1.64412844  9.179426  -19.45681593  16.4219780
[138,]   -9.66209267 10.587063  -30.51371843  11.6867421
[139,]   -8.47805690 12.300227  -33.11403271  16.3150653
[140,]   -9.60092113 14.208831  -37.88018716  18.7848902
[141,]   17.72342324 12.450049   -7.66642933  41.7598473
[142,]    2.80663727 10.667291  -18.64762112  23.5694371
[143,]  -19.81804869  9.191100  -37.97799923  -2.1233449
[144,]  -10.83403466  8.188981  -27.12824911   5.3380534
[145,]   14.90137938  7.844765   -0.71214669  30.5072799
[146,]    5.86249341  8.241306  -10.33503664  22.6531742
[147,]  -24.64589255  9.284168  -42.98215753  -5.7237842
[148,]   13.91152148 10.787505   -7.51170661  35.6279528
[149,]   -5.36156448 12.587399  -30.47161897  19.9089941
[150,]    9.44134955 14.574389  -19.24082111  39.0587606
[151,]   -1.24712109 13.512826  -27.66051871  25.8692042
[152,]   -7.19783017 11.548983  -29.58913879  15.5021364
[153,]  -18.03073926  9.862624  -37.49677308   1.0672301
[154,]  -31.66874834  8.618208  -48.53607874 -15.2913208
[155,]  -19.81465743  8.024055  -35.53579749  -4.3413678
[156,]   41.63153349  8.222360   25.75119318  57.4820661
[157,]  -36.62427560  9.161809  -54.30629496 -18.5094508
[158,]   14.60291532 10.648009   -6.06429756  35.6681390
[159,]   16.97020623 12.487243   -7.66893348  41.4907677
[160,]    8.82579715 14.546208  -19.78091959  36.9042418
[161,]   17.67972000 12.309348   -6.43846145  41.3583955
[162,]   10.75224166 10.623767  -10.24678258  31.3599122
[163,]    6.71846333  9.216370  -11.57681348  24.4803974
[164,]    1.11918499  8.231112  -15.60521178  16.9678231
[165,]  -10.98969334  7.829023  -26.89828688   3.8558668
[166,]  -15.13807168  8.097449  -31.53193376   0.2810008
[167,]  -49.87415001  8.976437  -67.20097406 -32.6380540
[168,]  -13.99922835 10.311006  -33.96357267   6.2544862
[169,]   22.66099332 11.949474   -0.62643801  46.4078735
[170,]   31.85961498 13.783893    5.24082081  59.6872025
[171,]    5.82206202 12.091172  -18.50852046  29.6447281
[172,]   -1.92737975 10.448210  -23.06227545  18.6176417
[173,]   10.38367847  9.104375   -7.51395666  28.1622118
[174,]   11.60673670  8.207930   -4.66332178  27.9384697
[175,]  -23.66400507  7.912426  -39.52353189  -7.9919970
[176,]    6.95925315  8.282436   -9.63541026  22.9199085
[177,]    0.02171138  9.238340  -18.41878688  17.5666539
[178,]   -3.05193039 10.623135  -24.08941962  17.3243165
[179,]   11.05812783 12.292721  -13.42010857  34.6421297
[180,]   -5.77171394 14.146620  -34.24008753  21.3774638</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.3  3.4
looic      1769.8 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   599       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   64        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.4
p_loo        33.6  8.3
looic      1721.9 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   1103      
 (0.5, 0.7]   (ok)         4    2.2%   610       
   (0.7, 1]   (bad)        1    0.6%   113       
   (1, Inf)   (very bad)   2    1.1%   9         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.9      11.6  
fit_sleep1 -92.4      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.3  3.4
looic      1769.8 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   599       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   64        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.4
p_loo        33.6  8.3
looic      1721.9 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   1103      
 (0.5, 0.7]   (ok)         4    2.2%   610       
   (0.7, 1]   (bad)        1    0.6%   113       
   (1, Inf)   (very bad)   2    1.1%   9         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.4        33.6    8.3   1721.9
fit_sleep2  -23.9      11.6  -884.9     14.4        19.3    3.4   1769.8
fit_sleep1  -92.4      21.0  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   44.8  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
7.683340e-41 4.000492e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.84      1.55     0.26     5.32       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.16      1.55    -3.31      2.8       5.34      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.1-0     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_5.0.0           compiler_4.2.2      
 [22] cli_3.6.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.5          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.20      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.1   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.4          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.12       yaml_2.3.7          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.42           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.20        V8_4.2.2            
 [88] RcppParallel_5.1.6   vctrs_0.5.2          nloptr_2.0.3        
 [91] httpuv_1.6.8         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
