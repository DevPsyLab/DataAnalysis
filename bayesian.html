<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.83      6.90    15.75    42.89 1.00     1802     2295
sd(Days)                6.57      1.53     4.16    10.17 1.00     1538     2098
cor(Intercept,Days)     0.09      0.30    -0.49     0.66 1.00      916     1529

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.23      7.25   236.80   266.13 1.00     1972     2627
Days         10.42      1.74     6.88    13.82 1.00     1175     1694

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.93      1.59    23.10    29.38 1.00     3459     3119

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1453  13.01764 228.2052 279.4974
309 211.4149  13.21940 185.5159 237.1365
310 213.0769  13.33565 185.5443 238.9683
330 274.2230  13.34651 248.7143 300.6651
331 273.3052  13.14098 247.6584 299.5436
332 260.3229  12.11146 237.2783 284.3645
333 267.6109  12.55674 243.3037 293.0113
334 244.0826  12.50363 219.6163 268.3600
335 250.6645  13.50115 224.8252 277.8773
337 286.0351  13.10557 260.3507 311.6984
349 226.5831  13.01530 200.9099 251.5860
350 238.6608  12.82604 212.9400 263.1595
351 255.8514  12.40389 231.4789 280.5659
352 272.1108  12.33817 247.8901 296.7733
369 254.6559  12.23437 230.7787 279.2943
370 226.4272  13.63222 198.5104 252.0741
371 252.4328  12.55822 228.5230 277.2949
372 263.5081  12.22189 240.5027 288.3620

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.5990098  2.516740 14.80773839 24.584302
309  1.7564368  2.463019 -3.03144432  6.836885
310  4.8854219  2.498929  0.01086488  9.935044
330  5.8295840  2.517379  0.96530261 10.757485
331  7.4641869  2.485812  2.52833806 12.078761
332 10.2213683  2.349951  5.55191226 14.786577
333 10.3364886  2.404840  5.56509975 14.948869
334 11.6076494  2.371661  6.97653607 16.306991
335 -0.1696448  2.611082 -5.31972064  4.837865
337 19.1389915  2.481032 14.37772843 24.089748
349 11.5526290  2.472646  6.96283859 16.460370
350 17.0124104  2.475754 12.18132088 21.952341
351  7.4839969  2.378937  2.86404314 12.111225
352 14.0222612  2.385895  9.38464257 18.663662
369 11.3163535  2.303251  6.71022021 15.851321
370 15.1424001  2.560309 10.21244887 20.232431
371  9.4756150  2.377194  4.77289808 14.116591
372 11.8125829  2.295698  7.29328091 16.336015</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1453 13.017643 228.2052 279.4974
  [2,] 273.7443 11.109931 251.8336 295.4742
  [3,] 293.3433  9.490524 274.7589 312.0182
  [4,] 312.9423  8.329316 296.5038 329.3885
  [5,] 332.5413  7.832809 317.2806 348.0326
  [6,] 352.1403  8.123808 336.0460 367.9057
  [7,] 371.7393  9.127298 353.5226 389.3810
  [8,] 391.3383 10.643629 370.0539 411.6807
  [9,] 410.9373 12.487357 386.3926 435.0655
 [10,] 430.5364 14.534417 401.8898 459.3151
 [11,] 211.4149 13.219404 185.5159 237.1365
 [12,] 213.1714 11.393218 191.2067 235.5901
 [13,] 214.9278  9.848408 195.9962 234.5739
 [14,] 216.6842  8.735546 200.0606 233.7132
 [15,] 218.4407  8.231727 202.5433 234.6346
 [16,] 220.1971  8.446644 204.1842 236.9499
 [17,] 221.9536  9.330767 204.4754 240.7572
 [18,] 223.7100 10.719773 203.2737 245.1931
 [19,] 225.4664 12.445754 201.4691 250.3032
 [20,] 227.2229 14.387945 199.6066 255.6740
 [21,] 213.0769 13.335651 185.5443 238.9683
 [22,] 217.9623 11.452680 194.2483 240.4801
 [23,] 222.8477  9.847714 203.0222 242.2766
 [24,] 227.7332  8.676425 210.7171 244.9066
 [25,] 232.6186  8.128501 216.7915 248.6240
 [26,] 237.5040  8.327906 221.5495 253.8443
 [27,] 242.3894  9.226310 224.3649 260.4545
 [28,] 247.2749 10.648233 226.2180 268.0018
 [29,] 252.1603 12.415081 227.4327 276.4794
 [30,] 257.0457 14.400448 227.9105 285.2157
 [31,] 274.2230 13.346512 248.7143 300.6651
 [32,] 280.0526 11.459074 257.7637 302.7231
 [33,] 285.8822  9.857269 266.7509 304.9848
 [34,] 291.7118  8.700318 274.6230 308.4645
 [35,] 297.5414  8.179223 281.3662 313.3621
 [36,] 303.3710  8.412981 286.7355 319.6407
 [37,] 309.2006  9.345117 290.6596 327.4967
 [38,] 315.0301 10.796229 294.1515 335.8825
 [39,] 320.8597 12.588101 296.2663 345.4356
 [40,] 326.6893 14.595767 298.2083 355.4996
 [41,] 273.3052 13.140982 247.6584 299.5436
 [42,] 280.7693 11.285788 258.8045 303.1762
 [43,] 288.2335  9.716538 269.3794 307.4527
 [44,] 295.6977  8.591376 279.0384 312.8744
 [45,] 303.1619  8.097586 287.2282 318.9964
 [46,] 310.6261  8.347968 294.0325 326.5121
 [47,] 318.0903  9.282498 299.5378 336.1436
 [48,] 325.5545 10.723782 304.5348 346.1013
 [49,] 333.0187 12.497709 308.7559 356.8380
 [50,] 340.4828 14.482559 311.9039 368.0662
 [51,] 260.3229 12.111459 237.2783 284.3645
 [52,] 270.5443 10.385259 250.5070 291.2460
 [53,] 280.7657  8.947867 263.3363 298.2750
 [54,] 290.9870  7.957359 275.4195 306.2705
 [55,] 301.2084  7.590742 286.4676 316.0719
 [56,] 311.4298  7.934966 296.3110 326.9166
 [57,] 321.6511  8.908005 304.9257 338.7707
 [58,] 331.8725 10.333730 311.8581 351.7574
 [59,] 342.0939 12.052548 318.3526 365.8058
 [60,] 352.3152 13.956590 324.4628 379.8646
 [61,] 267.6109 12.556739 243.3037 293.0113
 [62,] 277.9474 10.793998 257.0408 299.6720
 [63,] 288.2839  9.322855 270.2622 306.8222
 [64,] 298.6204  8.299840 282.3421 315.0125
 [65,] 308.9569  7.900987 293.1189 324.4806
 [66,] 319.2934  8.217685 302.9533 335.7508
 [67,] 329.6299  9.176143 310.9763 348.0201
 [68,] 339.9664 10.603744 318.8198 360.6579
 [69,] 350.3029 12.338706 325.4795 374.3411
 [70,] 360.6393 14.269354 332.1202 388.2301
 [71,] 244.0826 12.503628 219.6163 268.3600
 [72,] 255.6902 10.794770 234.3411 276.7429
 [73,] 267.2979  9.378857 249.0683 285.9570
 [74,] 278.9055  8.405260 262.7970 296.0114
 [75,] 290.5132  8.036378 275.2508 306.5254
 [76,] 302.1208  8.352719 285.9996 318.5873
 [77,] 313.7285  9.284503 295.5934 332.2465
 [78,] 325.3361 10.671721 304.7324 346.7441
 [79,] 336.9438 12.361990 312.6639 362.2006
 [80,] 348.5514 14.247861 320.5145 377.6723
 [81,] 250.6645 13.501146 224.8252 277.8773
 [82,] 250.4948 11.460762 228.7362 272.7610
 [83,] 250.3252  9.698078 231.7375 269.3133
 [84,] 250.1555  8.389985 234.1448 266.4052
 [85,] 249.9859  7.769587 235.1599 265.3812
 [86,] 249.8162  7.998539 234.5227 265.3599
 [87,] 249.6466  9.012339 232.1985 267.3049
 [88,] 249.4769 10.587888 228.9234 270.2081
 [89,] 249.3073 12.514792 224.7259 273.8171
 [90,] 249.1377 14.655106 220.6626 277.9012
 [91,] 286.0351 13.105569 260.3507 311.6984
 [92,] 305.1740 11.261897 283.2042 327.0984
 [93,] 324.3130  9.706479 305.3215 342.9183
 [94,] 343.4520  8.597220 326.7428 360.0691
 [95,] 362.5910  8.119094 346.7359 378.0318
 [96,] 381.7300  8.380824 365.2464 397.5619
 [97,] 400.8690  9.320289 382.2982 419.1369
 [98,] 420.0080 10.761431 398.7756 441.0220
 [99,] 439.1470 12.532359 414.5672 463.7009
[100,] 458.2860 14.512847 429.8544 486.8003
[101,] 226.5831 13.015299 200.9099 251.5860
[102,] 238.1357 11.159721 216.2730 259.6176
[103,] 249.6883  9.586901 231.1470 268.1223
[104,] 261.2410  8.456118 244.6774 277.6322
[105,] 272.7936  7.958087 257.1666 288.4372
[106,] 284.3462  8.208796 268.2164 300.3925
[107,] 295.8988  9.146882 277.7883 313.9822
[108,] 307.4515 10.591248 286.6042 328.2243
[109,] 319.0041 12.365742 295.2654 343.2485
[110,] 330.5567 14.348400 303.4793 358.6217
[111,] 238.6608 12.826038 212.9400 263.1595
[112,] 255.6732 10.999342 233.2923 276.8188
[113,] 272.6856  9.472198 253.5463 290.5285
[114,] 289.6980  8.409415 272.8199 306.2223
[115,] 306.7104  7.998294 290.9796 322.5834
[116,] 323.7228  8.335818 307.2077 340.3566
[117,] 340.7353  9.341184 322.1202 359.1582
[118,] 357.7477 10.829973 336.7195 379.2896
[119,] 374.7601 12.632403 350.1910 399.6343
[120,] 391.7725 14.633032 363.8134 420.3226
[121,] 255.8514 12.403894 231.4789 280.5659
[122,] 263.3354 10.644516 242.1114 284.2639
[123,] 270.8194  9.169162 252.8089 288.9527
[124,] 278.3034  8.133880 262.2841 294.5104
[125,] 285.7874  7.717848 270.8863 300.9536
[126,] 293.2714  8.018043 277.8631 309.2968
[127,] 300.7554  8.962786 283.6663 318.5419
[128,] 308.2394 10.377510 288.3561 328.6865
[129,] 315.7234 12.098454 292.3119 339.3809
[130,] 323.2074 14.013249 296.0975 350.6166
[131,] 272.1108 12.338172 247.8901 296.7733
[132,] 286.1331 10.605557 265.2823 307.3973
[133,] 300.1553  9.171160 282.2978 318.0453
[134,] 314.1776  8.193137 298.4038 330.1122
[135,] 328.1998  7.844094 313.3551 343.3454
[136,] 342.2221  8.204700 325.8831 358.2713
[137,] 356.2444  9.191811 338.0432 374.4008
[138,] 370.2666 10.632341 349.2730 391.2630
[139,] 384.2889 12.368870 360.0114 408.6849
[140,] 398.3111 14.293922 370.2552 426.7871
[141,] 254.6559 12.234373 230.7787 279.2943
[142,] 265.9723 10.552937 245.4706 287.1398
[143,] 277.2886  9.146529 259.2910 295.4698
[144,] 288.6050  8.158642 272.1768 304.5535
[145,] 299.9213  7.750989 284.5906 314.7677
[146,] 311.2377  8.012624 295.3276 326.6742
[147,] 322.5540  8.884615 304.6603 339.2771
[148,] 333.8704 10.211786 313.2866 353.4580
[149,] 345.1867 11.842072 321.0606 368.1721
[150,] 356.5031 13.667433 328.9604 383.2622
[151,] 226.4272 13.632220 198.5104 252.0741
[152,] 241.5696 11.662464 217.4529 263.8583
[153,] 256.7120  9.964892 236.8356 276.1578
[154,] 271.8544  8.700312 254.7437 289.0508
[155,] 286.9968  8.074785 270.9129 302.9112
[156,] 302.1392  8.235243 286.0935 318.4751
[157,] 317.2816  9.140387 299.4500 335.3855
[158,] 332.4240 10.601154 311.7707 353.3332
[159,] 347.5664 12.423068 323.4505 372.3790
[160,] 362.7088 14.470354 334.5586 391.6150
[161,] 252.4328 12.558218 228.5230 277.2949
[162,] 261.9084 10.798488 241.2662 283.0428
[163,] 271.3840  9.317078 253.4605 289.8050
[164,] 280.8596  8.265026 264.7193 296.9212
[165,] 290.3353  7.817638 274.8536 305.6566
[166,] 299.8109  8.076037 283.9146 315.6553
[167,] 309.2865  8.979498 291.8397 326.5319
[168,] 318.7621 10.360622 298.5013 338.7045
[169,] 328.2377 12.056356 304.7003 351.6257
[170,] 337.7133 13.952456 310.7420 364.9434
[171,] 263.5081 12.221889 240.5027 288.3620
[172,] 275.3206 10.515238 255.3454 297.0015
[173,] 287.1332  9.072284 269.7152 305.6647
[174,] 298.9458  8.036349 283.4540 315.2791
[175,] 310.7584  7.576274 296.0413 325.8860
[176,] 322.5710  7.794704 307.2989 338.0578
[177,] 334.3836  8.640333 317.1905 351.1875
[178,] 346.1961  9.954584 326.2034 365.8343
[179,] 358.0087 11.578972 334.9902 381.0324
[180,] 369.8213 13.401190 342.7871 396.6929</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.58526735 13.017643  -29.93739733  21.3547880
  [2,]  -15.03957719 11.109931  -36.76947923   6.8710764
  [3,]  -42.54268702  9.490524  -61.21763571 -23.9583073
  [4,]    8.49750314  8.329316   -7.94873432  24.9360017
  [5,]   24.31059330  7.832809    8.81929809  39.5712839
  [6,]   62.54978347  8.123808   46.78444426  78.6441265
  [7,]   10.46447363  9.127298   -7.17723890  28.6812375
  [8,] -101.18973621 10.643629 -121.53210364 -79.9053030
  [9,]   19.64795396 12.487357   -4.48015957  44.1926812
 [10,]   35.81714412 14.534417    7.03841933  64.4637417
 [11,]   11.31896573 13.219404  -14.40258495  37.2180023
 [12,]   -7.90557103 11.393218  -30.32429527  14.0590563
 [13,]  -11.95000779  9.848408  -31.59608315   6.9816288
 [14,]  -11.97724455  8.735546  -29.00618782   4.6464224
 [15,]  -10.72458131  8.231727  -26.91854909   5.1728132
 [16,]   -4.23531807  8.446644  -20.98808968  11.7776329
 [17,]   -8.32325483  9.330767  -27.12691327   9.1548761
 [18,]   -5.98279160 10.719773  -27.46586840  14.4534659
 [19,]   -1.17072836 12.445754  -26.00746484  22.8266230
 [20,]   10.09133488 14.387945  -18.35981644  37.7076281
 [21,]  -14.02299792 13.335651  -39.91443059  13.5095720
 [22,]  -23.63011985 11.452680  -46.14785257   0.0838626
 [23,]   11.47225821  9.847714   -7.95657464  31.2978488
 [24,]    5.10843628  8.676425  -12.06495477  22.1244866
 [25,]   -3.31118566  8.128501  -19.31662776  12.5158876
 [26,]  -17.04610759  8.327906  -33.38637526  -1.0916043
 [27,]   -6.96862953  9.226310  -25.03368827  11.0559098
 [28,]    8.47624854 10.648233  -12.25072837  29.5331457
 [29,]    8.85222660 12.415081  -15.46685673  33.5797572
 [30,]   -9.53039533 14.400448  -37.70043141  19.6048010
 [31,]   47.31955048 13.346512   20.87749216  72.8283120
 [32,]   20.34756653 11.459074   -2.32292602  42.6364629
 [33,]   -2.02571742  9.857269  -21.12834385  17.1055564
 [34,]   -6.57880137  8.700318  -23.33154553  10.5100462
 [35,]  -11.74408532  8.179223  -27.56484988   4.4310824
 [36,]   -5.78546927  8.412981  -22.05515751  10.8500267
 [37,]  -28.96095322  9.345117  -47.25714831 -10.4199884
 [38,]    3.23116283 10.796229  -17.62118905  24.1097696
 [39,]  -15.51022112 12.588101  -40.08610789   9.0832007
 [40,]   27.35939493 14.595767   -1.45092535  55.8404416
 [41,]   14.30273806 13.140982  -11.93572039  39.9494890
 [42,]    4.23065114 11.285788  -18.17618222  26.1955108
 [43,]   13.58706422  9.716538   -5.63205022  32.4411722
 [44,]   24.41757730  8.591376    7.24086805  41.0768836
 [45,]   13.11539038  8.097586   -2.71913234  29.0491236
 [46,]  -17.30739654  8.347968  -33.19340304  -0.7138258
 [47,]  -28.01528346  9.282498  -46.06861131  -9.4628392
 [48,]    9.26322963 10.723782  -11.28363221  30.2828680
 [49,]  -39.27175729 12.497709  -63.09109355 -15.0089771
 [50,]   31.09825579 14.482559    3.51490166  59.6772257
 [51,]  -25.46233022 12.111459  -49.50392278  -2.4177306
 [52,]  -27.73249856 10.385259  -48.43423477  -7.6951923
 [53,]   -7.80436691  8.947867  -25.31368693   9.6249883
 [54,]   18.78176474  7.957359    3.49834341  34.3492850
 [55,]   16.25449639  7.590742    1.39099146  30.9952847
 [56,]   -1.43217196  7.934966  -16.91895601  13.6865775
 [57,]  132.51075970  8.908005  115.39117414 149.2361907
 [58,]   14.95859135 10.333730   -4.92632063  34.9729600
 [59,]  -11.79357700 12.052548  -35.50545521  11.9477089
 [60,]  -98.45084535 13.956590 -126.00020660 -70.5983821
 [61,]   16.23145688 12.556739   -9.16886585  40.5387011
 [62,]   11.60756824 10.793998  -10.11695706  32.5141695
 [63,]  -11.51462041  9.322855  -30.05286183   6.5071158
 [64,]    1.18929094  8.299840  -15.20277556  17.4675510
 [65,]  -11.78589770  7.900987  -27.30961649   4.0520804
 [66,]   18.87311365  8.217685    2.41567028  35.2132118
 [67,]    2.39662501  9.176143  -15.99357593  21.0502141
 [68,]    8.87353636 10.603744  -11.81803289  30.0201399
 [69,]  -16.94285229 12.338706  -40.98110091   7.8804681
 [70,]    1.40345907 14.269354  -26.18733029  29.9225558
 [71,]   21.39052791 12.503628   -2.88688118  45.8567760
 [72,]   20.51097852 10.794770   -0.54171558  41.8601311
 [73,]  -23.93317087  9.378857  -42.59230951  -5.7036432
 [74,]  -24.23322025  8.405260  -41.33907546  -8.1247287
 [75,]  -11.48876964  8.036378  -27.50100881   3.7736134
 [76,]  -17.92961903  8.352719  -34.39612089  -1.8084304
 [77,]   -8.20366842  9.284503  -26.72172834   9.9313564
 [78,]    6.18678220 10.671721  -15.22122266  26.7905041
 [79,]   -1.19686719 12.361990  -26.45369049  23.0829794
 [80,]   28.74758342 14.247861   -0.37333304  56.7845410
 [81,]   -9.05615318 13.501146  -36.26904369  16.7830688
 [82,]   23.45239159 11.460762    1.18615970  45.2109976
 [83,]    4.16553636  9.698078  -14.82260335  22.7532450
 [84,]   20.64658113  8.389985    4.39689920  36.6573390
 [85,]    1.46602589  7.769587  -13.92934555  16.2919917
 [86,]    4.81997066  7.998539  -10.72373226  20.1134685
 [87,]   -4.19428457  9.012339  -21.85258928  13.2537742
 [88,]  -14.16593981 10.587888  -34.89708323   6.3875671
 [89,]  -13.55319504 12.514792  -38.06301724  11.0281678
 [90,]  -11.89105027 14.655106  -40.65463260  16.5840479
 [91,]   26.33154775 13.105569    0.66819773  52.0159374
 [92,]    8.63175625 11.261897  -13.29256147  30.6016418
 [93,]  -32.70183525  9.706479  -51.30706456 -13.7103307
 [94,]    2.67017325  8.597220  -13.94691160  19.3794500
 [95,]    3.14138175  8.119094  -12.29937049  18.9965015
 [96,]   10.10849025  8.380824   -5.72335370  26.5920808
 [97,]    3.39109875  9.320289  -14.87675522  21.9618636
 [98,]   -3.31569275 10.761431  -24.32966196  17.9167349
 [99,]   16.71731575 12.532359   -7.83659010  41.2971069
[100,]    0.63072425 14.512847  -27.88357405  29.0622952
[101,]    9.52012580 13.015299  -15.48284618  35.1933356
[102,]   -7.81900320 11.159721  -29.30085642  14.0437413
[103,]  -10.76273219  9.586901  -29.19669543   7.7785664
[104,]   -6.31896119  8.456118  -22.71023833  10.2445918
[105,]  -22.08329018  7.958087  -37.72689998  -6.4563365
[106,]  -14.57181918  8.208796  -30.61811106   1.5580182
[107,]  -14.33404817  9.146882  -32.41736394   3.7764831
[108,]    0.65052283 10.591248  -20.12234463  21.4978230
[109,]   17.27649384 12.365742   -6.96791950  41.0151559
[110,]   21.08836484 14.348400   -6.97662002  48.1657500
[111,]   17.63600732 12.826038   -6.86271444  43.3567988
[112,]  -12.21890311 10.999342  -33.36445699  10.1619962
[113,]  -16.48101355  9.472198  -34.32391159   2.6582926
[114,]  -34.17092399  8.409415  -50.69521276 -17.2927692
[115,]  -37.79393443  7.998294  -53.66686553 -22.0631130
[116,]    6.00185513  8.335818  -10.63192336  22.5170197
[117,]   38.70924470  9.341184   20.28628009  57.3242923
[118,]    5.17073426 10.829973  -16.37117389  26.1989151
[119,]   19.72712382 12.632403   -5.14705974  44.2962412
[120,]   -2.71978662 14.633032  -31.26994563  25.2392969
[121,]   -5.32491474 12.403894  -30.03942262  19.0475824
[122,]   36.72218832 10.644516   15.79369127  57.9462375
[123,]   -0.92550862  9.169162  -19.05882704  17.0850141
[124,]    2.28569445  8.133880  -13.92125052  18.3049552
[125,]  -13.96000249  7.717848  -29.12623912   0.9410866
[126,]   11.36220057  8.018043   -4.66323056  26.7704770
[127,]  -13.00879637  8.962786  -30.79530875   4.0802704
[128,]  -41.64389331 10.377510  -62.09095596 -21.7606119
[129,]    5.81840975 12.098454  -17.83912568  29.2299422
[130,]   24.35811281 14.013249   -3.05109331  51.4679634
[131,]  -50.43369875 12.338172  -75.09615058 -26.2129911
[132,]   12.06084000 10.605557   -9.20341949  32.9116404
[133,]   26.72317875  9.171160    8.83322624  44.5806566
[134,]   32.67791751  8.193137   16.74331508  48.4516730
[135,]   20.54035626  7.844094    5.39484372  35.3850627
[136,]   10.60659501  8.204700   -5.44259198  26.9456269
[137,]   -1.81776623  9.191811  -19.97417373  16.3834303
[138,]   -9.83402748 10.632341  -30.83041723  11.1595713
[139,]   -8.64828873 12.368870  -33.04433120  15.6291526
[140,]   -9.76944997 14.293922  -38.24544910  18.2864911
[141,]   17.26760315 12.234373   -7.37083007  41.1448042
[142,]    2.46464970 10.552937  -18.70287919  22.9662971
[143,]  -20.04620376  9.146529  -38.22740514  -2.0486004
[144,]  -10.94835722  8.158642  -26.89690672   5.4797729
[145,]   14.90088933  7.750989    0.05447621  30.2315702
[146,]    5.97583587  8.012624   -9.46071808  21.8859350
[147,]  -24.41871759  8.884615  -41.14182740  -6.5249715
[148,]   14.25252895 10.211786   -5.33505432  34.8363279
[149,]   -4.90672450 11.842072  -27.89206811  19.2193990
[150,]   10.01002204 13.667433  -16.74913630  37.5527342
[151,]   -1.16315730 13.632220  -26.81005275  26.7535951
[152,]   -7.04605739 11.662464  -29.33483408  17.0705834
[153,]  -17.81115748  9.964892  -37.25697931   2.0652445
[154,]  -31.38135756  8.700312  -48.57783397 -14.2707275
[155,]  -19.45945765  8.074785  -35.37385232  -3.3755670
[156,]   42.05454226  8.235243   25.71864126  58.1002287
[157,]  -36.13345783  9.140387  -54.23740057 -18.3018828
[158,]   15.16154208 10.601154   -5.74765537  35.8148235
[159,]   17.59664199 12.423068   -7.21601709  41.7125207
[160,]    9.52004190 14.470354  -19.38622676  37.6702474
[161,]   17.44759509 12.558218   -7.41454039  41.3574153
[162,]   10.53438011 10.798488  -10.60000203  31.1765877
[163,]    6.51486513  9.317078  -11.90606983  24.4383961
[164,]    0.92985015  8.265026  -15.13172765  17.0702272
[165,]  -11.16476484  7.817638  -26.48605178   4.3169461
[166,]  -15.29887982  8.076037  -31.14329111   0.5973864
[167,]  -50.02069480  8.979498  -67.26610821 -32.5739044
[168,]  -14.13150978 10.360622  -34.07389503   6.1292578
[169,]   22.54297524 12.056356   -0.84495960  46.0803839
[170,]   31.75586026 13.952456    4.52575412  58.7272451
[171,]    5.90364237 12.221889  -18.95026147  28.9090135
[172,]   -1.84664050 10.515238  -23.52746431  18.1285853
[173,]   10.46357662  9.072284   -8.06791811  27.8816245
[174,]   11.68579375  8.036349   -4.64752234  27.1775526
[175,]  -23.58578912  7.576274  -38.71342734  -8.8687443
[176,]    7.03662801  7.794704   -8.45024516  22.3087192
[177,]    0.09824514  8.640333  -16.70568432  17.2912595
[178,]   -2.97623773  9.954584  -22.61436729  17.0165497
[179,]   11.13297939 11.578972  -11.89067320  34.1515427
[180,]   -5.69770348 13.401190  -32.56927445  21.3365207</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 5 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.3 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.7  3.5
looic      1770.3 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   643       
 (0.5, 0.7]   (ok)         1    0.6%   80        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.1
p_loo        33.6  8.1
looic      1721.6 44.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   819       
 (0.5, 0.7]   (ok)         4    2.2%   333       
   (0.7, 1]   (bad)        5    2.8%   23        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.4      11.3  
fit_sleep1 -92.4      20.7  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 5 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.3 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.7  3.5
looic      1770.3 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   643       
 (0.5, 0.7]   (ok)         1    0.6%   80        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.1
p_loo        33.6  8.1
looic      1721.6 44.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   819       
 (0.5, 0.7]   (ok)         4    2.2%   333       
   (0.7, 1]   (bad)        5    2.8%   23        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.8     22.1        33.6    8.1   1721.6
fit_sleep2  -24.4      11.3  -885.2     14.4        19.7    3.5   1770.3
fit_sleep1  -92.4      20.7  -953.2     10.5         3.1    0.5   1906.3
           se_looic
fit_sleep3   44.1  
fit_sleep2   28.9  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
7.566671e-41 2.563498e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.96      1.59     0.23     5.53       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.04      1.59    -3.35     2.99       5.24      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.62.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.2          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.3         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.3.1      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.40           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
