<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.03      6.69    15.99    41.96 1.00     2076     2704
sd(Days)                6.53      1.51     4.19    10.11 1.00     1640     2233
cor(Intercept,Days)     0.09      0.30    -0.51     0.65 1.00      962     1267

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.35      7.39   236.95   265.91 1.00     1756     2597
Days         10.44      1.71     7.08    13.86 1.00     1349     2222

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.95      1.54    23.15    29.14 1.00     3588     2148

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9884  12.85309 228.6578 278.3698
309 211.4822  13.22926 185.4759 237.1127
310 212.7839  13.28880 185.9774 238.2837
330 274.5511  13.24102 249.6188 301.0713
331 273.1610  12.96519 248.4030 299.9768
332 260.5565  12.24398 236.2957 284.3769
333 267.7140  12.82272 242.5718 293.4226
334 244.2784  12.43110 220.0131 268.4212
335 250.6714  13.29798 224.8091 277.4683
337 285.9932  13.14780 260.5860 311.8532
349 226.7034  12.83580 201.0741 251.4849
350 239.0066  13.11676 212.0675 263.7494
351 255.3887  12.48492 231.7008 280.3280
352 271.8435  12.66912 247.5958 296.8368
369 254.6006  12.23948 230.8311 278.7296
370 226.2610  13.34601 199.5338 251.8757
371 252.0134  12.25474 227.1996 276.2966
372 263.8071  12.16584 240.8140 288.4470

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6104835  2.518799 14.8700767 24.620266
309  1.7602581  2.465860 -3.0135838  6.560410
310  4.9693559  2.537616  0.1607835 10.131978
330  5.7343743  2.497856  0.7408408 10.594941
331  7.4943925  2.426485  2.6936601 12.143188
332 10.1722921  2.323724  5.7348425 14.799818
333 10.3128002  2.445020  5.3765836 15.102475
334 11.5250451  2.360428  6.8941945 16.120568
335 -0.2079756  2.564341 -5.2678047  4.772918
337 19.1414106  2.525661 14.2728288 24.085044
349 11.5346957  2.405058  6.9316603 16.367362
350 16.9948813  2.507605 12.2608606 22.055502
351  7.5443915  2.371486  2.7450933 12.118666
352 14.0971992  2.386082  9.2039526 18.759350
369 11.3418128  2.317592  6.8543199 15.770875
370 15.1911995  2.488256 10.3269635 20.186865
371  9.4862476  2.329747  4.8647278 14.039059
372 11.7446435  2.316078  7.1319601 16.242556</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9884 12.853086 228.6578 278.3698
  [2,] 273.5989 10.963393 251.9213 294.2283
  [3,] 293.2094  9.374373 274.6180 311.3958
  [4,] 312.8199  8.261382 296.5115 328.8316
  [5,] 332.4303  7.830114 317.0291 347.5495
  [6,] 352.0408  8.188995 335.7166 367.7219
  [7,] 371.6513  9.246474 353.0127 389.5049
  [8,] 391.2618 10.799241 369.4897 411.9823
  [9,] 410.8723 12.666438 386.0534 435.6715
 [10,] 430.4828 14.728963 401.5898 459.6305
 [11,] 211.4822 13.229256 185.4759 237.1127
 [12,] 213.2425 11.372405 190.8461 235.5551
 [13,] 215.0027  9.788305 195.6178 234.0480
 [14,] 216.7630  8.628509 199.6787 233.4169
 [15,] 218.5232  8.077893 202.7242 234.1446
 [16,] 220.2835  8.259206 203.9994 236.8063
 [17,] 222.0438  9.128940 204.1307 240.3122
 [18,] 223.8040 10.517677 203.0885 244.5593
 [19,] 225.5643 12.250162 202.0574 249.7583
 [20,] 227.3245 14.201138 199.8331 255.2796
 [21,] 212.7839 13.288796 185.9774 238.2837
 [22,] 217.7533 11.347427 195.1482 239.9150
 [23,] 222.7227  9.685821 203.5637 241.7387
 [24,] 227.6920  8.470249 210.4705 244.5425
 [25,] 232.6614  7.909116 217.0826 248.5002
 [26,] 237.6307  8.138925 221.3935 254.1215
 [27,] 242.6001  9.099950 224.8237 260.9963
 [28,] 247.5694 10.595049 227.3464 268.8361
 [29,] 252.5388 12.433021 228.4323 277.3519
 [30,] 257.5081 14.483921 229.8615 286.8518
 [31,] 274.5511 13.241022 249.6188 301.0713
 [32,] 280.2854 11.334396 258.8263 303.2687
 [33,] 286.0198  9.700051 267.0667 305.3132
 [34,] 291.7542  8.496588 274.8692 308.4862
 [35,] 297.4886  7.922852 282.2231 313.0481
 [36,] 303.2229  8.113554 287.5955 319.1241
 [37,] 308.9573  9.020337 291.1690 326.5353
 [38,] 314.6917 10.458575 294.3614 335.1744
 [39,] 320.4261 12.242371 296.7333 344.2684
 [40,] 326.1604 14.242475 298.6493 354.3206
 [41,] 273.1610 12.965188 248.4030 299.9768
 [42,] 280.6554 11.129867 259.2183 303.8651
 [43,] 288.1498  9.561769 269.5049 307.2976
 [44,] 295.6442  8.411694 279.1888 311.9551
 [45,] 303.1386  7.865203 287.4841 318.5617
 [46,] 310.6330  8.046235 294.8046 326.4570
 [47,] 318.1274  8.910558 300.7515 335.5088
 [48,] 325.6218 10.287364 305.4259 346.0213
 [49,] 333.1162 12.001555 309.4748 356.5128
 [50,] 340.6106 13.929122 313.3752 368.0959
 [51,] 260.5565 12.243981 236.2957 284.3769
 [52,] 270.7288 10.563407 249.8751 291.4646
 [53,] 280.9011  9.168176 262.8458 298.7213
 [54,] 291.0734  8.205165 274.8712 306.8607
 [55,] 301.2457  7.835393 285.8416 316.3524
 [56,] 311.4180  8.140113 295.3818 326.9189
 [57,] 321.5903  9.051457 304.0859 339.0819
 [58,] 331.7626 10.411325 311.6011 352.0418
 [59,] 341.9349 12.069047 318.5664 365.4980
 [60,] 352.1072 13.918602 325.1667 379.3789
 [61,] 267.7140 12.822718 242.5718 293.4226
 [62,] 278.0268 11.020846 256.7985 300.1835
 [63,] 288.3396  9.510638 269.5951 307.3790
 [64,] 298.6524  8.449951 281.9357 315.1736
 [65,] 308.9652  8.019187 293.5138 324.9655
 [66,] 319.2780  8.316808 303.4071 335.5899
 [67,] 329.5908  9.272943 311.4674 347.6075
 [68,] 339.9036 10.712698 319.1505 360.5511
 [69,] 350.2164 12.469667 325.5513 374.3588
 [70,] 360.5292 14.428427 332.0606 388.8722
 [71,] 244.2784 12.431095 220.0131 268.4212
 [72,] 255.8035 10.723852 234.9169 276.5658
 [73,] 267.3285  9.306618 248.8528 285.3589
 [74,] 278.8536  8.328776 261.7500 294.9441
 [75,] 290.3786  7.954063 274.5390 305.7684
 [76,] 301.9037  8.264924 285.7362 317.9441
 [77,] 313.4287  9.192065 295.7679 331.3032
 [78,] 324.9538 10.574611 304.7162 345.5840
 [79,] 336.4788 12.259444 312.5851 360.2374
 [80,] 348.0038 14.138911 320.4241 375.1979
 [81,] 250.6714 13.297978 224.8091 277.4683
 [82,] 250.4634 11.331264 228.2489 273.0468
 [83,] 250.2555  9.649381 231.5099 268.8790
 [84,] 250.0475  8.424682 233.4018 266.4537
 [85,] 249.8395  7.873480 234.3780 264.9784
 [86,] 249.6315  8.133866 233.5970 265.0306
 [87,] 249.4236  9.136716 231.2268 267.3167
 [88,] 249.2156 10.674786 227.5745 269.6628
 [89,] 249.0076 12.552858 223.7525 273.3175
 [90,] 248.7996 14.640666 219.5803 277.0034
 [91,] 285.9932 13.147799 260.5860 311.8532
 [92,] 305.1346 11.235869 283.3104 327.0022
 [93,] 324.2760  9.611597 305.7692 342.4953
 [94,] 343.4174  8.442676 327.0450 359.5703
 [95,] 362.5588  7.933012 346.8417 377.5377
 [96,] 381.7003  8.206369 365.5464 397.4192
 [97,] 400.8417  9.193163 382.9346 418.8732
 [98,] 419.9831 10.697752 399.0226 441.3670
 [99,] 439.1245 12.535050 414.5605 464.3516
[100,] 458.2659 14.579815 429.3076 487.6415
[101,] 226.7034 12.835802 201.0741 251.4849
[102,] 238.2381 11.052298 216.3035 259.4784
[103,] 249.7728  9.545541 230.7958 267.9744
[104,] 261.3075  8.464635 244.4773 277.4980
[105,] 272.8422  7.984443 257.0510 288.3534
[106,] 284.3769  8.211042 268.3827 300.3894
[107,] 295.9116  9.091738 278.0872 313.7501
[108,] 307.4463 10.462639 286.6466 327.6770
[109,] 318.9810 12.159050 294.7089 342.8800
[110,] 330.5156 14.063670 302.5096 357.7755
[111,] 239.0066 13.116760 212.0675 263.7494
[112,] 256.0015 11.221508 233.0562 277.6618
[113,] 272.9963  9.610996 253.6136 291.6762
[114,] 289.9912  8.449641 273.3131 306.5439
[115,] 306.9861  7.937113 291.5858 322.6475
[116,] 323.9810  8.196052 308.0702 340.0355
[117,] 340.9759  9.161274 322.9251 358.6701
[118,] 357.9707 10.642311 337.3500 378.5685
[119,] 374.9656 12.456515 350.3438 398.9479
[120,] 391.9605 14.479190 363.3774 419.7166
[121,] 255.3887 12.484920 231.7008 280.3280
[122,] 262.9331 10.759136 242.0663 284.0727
[123,] 270.4775  9.321624 252.3153 288.6676
[124,] 278.0219  8.323114 261.6815 294.2339
[125,] 285.5663  7.931183 270.2015 300.9760
[126,] 293.1107  8.232922 276.8408 309.0033
[127,] 300.6550  9.160034 282.7643 318.4135
[128,] 308.1994 10.548902 287.3943 328.9218
[129,] 315.7438 12.243379 291.3476 339.5101
[130,] 323.2882 14.133974 295.2170 350.6489
[131,] 271.8435 12.669116 247.5958 296.8368
[132,] 285.9407 10.894016 265.3639 307.3460
[133,] 300.0379  9.393585 282.0532 318.4658
[134,] 314.1351  8.317817 297.9751 330.6326
[135,] 328.2323  7.843436 313.0520 343.7698
[136,] 342.3295  8.077108 326.9641 357.9848
[137,] 356.4267  8.963629 339.6047 373.5936
[138,] 370.5239 10.336362 350.8232 390.5229
[139,] 384.6211 12.030000 361.6220 408.1884
[140,] 398.7183 13.927964 372.2884 425.8524
[141,] 254.6006 12.239478 230.8311 278.7296
[142,] 265.9424 10.601472 245.3697 286.8907
[143,] 277.2842  9.258512 259.4106 295.6516
[144,] 288.6260  8.354123 272.5641 305.0713
[145,] 299.9679  8.037733 284.4776 315.6592
[146,] 311.3097  8.376240 295.1138 327.4537
[147,] 322.6515  9.298393 304.7084 340.1669
[148,] 333.9933 10.653699 313.4652 354.4665
[149,] 345.3351 12.299794 321.6957 368.6789
[150,] 356.6769 14.135454 329.3487 383.0889
[151,] 226.2610 13.346009 199.5338 251.8757
[152,] 241.4522 11.454946 218.6403 263.4239
[153,] 256.6434  9.833538 237.3132 275.7681
[154,] 271.8346  8.635044 254.6952 288.8747
[155,] 287.0258  8.050610 271.2055 303.0232
[156,] 302.2170  8.212398 286.0522 318.4463
[157,] 317.4082  9.080610 299.0950 334.9584
[158,] 332.5994 10.481141 311.4773 352.3532
[159,] 347.7906 12.232497 323.3442 371.1709
[160,] 362.9818 14.205509 334.6561 390.1403
[161,] 252.0134 12.254741 227.1996 276.2966
[162,] 261.4997 10.544553 240.1542 282.3095
[163,] 270.9859  9.113284 252.7744 289.2478
[164,] 280.4721  8.109979 264.5910 296.7558
[165,] 289.9584  7.703701 274.9149 305.0588
[166,] 299.4446  7.986094 283.7168 315.1695
[167,] 308.9309  8.891785 291.2657 326.8467
[168,] 318.4171 10.256970 298.3833 339.4817
[169,] 327.9034 11.924867 304.5831 352.1871
[170,] 337.3896 13.786041 310.5457 365.5201
[171,] 263.8071 12.165840 240.8140 288.4470
[172,] 275.5518 10.486872 255.4956 296.7219
[173,] 287.2964  9.092290 269.7744 305.4295
[174,] 299.0410  8.129786 283.1989 315.1611
[175,] 310.7857  7.761800 295.7421 326.0458
[176,] 322.5303  8.070074 306.6124 338.1783
[177,] 334.2750  8.985271 316.2869 351.8054
[178,] 346.0196 10.347586 325.0592 366.4041
[179,] 357.7643 12.005765 333.7365 381.4273
[180,] 369.5089 13.853978 342.2649 396.6529</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.4284143 12.853086  -28.8098252  20.9021543
  [2,]  -14.8941978 10.963393  -35.5236379   6.7834239
  [3,]  -42.4087813  9.374373  -60.5951997 -23.8173738
  [4,]    8.6199351  8.261382   -7.3917651  24.9282514
  [5,]   24.4215516  7.830114    9.3024115  39.8227907
  [6,]   62.6492681  8.188995   46.9682354  78.9734978
  [7,]   10.5524845  9.246474   -7.3011476  29.1911287
  [8,] -101.1131990 10.799241 -121.8336907 -79.3410648
  [9,]   19.7130175 12.666438   -5.0861658  44.5318977
 [10,]   35.8707339 14.728963    6.7229770  64.7636592
 [11,]   11.2516974 13.229256  -14.3788034  37.2580346
 [12,]   -7.9766607 11.372405  -30.2892705  14.4196723
 [13,]  -12.0249188  9.788305  -31.0702091   7.3600263
 [14,]  -12.0559768  8.628509  -28.7099375   5.0283485
 [15,]  -10.8071349  8.077893  -26.4285494   4.9919334
 [16,]   -4.3216930  8.259206  -20.8445014  11.9624378
 [17,]   -8.4134511  9.128940  -26.6819082   9.4996141
 [18,]   -6.0768092 10.517677  -26.8320879  14.6386779
 [19,]   -1.2685672 12.250162  -25.4625639  22.2383227
 [20,]    9.9896747 14.201138  -17.9653777  37.4810943
 [21,]  -13.7300445 13.288796  -39.2297869  13.0764932
 [22,]  -23.4211004 11.347427  -45.5827944  -0.8159848
 [23,]   11.5973436  9.685821   -7.4186705  30.7562869
 [24,]    5.1495877  8.470249  -11.7009342  22.3711032
 [25,]   -3.3539682  7.909116  -19.1927508  12.2248431
 [26,]  -17.1728241  8.138925  -33.6636479  -0.9355995
 [27,]   -7.1792801  9.099950  -25.5755392  10.5971376
 [28,]    8.1816640 10.595049  -13.0849824  28.4047453
 [29,]    8.4737081 12.433021  -16.3393594  32.5802024
 [30,]   -9.9928479 14.483921  -39.3365385  17.6537932
 [31,]   46.9915317 13.241022   20.4712629  71.9237892
 [32,]   20.1147574 11.334396   -2.8684909  41.5738595
 [33,]   -2.1633170  9.700051  -21.4567069  16.7898411
 [34,]   -6.6211913  8.496588  -23.3532227  10.2638371
 [35,]  -11.6912656  7.922852  -27.2507753   3.5741721
 [36,]   -5.6374400  8.113554  -21.5385971   9.9899820
 [37,]  -28.7177143  9.020337  -46.2957041 -10.9294327
 [38,]    3.5696114 10.458575  -16.9130876  23.8999081
 [39,]  -15.0765629 12.242371  -38.9188908   8.6161566
 [40,]   27.8882627 14.242475   -0.2719367  55.3994338
 [41,]   14.4468517 12.965188  -12.3689488  39.2048561
 [42,]    4.3445592 11.129867  -18.8650684  25.7817120
 [43,]   13.6707667  9.561769   -5.4769789  32.3156972
 [44,]   24.4710743  8.411694    8.1601933  40.9264644
 [45,]   13.1386818  7.865203   -2.2843889  28.7932103
 [46,]  -17.3143107  8.046235  -33.1382654  -1.4859230
 [47,]  -28.0524032  8.910558  -45.4338340 -10.6764686
 [48,]    9.1959044 10.287364  -11.2036497  29.3917556
 [49,]  -39.3692881 12.001555  -62.7658575 -15.7278617
 [50,]   30.9705194 13.929122    3.4852481  58.2059087
 [51,]  -25.6959491 12.243981  -49.5162588  -1.4351152
 [52,]  -27.9170412 10.563407  -48.6528249  -7.0633021
 [53,]   -7.9398334  9.168176  -25.7600013  10.1154755
 [54,]   18.6953745  8.205165    2.9081114  34.8976235
 [55,]   16.2171824  7.835393    1.1104839  31.6212718
 [56,]   -1.4204098  8.140113  -16.9213223  14.6158175
 [57,]  132.5715981  9.051457  115.0799751 150.0760152
 [58,]   15.0685060 10.411325   -5.2107375  35.2299907
 [59,]  -11.6345862 12.069047  -35.1976631  11.7339270
 [60,]  -98.2427783 13.918602 -125.5144703 -71.3022877
 [61,]   16.1284189 12.822718   -9.5801822  41.2706312
 [62,]   11.5282188 11.020846  -10.6284975  32.7564516
 [63,]  -11.5702814  9.510638  -30.6097021   7.1741928
 [64,]    1.1573184  8.449951  -15.3639096  17.8740393
 [65,]  -11.7941818  8.019187  -27.7944761   3.6571755
 [66,]   18.8885180  8.316808    2.5765909  34.7594324
 [67,]    2.4357179  9.272943  -15.5810108  20.5590862
 [68,]    8.9363177 10.712698  -11.7112132  29.6894339
 [69,]  -16.8563825 12.469667  -40.9987837   7.8086972
 [70,]    1.5136173 14.428427  -26.8294342  29.9822041
 [71,]   21.1946581 12.431095   -2.9481260  45.4599935
 [72,]   20.3977130 10.723852   -0.3645578  41.2842993
 [73,]  -23.9638321  9.306618  -41.9942276  -5.4881340
 [74,]  -24.1812772  8.328776  -40.2718248  -7.0777138
 [75,]  -11.3542223  7.954063  -26.7440298   4.4854345
 [76,]  -17.7124674  8.264924  -33.7528801  -1.5449551
 [77,]   -7.9039125  9.192065  -25.7783847   9.7569187
 [78,]    6.5691424 10.574611  -14.0611261  26.8067028
 [79,]   -0.7319027 12.259444  -24.4905014  23.1617708
 [80,]   29.2951522 14.138911    2.1011328  56.8749437
 [81,]   -9.0631162 13.297978  -35.8599931  16.7992230
 [82,]   23.4837594 11.331264    0.9004431  45.6982637
 [83,]    4.2352350  9.649381  -14.3882511  22.9808147
 [84,]   20.7546105  8.424682    4.3484284  37.4002830
 [85,]    1.6123861  7.873480  -13.5264566  17.0738979
 [86,]    5.0046617  8.133866  -10.3944252  21.0392391
 [87,]   -3.9712628  9.136716  -21.8644240  14.2255417
 [88,]  -13.9045872 10.674786  -34.3518371   7.7365014
 [89,]  -13.2535116 12.552858  -37.5633795  12.0015951
 [90,]  -11.5530361 14.640666  -39.7567696  17.6662797
 [91,]   26.3733961 13.147799    0.5134234  51.7805904
 [92,]    8.6711856 11.235869  -13.1963777  30.4954399
 [93,]  -32.6648250  9.611597  -50.8841264 -14.1579977
 [94,]    2.7047645  8.442676  -13.4480724  19.0772485
 [95,]    3.1735539  7.933012  -11.8052734  18.8906582
 [96,]   10.1382434  8.206369   -5.5806974  26.2921310
 [97,]    3.4184328  9.193163  -14.6130639  21.3255293
 [98,]   -3.2907777 10.697752  -24.6747329  17.6697413
 [99,]   16.7398117 12.535050   -8.4873069  41.3037644
[100,]    0.6508011 14.579815  -28.7247513  29.6091492
[101,]    9.3998118 12.835802  -15.3817215  35.0291207
[102,]   -7.9213839 11.052298  -29.1617447  14.0131523
[103,]  -10.8471796  9.545541  -29.0487954   8.1298409
[104,]   -6.3854754  8.464635  -22.5759670  10.4446884
[105,]  -22.1318711  7.984443  -37.6430936  -6.3406888
[106,]  -14.6024668  8.211042  -30.6149721   1.3917154
[107,]  -14.3467625  9.091738  -32.1853448   3.4775634
[108,]    0.6557418 10.462639  -19.5750182  21.4553829
[109,]   17.2996461 12.159050   -6.5993841  41.5716849
[110,]   21.1294504 14.063670   -6.1303606  49.1355067
[111,]   17.2902241 13.116760   -7.4525782  44.2292523
[112,]  -12.5471572 11.221508  -34.2074885  10.3980860
[113,]  -16.7917385  9.610996  -35.4716256   2.5910229
[114,]  -34.4641199  8.449641  -51.0168470 -17.7860218
[115,]  -38.0696012  7.937113  -53.7310343 -22.6692569
[116,]    5.7437175  8.196052  -10.3107597  21.6544758
[117,]   38.4686362  9.161274   20.7744213  56.5193569
[118,]    4.9476549 10.642311  -15.6501069  25.5684164
[119,]   19.5215735 12.456515   -4.4606831  44.1433976
[120,]   -2.9078078 14.479190  -30.6639376  25.6752971
[121,]   -4.8621942 12.484920  -29.8014724  18.8256739
[122,]   37.1245143 10.759136   15.9848832  57.9913118
[123,]   -0.5835772  9.321624  -18.7736515  17.5785922
[124,]    2.5672313  8.323114  -13.6447565  18.9075826
[125,]  -13.7388603  7.931183  -29.1485977   1.6258920
[126,]   11.5229482  8.232922   -4.3696759  27.7927881
[127,]  -12.9084433  9.160034  -30.6669296   4.9822893
[128,]  -41.6039348 10.548902  -62.3263204 -20.7987693
[129,]    5.7979736 12.243379  -17.9682950  30.1941916
[130,]   24.2772821 14.133974   -3.0834140  52.3485035
[131,]  -50.1663718 12.669116  -75.1596899 -25.9187100
[132,]   12.2532291 10.894016   -9.1520894  32.8300067
[133,]   26.8406299  9.393585    8.4127107  44.8253037
[134,]   32.7204307  8.317817   16.2229436  48.8803964
[135,]   20.5079316  7.843436    4.9704385  35.6882102
[136,]   10.4992324  8.077108   -5.1561206  25.8645906
[137,]   -2.0000668  8.963629  -19.1670432  14.8218884
[138,]  -10.0912659 10.336362  -30.0902517   9.6094467
[139,]   -8.9804651 12.030000  -32.5478115  14.0186181
[140,]  -10.1765643 13.927964  -37.3107159  16.2533483
[141,]   17.3228953 12.239478   -6.8060921  41.0923888
[142,]    2.4944825 10.601472  -18.4538043  23.0671590
[143,]  -20.0418302  9.258512  -38.4091966  -2.1682383
[144,]  -10.9694430  8.354123  -27.4147245   5.0925058
[145,]   14.8543443  8.037733   -0.8369679  30.3445629
[146,]    5.9038315  8.376240  -10.2402453  22.0997219
[147,]  -24.5161813  9.298393  -42.0316315  -6.5730700
[148,]   14.1296060 10.653699   -6.3435702  34.6576577
[149,]   -5.0551068 12.299794  -28.3989276  18.5843210
[150,]    9.8361805 14.135454  -16.5758258  37.1644339
[151,]   -0.9969687 13.346009  -26.6116601  25.7301738
[152,]   -6.9286682 11.454946  -28.9003903  15.8832147
[153,]  -17.7425676  9.833538  -36.8673396   1.5875855
[154,]  -31.3615671  8.635044  -48.4017327 -14.2221542
[155,]  -19.4884665  8.050610  -35.4859415  -3.6682301
[156,]   41.9767340  8.212398   25.7473634  58.1415021
[157,]  -36.2600655  9.080610  -53.8103215 -17.9468505
[158,]   14.9861351 10.481141   -4.7676633  36.1082015
[159,]   17.3724356 12.232497   -6.0078510  41.8187794
[160,]    9.2470362 14.205509  -17.9114939  37.5727013
[161,]   17.8669946 12.254741   -6.4161534  42.6807763
[162,]   10.9431470 10.544553   -9.8667244  32.2886164
[163,]    6.9129995  9.113284  -11.3489072  25.1244512
[164,]    1.3173519  8.109979  -14.9663005  17.1984632
[165,]  -10.7878957  7.703701  -25.8883246   4.2555575
[166,]  -14.9326433  7.986094  -30.6574897   0.7952297
[167,]  -49.6650909  8.891785  -67.5808789 -31.9998828
[168,]  -13.7865385 10.256970  -34.8510987   6.2473274
[169,]   22.8773139 11.924867   -1.4063535  46.1976216
[170,]   32.0795663 13.786041    3.9490792  58.9235062
[171,]    5.6045913 12.165840  -19.0353138  28.5977472
[172,]   -2.0777522 10.486872  -23.2478509  17.9783809
[173,]   10.3004043  9.092290   -7.8327043  27.8223828
[174,]   11.5905608  8.129786   -4.5295060  27.4326937
[175,]  -23.6130827  7.761800  -38.8732388  -8.5694532
[176,]    7.0772737  8.070074   -8.5707489  22.9951678
[177,]    0.2068302  8.985271  -17.3235780  18.1948810
[178,]   -2.7997133 10.347586  -23.1841996  18.1607315
[179,]   11.3774432 12.005765  -12.2856124  35.4052412
[180,]   -5.3853003 13.853978  -32.5293447  21.8587183</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.2 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1461      
 (0.5, 0.7]   (ok)         2    1.1%   74        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.9 22.3
p_loo        33.6  8.3
looic      1721.8 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1185      
 (0.5, 0.7]   (ok)         6    3.3%   75        
   (0.7, 1]   (bad)        2    1.1%   28        
   (1, Inf)   (very bad)   1    0.6%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.2      11.5  
fit_sleep1 -92.5      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.2 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1461      
 (0.5, 0.7]   (ok)         2    1.1%   74        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.9 22.3
p_loo        33.6  8.3
looic      1721.8 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1185      
 (0.5, 0.7]   (ok)         6    3.3%   75        
   (0.7, 1]   (bad)        2    1.1%   28        
   (1, Inf)   (very bad)   1    0.6%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.9     22.3        33.6    8.3   1721.8
fit_sleep2  -24.2      11.5  -885.1     14.4        19.6    3.4   1770.2
fit_sleep1  -92.5      20.9  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   44.5  
fit_sleep2   28.9  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.534244e-41 3.093719e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.94      1.59      0.3      5.5       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.06      1.59    -3.28     2.97       5.56      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0.1       tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
