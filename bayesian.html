<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.89      6.94    15.36    43.47 1.00     1627     2200
sd(Days)                6.59      1.58     4.19    10.49 1.00     1441     1599
cor(Intercept,Days)     0.10      0.30    -0.47     0.66 1.00      959     1794

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.21      7.50   236.79   266.07 1.00     1781     2566
Days         10.46      1.73     6.96    14.02 1.00     1223     1513

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.58    23.06    29.22 1.00     3538     2995

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0007  13.20552 228.2267 279.8034
309 211.5413  13.07250 186.5531 236.9119
310 213.0572  13.46196 187.1278 239.1575
330 274.5403  12.99320 250.1984 300.8350
331 273.1940  12.92350 248.9537 299.4308
332 260.4617  12.33520 236.6567 284.5467
333 268.1146  12.74101 243.9533 294.3181
334 244.3984  12.29639 219.8796 268.5127
335 250.8030  13.41340 225.1004 277.9861
337 285.9730  12.95609 261.3703 311.9253
349 226.6434  13.16827 199.6972 251.7697
350 238.7578  13.07729 212.2054 264.1891
351 255.8673  12.41416 231.6428 280.7912
352 272.1108  12.82074 247.6095 297.5929
369 254.8007  12.13186 230.3223 278.1687
370 226.3419  13.67883 199.0101 252.2569
371 252.0020  12.62672 227.2193 277.2879
372 263.7870  12.09708 240.1435 288.1285

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6563838  2.520665 14.8266721 24.600058
309  1.7439706  2.480645 -3.1415180  6.380475
310  4.9095950  2.553602  0.1048576  9.987652
330  5.7510912  2.437904  0.9175162 10.317698
331  7.5358743  2.474854  2.4634172 12.217516
332 10.1795792  2.361420  5.5271220 14.826224
333 10.2572412  2.378593  5.5170525 14.910150
334 11.5005653  2.332210  6.9113300 16.084896
335 -0.2040553  2.573746 -5.3878423  4.644570
337 19.1738171  2.459165 14.2733591 24.052344
349 11.5394285  2.459430  6.7811405 16.525810
350 17.0087000  2.483271 12.1297815 21.958435
351  7.4808015  2.357162  2.7951827 12.090394
352 14.0502116  2.410459  9.2784206 18.655907
369 11.3518605  2.323892  6.8770445 16.020653
370 15.1836892  2.564112 10.2959221 20.249700
371  9.5036741  2.398954  4.6976409 14.128754
372 11.7455197  2.340168  7.0992191 16.274054</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0007 13.205518 228.2267 279.8034
  [2,] 273.6571 11.290466 251.8158 295.9502
  [3,] 293.3135  9.657693 274.3328 312.2541
  [4,] 312.9698  8.472010 296.6420 329.7271
  [5,] 332.6262  7.936395 317.2608 348.1386
  [6,] 352.2826  8.179565 336.2857 367.9521
  [7,] 371.9390  9.139567 354.1512 389.4358
  [8,] 391.5954 10.623823 370.5767 411.6937
  [9,] 411.2518 12.446165 386.9138 434.6761
 [10,] 430.9081 14.479500 402.8305 458.6330
 [11,] 211.5413 13.072496 186.5531 236.9119
 [12,] 213.2852 11.194245 191.2955 235.0040
 [13,] 215.0292  9.593711 196.2128 234.1002
 [14,] 216.7732  8.430580 200.3921 233.4369
 [15,] 218.5171  7.900460 203.0859 234.0546
 [16,] 220.2611  8.128164 204.4427 236.7097
 [17,] 222.0051  9.056712 204.3070 239.9702
 [18,] 223.7491 10.501821 203.1075 244.0284
 [19,] 225.4930 12.282493 201.3155 249.1071
 [20,] 227.2370 14.273690 198.8749 254.6884
 [21,] 213.0572 13.461963 187.1278 239.1575
 [22,] 217.9668 11.500817 195.8237 240.4119
 [23,] 222.8764  9.816052 204.1556 242.1560
 [24,] 227.7860  8.572208 211.2766 244.5713
 [25,] 232.6956  7.978243 217.0449 248.5592
 [26,] 237.6052  8.177026 221.5801 253.9976
 [27,] 242.5148  9.116847 224.7922 260.5795
 [28,] 247.4243 10.602443 226.7872 268.4624
 [29,] 252.3339 12.439794 228.0809 277.1168
 [30,] 257.2435 14.495755 228.7388 285.7355
 [31,] 274.5403 12.993196 250.1984 300.8350
 [32,] 280.2914 11.150821 258.9834 302.9256
 [33,] 286.0424  9.578373 267.9258 305.1918
 [34,] 291.7935  8.428310 275.4582 308.0286
 [35,] 297.5446  7.887605 281.9691 313.3035
 [36,] 303.2957  8.079541 287.5867 319.2894
 [37,] 309.0468  8.957142 291.6843 326.8369
 [38,] 314.7979 10.347394 294.5364 335.4178
 [39,] 320.5490 12.074496 296.5015 344.3192
 [40,] 326.3001 14.014461 298.0906 353.9039
 [41,] 273.1940 12.923504 248.9537 299.4308
 [42,] 280.7299 11.045869 259.8340 302.7434
 [43,] 288.2658  9.447501 270.2141 306.9932
 [44,] 295.8016  8.291510 279.8342 312.2338
 [45,] 303.3375  7.777713 288.1772 318.6239
 [46,] 310.8734  8.030337 295.1001 326.7642
 [47,] 318.4093  8.984965 300.7591 335.9318
 [48,] 325.9451 10.450967 305.3078 346.1992
 [49,] 333.4810 12.246045 309.8075 357.4901
 [50,] 341.0169 14.246345 312.5996 369.3034
 [51,] 260.4617 12.335203 236.6567 284.5467
 [52,] 270.6413 10.605701 250.0073 291.3313
 [53,] 280.8209  9.162815 262.7870 298.6545
 [54,] 291.0005  8.160028 275.2214 306.8713
 [55,] 301.1801  7.769656 286.1715 316.0676
 [56,] 311.3596  8.080944 295.5376 326.9361
 [57,] 321.5392  9.021549 304.1141 338.9365
 [58,] 331.7188 10.422460 311.4432 351.5045
 [59,] 341.8984 12.125163 317.8312 364.9498
 [60,] 352.0779 14.020132 324.1692 379.0297
 [61,] 268.1146 12.741011 243.9533 294.3181
 [62,] 278.3718 10.954691 257.8110 301.1184
 [63,] 288.6291  9.433587 270.5562 307.7770
 [64,] 298.8863  8.324379 282.9320 315.3131
 [65,] 309.1436  7.804705 293.6799 323.8686
 [66,] 319.4008  7.990428 303.4611 334.8291
 [67,] 329.6581  8.837187 312.3907 346.4706
 [68,] 339.9153 10.181366 319.9271 359.8865
 [69,] 350.1725 11.854955 326.7854 373.9935
 [70,] 360.4298 13.738090 333.4517 387.5693
 [71,] 244.3984 12.296389 219.8796 268.5127
 [72,] 255.8990 10.566959 234.9535 276.6520
 [73,] 267.3995  9.110348 249.3803 285.4099
 [74,] 278.9001  8.075561 263.3067 294.9686
 [75,] 290.4007  7.636056 275.6330 305.6088
 [76,] 301.9012  7.891920 286.5561 317.1638
 [77,] 313.4018  8.782589 296.4036 330.7858
 [78,] 324.9024 10.142177 305.2051 344.6417
 [79,] 336.4029 11.809828 312.9283 359.4854
 [80,] 347.9035 13.673286 321.2085 374.8911
 [81,] 250.8030 13.413395 225.1004 277.9861
 [82,] 250.5989 11.434543 228.7229 273.8492
 [83,] 250.3949  9.737902 231.6352 270.1694
 [84,] 250.1908  8.494293 234.0063 267.3195
 [85,] 249.9867  7.920078 234.7568 265.6252
 [86,] 249.7827  8.157855 233.9639 265.6569
 [87,] 249.5786  9.144501 232.1178 267.5956
 [88,] 249.3746 10.674340 228.9901 270.1256
 [89,] 249.1705 12.550280 224.7134 273.8346
 [90,] 248.9665 14.639872 220.4345 277.5050
 [91,] 285.9730 12.956095 261.3703 311.9253
 [92,] 305.1468 11.114477 283.9659 326.9641
 [93,] 324.3207  9.554988 305.9115 343.2322
 [94,] 343.4945  8.435578 327.0324 360.0749
 [95,] 362.6683  7.944504 347.2979 378.2741
 [96,] 381.8421  8.195504 365.6430 398.1032
 [97,] 401.0159  9.127564 383.1550 419.1204
 [98,] 420.1897 10.561892 399.5249 441.1293
 [99,] 439.3636 12.324353 414.9286 463.9660
[100,] 458.5374 14.294082 430.1204 487.3418
[101,] 226.6434 13.168268 199.6972 251.7697
[102,] 238.1829 11.304228 215.1531 259.6675
[103,] 249.7223  9.709041 230.4678 268.1604
[104,] 261.2617  8.534809 244.4572 277.4657
[105,] 272.8011  7.969822 257.4050 288.1475
[106,] 284.3406  8.141913 268.3508 300.6542
[107,] 295.8800  9.008941 278.1447 313.7642
[108,] 307.4194 10.398505 286.7958 328.0969
[109,] 318.9589 12.132369 295.3971 342.7410
[110,] 330.4983 14.083943 302.7004 358.7113
[111,] 238.7578 13.077295 212.2054 264.1891
[112,] 255.7665 11.224571 233.1191 277.3522
[113,] 272.7752  9.659174 253.4188 291.5156
[114,] 289.7839  8.540582 273.2374 306.2554
[115,] 306.7926  8.057091 291.0758 322.3146
[116,] 323.8013  8.320165 307.3692 339.9401
[117,] 340.8100  9.266436 322.8935 359.3952
[118,] 357.8187 10.716427 336.8239 378.9395
[119,] 374.8274 12.496001 350.3555 399.7248
[120,] 391.8361 14.484182 363.6543 420.6092
[121,] 255.8673 12.414159 231.6428 280.7912
[122,] 263.3481 10.685270 243.0732 284.5570
[123,] 270.8289  9.238564 253.0664 288.6880
[124,] 278.3097  8.224327 262.4108 294.1810
[125,] 285.7905  7.812841 270.6557 300.5274
[126,] 293.2713  8.096531 277.2883 308.9298
[127,] 300.7521  9.009971 282.8759 318.3119
[128,] 308.2329 10.388348 287.7723 328.4363
[129,] 315.7137 12.073457 291.9552 338.9189
[130,] 323.1945 13.954619 295.9479 350.3642
[131,] 272.1108 12.820735 247.6095 297.5929
[132,] 286.1611 11.012944 265.0285 308.2678
[133,] 300.2113  9.477301 281.9254 319.2845
[134,] 314.2615  8.365057 297.8967 330.4208
[135,] 328.3117  7.858100 312.9786 343.2851
[136,] 342.3619  8.071302 326.2379 357.6655
[137,] 356.4121  8.953365 338.7476 373.8650
[138,] 370.4623 10.334417 350.2236 390.5254
[139,] 384.5125 12.044013 360.9828 408.4550
[140,] 398.5627 13.961982 371.3035 426.1347
[141,] 254.8007 12.131859 230.3223 278.1687
[142,] 266.1526 10.411087 245.2290 286.3647
[143,] 277.5044  8.966626 259.8997 294.7174
[144,] 288.8563  7.950534 273.2834 304.4915
[145,] 300.2082  7.538074 285.7697 315.0009
[146,] 311.5600  7.825283 296.3519 326.5355
[147,] 322.9119  8.743484 305.6821 339.2808
[148,] 334.2637 10.122397 314.4309 353.4663
[149,] 345.6156 11.801622 322.7141 367.9713
[150,] 356.9675 13.670939 330.5026 383.5298
[151,] 226.3419 13.678829 199.0101 252.2569
[152,] 241.5256 11.681114 218.3086 263.6041
[153,] 256.7093  9.946648 236.8091 275.1907
[154,] 271.8930  8.635540 254.7148 288.0542
[155,] 287.0767  7.959813 271.0889 302.4435
[156,] 302.2604  8.080473 286.2518 317.7041
[157,] 317.4441  8.965422 299.5595 334.7526
[158,] 332.6278 10.421750 311.9640 352.8735
[159,] 347.8115 12.247298 323.7698 371.5685
[160,] 362.9951 14.301367 335.2443 391.0355
[161,] 252.0020 12.626720 227.2193 277.2879
[162,] 261.5057 10.879888 240.4687 283.2573
[163,] 271.0094  9.424429 252.8178 289.8891
[164,] 280.5130  8.412949 264.3773 296.9533
[165,] 290.0167  8.015331 274.4546 305.6381
[166,] 299.5204  8.320055 283.3754 315.8021
[167,] 309.0240  9.258027 290.7975 326.6919
[168,] 318.5277 10.663431 297.0953 338.7774
[169,] 328.0314 12.378063 303.1132 351.8983
[170,] 337.5351 14.291049 309.1695 365.1715
[171,] 263.7870 12.097075 240.1435 288.1285
[172,] 275.5325 10.405305 254.9619 296.3061
[173,] 287.2780  9.008567 269.4969 305.1502
[174,] 299.0235  8.061698 283.0853 315.1234
[175,] 310.7691  7.731780 295.3664 326.3117
[176,] 322.5146  8.094605 306.5524 338.3767
[177,] 334.2601  9.067394 316.6251 351.8113
[178,] 346.0056 10.481669 325.8958 366.5008
[179,] 357.7511 12.184659 334.2204 381.8244
[180,] 369.4967 14.071930 342.2024 397.3173</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5      Q97.5
  [1,]   -4.4406919 13.205518  -30.24337689  21.333307
  [2,]  -14.9523757 11.290466  -37.24546492   6.888937
  [3,]  -42.5128595  9.657693  -61.45346228 -23.532161
  [4,]    8.4699568  8.472010   -8.28733177  24.797841
  [5,]   24.2256730  7.936395    8.71333382  39.591116
  [6,]   62.4074892  8.179565   46.73798195  78.404405
  [7,]   10.2648055  9.139567   -7.23198307  28.052635
  [8,] -101.4467783 10.623823 -121.54511271 -80.428085
  [9,]   19.3335380 12.446165   -4.09080423  43.671513
 [10,]   35.4453542 14.479500    7.72048628  63.522999
 [11,]   11.1926431 13.072496  -14.17795262  36.180752
 [12,]   -8.0194275 11.194245  -29.73815837  13.970277
 [13,]  -12.0513980  9.593711  -31.12236842   6.764963
 [14,]  -12.0661686  8.430580  -28.72990095   4.314855
 [15,]  -10.8010392  7.900460  -26.33847775   4.630159
 [16,]   -4.2993097  8.128164  -20.74791481  11.519115
 [17,]   -8.3747803  9.056712  -26.33988038   9.323307
 [18,]   -6.0218508 10.501821  -26.30122709  14.619715
 [19,]   -1.1973214 12.282493  -24.81135766  22.980202
 [20,]   10.0772080 14.273690  -17.37417779  38.439257
 [21,]  -14.0032823 13.461963  -40.10360890  11.926052
 [22,]  -23.6345773 11.500817  -46.07966899  -1.491494
 [23,]   11.4436277  9.816052   -7.83602119  30.164371
 [24,]    5.0556327  8.572208  -11.72973882  21.564953
 [25,]   -3.3881624  7.978243  -19.25175935  12.262517
 [26,]  -17.1472574  8.177026  -33.53968108  -1.122201
 [27,]   -7.0939524  9.116847  -25.15865790  10.628617
 [28,]    8.3267526 10.602443  -12.71130395  28.963896
 [29,]    8.6785575 12.439794  -16.10434738  32.931565
 [30,]   -9.7282375 14.495755  -38.22018065  18.776546
 [31,]   47.0023393 12.993196   20.70758041  71.344247
 [32,]   20.1088481 11.150821   -2.52539621  41.416846
 [33,]   -2.1859431  9.578373  -21.33530639  15.930748
 [34,]   -6.6605344  8.428310  -22.89556719   9.674798
 [35,]  -11.7473256  7.887605  -27.50622241   3.828214
 [36,]   -5.7102168  8.079541  -21.70392476   9.998803
 [37,]  -28.8072080  8.957142  -46.59731891 -11.444746
 [38,]    3.4634007 10.347394  -17.15649047  23.724859
 [39,]  -15.1994905 12.074496  -38.96969079   8.848037
 [40,]   27.7486183 14.014461    0.14479910  55.958052
 [41,]   14.4138877 12.923504  -11.82285776  38.654217
 [42,]    4.2701134 11.045869  -17.74337546  25.165974
 [43,]   13.5548391  9.447501   -5.17260960  31.606468
 [44,]   24.3136648  8.291510    7.88154662  40.281097
 [45,]   12.9397905  7.777713   -2.34655948  28.100102
 [46,]  -17.5546838  8.030337  -33.44545237  -1.781414
 [47,]  -28.3342581  8.984965  -45.85678715 -10.684081
 [48,]    8.8725677 10.450967  -11.38151342  29.509910
 [49,]  -39.7341066 12.246045  -63.74318449 -16.060638
 [50,]   30.5642191 14.246345    2.27771980  58.981464
 [51,]  -25.6011370 12.335203  -49.68608787  -1.796138
 [52,]  -27.8295162 10.605701  -48.51953973  -7.195495
 [53,]   -7.8595953  9.162815  -25.69324508  10.174289
 [54,]   18.7683255  8.160028    2.89752291  34.547446
 [55,]   16.2828463  7.769656    1.39527114  31.291374
 [56,]   -1.3620328  8.080944  -16.93847476  14.460047
 [57,]  132.6226880  9.021549  115.22537439 150.047754
 [58,]   15.1123088 10.422460   -4.67335701  35.387903
 [59,]  -11.5980703 12.125163  -34.64947693  12.469108
 [60,]  -98.2135495 14.020132 -125.16529188 -70.304778
 [61,]   15.7277937 12.741011  -10.47567186  39.889078
 [62,]   11.1831524 10.954691  -11.56343856  31.744000
 [63,]  -11.8597888  9.433587  -31.00770944   6.213050
 [64,]    0.9233700  8.324379  -15.50339971  16.877708
 [65,]  -11.9725713  7.804705  -26.69761178   3.491118
 [66,]   18.7656875  7.990428    3.33743953  34.705371
 [67,]    2.3684463  8.837187  -14.44405376  19.635795
 [68,]    8.9246050 10.181366  -11.04662596  28.912819
 [69,]  -16.8125362 11.854955  -40.63349506   6.574566
 [70,]    1.6130226 13.738090  -25.52646581  28.591097
 [71,]   21.0746847 12.296389   -3.03956546  45.593531
 [72,]   20.3022195 10.566959   -0.45076543  41.247671
 [73,]  -24.0348458  9.110348  -42.04520624  -6.015599
 [74,]  -24.2278111  8.075561  -40.29628880  -8.634403
 [75,]  -11.3762764  7.636056  -26.58435038   3.391381
 [76,]  -17.7100416  7.891920  -32.97256815  -2.364854
 [77,]   -7.8770069  8.782589  -25.26101982   9.121169
 [78,]    6.6205278 10.142177  -13.11883960  26.317778
 [79,]   -0.6560374 11.809828  -23.73846724  22.818601
 [80,]   29.3954973 13.673286    2.40790493  56.090459
 [81,]   -9.1946695 13.413395  -36.37777582  16.507925
 [82,]   23.3482858 11.434543    0.09802338  45.224257
 [83,]    4.0958411  9.737902  -15.67871376  22.855545
 [84,]   20.6112965  8.494293    3.48255367  36.795815
 [85,]    1.4651518  7.920078  -14.17330437  16.695062
 [86,]    4.8535071  8.157855  -11.02073818  20.672292
 [87,]   -4.1263375  9.144501  -22.14331567  13.334452
 [88,]  -14.0635822 10.674340  -34.81455352   6.320885
 [89,]  -13.4164269 12.550280  -38.08045782  11.040693
 [90,]  -11.7198716 14.639872  -40.25837178  16.812097
 [91,]   26.3935802 12.956095    0.44127995  50.996339
 [92,]    8.6589631 11.114477  -13.15828527  29.839940
 [93,]  -32.7094539  9.554988  -51.62099365 -14.300288
 [94,]    2.6277290  8.435578  -13.95266918  19.089778
 [95,]    3.0641119  7.944504  -12.54167758  18.434460
 [96,]    9.9963948  8.195504   -6.26467978  26.195477
 [97,]    3.2441778  9.127564  -14.86032005  21.105094
 [98,]   -3.4974393 10.561892  -24.43704731  17.167385
 [99,]   16.5007436 12.324353   -8.10170193  40.935702
[100,]    0.3793265 14.294082  -28.42512824  28.796327
[101,]    9.4597783 13.168268  -15.66654570  36.405973
[102,]   -7.8661502 11.304228  -29.35084380  15.163594
[103,]  -10.7966788  9.709041  -29.23479130   8.457835
[104,]   -6.3397073  8.534809  -22.54370988  10.464783
[105,]  -22.0908359  7.969822  -37.43720329  -6.694727
[106,]  -14.5661644  8.141913  -30.87976546   1.423629
[107,]  -14.3151930  9.008941  -32.19937219   3.420134
[108,]    0.6825785 10.398505  -19.99486825  21.306218
[109,]   17.3217500 12.132369   -6.46036916  40.883481
[110,]   21.1468214 14.083943   -7.06615212  48.944738
[111,]   17.5390465 13.077295   -7.89227565  44.091400
[112,]  -12.3121535 11.224571  -33.89790505  10.335216
[113,]  -16.5705535  9.659174  -35.31104797   2.785829
[114,]  -34.2567535  8.540582  -50.72832913 -17.710303
[115,]  -37.8760535  8.057091  -53.39814332 -22.159260
[116,]    5.9234465  8.320165  -10.21540609  22.355480
[117,]   38.6345464  9.266436   20.04933592  56.550975
[118,]    5.0997464 10.716427  -16.02112261  26.094522
[119,]   19.6598464 12.496001   -5.23755501  44.131723
[120,]   -2.7833536 14.484182  -31.55651510  25.398436
[121,]   -5.3407896 12.414159  -30.26468614  18.883696
[122,]   36.7095089 10.685270   15.50062733  56.984409
[123,]   -0.9349927  9.238564  -18.79409210  16.827461
[124,]    2.2794058  8.224327  -13.59188275  18.178260
[125,]  -13.9630957  7.812841  -28.70003209   1.171693
[126,]   11.3623028  8.096531   -4.29619136  27.345343
[127,]  -13.0054987  9.009971  -30.56533157   4.870740
[128,]  -41.6374002 10.388348  -61.84083941 -21.176811
[129,]    5.8280983 12.073457  -17.37712442  29.586557
[130,]   24.3709967 13.954619   -2.79870764  51.617563
[131,]  -50.4337419 12.820735  -75.91577166 -25.932378
[132,]   12.0328465 11.012944  -10.07387711  33.165431
[133,]   26.6672349  9.477301    7.59396641  44.953146
[134,]   32.5940232  8.365057   16.43470242  48.958801
[135,]   20.4285116  7.858100    5.45509182  35.761645
[136,]   10.4668000  8.071302   -4.83681904  26.590806
[137,]   -1.9855116  8.953365  -19.43844769  15.678969
[138,]  -10.0297233 10.334417  -30.09283219  10.209038
[139,]   -8.8719349 12.044013  -32.81438820  14.657845
[140,]  -10.0210465 13.961982  -37.59299817  17.238214
[141,]   17.1227819 12.131859   -6.24519918  41.601191
[142,]    2.2843214 10.411087  -17.92783169  23.207926
[143,]  -20.2620391  8.966626  -37.47502557  -2.657256
[144,]  -11.1996996  7.950534  -26.83486993   4.373181
[145,]   14.6140398  7.538074   -0.17865721  29.052460
[146,]    5.6534793  7.825283   -9.32197897  20.861634
[147,]  -24.7765812  8.743484  -41.14546298  -7.546780
[148,]   13.8591583 10.122397   -5.34337471  33.692001
[149,]   -5.3356022 11.801622  -27.69126406  17.565917
[150,]    9.5456373 13.670939  -17.01669710  36.010499
[151,]   -1.0779433 13.678829  -26.99294925  26.253884
[152,]   -7.0021325 11.681114  -29.08060356  16.214943
[153,]  -17.8085216  9.946648  -36.28993449   2.091667
[154,]  -31.4200108  8.635540  -47.58124637 -14.241834
[155,]  -19.5393999  7.959813  -34.90618162  -3.551618
[156,]   41.9333109  8.080473   26.48957704  57.941878
[157,]  -36.2959782  8.965422  -53.60446468 -18.411402
[158,]   14.9577326 10.421750   -5.28796432  35.621464
[159,]   17.3515435 12.247298   -6.40553315  41.393216
[160,]    9.2336543 14.301367  -18.80665577  36.984483
[161,]   17.8783971 12.626720   -7.40746128  42.661137
[162,]   10.9371230 10.879888  -10.81449109  31.974134
[163,]    6.8895489  9.424429  -11.99015523  25.081140
[164,]    1.2764748  8.412949  -15.16381792  17.412241
[165,]  -10.8461993  8.015331  -26.46764833   4.715903
[166,]  -15.0083733  8.320055  -31.29010185   1.136598
[167,]  -49.7582474  9.258027  -67.42609160 -31.531651
[168,]  -13.8971215 10.663431  -34.14677540   7.535335
[169,]   22.7493044 12.378063   -1.11761406  47.667548
[170,]   31.9341303 14.291049    4.29771421  60.299677
[171,]    5.6247237 12.097075  -18.71683276  29.268173
[172,]   -2.0584960 10.405305  -22.83214347  18.512053
[173,]   10.3187843  9.008567   -7.55337967  28.099889
[174,]   11.6080647  8.061698   -4.49180153  27.546284
[175,]  -23.5964550  7.731780  -39.13913814  -8.193788
[176,]    7.0930253  8.094605   -8.76911938  23.055210
[177,]    0.2217056  9.067394  -17.32952136  17.856667
[178,]   -2.7857141 10.481669  -23.28085826  17.324066
[179,]   11.3905663 12.184659  -12.68274495  34.921260
[180,]   -5.3730534 14.071930  -33.19373655  21.921217</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.2  3.3
looic      1769.6 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   693       
 (0.5, 0.7]   (ok)         1    0.6%   171       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.4
p_loo        34.0  8.4
looic      1721.9 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     169   93.9%   1203      
 (0.5, 0.7]   (ok)         8    4.4%   506       
   (0.7, 1]   (bad)        1    0.6%   45        
   (1, Inf)   (very bad)   2    1.1%   21        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.8      11.8  
fit_sleep1 -92.4      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.2  3.3
looic      1769.6 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   693       
 (0.5, 0.7]   (ok)         1    0.6%   171       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.4
p_loo        34.0  8.4
looic      1721.9 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     169   93.9%   1203      
 (0.5, 0.7]   (ok)         8    4.4%   506       
   (0.7, 1]   (bad)        1    0.6%   45        
   (1, Inf)   (very bad)   2    1.1%   21        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.4        34.0    8.4   1721.9
fit_sleep2  -23.8      11.8  -884.8     14.3        19.2    3.3   1769.6
fit_sleep1  -92.4      21.1  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.8  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
7.679345e-41 4.516619e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.84      1.62     0.16     5.41       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.16      1.62    -3.51     3.01       4.99      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.3.5         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.0       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
