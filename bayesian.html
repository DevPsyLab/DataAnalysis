<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.94      6.59    15.71    41.82 1.00     1916     2597
sd(Days)                6.56      1.50     4.21     9.98 1.00     1531     1826
cor(Intercept,Days)     0.09      0.29    -0.47     0.66 1.00      952     1899

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.11      7.43   236.30   266.14 1.00     1791     2406
Days         10.39      1.69     7.01    13.66 1.00     1362     1943

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.86      1.53    23.15    29.13 1.00     3784     2639

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.5464  12.70982 227.9803 277.8023
309 211.3677  13.62828 184.8343 238.0480
310 213.0096  13.45735 186.1937 238.5439
330 274.4902  13.35998 248.8168 300.5327
331 273.5132  13.02374 248.5276 299.3777
332 260.0194  12.09913 236.5028 284.5415
333 268.0504  12.82299 243.4936 293.2973
334 244.3357  12.38594 219.8306 269.0683
335 250.7074  13.53421 225.3710 278.6488
337 285.8224  13.08472 260.9760 311.5204
349 226.3080  12.93153 200.5797 251.2062
350 238.4492  13.04628 211.7494 263.6063
351 255.6597  12.63669 230.3604 281.7070
352 271.8722  12.25314 248.4717 296.2335
369 254.4350  12.36448 229.0776 277.8597
370 226.4271  13.29213 198.7271 251.0403
371 252.4839  12.03622 229.4840 276.7682
372 263.5847  12.17642 240.2155 287.6822

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6546846  2.420263 14.90898481 24.258389
309  1.7849512  2.518264 -3.04421592  6.727101
310  4.9023635  2.515932 -0.07015614  9.801626
330  5.7644546  2.513734  0.75154775 10.485457
331  7.4470114  2.460991  2.47650777 12.101390
332 10.2102760  2.290462  5.78177297 14.667944
333 10.3147231  2.421841  5.54261078 15.007409
334 11.4693987  2.364885  6.91479949 16.204118
335 -0.2456434  2.600007 -5.34424704  4.697257
337 19.1811217  2.451767 14.23998879 24.027535
349 11.6071525  2.462113  6.76963097 16.489185
350 17.0648280  2.487993 12.30141720 21.916259
351  7.5030243  2.397386  2.66594009 12.105850
352 14.1318776  2.293885  9.62369035 18.615351
369 11.3460642  2.373119  6.60046117 16.055526
370 15.1838129  2.542413 10.38971428 20.297608
371  9.4241327  2.322723  4.66831962 14.000495
372 11.8082713  2.334611  7.23766404 16.501622</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.5464 12.709818 227.9803 277.8023
  [2,] 273.2011 10.899169 251.3676 294.0690
  [3,] 292.8558  9.368012 274.3838 311.0191
  [4,] 312.5104  8.273014 296.4573 328.2525
  [5,] 332.1651  7.800078 317.1168 347.5343
  [6,] 351.8198  8.059468 336.2220 367.6236
  [7,] 371.4745  8.988002 353.8960 388.8914
  [8,] 391.1292 10.408106 370.8047 411.4042
  [9,] 410.7839 12.148602 386.8030 434.6941
 [10,] 430.4385 14.091264 402.7600 457.6987
 [11,] 211.3677 13.628280 184.8343 238.0480
 [12,] 213.1527 11.707717 190.3085 236.3291
 [13,] 214.9376 10.054579 195.1686 234.9366
 [14,] 216.7226  8.820533 199.3323 233.7902
 [15,] 218.5075  8.197094 202.2778 234.5788
 [16,] 220.2925  8.322632 203.5915 236.3810
 [17,] 222.0774  9.166426 204.0712 239.8893
 [18,] 223.8624 10.557643 203.3721 244.4675
 [19,] 225.6473 12.312091 201.6957 249.7195
 [20,] 227.4323 14.296666 199.0322 254.9305
 [21,] 213.0096 13.457353 186.1937 238.5439
 [22,] 217.9119 11.530349 194.7684 239.9540
 [23,] 222.8143  9.872050 202.9257 241.5801
 [24,] 227.7167  8.638613 210.3424 244.3325
 [25,] 232.6190  8.028307 217.0343 248.0888
 [26,] 237.5214  8.181786 221.7844 253.7813
 [27,] 242.4237  9.060318 225.0716 260.4202
 [28,] 247.3261 10.483174 226.9391 268.3513
 [29,] 252.2285 12.262314 227.9539 276.2335
 [30,] 257.1308 14.265047 229.1392 284.9456
 [31,] 274.4902 13.359976 248.8168 300.5327
 [32,] 280.2547 11.416630 258.1701 302.4335
 [33,] 286.0191  9.737949 267.0135 304.9249
 [34,] 291.7836  8.482545 275.3972 308.2709
 [35,] 297.5480  7.856030 282.1768 312.8336
 [36,] 303.3125  8.007407 287.7772 319.1480
 [37,] 309.0769  8.897057 291.5128 326.4135
 [38,] 314.8414 10.336074 293.7810 334.6415
 [39,] 320.6059 12.130495 296.0791 343.5418
 [40,] 326.3703 14.145711 298.2236 353.0378
 [41,] 273.5132 13.023739 248.5276 299.3777
 [42,] 280.9602 11.160777 259.4060 303.0580
 [43,] 288.4072  9.571890 269.8290 307.2240
 [44,] 295.8542  8.413808 279.4632 312.4273
 [45,] 303.3012  7.878845 287.3380 318.5974
 [46,] 310.7482  8.091550 294.7994 326.6312
 [47,] 318.1952  8.999061 299.9837 335.7408
 [48,] 325.6423 10.421420 304.9263 345.7375
 [49,] 333.0893 12.179565 308.8279 356.6413
 [50,] 340.5363 14.148873 312.9653 368.2840
 [51,] 260.0194 12.099131 236.5028 284.5415
 [52,] 270.2297 10.480486 249.7089 291.3167
 [53,] 280.4400  9.153395 262.6155 298.5725
 [54,] 290.6502  8.259609 274.7025 306.8984
 [55,] 300.8605  7.946702 285.5098 316.4120
 [56,] 311.0708  8.280787 295.0692 326.8449
 [57,] 321.2811  9.191585 303.2897 338.7715
 [58,] 331.4913 10.530502 310.8996 351.8208
 [59,] 341.7016 12.156896 317.7268 365.3645
 [60,] 351.9119 13.970728 324.8881 379.4358
 [61,] 268.0504 12.822988 243.4936 293.2973
 [62,] 278.3651 10.999455 257.5210 299.9160
 [63,] 288.6798  9.448683 270.5746 307.2810
 [64,] 298.9945  8.324534 282.8497 315.4325
 [65,] 309.3093  7.813369 293.8465 324.3922
 [66,] 319.6240  8.033072 303.1976 335.2178
 [67,] 329.9387  8.929859 312.0604 347.3889
 [68,] 340.2534 10.328851 319.7482 361.0354
 [69,] 350.5682 12.056474 327.1740 374.9133
 [70,] 360.8829 13.991519 333.9664 389.0750
 [71,] 244.3357 12.385941 219.8306 269.0683
 [72,] 255.8051 10.659151 234.9803 276.9323
 [73,] 267.2745  9.220024 249.1928 285.1338
 [74,] 278.7439  8.221042 262.7220 294.7142
 [75,] 290.2133  7.832470 274.8481 305.6769
 [76,] 301.6827  8.142174 285.2533 317.7439
 [77,] 313.1521  9.078975 295.2671 331.0839
 [78,] 324.6215 10.475969 304.6192 345.7033
 [79,] 336.0909 12.175773 312.6624 360.3484
 [80,] 347.5603 14.069055 320.4796 375.8159
 [81,] 250.7074 13.534212 225.3710 278.6488
 [82,] 250.4617 11.527188 228.8204 274.1865
 [83,] 250.2161  9.802923 231.5220 270.1087
 [84,] 249.9705  8.534554 233.4227 267.1709
 [85,] 249.7248  7.943550 234.2474 264.9302
 [86,] 249.4792  8.178108 233.6250 265.1555
 [87,] 249.2335  9.175128 231.4243 267.0459
 [88,] 248.9879 10.724018 228.0609 270.4163
 [89,] 248.7422 12.623241 223.7569 273.6716
 [90,] 248.4966 14.737976 219.3249 277.2904
 [91,] 285.8224 13.084723 260.9760 311.5204
 [92,] 305.0035 11.223460 283.7315 327.2057
 [93,] 324.1847  9.630394 305.5050 343.2556
 [94,] 343.3658  8.458441 326.8425 360.1518
 [95,] 362.5469  7.897360 346.8333 377.9837
 [96,] 381.7280  8.075499 365.6514 397.7333
 [97,] 400.9092  8.948821 383.0299 418.8374
 [98,] 420.0903 10.342700 399.5123 440.7277
 [99,] 439.2714 12.078237 415.1912 463.4360
[100,] 458.4525 14.029202 430.6217 486.0014
[101,] 226.3080 12.931532 200.5797 251.2062
[102,] 237.9152 11.071635 215.8016 259.3153
[103,] 249.5223  9.490083 230.3569 268.1643
[104,] 261.1295  8.346630 244.5796 277.4914
[105,] 272.7366  7.835484 257.5402 288.5675
[106,] 284.3438  8.077584 268.8633 300.0445
[107,] 295.9509  9.012432 278.1881 313.9641
[108,] 307.5581 10.455835 287.0337 328.3928
[109,] 319.1652 12.229025 295.3758 343.4067
[110,] 330.7724 14.209067 303.0021 358.9441
[111,] 238.4492 13.046282 211.7494 263.6063
[112,] 255.5140 11.140062 232.8294 276.8896
[113,] 272.5788  9.506666 253.3238 290.9324
[114,] 289.6437  8.308588 272.6880 306.2032
[115,] 306.7085  7.750406 291.3870 321.9039
[116,] 323.7733  7.967757 308.1415 339.5575
[117,] 340.8382  8.904030 323.3759 358.2809
[118,] 357.9030 10.366221 337.2198 378.1164
[119,] 374.9678 12.166165 350.5775 399.0039
[120,] 392.0326 14.175782 364.1391 419.5186
[121,] 255.6597 12.636685 230.3604 281.7070
[122,] 263.1627 10.878473 241.6304 285.7325
[123,] 270.6658  9.406989 252.1941 289.7776
[124,] 278.1688  8.374761 261.8219 295.1156
[125,] 285.6718  7.954668 270.2190 301.7833
[126,] 293.1748  8.240860 277.3771 309.8159
[127,] 300.6779  9.167428 283.3225 318.7192
[128,] 308.1809 10.567242 287.8464 329.1617
[129,] 315.6839 12.279511 291.8331 340.1314
[130,] 323.1869 14.191586 295.3740 351.2562
[131,] 271.8722 12.253141 248.4717 296.2335
[132,] 286.0040 10.609945 265.6420 306.9783
[133,] 300.1359  9.248039 282.6145 318.4377
[134,] 314.2678  8.306946 298.0166 330.7095
[135,] 328.3997  7.937776 312.7924 344.1081
[136,] 342.5316  8.217970 326.2424 358.6240
[137,] 356.6634  9.087663 338.4059 373.9933
[138,] 370.7953 10.400000 349.9696 390.5965
[139,] 384.9272 12.010754 360.7220 408.0536
[140,] 399.0591 13.815942 371.2252 425.3727
[141,] 254.4350 12.364477 229.0776 277.8597
[142,] 265.7811 10.620756 244.0909 286.3107
[143,] 277.1272  9.164279 259.1039 295.5200
[144,] 288.4732  8.150518 272.5882 304.9304
[145,] 299.8193  7.755081 284.5534 315.3223
[146,] 311.1653  8.069387 295.4025 326.9099
[147,] 322.5114  9.019541 304.5775 339.8233
[148,] 333.8575 10.433245 312.9603 353.7414
[149,] 345.2035 12.149753 320.8982 368.3372
[150,] 356.5496 14.058583 328.3998 383.3555
[151,] 226.4271 13.292132 198.7271 251.0403
[152,] 241.6110 11.337079 217.9740 262.4986
[153,] 256.7948  9.659485 236.7057 274.6383
[154,] 271.9786  8.426725 254.7509 288.0368
[155,] 287.1624  7.851208 271.3475 302.4979
[156,] 302.3462  8.074711 286.4812 317.6603
[157,] 317.5300  9.038151 299.7710 335.0522
[158,] 332.7138 10.540547 311.8764 353.1194
[159,] 347.8976 12.387324 323.8733 371.7821
[160,] 363.0815 14.447014 334.8578 390.5908
[161,] 252.4839 12.036219 229.4840 276.7682
[162,] 261.9081 10.353444 241.9336 282.4508
[163,] 271.3322  8.961425 253.9133 288.9551
[164,] 280.7563  8.013149 265.1844 296.3414
[165,] 290.1805  7.674898 275.3894 304.9932
[166,] 299.6046  8.024192 283.8609 315.5902
[167,] 309.0287  8.981165 291.4247 327.2854
[168,] 318.4529 10.379070 298.1884 339.4666
[169,] 327.8770 12.065609 304.2541 352.1146
[170,] 337.3011 13.936386 309.5171 365.0012
[171,] 263.5847 12.176421 240.2155 287.6822
[172,] 275.3930 10.486413 255.1578 296.0143
[173,] 287.2013  9.086544 269.2554 305.3014
[174,] 299.0095  8.128133 283.0501 314.9033
[175,] 310.8178  7.776157 295.2060 325.9659
[176,] 322.6261  8.109964 306.7191 338.6899
[177,] 334.4343  9.054017 316.7944 352.5240
[178,] 346.2426 10.444126 326.0210 367.1669
[179,] 358.0509 12.127865 334.6084 382.1178
[180,] 369.8592 13.999689 342.3812 397.3799</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error         Q2.5       Q97.5
  [1,]   -3.98638233 12.709818  -28.2423265  21.5797433
  [2,]  -14.49636693 10.899169  -35.3642861   7.3371476
  [3,]  -42.05515153  9.368012  -60.2184722 -23.5831726
  [4,]    8.92936387  8.273014   -6.8127148  24.9825417
  [5,]   24.68677927  7.800078    9.3175526  39.7351386
  [6,]   62.87029467  8.059468   47.0664819  78.4680836
  [7,]   10.72931007  8.988002   -6.6876257  28.3078080
  [8,] -100.98057453 10.408106 -121.2556397 -80.6561154
  [9,]   19.80144088 12.148602   -4.1087642  43.7822652
 [10,]   35.91495628 14.091264    8.6547790  63.5934997
 [11,]   11.36617295 13.628280  -15.3140955  37.8996186
 [12,]   -7.88687822 11.707717  -31.0632653  14.9573015
 [13,]  -11.95982940 10.054579  -31.9588069   7.8091997
 [14,]  -12.01558058  8.820533  -29.0832225   5.3746664
 [15,]  -10.79143175  8.197094  -26.8626647   5.4383467
 [16,]   -4.33068293  8.322632  -20.4191836  12.3703346
 [17,]   -8.44713411  9.166426  -26.2589806   9.5591393
 [18,]   -6.13518528 10.557643  -26.7403294  14.3551178
 [19,]   -1.35163646 12.312091  -25.4237682  22.6000018
 [20,]    9.88191236 14.296666  -17.6162517  38.2819969
 [21,]  -13.95566155 13.457353  -39.4899601  12.8602212
 [22,]  -23.57972508 11.530349  -45.6217833  -0.4362190
 [23,]   11.50571140  9.872050   -7.2601406  31.3943434
 [24,]    5.12494788  8.638613  -11.4908578  22.4991500
 [25,]   -3.31161565  8.028307  -18.7813964  12.2730801
 [26,]  -17.06347917  8.181786  -33.3233779  -1.3265369
 [27,]   -7.00294269  9.060318  -24.9993672  10.3492158
 [28,]    8.42499378 10.483174  -12.6002225  28.8119589
 [29,]    8.78403026 12.262314  -15.2210043  33.0586272
 [30,]   -9.61553327 14.265047  -37.4303281  18.3760594
 [31,]   47.05238443 13.359976   21.0098769  72.7258133
 [32,]   20.14552986 11.416630   -2.0333095  42.2300567
 [33,]   -2.16262471  9.737949  -21.0683574  16.8430334
 [34,]   -6.65057928  8.482545  -23.1379367   9.7357743
 [35,]  -11.75073386  7.856030  -27.0362761   3.6204708
 [36,]   -5.72698843  8.007407  -21.5624785   9.8083154
 [37,]  -28.83734300  8.897057  -46.1739379 -11.2731642
 [38,]    3.41990243 10.336074  -16.3801529  24.4802705
 [39,]  -15.25635214 12.130495  -38.1922939   9.2704004
 [40,]   27.67839329 14.145711    1.0108618  55.8251092
 [41,]   14.09472115 13.023739  -11.7698328  39.0803364
 [42,]    4.03980972 11.160777  -18.0580260  25.5939567
 [43,]   13.41339830  9.571890   -5.4034235  31.9915535
 [44,]   24.26108687  8.413808    7.6879938  40.6520785
 [45,]   12.97607545  7.878845   -2.3201411  28.9392996
 [46,]  -17.42953598  8.091550  -33.3124832  -1.4806803
 [47,]  -28.12024740  8.999061  -45.6658298  -9.9086755
 [48,]    9.17544118 10.421420  -10.9197505  29.8913796
 [49,]  -39.34237025 12.179565  -62.8944077 -15.0810116
 [50,]   31.04481833 14.148873    3.2971161  58.6157626
 [51,]  -25.15881082 12.099131  -49.6809305  -1.6421598
 [52,]  -27.41788682 10.480486  -48.5048881  -6.8971026
 [53,]   -7.47866281  9.153395  -25.6111821  10.3458157
 [54,]   19.11856120  8.259609    2.8703703  35.0662628
 [55,]   16.60238520  7.946702    1.0509177  31.9530681
 [56,]   -1.07319079  8.280787  -16.8473200  14.9284200
 [57,]  132.88083322  9.191585  115.3904211 150.8722480
 [58,]   15.33975722 10.530502   -4.9896544  35.9314961
 [59,]  -11.40131877 12.156896  -35.0642010  12.5734968
 [60,]  -98.04749477 13.970728 -125.5714082 -71.0236600
 [61,]   15.79202610 12.822988   -9.4548986  40.3487906
 [62,]   11.18990305 10.999455  -10.3609857  32.0339969
 [63,]  -11.91052000  9.448683  -30.5116569   6.1946676
 [64,]    0.81515695  8.324534  -15.6227879  16.9599625
 [65,]  -12.13826610  7.813369  -27.2212303   3.3245068
 [66,]   18.54251085  8.033072    2.9487484  34.9688963
 [67,]    2.08778780  8.929859  -15.3623754  19.9661143
 [68,]    8.58646475 10.328851  -12.1955042  29.0917268
 [69,]  -17.20815830 12.056474  -41.5532674   6.1860225
 [70,]    1.15991865 13.991519  -27.0321746  28.0764354
 [71,]   21.13740019 12.385941   -3.5951803  45.6425266
 [72,]   20.39610146 10.659151   -0.7311084  41.2208944
 [73,]  -23.90979727  9.220024  -41.7691111  -5.8281481
 [74,]  -24.07159599  8.221042  -40.0419010  -8.0496535
 [75,]  -11.18889472  7.832470  -26.6524923   4.1762725
 [76,]  -17.49149345  8.142174  -33.5527444  -1.0620877
 [77,]   -7.62729218  9.078975  -25.5591423  10.2577301
 [78,]    6.90140910 10.475969  -14.1803586  26.9037124
 [79,]   -0.34398963 12.175773  -24.6015088  23.0844913
 [80,]   29.73871164 14.069055    1.4830530  56.8193852
 [81,]   -9.09908241 13.534212  -37.0404855  16.2372894
 [82,]   23.48546096 11.527188   -0.2392693  45.1267712
 [83,]    4.27460433  9.802923  -15.6180087  22.9686626
 [84,]   20.83164770  8.534554    3.6312369  37.3793889
 [85,]    1.72709108  7.943550  -13.4782771  17.2045398
 [86,]    5.15703445  8.178108  -10.5192543  21.0111922
 [87,]   -3.78122218  9.175128  -21.5936249  14.0279799
 [88,]  -13.67687881 10.724018  -35.1052852   7.2501164
 [89,]  -12.98813544 12.623241  -37.9175435  11.9972392
 [90,]  -11.24999207 14.737976  -40.0437778  17.9216557
 [91,]   26.54417906 13.084723    0.8461565  51.3906114
 [92,]    8.80225736 11.223460  -13.3999395  30.0742927
 [93,]  -32.57346434  9.630394  -51.6444322 -13.8937742
 [94,]    2.75641395  8.458441  -14.0295904  19.2797409
 [95,]    3.18549225  7.897360  -12.2512808  18.8990660
 [96,]   10.11047055  8.075499   -5.8948039  26.1871230
 [97,]    3.35094884  8.948821  -14.5773152  21.2302452
 [98,]   -3.39797286 10.342700  -24.0353927  17.1799714
 [99,]   16.59290544 12.078237   -7.5717029  40.6730504
[100,]    0.46418373 14.029202  -27.0847252  28.2950283
[101,]    9.79519148 12.931532  -15.1030469  35.5234588
[102,]   -7.59846100 11.071635  -28.9986019  14.5151421
[103,]  -10.59671348  9.490083  -29.2387276   8.5687363
[104,]   -6.20746596  8.346630  -22.5693588  10.3424078
[105,]  -22.02631843  7.835484  -37.8572366  -6.8299287
[106,]  -14.56937091  8.077584  -30.2701032   0.9111488
[107,]  -14.38612339  9.012432  -32.3993375   3.3766769
[108,]    0.54392413 10.455835  -20.2907957  21.0683408
[109,]   17.11537165 12.229025   -7.1261096  40.9048352
[110,]   20.87271917 14.209067   -7.2990141  48.6429933
[111,]   17.84760756 13.046282   -7.3095283  44.5473921
[112,]  -12.05972044 11.140062  -33.4353428  10.6248784
[113,]  -16.37424844  9.506666  -34.7277762   2.8807541
[114,]  -34.11657645  8.308588  -50.6760648 -17.1609481
[115,]  -37.79200445  7.750406  -52.9873965 -22.4704645
[116,]    5.95136755  7.967757   -9.8328438  21.5832199
[117,]   38.60633954  8.904030   21.1635521  56.0686299
[118,]    5.01541154 10.366221  -15.1979946  25.6985991
[119,]   19.51938354 12.166165   -4.5166542  43.9096609
[120,]   -2.97994447 14.175782  -30.4658962  24.9136384
[121,]   -5.13320804 12.636685  -31.1805339  20.1661429
[122,]   36.89486769 10.878473   14.3251169  58.4272176
[123,]   -0.77185658  9.406989  -19.8836746  17.6997905
[124,]    2.42031914  8.374761  -14.5264877  18.7672142
[125,]  -13.84440513  7.954668  -29.9558949   1.6083797
[126,]   11.45877060  8.240860   -5.1823360  27.2565249
[127,]  -12.93125367  9.167428  -30.9725955   4.4240783
[128,]  -41.58537795 10.567242  -62.5662019 -21.2509056
[129,]    5.85789778 12.279511  -18.5896278  29.7087351
[130,]   24.37857351 14.191586   -3.6907242  52.1915108
[131,]  -50.19506506 12.253141  -74.5564068 -26.7946456
[132,]   12.18985735 10.609945   -8.7844100  32.5518596
[133,]   26.74257976  9.248039    8.4407780  44.2639834
[134,]   32.58770217  8.306946   16.1459522  48.8389164
[135,]   20.34052458  7.937776    4.6321492  35.9478010
[136,]   10.29714699  8.217970   -5.7953455  26.5862931
[137,]   -2.23683060  9.087663  -19.5666690  16.0207256
[138,]  -10.36270819 10.400000  -30.1639193  10.4630167
[139,]   -9.28658579 12.010754  -32.4130371  14.9185997
[140,]  -10.51736338 13.815942  -36.8310270  17.3165329
[141,]   17.48847435 12.364477   -5.9361641  42.8458916
[142,]    2.65581010 10.620756  -17.8737726  24.3460097
[143,]  -19.88475415  9.164279  -38.2775954  -1.8614547
[144,]  -10.81661840  8.150518  -27.2737773   5.0683893
[145,]   15.00291735  7.755081   -0.5000750  30.2687963
[146,]    6.04815310  8.069387   -9.6963870  21.8110360
[147,]  -24.37611115  9.019541  -41.6880215  -6.4422453
[148,]   14.26542460 10.433245   -5.6184919  35.1626355
[149,]   -4.92353965 12.149753  -28.0572495  19.3817565
[150,]    9.96349610 14.058583  -16.8424282  38.1132610
[151,]   -1.16314054 13.292132  -25.7762612  26.5368608
[152,]   -7.08745348 11.337079  -27.9751074  16.5494843
[153,]  -17.89396641  9.659485  -35.7375278   2.1951397
[154,]  -31.50557935  8.426725  -47.5638131 -14.2778931
[155,]  -19.62509228  7.851208  -34.9605539  -3.8101521
[156,]   41.84749478  8.074711   26.5334338  57.7125044
[157,]  -36.38191815  9.038151  -53.9040561 -18.6228734
[158,]   14.87166891 10.540547   -5.5338780  35.7091127
[159,]   17.26535598 12.387324   -6.6191068  41.2897316
[160,]    9.14734304 14.447014  -18.3620338  37.3709574
[161,]   17.39646707 12.036219   -6.8877525  40.3963662
[162,]   10.53473440 10.353444  -10.0079598  30.5091783
[163,]    6.56670174  8.961425  -11.0562397  23.9855534
[164,]    1.03316907  8.013149  -14.5519327  16.6051288
[165,]  -11.00996359  7.674898  -25.8227065   3.7811027
[166,]  -15.09259625  8.024192  -31.0781686   0.6511102
[167,]  -49.76292892  8.981165  -68.0195763 -32.1588873
[168,]  -13.82226158 10.379070  -34.8359776   6.4422179
[169,]   22.90370576 12.065609   -1.3338988  46.5266124
[170,]   32.16807309 13.936386    4.4680016  59.9520984
[171,]    5.82698400 12.176421  -18.2705051  29.1961789
[172,]   -1.91898728 10.486413  -22.5402929  18.3162163
[173,]   10.39554145  9.086544   -7.7046435  28.3414205
[174,]   11.62207017  8.128133   -4.2717262  27.5815335
[175,]  -23.64520110  7.776157  -38.7933420  -8.0333609
[176,]    6.98152762  8.109964   -9.0822665  22.8884521
[177,]    0.04745635  9.054017  -18.0421934  17.6874280
[178,]   -3.02271493 10.444126  -23.9469546  17.1989351
[179,]   11.09081380 12.127865  -12.9761328  34.5332719
[180,]   -5.73555748 13.999689  -33.2563368  21.7424317</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.1 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   820       
 (0.5, 0.7]   (ok)         1    0.6%   2026      
   (0.7, 1]   (bad)        1    0.6%   126       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.6
p_loo        34.1  8.6
looic      1722.0 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   953       
 (0.5, 0.7]   (ok)         6    3.3%   832       
   (0.7, 1]   (bad)        3    1.7%   25        
   (1, Inf)   (very bad)   1    0.6%   14        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.0      11.9  
fit_sleep1 -92.2      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.1 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   820       
 (0.5, 0.7]   (ok)         1    0.6%   2026      
   (0.7, 1]   (bad)        1    0.6%   126       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.6
p_loo        34.1  8.6
looic      1722.0 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   953       
 (0.5, 0.7]   (ok)         6    3.3%   832       
   (0.7, 1]   (bad)        3    1.7%   25        
   (1, Inf)   (very bad)   1    0.6%   14        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.6        34.1    8.6   1722.0
fit_sleep2  -24.0      11.9  -885.1     14.4        19.6    3.4   1770.1
fit_sleep1  -92.2      21.2  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   45.2  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.647697e-41 3.624590e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.94      1.57     0.31     5.43       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.06      1.57    -3.37     2.92       5.44      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.26 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.5      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.3         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.0          
 [52] processx_3.8.1       pkgbuild_1.4.0       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.0        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.0         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-1       
 [85] grid_4.3.0           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.31       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
