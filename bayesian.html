<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.92      6.98    15.48    42.74 1.00     1810     2488
sd(Days)                6.51      1.42     4.13     9.57 1.00     1611     2073
cor(Intercept,Days)     0.08      0.30    -0.49     0.65 1.00      990     1634

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.43      7.47   236.96   266.59 1.00     1793     2417
Days         10.40      1.72     6.97    13.81 1.00     1452     2188

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.55    23.12    29.13 1.00     3752     2966

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0658  12.87248 228.0417 278.5754
309 211.7590  13.47213 185.1195 238.6615
310 212.8525  13.05714 186.8176 237.6391
330 274.3618  13.58666 248.8964 300.9762
331 273.1780  13.02421 248.8479 299.0524
332 260.2081  12.51307 236.1789 285.3843
333 267.9027  12.65742 243.7339 293.5692
334 244.1975  12.29056 219.7240 268.5531
335 250.8174  13.03263 225.6263 277.1831
337 286.0892  13.27660 259.7282 312.1109
349 226.8892  12.65978 201.6628 250.0899
350 238.9476  13.02750 213.1091 263.7797
351 256.0238  12.44703 232.1411 280.5820
352 272.3129  12.46004 247.6688 297.0794
369 254.8756  12.61031 230.2428 279.5650
370 226.4943  13.48480 199.5757 251.8902
371 252.3806  12.45662 227.9745 276.7528
372 263.5195  12.50186 239.4470 288.5351

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5925011  2.443153 14.9622385 24.598082
309  1.7818423  2.542848 -3.2725995  6.709080
310  4.9172793  2.479288  0.1108682  9.704834
330  5.7570672  2.576990  0.6636981 10.587991
331  7.4701905  2.484014  2.4424092 12.156290
332 10.2400076  2.364620  5.5544906 14.866794
333 10.2991790  2.394903  5.4531340 14.866783
334 11.5025658  2.362753  6.7992910 16.077109
335 -0.2469288  2.502210 -5.1304374  4.587437
337 19.1373615  2.488227 14.1834848 23.838462
349 11.4996024  2.434394  6.8778299 16.357880
350 17.0203143  2.505717 12.2020848 22.003347
351  7.4259351  2.376571  2.7930028 11.927448
352 13.9912498  2.370184  9.3217579 18.623487
369 11.2984222  2.383452  6.6008719 15.949827
370 15.1305543  2.572174 10.2437372 20.261933
371  9.4373187  2.355542  4.8330170 14.003940
372 11.8013797  2.398139  7.2300776 16.517216</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0658 12.872485 228.0417 278.5754
  [2,] 273.6583 11.052547 251.7710 294.6971
  [3,] 293.2508  9.516025 274.2995 311.3241
  [4,] 312.8433  8.419541 296.2602 328.8078
  [5,] 332.4358  7.947363 316.9405 347.4099
  [6,] 352.0283  8.207953 335.9016 367.9301
  [7,] 371.6208  9.138840 353.7396 389.7219
  [8,] 391.2133 10.564293 370.8729 412.2657
  [9,] 410.8058 12.313740 387.1182 435.2036
 [10,] 430.3983 14.268499 403.0342 458.9122
 [11,] 211.7590 13.472130 185.1195 238.6615
 [12,] 213.5408 11.531858 190.7458 236.2232
 [13,] 215.3227  9.869213 195.8059 234.6568
 [14,] 217.1045  8.645873 200.1877 233.9531
 [15,] 218.8864  8.064306 203.1579 234.9276
 [16,] 220.6682  8.261180 204.5580 236.9234
 [17,] 222.4500  9.186583 204.5489 240.5790
 [18,] 224.2319 10.652308 202.9681 245.2251
 [19,] 226.0137 12.469249 200.7898 250.5898
 [20,] 227.7956 14.506027 198.1846 256.1176
 [21,] 212.8525 13.057137 186.8176 237.6391
 [22,] 217.7697 11.185919 195.8248 239.1685
 [23,] 222.6870  9.594503 204.1515 241.5412
 [24,] 227.6043  8.442626 210.9257 244.3591
 [25,] 232.5216  7.924337 217.1206 248.2872
 [26,] 237.4389  8.161251 221.4814 253.9485
 [27,] 242.3561  9.094541 224.2316 260.7913
 [28,] 247.2734 10.540828 226.4586 268.3066
 [29,] 252.1907 12.320762 227.2027 276.8104
 [30,] 257.1080 14.310382 228.2432 285.3505
 [31,] 274.3618 13.586661 248.8964 300.9762
 [32,] 280.1189 11.576559 258.2400 302.9134
 [33,] 285.8759  9.834522 267.3333 305.1147
 [34,] 291.6330  8.526469 275.2041 308.4009
 [35,] 297.3901  7.871804 281.8647 312.5677
 [36,] 303.1472  8.031915 287.2341 318.9394
 [37,] 308.9042  8.963246 291.2360 326.4132
 [38,] 314.6613 10.461818 293.9469 335.0601
 [39,] 320.4184 12.322389 296.2202 344.5467
 [40,] 326.1754 14.405369 297.8063 354.2699
 [41,] 273.1780 13.024214 248.8479 299.0524
 [42,] 280.6482 11.155456 259.7743 302.8420
 [43,] 288.1184  9.570731 270.2143 307.2939
 [44,] 295.5886  8.431740 279.4242 312.4176
 [45,] 303.0587  7.932858 287.8793 318.9920
 [46,] 310.5289  8.191879 294.6311 327.0855
 [47,] 317.9991  9.144625 299.8849 336.5106
 [48,] 325.4693 10.605759 304.7003 346.4617
 [49,] 332.9395 12.396802 308.8441 357.2836
 [50,] 340.4097 14.395137 311.8727 368.2797
 [51,] 260.2081 12.513071 236.1789 285.3843
 [52,] 270.4481 10.782647 249.7522 292.0585
 [53,] 280.6881  9.334712 262.8679 299.7953
 [54,] 290.9281  8.318117 274.4061 307.7176
 [55,] 301.1681  7.901149 285.5396 317.2260
 [56,] 311.4081  8.176069 295.1780 327.4731
 [57,] 321.6482  9.080247 303.4850 339.4682
 [58,] 331.8882 10.451629 311.0201 352.6816
 [59,] 342.1282 12.132809 318.0342 366.1907
 [60,] 352.3682 14.012723 324.7578 380.1296
 [61,] 267.9027 12.657423 243.7339 293.5692
 [62,] 278.2019 10.910722 257.6808 300.3595
 [63,] 288.5011  9.452433 270.4943 307.3207
 [64,] 298.8003  8.433519 282.5260 315.4250
 [65,] 309.0995  8.023162 293.4645 324.6512
 [66,] 319.3986  8.311987 302.7613 335.3607
 [67,] 329.6978  9.234622 311.2286 347.5798
 [68,] 339.9970 10.627253 318.7955 360.9838
 [69,] 350.2962 12.331662 325.7191 374.5433
 [70,] 360.5953 14.236305 332.7115 388.5838
 [71,] 244.1975 12.290563 219.7240 268.5531
 [72,] 255.7000 10.582887 234.6964 276.5537
 [73,] 267.2026  9.170728 249.3233 285.5916
 [74,] 278.7052  8.208058 262.4498 295.1552
 [75,] 290.2077  7.861768 274.5645 305.7275
 [76,] 301.7103  8.210224 285.4195 317.9670
 [77,] 313.2129  9.174605 295.4765 331.1388
 [78,] 324.7154 10.587926 303.9764 345.1985
 [79,] 336.2180 12.296348 312.0275 359.9106
 [80,] 347.7206 14.193710 319.7076 375.1392
 [81,] 250.8174 13.032633 225.6263 277.1831
 [82,] 250.5705 11.138562 229.3099 272.8662
 [83,] 250.3235  9.529308 231.9044 269.0507
 [84,] 250.0766  8.370781 233.7481 266.3874
 [85,] 249.8297  7.864752 234.5164 265.1731
 [86,] 249.5828  8.133929 233.6950 265.7511
 [87,] 249.3358  9.109851 231.5680 267.2008
 [88,] 249.0889 10.599060 227.5142 269.5673
 [89,] 248.8420 12.418247 223.5767 273.4347
 [90,] 248.5950 14.443260 219.3761 276.9380
 [91,] 286.0892 13.276596 259.7282 312.1109
 [92,] 305.2266 11.375398 282.6045 327.5044
 [93,] 324.3639  9.742377 305.0670 343.3488
 [94,] 343.5013  8.532918 326.6326 359.7723
 [95,] 362.6386  7.942922 347.0503 378.3695
 [96,] 381.7760  8.108753 366.0340 397.7621
 [97,] 400.9134  8.988676 383.4777 418.7282
 [98,] 420.0507 10.403042 399.6913 440.4794
 [99,] 439.1881 12.166873 415.5463 462.9525
[100,] 458.3254 14.150084 431.1850 486.2196
[101,] 226.8892 12.659777 201.6628 250.0899
[102,] 238.3888 10.866923 216.4816 258.3201
[103,] 249.8884  9.368170 230.9069 267.6735
[104,] 261.3880  8.323927 244.8351 277.2511
[105,] 272.8877  7.916151 257.3043 288.5364
[106,] 284.3873  8.239884 268.4836 301.0491
[107,] 295.8869  9.218376 278.0100 314.1637
[108,] 307.3865 10.673040 286.5903 328.7749
[109,] 318.8861 12.437911 294.8400 343.6473
[110,] 330.3857 14.399376 302.3988 358.9622
[111,] 238.9476 13.027499 213.1091 263.7797
[112,] 255.9679 11.133949 233.8002 277.5403
[113,] 272.9882  9.527389 253.9643 291.5890
[114,] 290.0085  8.374646 273.6059 306.7817
[115,] 307.0288  7.877530 291.9953 322.8154
[116,] 324.0491  8.156807 308.3013 339.9843
[117,] 341.0694  9.141595 323.1157 358.8941
[118,] 358.0898 10.637728 337.0604 378.5642
[119,] 375.1101 12.462383 350.7440 399.5233
[120,] 392.1304 14.491996 364.1030 420.6669
[121,] 256.0238 12.447025 232.1411 280.5820
[122,] 263.4497 10.692880 242.7133 284.5602
[123,] 270.8756  9.221882 253.3979 288.9337
[124,] 278.3016  8.188083 262.6897 294.2953
[125,] 285.7275  7.768042 270.7607 300.9594
[126,] 293.1534  8.058314 277.4413 308.5482
[127,] 300.5794  8.990359 282.8741 317.3574
[128,] 308.0053 10.392923 287.5108 327.6612
[129,] 315.4312 12.103525 291.5385 338.8537
[130,] 322.8572 14.009781 295.4231 350.5684
[131,] 272.3129 12.460042 247.6688 297.0794
[132,] 286.3042 10.747933 265.1412 307.5221
[133,] 300.2954  9.328400 281.9659 318.3922
[134,] 314.2867  8.351980 298.0465 330.2880
[135,] 328.2779  7.982959 312.5858 343.7541
[136,] 342.2692  8.302726 325.7883 358.2945
[137,] 356.2604  9.240044 338.2194 373.9202
[138,] 370.2517 10.632833 349.1068 390.6628
[139,] 384.2429 12.327668 359.9823 407.7660
[140,] 398.2342 14.216934 370.4449 425.3877
[141,] 254.8756 12.610307 230.2428 279.5650
[142,] 266.1740 10.846997 245.0805 287.3104
[143,] 277.4724  9.362508 259.1546 296.0705
[144,] 288.7708  8.307673 272.5518 305.4525
[145,] 300.0692  7.857481 284.6451 315.5780
[146,] 311.3677  8.113215 294.9277 327.4706
[147,] 322.6661  9.014998 304.6323 340.6295
[148,] 333.9645 10.396048 313.1079 354.4423
[149,] 345.2629 12.093268 321.3495 369.1030
[150,] 356.5614 13.992074 328.7935 383.9710
[151,] 226.4943 13.484802 199.5757 251.8902
[152,] 241.6249 11.494022 218.6132 263.1719
[153,] 256.7554  9.778413 237.5290 275.5524
[154,] 271.8860  8.506134 255.4851 288.6397
[155,] 287.0165  7.894520 271.9084 302.8043
[156,] 302.1471  8.094735 286.5418 318.1996
[157,] 317.2776  9.053075 299.5677 335.0844
[158,] 332.4082 10.565215 311.7394 353.4577
[159,] 347.5387 12.430668 323.1174 372.1164
[160,] 362.6693 14.513835 334.0375 391.8779
[161,] 252.3806 12.456617 227.9745 276.7528
[162,] 261.8179 10.759619 240.6636 282.8585
[163,] 271.2552  9.352467 253.0909 289.3960
[164,] 280.6925  8.382425 264.4372 296.8686
[165,] 290.1298  8.009907 274.4932 306.1339
[166,] 299.5672  8.315608 283.0735 315.7693
[167,] 309.0045  9.232400 290.8292 326.8154
[168,] 318.4418 10.602936 297.7378 338.7690
[169,] 327.8791 12.276173 303.4086 351.5682
[170,] 337.3164 14.145097 309.4944 364.6250
[171,] 263.5195 12.501861 239.4470 288.5351
[172,] 275.3209 10.753607 254.2712 296.6855
[173,] 287.1223  9.299772 268.9417 305.6141
[174,] 298.9237  8.296600 282.7716 315.1646
[175,] 310.7251  7.917294 295.5557 326.2076
[176,] 322.5264  8.248372 306.3954 338.3885
[177,] 334.3278  9.213571 315.7267 352.0689
[178,] 346.1292 10.641723 324.6138 366.8320
[179,] 357.9306 12.373552 333.0145 381.8462
[180,] 369.7320 14.299142 341.6094 397.7253</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5      Q97.5
  [1,]   -4.5058326 12.872485  -29.0153810  21.518279
  [2,]  -14.9536337 11.052547  -35.9924055   6.933737
  [3,]  -42.4502348  9.516025  -60.5234884 -23.498876
  [4,]    8.5964640  8.419541   -7.3679771  25.179646
  [5,]   24.4160629  7.947363    9.4420110  39.911426
  [6,]   62.6617618  8.207953   46.7599587  78.788526
  [7,]   10.5829606  9.138840   -7.5180697  28.464227
  [8,] -101.0647405 10.564293 -122.1171487 -80.724285
  [9,]   19.7794584 12.313740   -4.6183211  43.467147
 [10,]   35.9551573 14.268499    7.4412912  63.319259
 [11,]   10.9749147 13.472130  -15.9275546  37.614361
 [12,]   -8.2750276 11.531858  -30.9573760  14.520041
 [13,]  -12.3448699  9.869213  -31.6790416   7.171867
 [14,]  -12.3975122  8.645873  -29.2461454   4.519296
 [15,]  -11.1702545  8.064306  -27.2114804   4.558193
 [16,]   -4.7063968  8.261180  -20.9615877  11.403808
 [17,]   -8.8197391  9.186583  -26.9486888   9.081358
 [18,]   -6.5046814 10.652308  -27.4979248  14.759073
 [19,]   -1.7180237 12.469249  -26.2940571  23.505946
 [20,]    9.5186340 14.506027  -18.8033783  39.129604
 [21,]  -13.7985546 13.057137  -38.5852224  12.236294
 [22,]  -23.4375339 11.185919  -44.8362876  -1.492640
 [23,]   11.6329867  9.594503   -7.2211896  30.168538
 [24,]    5.2373074  8.442626  -11.5175490  21.915913
 [25,]   -3.2141719  7.924337  -18.9798432  12.186827
 [26,]  -16.9809513  8.161251  -33.4906294  -1.023540
 [27,]   -6.9353306  9.094541  -25.3704509  11.189169
 [28,]    8.4776901 10.540828  -12.5554761  29.292516
 [29,]    8.8218108 12.320762  -15.7979348  33.809771
 [30,]   -9.5926686 14.310382  -37.8352294  19.272136
 [31,]   47.1807856 13.586661   20.5664327  72.646159
 [32,]   20.2813184 11.576559   -2.5132031  42.160241
 [33,]   -2.0194489  9.834522  -21.2581648  16.523188
 [34,]   -6.5000161  8.526469  -23.2679409   9.928919
 [35,]  -11.5927833  7.871804  -26.7703553   3.932626
 [36,]   -5.5616505  8.031915  -21.3538593  10.351392
 [37,]  -28.6646178  8.963246  -46.1736326 -10.996415
 [38,]    3.6000150 10.461818  -16.7988277  24.314361
 [39,]  -15.0688522 12.322389  -39.1971991   9.129334
 [40,]   27.8732806 14.405369   -0.2212383  56.242427
 [41,]   14.4299148 13.024214  -11.4445262  38.759972
 [42,]    4.3518243 11.155456  -17.8420271  25.225725
 [43,]   13.7022338  9.570731   -5.4732992  31.606291
 [44,]   24.5267433  8.431740    7.6976661  40.691124
 [45,]   13.2185528  7.932858   -2.7147027  28.397973
 [46,]  -17.2102377  8.191879  -33.7667759  -1.312376
 [47,]  -27.9241283  9.144625  -46.4356077  -9.809940
 [48,]    9.3483812 10.605759  -11.6440163  30.117398
 [49,]  -39.1926093 12.396802  -63.5367090 -15.097221
 [50,]   31.1714002 14.395137    3.3014215  59.708424
 [51,]  -25.3475070 12.513071  -50.5236529  -1.318345
 [52,]  -27.6363146 10.782647  -49.2467477  -6.940373
 [53,]   -7.7268221  9.334712  -26.8340281  10.093387
 [54,]   18.8406703  8.318117    2.0511996  35.362679
 [55,]   16.2947628  7.901149    0.2368723  31.923317
 [56,]   -1.4105448  8.176069  -17.4755016  14.819584
 [57,]  132.5137476  9.080247  114.6936689 150.676887
 [58,]   14.9429401 10.451629   -5.8504912  35.810997
 [59,]  -11.8278675 12.132809  -35.8904389  12.266058
 [60,]  -98.5037750 14.012723 -126.2651687 -70.893402
 [61,]   15.9396634 12.657423   -9.7268188  40.108542
 [62,]   11.3530844 10.910722  -10.8045162  31.874214
 [63,]  -11.7317947  9.452433  -30.5514242   6.274996
 [64,]    1.0094263  8.433519  -15.6153209  17.283738
 [65,]  -11.9284527  8.023162  -27.4802040   3.706503
 [66,]   18.7678683  8.311987    2.8057800  35.405217
 [67,]    2.3286893  9.234622  -15.5532603  20.797853
 [68,]    8.8429103 10.627253  -12.1439239  30.044370
 [69,]  -16.9361687 12.331662  -41.1833105   7.640891
 [70,]    1.4474523 14.236305  -26.5409542  29.331257
 [71,]   21.2756161 12.290563   -3.0799587  45.749097
 [72,]   20.5011503 10.582887   -0.3525201  41.504841
 [73,]  -23.8379155  9.170728  -42.2268886  -5.958599
 [74,]  -24.0328813  8.208058  -40.4829490  -7.777471
 [75,]  -11.1833471  7.861768  -26.7031130   4.459895
 [76,]  -17.5191128  8.210224  -33.7758010  -1.228309
 [77,]   -7.6880786  9.174605  -25.6140362  10.048316
 [78,]    6.8074556 10.587926  -13.6756289  27.546533
 [79,]   -0.4711102 12.296348  -24.1636980  23.719428
 [80,]   29.5784240 14.193710    2.1597588  57.591427
 [81,]   -9.2091063 13.032633  -35.5748044  15.981983
 [82,]   23.3767225 11.138562    1.0810225  44.637319
 [83,]    4.1671512  9.529308  -14.5599676  22.586289
 [84,]   20.7254800  8.370781    4.4147297  37.054031
 [85,]    1.6222087  7.864752  -13.7212091  16.935490
 [86,]    5.0534375  8.133929  -11.1148907  20.941189
 [87,]   -3.8835338  9.109851  -21.7484960  13.884265
 [88,]  -13.7779050 10.599060  -34.2562634   7.796778
 [89,]  -13.0878762 12.418247  -37.6805962  12.177436
 [90,]  -11.3484475 14.443260  -39.6913699  17.870464
 [91,]   26.2774113 13.276596    0.2557445  52.638439
 [92,]    8.5792498 11.375398  -13.6985679  31.201257
 [93,]  -32.7527118  9.742377  -51.7375820 -13.455820
 [94,]    2.6209267  8.532918  -13.6500566  19.489633
 [95,]    3.0937651  7.942922  -12.6371112  18.682102
 [96,]   10.0625036  8.108753   -5.9236296  25.804481
 [97,]    3.3467420  8.988676  -14.4681021  20.782391
 [98,]   -3.3584195 10.403042  -23.7871004  17.001008
 [99,]   16.6762189 12.166873   -7.0882071  40.317979
[100,]    0.5912574 14.150084  -27.3029013  27.731729
[101,]    9.2139596 12.659777  -13.9867093  34.440407
[102,]   -8.0721429 10.866923  -28.0033577  13.835100
[103,]  -10.9628453  9.368170  -28.7479435   8.018717
[104,]   -6.4660478  8.323927  -22.3291094  10.086857
[105,]  -22.1773502  7.916151  -37.8261197  -6.593983
[106,]  -14.6128526  8.239884  -31.2747490   1.290835
[107,]  -14.3220551  9.218376  -32.5989072   3.554783
[108,]    0.7155425 10.673040  -20.6728897  21.511719
[109,]   17.3945400 12.437911   -7.3666662  41.440573
[110,]   21.2594376 14.399376   -7.3171453  49.246345
[111,]   17.3492406 13.027499   -7.4829125  43.187723
[112,]  -12.5135737 11.133949  -34.0860191   9.654088
[113,]  -16.7835880  9.527389  -35.3844161   2.240255
[114,]  -34.4814023  8.374646  -51.2546438 -18.078838
[115,]  -38.1123166  7.877530  -53.8989074 -23.078766
[116,]    5.6755691  8.156807  -10.2595942  21.423430
[117,]   38.3750548  9.141595   20.5503983  56.328800
[118,]    4.8286405 10.637728  -15.6457740  25.858024
[119,]   19.3771263 12.462383   -5.0360569  43.743190
[120,]   -3.0776880 14.491996  -31.6142225  24.949744
[121,]   -5.4972534 12.447025  -30.0555283  18.385420
[122,]   36.6079114 10.692880   15.4973928  57.344275
[123,]   -0.9817237  9.221882  -19.0398286  16.496016
[124,]    2.2875412  8.188083  -13.7062063  17.899401
[125,]  -13.9000939  7.768042  -29.1319690   1.066711
[126,]   11.4801710  8.058314   -3.9146216  27.192283
[127,]  -12.8327641  8.990359  -29.6108318   4.872540
[128,]  -41.4097992 10.392923  -61.0657131 -20.915282
[129,]    6.1105657 12.103525  -17.3119054  30.003263
[130,]   24.7083305 14.009781   -3.0029117  52.142409
[131,]  -50.6358382 12.460042  -75.4023464 -25.991727
[132,]   11.8897120 10.747933   -9.3282442  33.052706
[133,]   26.5830622  9.328400    8.4862932  44.912608
[134,]   32.5688124  8.351980   16.5674554  48.809037
[135,]   20.4622625  7.982959    4.9860563  36.154431
[136,]   10.5595127  8.302726   -5.4657937  27.040364
[137,]   -1.8338371  9.240044  -19.4936041  16.207207
[138,]   -9.8190870 10.632833  -30.2301928  11.325806
[139,]   -8.6023368 12.327668  -32.1253886  15.658259
[140,]   -9.6924866 14.216934  -36.8460410  18.096824
[141,]   17.0479472 12.610307   -7.6414550  41.680695
[142,]    2.2629250 10.846997  -18.8734980  23.356422
[143,]  -20.2299972  9.362508  -38.8280752  -1.912218
[144,]  -11.1142194  8.307673  -27.7958860   5.104780
[145,]   14.7529584  7.857481   -0.7557890  30.177087
[146,]    5.8458362  8.113215  -10.2570535  22.285767
[147,]  -24.5307859  9.014998  -42.4942278  -6.496971
[148,]   14.1583919 10.396048   -6.3193873  35.015025
[149,]   -4.9829303 12.093268  -28.8230464  18.930544
[150,]    9.9517475 13.992074  -17.4579281  37.719647
[151,]   -1.2302978 13.484802  -26.6262239  25.688281
[152,]   -7.1013521 11.494022  -28.6484092  15.910267
[153,]  -17.8546064  9.778413  -36.6516252   1.371840
[154,]  -31.4129606  8.506134  -48.1666856 -15.012119
[155,]  -19.4792149  7.894520  -35.2669973  -4.371147
[156,]   42.0466308  8.094735   25.9940841  57.651902
[157,]  -36.1295234  9.053075  -53.9363212 -18.419592
[158,]   15.1773223 10.565215   -5.8721750  35.846080
[159,]   17.6242680 12.430668   -6.9533754  42.045586
[160,]    9.5595137 14.513835  -19.6491299  38.191286
[161,]   17.4998398 12.456617   -6.8723669  41.905883
[162,]   10.6249211 10.759619  -10.4157469  31.779165
[163,]    6.6437023  9.352467  -11.4970916  24.808007
[164,]    1.0969836  8.382425  -15.0791382  17.352331
[165,]  -10.9593351  8.009907  -26.9634361   4.677315
[166,]  -15.0551539  8.315608  -31.2572517   1.438500
[167,]  -49.7386726  9.232400  -67.5496028 -31.563401
[168,]  -13.8111913 10.602936  -34.1384495   6.892783
[169,]   22.9015899 12.276173   -0.7874653  47.372062
[170,]   32.1527712 14.145097    4.8441545  59.974778
[171,]    5.8921509 12.501861  -19.1234026  29.964697
[172,]   -1.8469287 10.753607  -23.2114739  19.202774
[173,]   10.4744916  9.299772   -8.0172615  28.655107
[174,]   11.7079119  8.296600   -4.5330348  27.860012
[175,]  -23.5524677  7.917294  -39.0350178  -8.383075
[176,]    7.0811526  8.248372   -8.7808665  23.212154
[177,]    0.1539730  9.213571  -17.5870576  18.755066
[178,]   -2.9093067 10.641723  -23.6120582  18.606120
[179,]   11.2111136 12.373552  -12.7044636  36.127184
[180,]   -5.6083660 14.299142  -33.6016938  22.514218</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.5
p_loo        19.6  3.6
looic      1770.0 29.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1815      
 (0.5, 0.7]   (ok)         2    1.1%   404       
   (0.7, 1]   (bad)        1    0.6%   102       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.1 22.8
p_loo        35.0  9.0
looic      1724.3 45.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   784       
 (0.5, 0.7]   (ok)         5    2.8%   566       
   (0.7, 1]   (bad)        2    1.1%   12        
   (1, Inf)   (very bad)   1    0.6%   3         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -22.9      11.9  
fit_sleep1 -91.1      21.4  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.5
p_loo        19.6  3.6
looic      1770.0 29.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1815      
 (0.5, 0.7]   (ok)         2    1.1%   404       
   (0.7, 1]   (bad)        1    0.6%   102       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.1 22.8
p_loo        35.0  9.0
looic      1724.3 45.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   784       
 (0.5, 0.7]   (ok)         5    2.8%   566       
   (0.7, 1]   (bad)        2    1.1%   12        
   (1, Inf)   (very bad)   1    0.6%   3         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.1     22.8        35.0    9.0   1724.3
fit_sleep2  -22.9      11.9  -885.0     14.5        19.6    3.6   1770.0
fit_sleep1  -91.1      21.4  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   45.6  
fit_sleep2   29.0  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
2.604703e-40 1.152944e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.86      1.57     0.24     5.42       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.14      1.57    -3.38     2.88       5.45      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.3 (2023-03-15)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.21      
[4] StanHeaders_2.26.21 lme4_1.1-32         Matrix_1.5-3       

loaded via a namespace (and not attached):
  [1] nlme_3.1-162         matrixStats_0.63.0   xts_0.13.0          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.3         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.3       cli_3.6.1           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.4.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.5      highr_0.10          
 [40] fastmap_1.1.1        htmlwidgets_1.6.2    rlang_1.1.0         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.1         
 [52] distributional_0.3.2 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.2       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.3          
 [67] parallel_4.2.3       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.3       
 [73] knitr_1.42           ps_1.7.3             pillar_1.9.0        
 [76] igraph_1.4.1         boot_1.3-28.1        markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-19    
 [82] stats4_4.2.3         rstantools_2.3.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.7  
 [88] vctrs_0.6.1          nloptr_2.0.3         httpuv_1.6.9        
 [91] gtable_0.3.3         cachem_1.0.7         ggplot2_3.4.1       
 [94] xfun_0.38            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.2.1        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
