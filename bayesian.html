<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">Jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.68      6.92    15.67    42.67 1.00     1551     2323
sd(Days)                6.58      1.60     4.12    10.40 1.00     1141     1192
cor(Intercept,Days)     0.10      0.30    -0.47     0.69 1.00     1139     1816

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.13      7.21   236.62   265.31 1.00     1939     2526
Days         10.36      1.69     6.94    13.63 1.00     1302     1944

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.88      1.55    23.15    29.21 1.00     3698     2785

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0051  12.90669 228.5547 278.8828
309 211.3824  13.26784 184.1373 237.0374
310 213.1847  13.08187 187.3323 238.3863
330 274.5282  13.34935 249.3772 301.5041
331 272.9947  13.07770 248.2702 299.1328
332 260.3833  12.32990 236.4337 285.1372
333 267.8581  12.57414 244.0099 293.4152
334 244.4118  12.12860 220.2727 267.9368
335 250.5589  13.44681 225.4847 277.9058
337 285.7654  13.13802 260.0544 311.0833
349 227.1474  12.95451 202.0345 251.8173
350 239.0859  12.98360 212.9532 263.9478
351 255.7486  12.29677 232.2496 280.5604
352 271.8623  12.64202 246.8840 296.6585
369 254.6065  12.16290 230.5158 279.4280
370 226.3397  13.56664 199.2968 252.0570
371 252.2120  12.40290 227.9551 276.7591
372 263.8089  12.21789 240.4642 288.3201

, , Days

     Estimate Est.Error       Q2.5     Q97.5
308 19.629125  2.499246 14.8437957 24.476631
309  1.741000  2.527458 -3.0954289  6.718287
310  4.930583  2.406124  0.1346284  9.660870
330  5.752751  2.496911  0.7440778 10.420683
331  7.463225  2.483440  2.6209677 12.229521
332 10.230779  2.365197  5.5222869 14.870246
333 10.315770  2.359243  5.5805343 14.907384
334 11.505163  2.318222  6.9881767 16.095702
335 -0.248755  2.555354 -5.2958170  4.758474
337 19.161086  2.493229 14.3149482 24.052703
349 11.472184  2.453458  6.7774763 16.257188
350 16.946072  2.504150 12.2657680 22.021942
351  7.536652  2.370571  2.8428922 12.130583
352 14.066204  2.387205  9.3577032 18.716813
369 11.336557  2.354377  6.6994181 15.952895
370 15.180624  2.560457 10.2916818 20.314778
371  9.487310  2.367403  4.7724158 14.153961
372 11.744804  2.284233  7.2945736 16.182386</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0051 12.906688 228.5547 278.8828
  [2,] 273.6343 11.033197 251.7528 295.2543
  [3,] 293.2634  9.453717 274.2276 311.8835
  [4,] 312.8925  8.337058 296.0809 329.5038
  [5,] 332.5217  7.882435 316.9134 348.0346
  [6,] 352.1508  8.200700 336.0492 368.0407
  [7,] 371.7799  9.212092 353.9737 389.7724
  [8,] 391.4090 10.722232 370.4105 412.5002
  [9,] 411.0382 12.552384 386.7463 435.3230
 [10,] 430.6673 14.582555 402.4920 458.5103
 [11,] 211.3824 13.267842 184.1373 237.0374
 [12,] 213.1234 11.368767 190.0421 235.2207
 [13,] 214.8644  9.759004 195.3967 234.0229
 [14,] 216.6054  8.602531 200.0230 233.5471
 [15,] 218.3464  8.095987 202.7242 234.1895
 [16,] 220.0874  8.358382 203.9679 236.4515
 [17,] 221.8284  9.325030 203.7770 239.8987
 [18,] 223.5694 10.808604 202.5283 244.8168
 [19,] 225.3104 12.628211 200.7515 250.2256
 [20,] 227.0514 14.659250 199.0378 255.9252
 [21,] 213.1847 13.081867 187.3323 238.3863
 [22,] 218.1152 11.263325 195.6924 239.6928
 [23,] 223.0458  9.704050 203.9081 241.4713
 [24,] 227.9764  8.547136 211.5953 244.4343
 [25,] 232.9070  7.969777 217.7530 248.7755
 [26,] 237.8376  8.096915 222.4641 253.8299
 [27,] 242.7682  8.898403 225.6399 260.2083
 [28,] 247.6987 10.216750 228.0764 267.6868
 [29,] 252.6293 11.881130 229.3952 275.9398
 [30,] 257.5599 13.766603 230.2656 284.4769
 [31,] 274.5282 13.349353 249.3772 301.5041
 [32,] 280.2810 11.452618 258.7660 303.4479
 [33,] 286.0337  9.827961 267.5131 306.2974
 [34,] 291.7865  8.630428 275.2372 309.2646
 [35,] 297.5392  8.052881 282.0538 313.4569
 [36,] 303.2920  8.226945 287.5313 319.4158
 [37,] 309.0447  9.109637 290.9917 326.6806
 [38,] 314.7975 10.524137 293.7449 335.0777
 [39,] 320.5502 12.288147 296.0081 344.2718
 [40,] 326.3030 14.272659 297.6323 353.6592
 [41,] 272.9947 13.077700 248.2702 299.1328
 [42,] 280.4580 11.171183 258.9550 303.1453
 [43,] 287.9212  9.534117 269.2899 307.1333
 [44,] 295.3844  8.326967 278.9234 311.7597
 [45,] 302.8476  7.753214 287.5838 318.0877
 [46,] 310.3109  7.951178 294.5351 326.0578
 [47,] 317.7741  8.869334 300.1535 334.8349
 [48,] 325.2373 10.317164 305.1428 345.4492
 [49,] 332.7005 12.106099 309.0023 356.3666
 [50,] 340.1637 14.106960 312.5314 367.7664
 [51,] 260.3833 12.329900 236.4337 285.1372
 [52,] 270.6141 10.578617 250.2729 291.8297
 [53,] 280.8449  9.109124 263.2786 299.0311
 [54,] 291.0757  8.076723 275.4116 307.0652
 [55,] 301.3065  7.660227 286.2521 316.1319
 [56,] 311.5372  7.956948 296.0786 327.2795
 [57,] 321.7680  8.895801 304.4807 339.7422
 [58,] 331.9988 10.302710 311.9811 352.8006
 [59,] 342.2296 12.014355 318.7573 366.1981
 [60,] 352.4603 13.918761 325.0377 380.3796
 [61,] 267.8581 12.574143 244.0099 293.4152
 [62,] 278.1739 10.810526 257.7868 299.9815
 [63,] 288.4897  9.314392 271.2186 307.3333
 [64,] 298.8055  8.232885 283.1481 315.3435
 [65,] 309.1212  7.741766 294.2105 324.7065
 [66,] 319.4370  7.951198 304.3467 335.4015
 [67,] 329.7528  8.811368 312.9215 347.3258
 [68,] 340.0685 10.158293 320.4350 359.9078
 [69,] 350.3843 11.826821 327.8784 373.5858
 [70,] 360.7001 13.699946 334.1360 387.5194
 [71,] 244.4118 12.128597 220.2727 267.9368
 [72,] 255.9169 10.449554 235.3304 276.0586
 [73,] 267.4221  9.057142 249.7967 284.8180
 [74,] 278.9273  8.100540 263.3790 294.5622
 [75,] 290.4324  7.742997 275.2443 305.4273
 [76,] 301.9376  8.064587 286.0431 317.3990
 [77,] 313.4427  8.992743 295.4885 331.1977
 [78,] 324.9479 10.365790 304.1968 344.8464
 [79,] 336.4531 12.032376 312.3532 359.7005
 [80,] 347.9582 13.887220 320.6136 374.8435
 [81,] 250.5589 13.446811 225.4847 277.9058
 [82,] 250.3101 11.494737 228.9142 273.4722
 [83,] 250.0614  9.823486 231.3829 270.0468
 [84,] 249.8126  8.598399 233.3015 267.0312
 [85,] 249.5639  8.026438 234.0744 265.5326
 [86,] 249.3151  8.244672 233.1018 265.7837
 [87,] 249.0664  9.197020 230.7425 267.0750
 [88,] 248.8176 10.689033 227.2426 270.3159
 [89,] 248.5689 12.529379 224.1577 273.1208
 [90,] 248.3201 14.586806 219.8504 277.0856
 [91,] 285.7654 13.138021 260.0544 311.0833
 [92,] 304.9265 11.261943 283.2146 326.7829
 [93,] 324.0876  9.668895 305.2356 342.7348
 [94,] 343.2487  8.519160 326.1553 359.7272
 [95,] 362.4098  8.006061 345.9772 377.7496
 [96,] 381.5709  8.249262 365.3110 397.2788
 [97,] 400.7320  9.188908 382.4388 418.3973
 [98,] 419.8930 10.642092 398.8325 440.6161
 [99,] 439.0541 12.429987 414.8270 462.9563
[100,] 458.2152 14.428702 430.2182 485.8290
[101,] 227.1474 12.954513 202.0345 251.8173
[102,] 238.6196 11.127338 216.6613 259.6494
[103,] 250.0918  9.584090 231.3124 268.7019
[104,] 261.5640  8.481205 245.2538 278.5539
[105,] 273.0362  8.002862 257.8723 288.6706
[106,] 284.5083  8.258309 268.9168 300.8178
[107,] 295.9805  9.186536 278.4041 314.2876
[108,] 307.4527 10.612452 287.0081 328.2659
[109,] 318.9249 12.365062 295.2436 343.2294
[110,] 330.3971 14.324953 303.0053 358.3919
[111,] 239.0859 12.983600 212.9532 263.9478
[112,] 256.0320 11.097524 233.9754 277.2492
[113,] 272.9781  9.501461 254.4798 291.5140
[114,] 289.9242  8.363133 273.9496 306.4000
[115,] 306.8702  7.883385 291.4469 322.4560
[116,] 323.8163  8.178940 307.6712 339.9630
[117,] 340.7624  9.175178 322.9282 358.6666
[118,] 357.7084 10.677746 337.0549 378.3372
[119,] 374.6545 12.505445 350.6334 398.9905
[120,] 391.6006 14.536147 363.3431 420.2276
[121,] 255.7486 12.296766 232.2496 280.5604
[122,] 263.2853 10.570416 242.6713 284.0118
[123,] 270.8219  9.137621 252.9248 289.0766
[124,] 278.3586  8.154616 262.2915 294.4555
[125,] 285.8952  7.793498 270.6730 300.7888
[126,] 293.4319  8.137486 277.2156 308.8495
[127,] 300.9685  9.107027 282.8097 318.2910
[128,] 308.5052 10.530737 287.6622 328.4550
[129,] 316.0418 12.251291 291.3045 339.1425
[130,] 323.5785 14.160898 294.6324 350.4790
[131,] 271.8623 12.642016 246.8840 296.6585
[132,] 285.9285 10.876060 264.6795 307.3799
[133,] 299.9947  9.389051 281.6799 318.4063
[134,] 314.0609  8.331710 297.5630 330.1965
[135,] 328.1271  7.878958 312.5986 343.4322
[136,] 342.1933  8.132408 326.2281 358.3106
[137,] 356.2595  9.032809 338.3153 374.0330
[138,] 370.3257 10.413679 349.4886 391.1431
[139,] 384.3919 12.111782 359.8061 408.5425
[140,] 398.4581 14.012256 369.8302 426.7329
[141,] 254.6065 12.162899 230.5158 279.4280
[142,] 265.9430 10.454037 245.3585 286.8381
[143,] 277.2796  9.040126 259.4807 295.0117
[144,] 288.6162  8.077564 272.7569 304.3511
[145,] 299.9527  7.736691 284.8651 315.0805
[146,] 311.2893  8.096414 295.3583 326.8289
[147,] 322.6258  9.073788 304.7042 340.4789
[148,] 333.9624 10.497692 313.3003 354.2180
[149,] 345.2989 12.212928 321.3576 369.5039
[150,] 356.6355 14.113677 329.3107 384.0152
[151,] 226.3397 13.566640 199.2968 252.0570
[152,] 241.5203 11.574697 218.6786 263.6530
[153,] 256.7009  9.849132 237.1847 275.7829
[154,] 271.8816  8.552723 255.3197 288.3526
[155,] 287.0622  7.899659 271.6601 302.4589
[156,] 302.2428  8.048108 285.9407 317.5559
[157,] 317.4234  8.958313 299.5890 334.5703
[158,] 332.6041 10.432764 312.1856 352.9763
[159,] 347.7847 12.269705 323.5929 372.2720
[160,] 362.9653 14.330409 334.8939 391.4504
[161,] 252.2120 12.402904 227.9551 276.7591
[162,] 261.6993 10.664910 240.9135 282.8413
[163,] 271.1866  9.211828 253.3066 289.4795
[164,] 280.6739  8.196612 264.7189 296.3924
[165,] 290.1612  7.792324 275.1148 305.5492
[166,] 299.6485  8.091067 284.2149 315.5341
[167,] 309.1358  9.023281 291.7132 326.6626
[168,] 318.6231 10.420319 298.3687 338.9263
[169,] 328.1105 12.122528 304.1950 351.6568
[170,] 337.5978 14.019183 310.2891 365.0090
[171,] 263.8089 12.217894 240.4642 288.3201
[172,] 275.5537 10.563863 255.4374 296.3676
[173,] 287.2985  9.184166 269.4894 305.0022
[174,] 299.0433  8.218154 282.8885 314.6783
[175,] 310.7881  7.820655 295.1816 325.7498
[176,] 322.5329  8.076056 306.3012 337.8817
[177,] 334.2777  8.928502 316.4140 351.9820
[178,] 346.0225 10.229813 326.0745 366.5142
[179,] 357.7674 11.832811 334.8832 381.4668
[180,] 369.5122 13.631479 342.6073 396.9057</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.4451500 12.906688  -29.3228434  21.0052626
  [2,]  -14.9295753 11.033197  -36.5495781   6.9519388
  [3,]  -42.4628006  9.453717  -61.0828722 -23.4269954
  [4,]    8.5472741  8.337058   -8.0639571  25.3589401
  [5,]   24.3302488  7.882435    8.8173047  39.9385114
  [6,]   62.5393235  8.200700   46.6494207  78.6409477
  [7,]   10.4238982  9.212092   -7.5685590  28.2300654
  [8,] -101.2604271 10.722232 -122.3516434 -80.2619085
  [9,]   19.5471476 12.552384   -4.7376769  43.8389666
 [10,]   35.6862223 14.582555    7.8431522  63.8615397
 [11,]   11.3514786 13.267842  -14.3034655  38.5965655
 [12,]   -7.8576214 11.368767  -29.9548662  15.2236568
 [13,]  -11.8866214  9.759004  -31.0451165   7.5810930
 [14,]  -11.8984214  8.602531  -28.8400719   4.6839775
 [15,]  -10.6303213  8.095987  -26.4733918   4.9919101
 [16,]   -4.1256213  8.358382  -20.4896950  11.9939167
 [17,]   -8.1981213  9.325030  -26.2684432   9.8533205
 [18,]   -5.8422213 10.808604  -27.0895735  15.1989061
 [19,]   -1.0147213 12.628211  -25.9299251  23.5442172
 [20,]   10.2627787 14.659250  -18.6109645  38.2763893
 [21,]  -14.1307545 13.081867  -39.3323728  11.7215630
 [22,]  -23.7830376 11.263325  -45.3606424  -1.3602247
 [23,]   11.2741792  9.704050   -7.1513183  30.4119495
 [24,]    4.8651960  8.547136  -11.5927155  21.2463000
 [25,]   -3.5995871  7.969777  -19.4680768  11.5543854
 [26,]  -17.3796703  8.096915  -33.3719666  -2.0062082
 [27,]   -7.3473535  8.898403  -24.7874832   9.7808910
 [28,]    8.0523634 10.216750  -11.9357230  27.6746712
 [29,]    8.3831802 11.881130  -14.9272685  31.6172843
 [30,]  -10.0446029 13.766603  -36.9616249  17.2497313
 [31,]   47.0143649 13.349353   20.0385061  72.1654343
 [32,]   20.1192139 11.452618   -3.0476894  41.6342456
 [33,]   -2.1772371  9.827961  -22.4408530  16.3434052
 [34,]   -6.6534881  8.630428  -24.1315647   9.8957614
 [35,]  -11.7419392  8.052881  -27.6595663   3.7435315
 [36,]   -5.7064902  8.226945  -21.8302645  10.0542347
 [37,]  -28.8051412  9.109637  -46.4409738 -10.7520979
 [38,]    3.4638078 10.524137  -16.8163612  24.5163549
 [39,]  -15.2007432 12.288147  -38.9223336   9.3414311
 [40,]   27.7457058 14.272659    0.3894765  56.4163778
 [41,]   14.6131739 13.077700  -11.5249147  39.3376808
 [42,]    4.5420490 11.171183  -18.1453048  26.0449790
 [43,]   13.8994241  9.534117   -5.3127001  32.5307140
 [44,]   24.7308993  8.326967    8.3555983  41.1918624
 [45,]   13.4296744  7.753214   -1.8104064  28.6934999
 [46,]  -16.9921504  7.951178  -32.7391296  -1.2163621
 [47,]  -27.6990753  8.869334  -44.7599150 -10.0785079
 [48,]    9.5803999 10.317164  -10.6314728  29.6748903
 [49,]  -38.9536250 12.106099  -62.6196725 -15.2554241
 [50,]   31.4173502 14.106960    3.8146760  59.0496881
 [51,]  -25.5227362 12.329900  -50.2766499  -1.5731197
 [52,]  -27.8023150 10.578617  -49.0179473  -7.4610623
 [53,]   -7.8835938  9.109124  -26.0698406   9.6827349
 [54,]   18.6931274  8.076723    2.7035556  34.3572028
 [55,]   16.1564486  7.660227    1.3309625  31.2108149
 [56,]   -1.5396302  7.956948  -17.2819233  13.9190325
 [57,]  132.3938910  8.895801  114.4197458 149.6811613
 [58,]   14.8323122 10.302710   -5.9695231  34.8500215
 [59,]  -11.9292666 12.014355  -35.8977767  11.5429694
 [60,]  -98.5959454 13.918761 -126.5152039 -71.1732532
 [61,]   15.9842567 12.574143   -9.5728325  39.8324839
 [62,]   11.3810871 10.810526  -10.4264722  31.7682105
 [63,]  -11.7203825  9.314392  -30.5640400   5.5506670
 [64,]    1.0042479  8.232885  -15.5338027  16.6615754
 [65,]  -11.9502217  7.741766  -27.5354792   2.9604863
 [66,]   18.7295087  7.951198    2.7649522  33.8198312
 [67,]    2.2737390  8.811368  -15.2993164  19.1049859
 [68,]    8.7713694 10.158293  -11.0678872  28.4049214
 [69,]  -17.0243002 11.826821  -40.2257561   5.4815856
 [70,]    1.3427302 13.699946  -25.4765971  27.9067917
 [71,]   21.0613281 12.128597   -2.4636821  45.2004013
 [72,]   20.2842656 10.449554    0.1426243  40.8708066
 [73,]  -24.0573970  9.057142  -41.4532790  -6.4319658
 [74,]  -24.2549596  8.100540  -39.8898504  -8.7067043
 [75,]  -11.4080222  7.742997  -26.4028580   3.7801030
 [76,]  -17.7463848  8.064587  -33.2078052  -1.8519270
 [77,]   -7.9179474  8.992743  -25.6729318  10.0363292
 [78,]    6.5749901 10.365790  -13.3234690  27.3260780
 [79,]   -0.7061725 12.032376  -23.9536144  23.3937442
 [80,]   29.3407649 13.887220    2.4555328  56.6854435
 [81,]   -8.9505931 13.446811  -36.2974541  16.1235832
 [82,]   23.6370619 11.494737    0.4749826  45.0330067
 [83,]    4.4293170  9.823486  -15.5560646  23.1077562
 [84,]   20.9894720  8.598399    3.7709327  37.5006389
 [85,]    1.8880271  8.026438  -14.0806867  17.3775307
 [86,]    5.3210821  8.244672  -11.1474557  21.5343964
 [87,]   -3.6140628  9.197020  -21.6227344  14.7098419
 [88,]  -13.5066078 10.689033  -35.0048514   8.0684314
 [89,]  -12.8147528 12.529379  -37.3666557  11.5963573
 [90,]  -11.0734977 14.586806  -39.8390283  17.3961526
 [91,]   26.6011637 13.138021    1.2833409  52.3121756
 [92,]    8.8792779 11.261943  -12.9771281  30.5912050
 [93,]  -32.4764079  9.668895  -51.1235578 -13.6244034
 [94,]    2.8735063  8.519160  -13.6050047  19.9669302
 [95,]    3.3226204  8.006061  -12.0171974  19.7551552
 [96,]   10.2676346  8.249262   -5.4403166  26.5274971
 [97,]    3.5281488  9.188908  -14.1372154  21.8212832
 [98,]   -3.2007370 10.642092  -23.9237596  17.8598078
 [99,]   16.8101771 12.429987   -7.0919921  41.0373018
[100,]    0.7014913 14.428702  -26.9122653  28.6985302
[101,]    8.9557726 12.954513  -15.7140586  34.0686539
[102,]   -8.3029113 11.127338  -29.3326522  13.6553782
[103,]  -11.1661952  9.584090  -29.7762728   7.6131520
[104,]   -6.6419791  8.481205  -23.6319173   9.6681585
[105,]  -22.3258630  8.002862  -37.9602527  -7.1619842
[106,]  -14.7339469  8.258309  -31.0434036   0.8576072
[107,]  -14.4157308  9.186536  -32.7227686   3.1606621
[108,]    0.6492854 10.612452  -20.1638548  21.0939207
[109,]   17.3557015 12.365062   -6.9487866  41.0370403
[110,]   21.2480176 14.324953   -6.7467926  48.6397935
[111,]   17.2108607 12.983600   -7.6509673  43.3436003
[112,]  -12.5777108 11.097524  -33.7948785   9.4789394
[113,]  -16.7734823  9.501461  -35.3093560   1.7248134
[114,]  -34.3970538  8.363133  -50.8728956 -18.4224852
[115,]  -37.9537253  7.883385  -53.5395135 -22.5303762
[116,]    5.9084031  8.178940  -10.2382555  22.0535403
[117,]   38.6821316  9.175178   20.7779031  56.5162833
[118,]    5.2099601 10.677746  -15.4188211  25.8634679
[119,]   19.8326886 12.505445   -4.5033238  43.8537798
[120,]   -2.5478829 14.536147  -31.1748980  25.7096307
[121,]   -5.2221058 12.296766  -30.0338803  18.2768622
[122,]   36.7723418 10.570416   16.0458036  57.3862734
[123,]   -0.9280106  9.137621  -19.1826892  16.9691381
[124,]    2.2305370  8.154616  -13.8664354  18.2976151
[125,]  -14.0678154  7.793498  -28.9614379   1.1543959
[126,]   11.2017322  8.137486   -4.2159495  27.4179906
[127,]  -13.2219202  9.107027  -30.5444100   4.9369225
[128,]  -41.9096727 10.530737  -61.8594938 -21.0666692
[129,]    5.4999749 12.251291  -17.6006566  30.2373232
[130,]   23.9870225 14.160898   -2.9135480  52.9330907
[131,]  -50.1851742 12.642016  -74.9813788 -25.2069255
[132,]   12.2654218 10.876060   -9.1860119  33.5143539
[133,]   26.8838177  9.389051    8.4722361  45.1985922
[134,]   32.7946136  8.331710   16.6590336  49.2925236
[135,]   20.6131095  7.878958    5.3079780  36.1415504
[136,]   10.6354054  8.132408   -5.4818727  26.6006147
[137,]   -1.8328987  9.032809  -19.6063957  16.1112994
[138,]   -9.8931028 10.413679  -30.7105285  10.9439549
[139,]   -8.7513069 12.111782  -32.9019489  15.8345217
[140,]   -9.9164109 14.012256  -38.1911964  18.7115231
[141,]   17.3170108 12.162899   -7.5044963  41.4076531
[142,]    2.4938533 10.454037  -18.4011681  23.0783537
[143,]  -20.0372041  9.040126  -37.7692771  -2.2383448
[144,]  -10.9595616  8.077564  -26.6944623   4.8997245
[145,]   14.8694809  7.736691   -0.2583325  29.9570833
[146,]    5.9242234  8.096414   -9.6154416  21.8552488
[147,]  -24.4905341  9.073788  -42.3436125  -6.5689266
[148,]   14.1605084 10.497692   -6.0951417  34.8225751
[149,]   -5.0189490 12.212928  -29.2239169  18.9223818
[150,]    9.8775935 14.113677  -17.5020642  37.2024154
[151,]   -1.0756954 13.566640  -26.7929747  25.9672448
[152,]   -6.9968197 11.574697  -29.1294997  15.8449276
[153,]  -17.8001440  9.849132  -36.8821170   1.7160701
[154,]  -31.4085684  8.552723  -47.8796344 -14.8466966
[155,]  -19.5248927  7.899659  -34.9215949  -4.1227921
[156,]   41.9508829  8.048108   26.6378031  58.2529577
[157,]  -36.2753414  8.958313  -53.4221704 -18.4408575
[158,]   14.9814342 10.432764   -5.3908114  35.3999000
[159,]   17.3783099 12.269705   -7.1090242  41.5700714
[160,]    9.2634855 14.330409  -19.2215602  37.3349094
[161,]   17.6684306 12.402904   -6.8786974  41.9252915
[162,]   10.7435202 10.664910  -10.3985361  31.5293269
[163,]    6.7123098  9.211828  -11.5806076  24.5923017
[164,]    1.1155993  8.196612  -14.6029365  17.0705676
[165,]  -10.9907111  7.792324  -26.3787217   4.0556794
[166,]  -15.1365216  8.091067  -31.0221217   0.2970601
[167,]  -49.8700320  9.023281  -67.3968434 -32.4474298
[168,]  -13.9925424 10.420319  -34.2956891   6.2618549
[169,]   22.6702471 12.122528   -0.8761170  46.5856829
[170,]   31.8714367 14.019183    4.4602308  59.1800614
[171,]    5.6027772 12.217894  -18.9084043  28.9475421
[172,]   -2.0797266 10.563863  -22.8935724  18.0366489
[173,]   10.2982696  9.184166   -7.4054466  28.1073582
[174,]   11.5882658  8.218154   -4.0467361  27.7431437
[175,]  -23.6155380  7.820655  -38.5771839  -8.0089842
[176,]    7.0746582  8.076056   -8.2741050  23.3063590
[177,]    0.2040544  8.928502  -17.5001842  18.0677502
[178,]   -2.8026495 10.229813  -23.2942630  17.1454222
[179,]   11.3743467 11.832811  -12.3251250  34.2585417
[180,]   -5.3885571 13.631479  -32.7821398  21.5163322</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.3 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   347       
 (0.5, 0.7]   (ok)         1    0.6%   1024      
   (0.7, 1]   (bad)        1    0.6%   95        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.3
p_loo        33.8  8.3
looic      1721.5 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   684       
 (0.5, 0.7]   (ok)         5    2.8%   447       
   (0.7, 1]   (bad)        1    0.6%   24        
   (1, Inf)   (very bad)   2    1.1%   27        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.4      11.6  
fit_sleep1 -92.5      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.3 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   347       
 (0.5, 0.7]   (ok)         1    0.6%   1024      
   (0.7, 1]   (bad)        1    0.6%   95        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.3
p_loo        33.8  8.3
looic      1721.5 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   684       
 (0.5, 0.7]   (ok)         5    2.8%   447       
   (0.7, 1]   (bad)        1    0.6%   24        
   (1, Inf)   (very bad)   2    1.1%   27        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.7     22.3        33.8    8.3   1721.5
fit_sleep2  -24.4      11.6  -885.1     14.4        19.6    3.4   1770.3
fit_sleep1  -92.5      20.9  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.5  
fit_sleep2   28.9  
fit_sleep1   21.1  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.446588e-41 2.516996e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.56     0.33     5.45       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.56    -3.18     2.91       5.43      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.3.5         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.0       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
