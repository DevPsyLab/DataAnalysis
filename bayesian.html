<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.98      6.92    15.47    42.68 1.00     1528     2491
sd(Days)                6.54      1.57     4.10    10.30 1.00     1418     1500
cor(Intercept,Days)     0.08      0.30    -0.49     0.65 1.01     1004     1422

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.41      7.38   236.75   266.63 1.00     2095     2604
Days         10.50      1.66     7.14    13.75 1.00     1303     1924

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.96      1.58    23.13    29.30 1.00     4016     2351

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7909  13.25736 227.8297 279.6201
309 211.1526  13.51427 183.2146 237.7196
310 212.8747  13.26691 185.8942 238.9840
330 274.4966  13.61171 248.3912 301.7311
331 273.2737  12.88803 248.9927 299.1399
332 260.3454  12.54729 236.2190 285.8195
333 267.9643  12.70364 243.5215 293.3045
334 244.1100  12.52088 219.0791 268.3754
335 250.5922  13.07880 225.3768 276.6784
337 285.6848  13.24069 259.8734 311.6882
349 226.6098  13.02581 200.7808 251.3096
350 238.8820  13.06283 212.4524 263.5367
351 255.5629  12.31153 232.0281 280.6293
352 272.1330  12.58713 247.1312 297.6532
369 255.2759  12.35741 230.9068 279.1853
370 226.4473  13.71128 198.6886 251.8325
371 251.9499  12.01575 228.6545 275.9278
372 263.4176  12.48284 239.5995 289.2279

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6306204  2.537949 14.9098252 24.694179
309  1.8328700  2.547904 -3.1621679  6.818454
310  4.9622123  2.455085  0.3404018  9.861609
330  5.7638809  2.559245  0.5827398 10.581160
331  7.4274696  2.446027  2.4181127 12.008513
332 10.2337864  2.372725  5.4166586 14.728143
333 10.2706138  2.419733  5.4465506 14.855476
334 11.5623538  2.365048  7.0695764 16.241649
335 -0.2013435  2.552742 -5.2674866  4.762393
337 19.2054524  2.486409 14.4773951 24.133972
349 11.5693273  2.461995  6.8885969 16.418228
350 16.9900745  2.501509 12.3351681 22.051852
351  7.5380237  2.351867  2.8224458 12.022327
352 14.0205180  2.405453  9.3313466 18.638207
369 11.2248289  2.363508  6.4854033 15.761225
370 15.1943560  2.576724 10.3550475 20.382461
371  9.5309260  2.290503  5.0456423 14.013352
372 11.7887822  2.357725  7.0440709 16.292843</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7909 13.257359 227.8297 279.6201
  [2,] 273.4215 11.323358 251.1434 295.5418
  [3,] 293.0522  9.672728 274.0642 311.8117
  [4,] 312.6828  8.472736 296.2065 329.0986
  [5,] 332.3134  7.930651 316.7938 347.5740
  [6,] 351.9440  8.178360 335.8974 367.2476
  [7,] 371.5746  9.151956 353.7371 388.8982
  [8,] 391.2053 10.654266 370.4972 411.6973
  [9,] 410.8359 12.496033 386.4915 435.3974
 [10,] 430.4665 14.548906 402.4819 459.4235
 [11,] 211.1526 13.514269 183.2146 237.7196
 [12,] 212.9855 11.583819 188.9577 235.4415
 [13,] 214.8184  9.935687 194.4957 233.7176
 [14,] 216.6512  8.731238 199.3665 233.6549
 [15,] 218.4841  8.169137 202.3446 234.4156
 [16,] 220.3170  8.379661 203.7935 236.6694
 [17,] 222.1498  9.310546 204.0114 240.4143
 [18,] 223.9827 10.776709 203.1518 245.2765
 [19,] 225.8156 12.592548 201.3083 250.5649
 [20,] 227.6485 14.628421 198.8750 256.0221
 [21,] 212.8747 13.266905 185.8942 238.9840
 [22,] 217.8369 11.404069 194.9347 240.2610
 [23,] 222.7991  9.805593 202.9936 241.9865
 [24,] 227.7613  8.619827 211.0889 244.5814
 [25,] 232.7236  8.031691 217.1367 248.8770
 [26,] 237.6858  8.171266 221.6338 254.2806
 [27,] 242.6480  9.004776 225.0542 260.9740
 [28,] 247.6102 10.366161 227.2834 268.2175
 [29,] 252.5724 12.078223 229.4071 276.4341
 [30,] 257.5346 14.013012 230.6701 285.0162
 [31,] 274.4966 13.611708 248.3912 301.7311
 [32,] 280.2604 11.647971 257.6527 303.3148
 [33,] 286.0243  9.958482 266.7962 305.7789
 [34,] 291.7882  8.704421 275.0186 308.6980
 [35,] 297.5521  8.090859 281.6761 313.1019
 [36,] 303.3160  8.261751 286.9071 319.2864
 [37,] 309.0798  9.173359 291.0455 327.0624
 [38,] 314.8437 10.636916 293.8276 336.0511
 [39,] 320.6076 12.459410 296.0731 345.2229
 [40,] 326.3715 14.506181 297.0280 355.2203
 [41,] 273.2737 12.888031 248.9927 299.1399
 [42,] 280.7012 11.044264 259.8115 302.7589
 [43,] 288.1287  9.477145 269.9813 307.2339
 [44,] 295.5561  8.344033 279.3423 312.0773
 [45,] 302.9836  7.835534 287.9062 318.4036
 [46,] 310.4111  8.070587 294.6449 326.1159
 [47,] 317.8385  8.991066 300.4317 335.7925
 [48,] 325.2660 10.416825 304.6085 345.8889
 [49,] 332.6935 12.171578 308.4086 356.4709
 [50,] 340.1210 14.133311 311.7836 367.6818
 [51,] 260.3454 12.547292 236.2190 285.8195
 [52,] 270.5792 10.824549 250.1416 292.6625
 [53,] 280.8130  9.389718 262.6340 299.9381
 [54,] 291.0468  8.391806 274.9378 308.0099
 [55,] 301.2806  7.996103 285.8961 317.2678
 [56,] 311.5144  8.289304 295.1788 327.7206
 [57,] 321.7481  9.205819 303.3515 339.8735
 [58,] 331.9819 10.584956 310.8615 352.7963
 [59,] 342.2157 12.271721 317.9030 365.8615
 [60,] 352.4495 14.156575 324.3435 379.7805
 [61,] 267.9643 12.703638 243.5215 293.3045
 [62,] 278.2349 10.896192 257.0022 300.2139
 [63,] 288.5055  9.369193 270.1556 307.2697
 [64,] 298.7761  8.279298 282.6081 315.2322
 [65,] 309.0468  7.811658 293.5172 324.5271
 [66,] 319.3174  8.075112 303.2368 335.1771
 [67,] 329.5880  9.005725 311.7979 347.2522
 [68,] 339.8586 10.426358 319.7304 360.2059
 [69,] 350.1292 12.166553 326.0041 373.5879
 [70,] 360.3998 14.108554 332.7504 387.0800
 [71,] 244.1100 12.520877 219.0791 268.3754
 [72,] 255.6724 10.783942 233.9030 276.6836
 [73,] 267.2347  9.327452 248.5682 285.6969
 [74,] 278.7971  8.300374 262.8863 294.9109
 [75,] 290.3594  7.872608 274.9433 305.7673
 [76,] 301.9218  8.139201 285.9214 317.7525
 [77,] 313.4842  9.038924 295.5661 330.9116
 [78,] 325.0465 10.408871 304.5063 344.6513
 [79,] 336.6089 12.090241 313.2740 359.6905
 [80,] 348.1712 13.971048 321.2688 375.1767
 [81,] 250.5922 13.078801 225.3768 276.6784
 [82,] 250.3909 11.132549 228.8406 272.2972
 [83,] 250.1895  9.478674 231.5630 268.6906
 [84,] 249.9882  8.293966 233.7203 265.9678
 [85,] 249.7868  7.795349 234.1083 265.2862
 [86,] 249.5855  8.110366 233.4880 265.7263
 [87,] 249.3842  9.155414 231.4320 267.3987
 [88,] 249.1828 10.719055 228.5116 270.3434
 [89,] 248.9815 12.609825 224.7199 273.9484
 [90,] 248.7801 14.702048 220.7574 278.1280
 [91,] 285.6848 13.240692 259.8734 311.6882
 [92,] 304.8903 11.357267 282.6990 327.2636
 [93,] 324.0957  9.748002 304.6821 343.1149
 [94,] 343.3012  8.568784 326.5376 359.9955
 [95,] 362.5066  8.011805 346.8500 377.9107
 [96,] 381.7121  8.204781 366.2428 397.6466
 [97,] 400.9175  9.100127 383.9056 418.6938
 [98,] 420.1230 10.520012 400.2295 440.8376
 [99,] 439.3284 12.283869 416.0364 463.6214
[100,] 458.5339 14.264666 431.5224 486.9813
[101,] 226.6098 13.025812 200.7808 251.3096
[102,] 238.1792 11.173749 216.0280 259.6310
[103,] 249.7485  9.599811 230.9209 268.6155
[104,] 261.3178  8.460668 244.7577 278.0652
[105,] 272.8872  7.945583 257.9209 288.5470
[106,] 284.4565  8.173403 268.7420 300.9602
[107,] 296.0258  9.088431 278.4009 314.1700
[108,] 307.5951 10.512729 287.2962 328.2491
[109,] 319.1645 12.270216 295.4734 343.3849
[110,] 330.7338 14.238040 302.9329 359.1095
[111,] 238.8820 13.062831 212.4524 263.5367
[112,] 255.8721 11.166916 233.5282 277.1314
[113,] 272.8621  9.553929 254.1718 291.2308
[114,] 289.8522  8.388695 273.3998 306.5011
[115,] 306.8423  7.872608 291.9658 322.4866
[116,] 323.8324  8.130240 308.4527 340.0990
[117,] 340.8224  9.096084 323.3056 358.7287
[118,] 357.8125 10.577891 338.0003 378.7039
[119,] 374.8026 12.391929 350.7771 399.2240
[120,] 391.7926 14.413298 364.0137 420.1134
[121,] 255.5629 12.311533 232.0281 280.6293
[122,] 263.1009 10.598274 242.6418 284.2253
[123,] 270.6390  9.172543 252.9621 288.5122
[124,] 278.1770  8.185978 262.2688 294.1706
[125,] 285.7150  7.806887 270.3932 301.0619
[126,] 293.2530  8.120794 277.5102 309.5223
[127,] 300.7911  9.055918 283.4111 318.8082
[128,] 308.3291 10.446750 288.3019 329.0900
[129,] 315.8671 12.137630 292.7199 339.7972
[130,] 323.4051 14.020417 296.3620 350.6679
[131,] 272.1330 12.587128 247.1312 297.6532
[132,] 286.1535 10.842717 264.8754 307.6205
[133,] 300.1740  9.394979 281.9911 318.6040
[134,] 314.1946  8.398760 297.7828 331.0638
[135,] 328.2151  8.024033 312.5127 344.2588
[136,] 342.2356  8.354846 325.9329 358.5037
[137,] 356.2561  9.316340 338.2124 374.4608
[138,] 370.2766 10.740454 349.1112 391.2718
[139,] 384.2972 12.469680 359.4880 408.7855
[140,] 398.3177 14.394475 370.0161 426.0877
[141,] 255.2759 12.357411 230.9068 279.1853
[142,] 266.5007 10.634347 245.8878 287.0658
[143,] 277.7255  9.200295 259.9352 295.9299
[144,] 288.9504  8.208157 273.2993 305.1541
[145,] 300.1752  7.827809 285.1302 315.8915
[146,] 311.4000  8.145409 295.3825 327.2437
[147,] 322.6248  9.088075 304.9065 340.3961
[148,] 333.8497 10.488607 313.2306 354.6560
[149,] 345.0745 12.190200 320.9823 369.3435
[150,] 356.2993 14.084154 328.6057 383.5211
[151,] 226.4473 13.711278 198.6886 251.8325
[152,] 241.6416 11.762033 217.7724 264.0892
[153,] 256.8360 10.098055 236.8295 276.1431
[154,] 272.0303  8.881161 254.2821 289.3922
[155,] 287.2247  8.310134 270.8022 303.4440
[156,] 302.4191  8.515907 285.2423 319.5932
[157,] 317.6134  9.447857 298.7513 336.4527
[158,] 332.8078 10.921646 311.2576 354.0757
[159,] 348.0021 12.750754 323.6448 373.2469
[160,] 363.1965 14.804057 334.7204 392.3175
[161,] 251.9499 12.015747 228.6545 275.9278
[162,] 261.4808 10.420289 240.8631 281.9154
[163,] 271.0118  9.125758 253.1004 288.6769
[164,] 280.5427  8.274619 264.3873 296.7984
[165,] 290.0736  8.009494 274.3080 305.9465
[166,] 299.6046  8.386147 283.4821 316.3934
[167,] 309.1355  9.327151 291.3244 327.4461
[168,] 318.6664 10.684420 298.0912 339.8504
[169,] 328.1973 12.321149 304.7470 352.6270
[170,] 337.7283 14.140630 310.5762 365.5827
[171,] 263.4176 12.482836 239.5995 289.2279
[172,] 275.2063 10.784472 254.3987 297.2795
[173,] 286.9951  9.375832 269.0528 306.0170
[174,] 298.7839  8.403890 282.8208 315.7687
[175,] 310.5727  8.028837 295.1447 326.4853
[176,] 322.3615  8.331676 306.3002 339.1236
[177,] 334.1503  9.246034 316.0968 352.6036
[178,] 345.9390 10.615047 325.1817 367.3272
[179,] 357.7278 12.287678 333.6936 382.6848
[180,] 369.5166 14.156714 341.9468 398.0212</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.2309180 13.257359  -30.0601067  21.7302944
  [2,]  -14.7168384 11.323358  -36.8371143   7.5612749
  [3,]  -42.2515587  9.672728  -61.0111362 -23.2636395
  [4,]    8.7570209  8.472736   -7.6588495  25.2332523
  [5,]   24.5385006  7.930651    9.2778909  40.0580616
  [6,]   62.7460802  8.178360   47.4425084  78.7926773
  [7,]   10.6291599  9.151956   -6.6943752  28.4666808
  [8,] -101.0566605 10.654266 -121.5486785 -80.3486254
  [9,]   19.7494191 12.496033   -4.8120750  44.0938434
 [10,]   35.8869988 14.548906    6.9300406  63.8716234
 [11,]   11.5812738 13.514269  -14.9856725  39.5192504
 [12,]   -7.7196962 11.583819  -30.1756640  16.3081065
 [13,]  -11.8405663  9.935687  -30.7397631   8.4820837
 [14,]  -11.9442363  8.731238  -28.9479264   5.3405081
 [15,]  -10.7680063  8.169137  -26.6995139   5.3715028
 [16,]   -4.3551763  8.379661  -20.7076492  12.1682863
 [17,]   -8.5195464  9.310546  -26.7839611   9.6188507
 [18,]   -6.2555164 10.776709  -27.5493123  14.5754249
 [19,]   -1.5198864 12.592548  -26.2691812  22.9874023
 [20,]    9.6657436 14.628421  -18.7078892  38.4391734
 [21,]  -13.8208065 13.266905  -39.9300929  13.1597324
 [22,]  -23.5047189 11.404069  -45.9288098  -0.6025032
 [23,]   11.5208688  9.805593   -7.6665397  31.3263527
 [24,]    5.0802565  8.619827  -11.7398113  21.7527046
 [25,]   -3.4161558  8.031691  -19.5695959  12.1706763
 [26,]  -17.2278681  8.171266  -33.8226822  -1.1759229
 [27,]   -7.2271804  9.004776  -25.5531673  10.3666463
 [28,]    8.1409073 10.366161  -12.4664207  28.4677135
 [29,]    8.4400949 12.078223  -15.4216186  31.6054251
 [30,]  -10.0193174 14.013012  -37.5008686  16.8452450
 [31,]   47.0460364 13.611708   19.8115224  73.1513578
 [32,]   20.1397555 11.647971   -2.9146158  42.7475074
 [33,]   -2.1678255  9.958482  -21.9223760  17.0603099
 [34,]   -6.6552064  8.704421  -23.5649803  10.1143534
 [35,]  -11.7547874  8.090859  -27.3045528   4.1212300
 [36,]   -5.7304683  8.261751  -21.7008874  10.6784320
 [37,]  -28.8402493  9.173359  -46.8228235 -10.8058940
 [38,]    3.4175698 10.636916  -17.7897650  24.4336909
 [39,]  -15.2581112 12.459410  -39.8734474   9.2764363
 [40,]   27.6772079 14.506181   -1.1715533  57.0206771
 [41,]   14.3341690 12.888031  -11.5319567  38.6151914
 [42,]    4.2987993 11.044264  -17.7589081  25.1884968
 [43,]   13.6919297  9.477145   -5.4133314  31.8393052
 [44,]   24.5591601  8.344033    8.0379663  40.7729768
 [45,]   13.2936905  7.835534   -2.1262926  28.3711131
 [46,]  -17.0923792  8.070587  -32.7972397  -1.3262384
 [47,]  -27.7635488  8.991066  -45.7175393 -10.3566959
 [48,]    9.5516816 10.416825  -11.0711824  30.2092075
 [49,]  -38.9465880 12.171578  -62.7240110 -14.6617115
 [50,]   31.4601424 14.133311    3.8993380  59.7975428
 [51,]  -25.4848191 12.547292  -50.9589201  -1.3584090
 [52,]  -27.7674055 10.824549  -49.8507083  -7.3298018
 [53,]   -7.8516920  9.389718  -26.9767783  10.3273257
 [54,]   18.7220216  8.391806    1.7588810  34.8309581
 [55,]   16.1823351  7.996103    0.1950789  31.5668059
 [56,]   -1.5167513  8.289304  -17.7230197  14.8187573
 [57,]  132.4137623  9.205819  114.2884409 150.8103951
 [58,]   14.8491758 10.584956   -5.9652411  35.9696001
 [59,]  -11.9154106 12.271721  -35.5611538  12.3972927
 [60,]  -98.5850971 14.156575 -125.9160840 -70.4790735
 [61,]   15.8780972 12.703638   -9.4620546  40.3208805
 [62,]   11.3200834 10.896192  -10.6588769  32.5527996
 [63,]  -11.7362304  9.369193  -30.5003708   6.6136756
 [64,]    1.0335557  8.279298  -15.4224738  17.2016405
 [65,]  -11.8757581  7.811658  -27.3560763   3.6538457
 [66,]   18.8491280  8.075112    2.9894056  34.9296704
 [67,]    2.4385142  9.005725  -15.2256563  20.2286343
 [68,]    8.9813003 10.426358  -11.3659754  29.1094707
 [69,]  -16.7692135 12.166553  -40.2278943   7.3559146
 [70,]    1.6429726 14.108554  -25.0371950  29.2924161
 [71,]   21.3630714 12.520877   -2.9022900  46.3939551
 [72,]   20.5288176 10.783942   -0.4823549  42.2982498
 [73,]  -23.8700363  9.327452  -42.3322376  -5.2035110
 [74,]  -24.1247901  8.300374  -40.2385561  -8.2139508
 [75,]  -11.3350439  7.872608  -26.7429427   4.0810965
 [76,]  -17.7305977  8.139201  -33.5613098  -1.7302246
 [77,]   -7.9593515  9.038924  -25.3868056   9.9586976
 [78,]    6.4763947 10.408871  -13.1283760  27.0166452
 [79,]   -0.8619591 12.090241  -23.9435847  22.4728702
 [80,]   29.1277871 13.971048    2.1222613  56.0301607
 [81,]   -8.9839218 13.078801  -35.0700803  16.2314600
 [82,]   23.5563217 11.132549    1.6499777  45.1066119
 [83,]    4.3011652  9.478674  -14.1998791  22.9277467
 [84,]   20.8139086  8.293966    4.8342532  37.0818271
 [85,]    1.6650521  7.795349  -13.8343155  17.3435850
 [86,]    5.0506956  8.110366  -11.0900984  21.1482478
 [87,]   -3.9318609  9.155414  -21.9464278  14.0202985
 [88,]  -13.8718174 10.719055  -35.0324172   6.7994098
 [89,]  -13.2273739 12.609825  -38.1942751  11.0342461
 [90,]  -11.5335304 14.702048  -40.8813834  16.4891545
 [91,]   26.6817905 13.240692    0.6783985  52.4932137
 [92,]    8.9155381 11.357267  -13.4577665  31.1067714
 [93,]  -32.4845143  9.748002  -51.5037476 -13.0708861
 [94,]    2.8210333  8.568784  -13.8733086  19.5845733
 [95,]    3.2257810  8.011805  -12.1783197  18.8824230
 [96,]   10.1264286  8.204781   -5.8081500  25.5956596
 [97,]    3.3425762  9.100127  -14.4337152  20.3545440
 [98,]   -3.4306762 10.520012  -24.1453330  16.4628173
 [99,]   16.5358714 12.283869   -7.7571056  39.8278812
[100,]    0.3828191 14.264666  -28.0646087  27.3943008
[101,]    9.4933563 13.025812  -15.2064114  35.3223733
[102,]   -7.8624709 11.173749  -29.3142972  14.2886546
[103,]  -10.8228982  9.599811  -29.6899455   8.0046538
[104,]   -6.3958255  8.460668  -23.1431746  10.1643305
[105,]  -22.1768527  7.945583  -37.8366697  -7.2105941
[106,]  -14.6820800  8.173403  -31.1858099   1.0323764
[107,]  -14.4610073  9.088431  -32.6051902   3.1639245
[108,]    0.5068654 10.512729  -20.1471145  20.8058246
[109,]   17.1161382 12.270216   -7.1043261  40.8072433
[110,]   20.9113109 14.238040   -7.4644439  48.7122096
[111,]   17.4148216 13.062831   -7.2398832  43.8443938
[112,]  -12.4177529 11.166916  -33.6771330   9.9261474
[113,]  -16.6575274  9.553929  -35.0262319   2.0328310
[114,]  -34.3251019  8.388695  -50.9740431 -17.8726943
[115,]  -37.9257764  7.872608  -53.5700769 -23.0493301
[116,]    5.8923491  8.130240  -10.3743017  21.2720285
[117,]   38.6220746  9.096084   20.7158400  56.1388688
[118,]    5.1059001 10.577891  -15.7855265  24.9180734
[119,]   19.6846256 12.391929   -4.7367823  43.7100676
[120,]   -2.7399489 14.413298  -31.0606666  25.0389853
[121,]   -5.0364160 12.311533  -30.1028277  18.4983768
[122,]   36.9566603 10.598274   15.8323375  57.4157633
[123,]   -0.7450634  9.172543  -18.6183102  16.9318340
[124,]    2.4121130  8.185978  -13.5815471  18.3202513
[125,]  -13.8876107  7.806887  -29.2345120   1.4342196
[126,]   11.3805656  8.120794   -4.8886793  27.1234003
[127,]  -13.0444581  9.055918  -31.0616229   4.3354692
[128,]  -41.7335818 10.446750  -62.4944692 -21.7064201
[129,]    5.6746945 12.137630  -18.2554384  28.8219284
[130,]   24.1603708 14.020417   -3.1023541  51.2034926
[131,]  -50.4559127 12.587128  -75.9761225 -25.4541495
[132,]   12.0403694 10.842717   -9.4266095  33.3184532
[133,]   26.7044514  9.394979    8.2745368  44.8874338
[134,]   32.6609334  8.398760   15.7916970  49.0726851
[135,]   20.5251154  8.024033    4.4813713  36.2274916
[136,]   10.5930975  8.354846   -5.6749673  26.8957854
[137,]   -1.8295205  9.316340  -20.0341847  16.2141979
[138,]   -9.8440385 10.740454  -30.8391520  11.3213720
[139,]   -8.6565564 12.469680  -33.1449210  16.1526251
[140,]   -9.7759744 14.394475  -37.5460095  18.5256206
[141,]   16.6476333 12.357411   -7.2617706  41.0167393
[142,]    1.9362043 10.634347  -18.6288810  22.5491304
[143,]  -20.4831246  9.200295  -38.6875204  -2.6927516
[144,]  -11.2937535  8.208157  -27.4974700   4.3572881
[145,]   14.6470175  7.827809   -1.0692700  29.6920387
[146,]    5.8134886  8.145409  -10.0302237  21.8310480
[147,]  -24.4895404  9.088075  -42.2607656  -6.7711507
[148,]   14.2732307 10.488607   -6.5331210  34.8923387
[149,]   -4.7944983 12.190200  -29.0635014  19.2976860
[150,]   10.2137728 14.084154  -17.0080228  37.9074066
[151,]   -1.1832720 13.711278  -26.5685075  26.5753657
[152,]   -7.1181280 11.762033  -29.5657131  16.7511190
[153,]  -17.9351840 10.098055  -37.2423430   2.0712921
[154,]  -31.5573399  8.881161  -48.9191839 -13.8091008
[155,]  -19.6873959  8.310134  -35.9066684  -3.2648836
[156,]   41.7746481  8.515907   24.6005395  58.9513684
[157,]  -36.4653078  9.447857  -55.3045512 -17.6032467
[158,]   14.7777362 10.921646   -6.4902303  36.3278803
[159,]   17.1608802 12.750754   -8.0839125  41.5182198
[160,]    9.0323242 14.804057  -20.0886957  37.5083510
[161,]   17.9304794 12.015747   -6.0474087  41.2258986
[162,]   10.9619535 10.420289   -9.4725965  31.5797010
[163,]    6.8871275  9.125758  -10.7780375  24.7985446
[164,]    1.2468016  8.274619  -15.0089279  17.4021773
[165,]  -10.9031244  8.009494  -26.7759950   4.8624519
[166,]  -15.0925503  8.386147  -31.8814115   1.0298779
[167,]  -49.8696763  9.327151  -68.1803232 -32.0585826
[168,]  -14.0358022 10.684420  -35.2197580   6.5394456
[169,]   22.5833718 12.321149   -1.8463429  46.0337438
[170,]   31.7409459 14.140630    3.8865229  58.8930420
[171,]    5.9941432 12.482836  -19.8161844  29.8121798
[172,]   -1.7323390 10.784472  -23.8054587  19.0753048
[173,]   10.6016788  9.375832   -8.4202280  28.5439827
[174,]   11.8476966  8.403890   -5.1370992  27.8107893
[175,]  -23.4000856  8.028837  -39.3127492  -7.9720973
[176,]    7.2461322  8.331676   -9.5159735  23.3074366
[177,]    0.3315500  9.246034  -18.1218406  18.3849944
[178,]   -2.7191322 10.615047  -24.1072568  18.0382186
[179,]   11.4138856 12.287678  -13.5430758  35.4481341
[180,]   -5.3929966 14.156714  -33.8976495  22.1767851</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.5 10.5
p_loo         3.4  0.5
looic      1906.9 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.1 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1188      
 (0.5, 0.7]   (ok)         2    1.1%   367       
   (0.7, 1]   (bad)        1    0.6%   85        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.4 22.9
p_loo        35.3  9.1
looic      1724.8 45.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   814       
 (0.5, 0.7]   (ok)         7    3.9%   531       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   3    1.7%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -22.7      12.1  
fit_sleep1 -91.1      21.5  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.5 10.5
p_loo         3.4  0.5
looic      1906.9 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.1 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1188      
 (0.5, 0.7]   (ok)         2    1.1%   367       
   (0.7, 1]   (bad)        1    0.6%   85        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.4 22.9
p_loo        35.3  9.1
looic      1724.8 45.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   814       
 (0.5, 0.7]   (ok)         7    3.9%   531       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   3    1.7%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.4     22.9        35.3    9.1   1724.8
fit_sleep2  -22.7      12.1  -885.1     14.4        19.6    3.4   1770.1
fit_sleep1  -91.1      21.5  -953.5     10.5         3.4    0.5   1906.9
           se_looic
fit_sleep3   45.9  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
2.769267e-40 1.398803e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.85       1.6     0.17      5.4       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.15       1.6    -3.45     2.91       5.26      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.1-0     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_5.0.0           compiler_4.2.2      
 [22] cli_3.6.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.5          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.20      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.1   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.4          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.12       yaml_2.3.7          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.42           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.20        V8_4.2.2            
 [88] RcppParallel_5.1.6   vctrs_0.5.2          nloptr_2.0.3        
 [91] httpuv_1.6.8         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
