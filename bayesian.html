<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.92      6.84    15.78    42.66 1.00     1931     2244
sd(Days)                6.63      1.59     4.16    10.24 1.00     1372     1498
cor(Intercept,Days)     0.08      0.31    -0.50     0.68 1.00      943     1667

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.14      7.67   235.79   266.61 1.00     1975     2546
Days         10.37      1.68     7.13    13.60 1.00     1420     1694

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.89      1.55    23.02    29.22 1.00     3286     2687

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.5771  13.21905 226.4619 278.7917
309 211.5302  13.33703 185.3713 237.3117
310 213.0797  13.20792 186.1351 238.9025
330 274.8955  13.38194 248.5331 301.4045
331 273.2876  13.11769 248.2847 299.2840
332 260.2730  12.19244 236.6676 284.5832
333 268.1646  12.29417 244.4750 293.3499
334 244.3274  12.43170 219.7481 269.1637
335 251.1056  13.43709 225.8093 278.0701
337 285.8762  13.06374 260.4881 311.1640
349 226.3580  13.23334 200.1351 251.6041
350 238.6307  13.50654 211.4088 264.1790
351 255.9000  11.99814 232.5484 280.2092
352 271.9482  12.61208 247.7350 297.1227
369 254.6708  12.23218 231.2072 278.8743
370 226.1925  14.00049 197.3678 252.4476
371 252.0601  12.30825 228.1004 276.3106
372 263.5065  12.37548 239.3277 288.2795

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6666451  2.520055 14.99528996 24.714675
309  1.7704128  2.476712 -3.09293791  6.687405
310  4.9080160  2.470126 -0.01919204  9.802288
330  5.7480169  2.551747  0.51185673 10.705211
331  7.4874228  2.481670  2.51526165 12.265475
332 10.2187691  2.337385  5.66753065 14.804956
333 10.2276558  2.357865  5.49187248 14.725054
334 11.5098543  2.383925  6.76614224 16.182269
335 -0.3148923  2.612663 -5.68129276  4.646244
337 19.1649557  2.475396 14.45752438 23.940071
349 11.6353847  2.492192  6.76629645 16.566629
350 17.0494676  2.567461 12.18431036 22.149914
351  7.4366461  2.323837  2.77421665 11.815320
352 14.0443663  2.369551  9.30369987 18.636933
369 11.3740303  2.373876  6.59471585 16.064242
370 15.2271143  2.593507 10.29868582 20.370794
371  9.5028290  2.344278  4.91758073 14.121379
372 11.8143088  2.364661  7.22589134 16.425924</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.5771 13.219052 226.4619 278.7917
  [2,] 273.2437 11.283539 250.4820 294.9862
  [3,] 292.9104  9.622606 273.4618 311.8532
  [4,] 312.5770  8.400726 295.8370 329.1317
  [5,] 332.2436  7.826315 316.9859 347.7480
  [6,] 351.9103  8.039375 336.0961 367.6457
  [7,] 371.5769  8.984056 353.6354 388.9284
  [8,] 391.2436 10.464050 370.4351 411.3397
  [9,] 410.9102 12.287423 386.4511 434.7319
 [10,] 430.5769 14.323636 402.3998 458.4947
 [11,] 211.5302 13.337030 185.3713 237.3117
 [12,] 213.3006 11.441928 191.0076 235.3923
 [13,] 215.0711  9.809549 196.0977 233.9047
 [14,] 216.8415  8.590984 200.0567 233.0479
 [15,] 218.6119  7.978154 203.0046 233.9900
 [16,] 220.3823  8.109568 204.1593 236.1179
 [17,] 222.1527  8.952510 204.4547 239.5038
 [18,] 223.9231 10.334311 203.9250 243.9486
 [19,] 225.6935 12.071318 202.0929 249.1209
 [20,] 227.4639 14.032237 199.7361 254.9585
 [21,] 213.0797 13.207922 186.1351 238.9025
 [22,] 217.9877 11.336932 195.0723 239.8801
 [23,] 222.8957  9.736832 203.4855 242.0918
 [24,] 227.8037  8.560889 211.4755 244.4802
 [25,] 232.7117  7.998423 217.4001 248.2917
 [26,] 237.6197  8.177028 221.8826 253.4650
 [27,] 242.5278  9.052946 225.1930 260.0663
 [28,] 247.4358 10.452317 227.0854 267.7463
 [29,] 252.3438 12.196272 228.2366 275.8199
 [30,] 257.2518 14.158045 229.2602 284.4481
 [31,] 274.8955 13.381940 248.5331 301.4045
 [32,] 280.6435 11.451178 258.1927 303.1229
 [33,] 286.3915  9.808439 267.2590 305.6293
 [34,] 292.1395  8.619993 275.4331 308.8419
 [35,] 297.8875  8.088629 282.1484 313.2023
 [36,] 303.6355  8.340885 287.5891 319.6858
 [37,] 309.3836  9.313304 291.9358 327.3019
 [38,] 315.1316 10.813312 294.1348 336.2170
 [39,] 320.8796 12.654669 296.0869 345.3318
 [40,] 326.6276 14.709737 297.6897 354.8726
 [41,] 273.2876 13.117691 248.2847 299.2840
 [42,] 280.7750 11.257757 259.2533 303.1195
 [43,] 288.2625  9.680792 269.8067 307.2368
 [44,] 295.7499  8.544926 279.3569 312.7319
 [45,] 303.2373  8.039351 287.6200 318.9415
 [46,] 310.7247  8.280334 294.4873 326.8700
 [47,] 318.2121  9.209456 300.4161 336.1343
 [48,] 325.6996 10.648080 305.2529 346.2004
 [49,] 333.1870 12.420406 309.0375 357.2908
 [50,] 340.6744 14.403776 312.6491 368.8947
 [51,] 260.2730 12.192444 236.6676 284.5832
 [52,] 270.4917 10.511933 249.9567 291.3424
 [53,] 280.7105  9.125377 263.2891 298.4564
 [54,] 290.9293  8.183582 275.4250 306.4468
 [55,] 301.1480  7.848329 286.3356 316.2037
 [56,] 311.3668  8.194403 295.5550 326.9845
 [57,] 321.5856  9.144777 304.0082 339.1974
 [58,] 331.8043 10.537191 311.2310 351.9747
 [59,] 342.0231 12.221480 317.7896 365.3872
 [60,] 352.2419 14.093384 324.6283 379.6693
 [61,] 268.1646 12.294175 244.4750 293.3499
 [62,] 278.3922 10.576643 258.1086 299.7410
 [63,] 288.6199  9.148938 270.8409 306.9621
 [64,] 298.8475  8.164546 283.4585 315.4716
 [65,] 309.0752  7.793306 294.3571 324.6677
 [66,] 319.3028  8.119759 303.7537 335.4120
 [67,] 329.5305  9.068870 312.0122 347.3387
 [68,] 339.7582 10.472697 319.5047 360.3252
 [69,] 349.9858 12.174950 326.5708 374.0409
 [70,] 360.2135 14.067712 333.0030 387.9838
 [71,] 244.3274 12.431695 219.7481 269.1637
 [72,] 255.8373 10.692516 234.6155 277.0933
 [73,] 267.3471  9.245482 248.9359 285.5226
 [74,] 278.8570  8.245857 262.5039 294.7729
 [75,] 290.3669  7.866104 274.8334 305.8050
 [76,] 301.8767  8.192875 285.9817 317.9823
 [77,] 313.3866  9.150793 295.1413 331.5373
 [78,] 324.8964 10.569627 303.5343 345.4825
 [79,] 336.4063 12.290777 311.3409 360.7461
 [80,] 347.9161 14.204774 318.7281 375.8404
 [81,] 251.1056 13.437085 225.8093 278.0701
 [82,] 250.7907 11.447052 228.8217 273.5525
 [83,] 250.4758  9.755345 231.4573 269.4214
 [84,] 250.1609  8.541109 233.4071 266.6125
 [85,] 249.8460  8.024110 234.1150 265.5026
 [86,] 249.5311  8.335116 233.0619 265.7097
 [87,] 249.2162  9.392230 230.7622 267.7454
 [88,] 248.9013 10.982069 227.5190 270.2826
 [89,] 248.5865 12.909287 223.1043 273.4922
 [90,] 248.2716 15.044786 218.2387 277.1664
 [91,] 285.8762 13.063741 260.4881 311.1640
 [92,] 305.0411 11.183028 283.4728 326.6429
 [93,] 324.2061  9.576746 305.6020 343.0495
 [94,] 343.3710  8.403760 327.0747 360.1779
 [95,] 362.5360  7.860500 346.9982 378.3551
 [96,] 381.7009  8.075080 365.5864 397.5768
 [97,] 400.8659  8.993417 383.1343 418.5604
 [98,] 420.0308 10.431268 399.7464 440.3565
 [99,] 439.1958 12.206405 415.5605 463.1522
[100,] 458.3608 14.192832 430.9319 486.1728
[101,] 226.3580 13.233336 200.1351 251.6041
[102,] 237.9934 11.355577 215.3257 259.9181
[103,] 249.6288  9.757003 229.8657 268.5572
[104,] 261.2642  8.594832 244.0325 277.9144
[105,] 272.8995  8.060099 257.1389 288.3626
[106,] 284.5349  8.275343 268.4603 300.4402
[107,] 296.1703  9.188005 278.2200 314.1128
[108,] 307.8057 10.619775 287.3606 328.9899
[109,] 319.4411 12.392008 295.9922 344.8001
[110,] 331.0765 14.379364 303.4462 360.0434
[111,] 238.6307 13.506538 211.4088 264.1790
[112,] 255.6802 11.519529 232.7315 277.4937
[113,] 272.7297  9.805930 253.0418 291.7289
[114,] 289.7792  8.532097 273.0191 306.5189
[115,] 306.8286  7.913330 290.8397 322.0864
[116,] 323.8781  8.101150 307.4797 339.6633
[117,] 340.9276  9.045450 322.7077 358.8160
[118,] 357.9770 10.544924 336.4786 378.9285
[119,] 375.0265 12.399774 350.0451 399.1852
[120,] 392.0760 14.474013 363.3569 419.9429
[121,] 255.9000 11.998137 232.5484 280.2092
[122,] 263.3367 10.277399 243.1247 284.2138
[123,] 270.7733  8.837137 253.1913 288.3983
[124,] 278.2100  7.833613 262.6781 293.9529
[125,] 285.6466  7.445565 270.6049 300.3390
[126,] 293.0832  7.765811 277.4176 308.7418
[127,] 300.5199  8.716630 283.3642 318.5477
[128,] 307.9565 10.121852 288.1203 328.7450
[129,] 315.3932 11.820516 292.1637 339.4480
[130,] 322.8298 13.703931 295.8213 350.2067
[131,] 271.9482 12.612076 247.7350 297.1227
[132,] 285.9926 10.849259 265.2976 307.6865
[133,] 300.0370  9.358309 281.7822 318.7430
[134,] 314.0813  8.287279 298.1079 330.4304
[135,] 328.1257  7.810864 313.0044 343.4301
[136,] 342.1701  8.035529 326.4375 357.9571
[137,] 356.2144  8.908390 338.7616 373.3294
[138,] 370.2588 10.265409 349.8280 390.0833
[139,] 384.3032 11.942670 360.4054 407.1780
[140,] 398.3475 13.824097 370.7807 424.6853
[141,] 254.6708 12.232185 231.2072 278.8743
[142,] 266.0448 10.497992 246.0816 286.5161
[143,] 277.4189  9.058692 259.9121 294.9016
[144,] 288.7929  8.073571 273.3459 304.6676
[145,] 300.1669  7.718533 285.4452 315.1361
[146,] 311.5410  8.077099 295.9628 327.4167
[147,] 322.9150  9.064981 305.1821 340.6883
[148,] 334.2890 10.506132 313.7427 354.6720
[149,] 345.6630 12.241499 321.6046 369.7926
[150,] 357.0371 14.163346 329.3770 384.4979
[151,] 226.1925 14.000493 197.3678 252.4476
[152,] 241.4196 11.959467 216.8868 263.7504
[153,] 256.6467 10.173321 235.7399 275.6459
[154,] 271.8738  8.798672 253.8782 288.9138
[155,] 287.1009  8.049184 270.9894 303.0233
[156,] 302.3281  8.100287 286.3949 318.3698
[157,] 317.5552  8.938260 300.2478 335.1588
[158,] 332.7823 10.374146 312.8505 353.3461
[159,] 348.0094 12.198602 324.5920 372.3049
[160,] 363.2365 14.263289 336.0294 391.7620
[161,] 252.0601 12.308249 228.1004 276.3106
[162,] 261.5629 10.593145 240.8783 282.6192
[163,] 271.0657  9.161206 253.1012 289.3319
[164,] 280.5685  8.162841 264.7357 296.8006
[165,] 290.0714  7.767078 275.1041 305.4673
[166,] 299.5742  8.063146 284.1351 315.1936
[167,] 309.0770  8.982896 291.1412 326.5478
[168,] 318.5799 10.361553 297.9540 338.5927
[169,] 328.0827 12.042526 304.1726 351.3812
[170,] 337.5855 13.916693 310.4497 364.3166
[171,] 263.5065 12.375478 239.3277 288.2795
[172,] 275.3208 10.638703 254.7059 296.6371
[173,] 287.1351  9.186663 269.4664 305.1435
[174,] 298.9495  8.172565 283.0720 314.8079
[175,] 310.7638  7.769819 295.4075 325.8251
[176,] 322.5781  8.070477 306.3165 338.4728
[177,] 334.3924  9.004352 316.5989 352.3454
[178,] 346.2067 10.402277 325.6665 366.5436
[179,] 358.0210 12.104528 334.2547 381.2734
[180,] 369.8353 14.000539 342.4612 396.5348</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.01706058 13.219052  -29.2317202  23.0980831
  [2,]  -14.53900569 11.283539  -36.2814756   8.2227040
  [3,]  -42.10975081  9.622606  -61.0526017 -22.6612283
  [4,]    8.86280408  8.400726   -7.6918818  25.6028394
  [5,]   24.60825897  7.826315    9.1038684  39.8659916
  [6,]   62.77981385  8.039375   47.0444152  78.5939884
  [7,]   10.62686874  8.984056   -6.7246272  28.5683503
  [8,] -101.09497637 10.464050 -121.1910785 -80.2864747
  [9,]   19.67507852 12.287423   -4.1466375  44.1342236
 [10,]   35.77663340 14.323636    7.8588210  63.9536676
 [11,]   11.20367436 13.337030  -14.5778307  37.3625980
 [12,]   -8.03483842 11.441928  -30.1265176  14.2581675
 [13,]  -12.09325120  9.809549  -30.9269428   6.8800928
 [14,]  -12.13446398  8.590984  -28.3408923   4.6502887
 [15,]  -10.89577676  7.978154  -26.2739384   4.7114561
 [16,]   -4.42048954  8.109568  -20.1560536  11.8024977
 [17,]   -8.52240232  8.952510  -25.8734504   9.1755954
 [18,]   -6.19591510 10.334311  -26.2213510  13.8022117
 [19,]   -1.39782788 12.071318  -24.8251613  22.2027846
 [20,]    9.85025934 14.032237  -17.6443221  37.5781278
 [21,]  -14.02576038 13.207922  -39.8485639  12.9187813
 [22,]  -23.65547642 11.336932  -45.5479056  -0.7401299
 [23,]   11.42430754  9.736832   -7.7717916  30.8345354
 [24,]    5.03789150  8.560889  -11.6385964  21.3661194
 [25,]   -3.40432454  7.998423  -18.9843484  11.9072671
 [26,]  -17.16184058  8.177028  -33.0071258  -1.4246715
 [27,]   -7.10695662  9.052946  -24.6454555  10.2278168
 [28,]    8.31532734 10.452317  -11.9952352  28.6656748
 [29,]    8.66871129 12.196272  -14.8073607  32.7758611
 [30,]   -9.73650475 14.158045  -36.9327935  18.2550672
 [31,]   46.64714670 13.381940   20.1381304  73.0094514
 [32,]   19.75672976 11.451178   -2.7226854  42.2074610
 [33,]   -2.53498718  9.808439  -21.7728428  16.5975425
 [34,]   -7.00650412  8.619993  -23.7088904   9.6998910
 [35,]  -12.09022106  8.088629  -27.4050442   3.6488723
 [36,]   -6.05003800  8.340885  -22.1003015   9.9963694
 [37,]  -29.14395494  9.313304  -47.0622604 -11.6961948
 [38,]    3.12972812 10.813312  -17.9556683  24.1265236
 [39,]  -15.53008882 12.654669  -39.9823437   9.2625526
 [40,]   27.42109425 14.709737   -0.8238952  56.3590458
 [41,]   14.32028723 13.117691  -11.6761493  39.3231880
 [42,]    4.22496444 11.257757  -18.1195376  25.7467268
 [43,]   13.55814164  9.680792   -5.4161596  32.0139047
 [44,]   24.36541885  8.544926    7.3834178  40.7583807
 [45,]   13.03999606  8.039351   -2.6642136  28.6573473
 [46,]  -17.40602674  8.280334  -33.5512874  -1.1686475
 [47,]  -28.13714953  9.209456  -46.0593361 -10.3411458
 [48,]    9.11812768 10.648080  -11.3827303  29.5647528
 [49,]  -39.44009512 12.420406  -63.5439217 -15.2905882
 [50,]   30.90668209 14.403776    2.6863739  58.9319867
 [51,]  -25.41235203 12.192444  -49.7226018  -1.8069755
 [52,]  -27.67992111 10.511933  -48.5305572  -7.1449233
 [53,]   -7.74919019  9.125377  -25.4951037   9.6721531
 [54,]   18.83954073  8.183582    3.3220261  34.3437843
 [55,]   16.31487165  7.848329    1.2592127  31.1272626
 [56,]   -1.36919743  8.194403  -16.9869474  14.4426375
 [57,]  132.57633350  9.144777  114.9645000 150.1537426
 [58,]   15.02676442 10.537191   -5.1435856  35.6001272
 [59,]  -11.72280466 12.221480  -35.0868719  12.5106584
 [60,]  -98.37747374 14.093384 -125.8049173 -70.7639461
 [61,]   15.67783667 12.294175   -9.5075163  39.3674030
 [62,]   11.16278083 10.576643  -10.1860346  31.4463842
 [63,]  -11.85057501  9.148938  -30.1928186   5.9283672
 [64,]    0.96216915  8.164546  -15.6619268  16.3511703
 [65,]  -11.90418669  7.793306  -27.4966635   2.8139003
 [66,]   18.86365747  8.119759    2.7544769  34.4128068
 [67,]    2.49600163  9.068870  -15.3121750  20.0142958
 [68,]    9.08174579 10.472697  -11.4853178  29.3352093
 [69,]  -16.62581006 12.174950  -40.6809192   6.7892487
 [70,]    1.82933410 14.067712  -25.9409796  29.0398373
 [71,]   21.14566686 12.431695   -3.6906019  45.7249966
 [72,]   20.36391260 10.692516   -0.8920992  41.5857203
 [73,]  -23.98244167  9.245482  -42.1579200  -5.5712335
 [74,]  -24.18469594  8.245857  -40.1006253  -7.8315888
 [75,]  -11.34245021  7.866104  -26.7806297   4.1909756
 [76,]  -17.68550447  8.192875  -33.7911451  -1.7904940
 [77,]   -7.86175874  9.150793  -26.0125437  10.3834828
 [78,]    6.62648699 10.569627  -13.9596180  27.9886279
 [79,]   -0.65936728 12.290777  -24.9991627  24.4059811
 [80,]   29.38287845 14.204774    1.4586012  58.5709132
 [81,]   -9.49729473 13.437085  -36.4617792  15.7990373
 [82,]   23.15649757 11.447052    0.3946585  45.1255483
 [83,]    4.01488988  9.755345  -14.9306516  23.0334201
 [84,]   20.64118219  8.541109    4.1896224  37.3949777
 [85,]    1.60587449  8.024110  -14.0507023  17.3369090
 [86,]    5.10506680  8.335116  -11.0734733  21.5742596
 [87,]   -3.76394089  9.392230  -22.2930610  14.6901471
 [88,]  -13.59034858 10.982069  -34.9716131   7.7919655
 [89,]  -12.83235628 12.909287  -37.7380940  12.6498170
 [90,]  -11.02496397 15.044786  -39.9198279  19.0078608
 [91,]   26.49044820 13.063741    1.2026375  51.8784540
 [92,]    8.76469246 11.183028  -12.8371118  30.3330327
 [93,]  -32.59486328  9.576746  -51.4383339 -13.9907830
 [94,]    2.75118099  8.403760  -14.0557432  19.0474570
 [95,]    3.19642525  7.860500  -12.6227453  18.7342065
 [96,]   10.13756951  8.075080   -5.7382582  26.2520617
 [97,]    3.39421378  8.993417  -14.3002948  21.1257718
 [98,]   -3.33854196 10.431268  -23.6642451  16.9458591
 [99,]   16.66850230 12.206405   -7.2878923  40.3038478
[100,]    0.55594656 14.192832  -27.2560922  27.9848481
[101,]    9.74519664 13.233336  -15.5009368  35.9681209
[102,]   -7.67668805 11.355577  -29.6014215  14.9910396
[103,]  -10.70317274  9.757003  -29.6316148   9.0599091
[104,]   -6.34215743  8.594832  -22.9923748  10.8894992
[105,]  -22.18924213  8.060099  -37.6522942  -6.4285618
[106,]  -14.76052682  8.275343  -30.6658115   1.3141059
[107,]  -14.60551151  9.188005  -32.5479872   3.3448304
[108,]    0.29630380 10.619775  -20.8878717  20.7414069
[109,]   16.83951911 12.392008   -8.5195036  40.2884084
[110,]   20.56863441 14.379364   -8.3982788  48.1989314
[111,]   17.66605002 13.506538   -7.8821652  44.8880224
[112,]  -12.22591761 11.519529  -34.0393824  10.7227645
[113,]  -16.52508525  9.805930  -35.5242623   3.1627674
[114,]  -34.25205288  8.532097  -50.9917780 -17.4920103
[115,]  -37.91212052  7.913330  -53.1698524 -21.9231543
[116,]    5.84661185  8.101150   -9.9386439  22.2450194
[117,]   38.51694421  9.045450   20.6284986  56.7367626
[118,]    4.94137658 10.544924  -16.0100736  26.4397850
[119,]   19.46070894 12.399774   -4.6979740  44.4420902
[120,]   -3.02325869 14.474013  -30.8902030  25.6958178
[121,]   -5.37351756 11.998137  -29.6826845  17.9780996
[122,]   36.72093630 10.277399   15.8437550  56.9329139
[123,]   -0.87940985  8.837137  -18.5044464  16.7026255
[124,]    2.37914401  7.833613  -13.3637698  17.9110230
[125,]  -13.81920213  7.445565  -28.5115739   1.2225316
[126,]   11.55035173  7.765811   -4.1081869  27.2159763
[127,]  -12.77329442  8.716630  -30.8010891   4.3824434
[128,]  -41.36104056 10.121852  -62.1495000 -21.5248077
[129,]    6.14861330 11.820516  -17.9061959  29.3781483
[130,]   24.73566715 13.703931   -2.6411651  51.7442355
[131,]  -50.27114622 12.612076  -75.4456106 -26.0579252
[132,]   12.20128751 10.849259   -9.4926254  32.8963437
[133,]   26.84152124  9.358309    8.1355335  45.0963433
[134,]   32.77415498  8.287279   16.4251074  48.7475851
[135,]   20.61448871  7.810864    5.3100818  35.7358451
[136,]   10.65862244  8.035529   -5.1284235  26.3912419
[137,]   -1.78784382  8.908390  -18.9027580  15.6649664
[138,]   -9.82621009 10.265409  -29.6506857  10.6045656
[139,]   -8.66257636 11.942670  -31.5373768  15.2352152
[140,]   -9.80584262 13.824097  -36.1436415  17.7610152
[141,]   17.25269814 12.232185   -6.9507612  40.7162852
[142,]    2.39206788 10.497992  -18.0792200  22.3553126
[143,]  -20.17646238  9.058692  -37.6592409  -2.6696892
[144,]  -11.13629264  8.073571  -27.0109557   4.3107388
[145,]   14.65527710  7.718533   -0.3139459  29.3770044
[146,]    5.67254683  8.077099  -10.2032285  21.2506675
[147,]  -24.77968343  9.064981  -42.5529801  -7.0467703
[148,]   13.83388631 10.506132   -6.5491366  34.3801733
[149,]   -5.38304395 12.241499  -29.5125618  18.6754338
[150,]    9.47602579 14.163346  -17.9848181  37.1360765
[151,]   -0.92849040 14.000493  -27.1836012  27.8962088
[152,]   -6.89610473 11.959467  -29.2268852  17.6367379
[153,]  -17.74591907 10.173321  -36.7450825   3.1609436
[154,]  -31.40083341  8.798672  -48.4408397 -13.4052269
[155,]  -19.56364775  8.049184  -35.4860101  -3.4521382
[156,]   41.86563791  8.100287   25.8239285  57.7988190
[157,]  -36.40707643  8.938260  -54.0106803 -19.0997118
[158,]   14.80320923 10.374146   -5.7606335  34.7350103
[159,]   17.15359490 12.198602   -7.1418755  40.5709673
[160,]    8.99228056 14.263289  -19.5331845  36.1993561
[161,]   17.82033858 12.308249   -6.4301961  41.7799811
[162,]   10.87990959 10.593145  -10.1763997  31.5645103
[163,]    6.83318060  9.161206  -11.4329860  24.7976568
[164,]    1.22095162  8.162841  -15.0110636  17.0537603
[165,]  -10.90087737  7.767078  -26.2968426   4.0663690
[166,]  -15.06220636  8.063146  -30.6815533   0.3768576
[167,]  -49.81123535  8.982896  -67.2820380 -31.8753964
[168,]  -13.94926434 10.361553  -33.9621107   6.6766265
[169,]   22.69800667 12.042526   -0.6004969  46.6080696
[170,]   31.88367768 13.916693    5.1525779  59.0195301
[171,]    5.90517221 12.375478  -18.8677630  30.0839549
[172,]   -1.84683657 10.638703  -23.1630893  18.7681225
[173,]   10.46165464  9.186663   -7.5466572  28.1303989
[174,]   11.68214586  8.172565   -4.1763364  27.5596456
[175,]  -23.59116292  7.769819  -38.6525278  -8.2349156
[176,]    7.02952830  8.070477   -8.8652215  23.2911063
[177,]    0.08941952  9.004352  -17.8635877  17.8829382
[178,]   -2.98678927 10.402277  -23.3237100  17.5533718
[179,]   11.12070195 12.104528  -12.1317430  34.8870398
[180,]   -5.71170683 14.000539  -32.4112289  21.6624070</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.4
looic      1769.5 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   676       
 (0.5, 0.7]   (ok)         1    0.6%   105       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.6 22.1
p_loo        33.6  8.2
looic      1721.2 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   682       
 (0.5, 0.7]   (ok)         6    3.3%   511       
   (0.7, 1]   (bad)        3    1.7%   10        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.2      11.5  
fit_sleep1 -92.8      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.4
looic      1769.5 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   676       
 (0.5, 0.7]   (ok)         1    0.6%   105       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.6 22.1
p_loo        33.6  8.2
looic      1721.2 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   682       
 (0.5, 0.7]   (ok)         6    3.3%   511       
   (0.7, 1]   (bad)        3    1.7%   10        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.6     22.1        33.6    8.2   1721.2
fit_sleep2  -24.2      11.5  -884.8     14.4        19.3    3.4   1769.5
fit_sleep1  -92.8      20.8  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   44.3  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
4.929017e-41 3.185795e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.91      1.57      0.4     5.47       0.04      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.09      1.57    -3.21     3.01       5.32      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.3.5         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.0       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
