<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.91      6.79    15.74    42.35 1.00     1855     2585
sd(Days)                6.59      1.50     4.16    10.06 1.00     1573     2221
cor(Intercept,Days)     0.09      0.31    -0.48     0.71 1.00      880     1815

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.13      7.40   235.53   265.51 1.00     1898     2502
Days         10.42      1.70     7.04    13.77 1.00     1387     1872

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.51    23.22    29.05 1.00     3778     2880

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1625  13.17646 227.7460 279.0565
309 211.2867  13.46876 185.0212 237.4995
310 212.6864  13.12403 185.9935 237.9435
330 274.2115  13.14951 249.2372 301.0199
331 273.4173  12.92578 247.9267 299.2502
332 260.3988  12.48389 236.0706 285.2697
333 267.9823  12.54414 244.1280 293.2648
334 244.3609  12.09560 219.3632 266.9149
335 250.5498  13.45592 224.3365 276.6568
337 285.7413  13.31300 259.4282 313.4107
349 226.8625  12.63827 201.4376 250.8805
350 238.7697  13.07993 212.8643 264.0650
351 255.6557  12.40347 232.1121 280.6840
352 271.9705  12.41630 248.0056 296.5535
369 254.8460  12.28397 230.6261 279.6971
370 226.4771  13.45396 199.9035 252.3971
371 252.1136  12.69046 227.1782 277.0630
372 263.2971  12.24660 239.1379 288.2641

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5986525  2.536570 14.7554078 24.671130
309  1.8092334  2.521263 -3.1429619  6.723452
310  4.9826530  2.461630  0.3196227  9.765342
330  5.7515125  2.531550  0.6431534 10.547497
331  7.4582130  2.450149  2.5305181 12.103492
332 10.2170767  2.421171  5.3348735 15.036913
333 10.3131699  2.376388  5.4176663 14.879388
334 11.4705229  2.319934  7.0452510 15.988932
335 -0.2132096  2.576152 -5.4040361  4.660188
337 19.1726726  2.515735 14.2259212 24.126003
349 11.5371421  2.386436  6.9416986 16.336538
350 17.0014604  2.473789 12.3217584 22.047967
351  7.5114944  2.380732  2.8827027 12.176901
352 14.0972084  2.366189  9.4871680 18.639677
369 11.3380763  2.327141  6.8451187 15.911672
370 15.2000351  2.539772 10.2749907 20.162353
371  9.5313292  2.443868  4.5535214 14.200056
372 11.7953708  2.298842  7.2761031 16.302395</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1625 13.176456 227.7460 279.0565
  [2,] 273.7611 11.229063 251.5432 295.0098
  [3,] 293.3598  9.562067 274.3675 311.6243
  [4,] 312.9584  8.345223 296.3153 329.3624
  [5,] 332.5571  7.792352 316.9389 347.6763
  [6,] 352.1557  8.041587 336.4657 367.6764
  [7,] 371.7544  9.026730 354.3062 388.9692
  [8,] 391.3530 10.543480 370.8629 411.3855
  [9,] 410.9517 12.398244 386.9653 434.8673
 [10,] 430.5503 14.461546 402.7030 458.4860
 [11,] 211.2867 13.468765 185.0212 237.4995
 [12,] 213.0959 11.524773 190.5462 235.7428
 [13,] 214.9051  9.846152 195.0676 233.9386
 [14,] 216.7144  8.589909 199.4961 233.6250
 [15,] 218.5236  7.958638 202.7609 234.2869
 [16,] 220.3328  8.099805 204.2277 236.4317
 [17,] 222.1421  8.977043 204.3687 240.1201
 [18,] 223.9513 10.405830 203.4615 244.3834
 [19,] 225.7605 12.193803 201.7407 249.7815
 [20,] 227.5698 14.205981 199.4986 255.7364
 [21,] 212.6864 13.124029 185.9935 237.9435
 [22,] 217.6691 11.268567 194.5789 239.3697
 [23,] 222.6517  9.687120 202.8846 241.2337
 [24,] 227.6344  8.533420 210.8209 244.3554
 [25,] 232.6170  7.994839 216.8929 248.3036
 [26,] 237.5997  8.193588 221.8435 253.8241
 [27,] 242.5824  9.081386 225.2626 260.4902
 [28,] 247.5650 10.484632 227.6003 268.3051
 [29,] 252.5477 12.227129 229.2413 276.5532
 [30,] 257.5303 14.184397 230.0003 285.0681
 [31,] 274.2115 13.149505 249.2372 301.0199
 [32,] 279.9630 11.211071 258.3283 302.6678
 [33,] 285.7145  9.554278 267.2383 305.2316
 [34,] 291.4660  8.348524 275.2105 308.2643
 [35,] 297.2175  7.805700 281.9633 312.5980
 [36,] 302.9690  8.060865 287.2951 318.5944
 [37,] 308.7205  9.046747 290.7693 326.0991
 [38,] 314.4721 10.560644 293.6954 334.6987
 [39,] 320.2236 12.410812 296.0289 344.0334
 [40,] 325.9751 14.468822 297.5971 354.3215
 [41,] 273.4173 12.925777 247.9267 299.2502
 [42,] 280.8755 11.085831 258.9483 303.1718
 [43,] 288.3338  9.524813 269.5584 307.3996
 [44,] 295.7920  8.399698 279.5705 312.3561
 [45,] 303.2502  7.899004 288.1237 318.9303
 [46,] 310.7084  8.138799 294.7348 326.5282
 [47,] 318.1666  9.060480 300.5646 335.4303
 [48,] 325.6248 10.485752 305.2893 345.6730
 [49,] 333.0830 12.239942 309.5099 356.4239
 [50,] 340.5412 14.201683 313.0528 367.3375
 [51,] 260.3988 12.483888 236.0706 285.2697
 [52,] 270.6159 10.704088 249.9457 292.1302
 [53,] 280.8329  9.221263 262.9501 299.3895
 [54,] 291.0500  8.198171 275.2234 307.2136
 [55,] 301.2671  7.817447 285.8994 316.5385
 [56,] 311.4842  8.169399 295.1506 327.5054
 [57,] 321.7012  9.170050 303.7272 339.8475
 [58,] 331.9183 10.637890 311.3118 352.8488
 [59,] 342.1354 12.408212 317.9580 366.4299
 [60,] 352.3525 14.369652 324.5512 380.7271
 [61,] 267.9823 12.544143 244.1280 293.2648
 [62,] 278.2955 10.781669 257.7967 300.0881
 [63,] 288.6086  9.296649 270.6818 307.2051
 [64,] 298.9218  8.240475 282.6179 315.1272
 [65,] 309.2350  7.789584 293.4939 324.6441
 [66,] 319.5482  8.046380 303.4388 335.5612
 [67,] 329.8613  8.950156 312.2255 347.7786
 [68,] 340.1745 10.332512 319.7234 360.4342
 [69,] 350.4877 12.029578 326.6441 373.6248
 [70,] 360.8008 13.926778 333.0292 387.7550
 [71,] 244.3609 12.095595 219.3632 266.9149
 [72,] 255.8314 10.378094 234.3817 275.2752
 [73,] 267.3019  8.937027 248.6888 284.4172
 [74,] 278.7724  7.924660 262.4737 294.1487
 [75,] 290.2429  7.516263 275.2692 304.9047
 [76,] 301.7135  7.807200 286.5799 317.2461
 [77,] 313.1840  8.727814 296.3409 330.5031
 [78,] 324.6545 10.107486 305.0573 344.6352
 [79,] 336.1250 11.786094 313.0304 359.0561
 [80,] 347.5956 13.653825 321.0462 374.4061
 [81,] 250.5498 13.455921 224.3365 276.6568
 [82,] 250.3366 11.485398 227.7982 272.2945
 [83,] 250.1233  9.800001 230.7343 269.2452
 [84,] 249.9101  8.569643 232.9940 266.6074
 [85,] 249.6969  8.006914 234.3524 265.4615
 [86,] 249.4837  8.249586 233.5495 266.0403
 [87,] 249.2705  9.234380 231.0814 267.7901
 [88,] 249.0573 10.759415 228.2882 270.0100
 [89,] 248.8441 12.630493 224.2784 273.2486
 [90,] 248.6309 14.716209 219.7315 276.9646
 [91,] 285.7413 13.312996 259.4282 313.4107
 [92,] 304.9139 11.404528 282.6221 328.3746
 [93,] 324.0866  9.774891 305.4015 344.1347
 [94,] 343.2593  8.584379 326.7361 360.6502
 [95,] 362.4320  8.030722 346.8830 378.4583
 [96,] 381.6046  8.243255 365.6981 397.9691
 [97,] 400.7773  9.168853 382.9709 418.8408
 [98,] 419.9500 10.622726 399.5746 440.8991
 [99,] 439.1226 12.420732 415.3759 463.6804
[100,] 458.2953 14.434844 430.9019 487.2328
[101,] 226.8625 12.638266 201.4376 250.8805
[102,] 238.3997 10.861026 216.6915 259.0739
[103,] 249.9368  9.358854 231.3941 268.0410
[104,] 261.4739  8.282788 245.2021 277.4763
[105,] 273.0111  7.810963 257.8204 287.9715
[106,] 284.5482  8.050333 269.0708 300.5218
[107,] 296.0854  8.943978 278.7673 313.9253
[108,] 307.6225 10.323360 287.6284 327.7595
[109,] 319.1597 12.022435 296.0428 342.7158
[110,] 330.6968 13.924664 303.6379 358.1314
[111,] 238.7697 13.079934 212.8643 264.0650
[112,] 255.7712 11.219103 233.7072 277.6298
[113,] 272.7726  9.638004 253.8472 291.7776
[114,] 289.7741  8.494306 273.1164 306.5262
[115,] 306.7756  7.978385 291.2411 322.4003
[116,] 323.7770  8.209462 307.6377 340.0841
[117,] 340.7785  9.131000 322.6778 358.8441
[118,] 357.7799 10.563822 337.0313 378.2377
[119,] 374.7814 12.330967 350.8598 398.4804
[120,] 391.7829 14.309103 363.7855 419.0694
[121,] 255.6557 12.403468 232.1121 280.6840
[122,] 263.1672 10.664130 242.9013 284.8378
[123,] 270.6787  9.216131 252.8439 289.0837
[124,] 278.1902  8.215003 261.9339 294.4327
[125,] 285.7017  7.833979 270.1470 300.9383
[126,] 293.2132  8.160390 277.5355 309.2830
[127,] 300.7247  9.118579 282.8119 318.6268
[128,] 308.2362 10.537589 287.3432 328.9878
[129,] 315.7477 12.258419 291.1874 339.7534
[130,] 323.2592 14.171544 294.9807 351.3205
[131,] 271.9705 12.416298 248.0056 296.5535
[132,] 286.0677 10.703523 265.3461 307.4723
[133,] 300.1650  9.282460 282.0944 318.6544
[134,] 314.2622  8.304242 297.5573 330.5509
[135,] 328.3594  7.934387 312.3125 343.6596
[136,] 342.4566  8.255075 325.7553 358.6105
[137,] 356.5538  9.194331 338.2910 374.5234
[138,] 370.6510 10.588809 350.2094 391.2283
[139,] 384.7482 12.284452 361.1377 408.5552
[140,] 398.8454 14.173578 371.8983 426.0600
[141,] 254.8460 12.283968 230.6261 279.6971
[142,] 266.1841 10.592743 245.3833 287.5791
[143,] 277.5221  9.184103 259.5240 295.8895
[144,] 288.8602  8.204904 272.4617 305.0924
[145,] 300.1983  7.818205 284.6595 315.6548
[146,] 311.5364  8.109216 295.1678 327.1574
[147,] 322.8745  9.012525 305.0656 340.1974
[148,] 334.2125 10.369330 314.1516 353.9457
[149,] 345.5506 12.027119 321.9350 368.8863
[150,] 356.8887 13.878448 329.5411 383.9491
[151,] 226.4771 13.453957 199.9035 252.3971
[152,] 241.6771 11.527670 219.0572 263.9339
[153,] 256.8772  9.882626 237.8012 276.2032
[154,] 272.0772  8.680224 255.2665 289.3118
[155,] 287.2772  8.119554 271.4707 303.1494
[156,] 302.4773  8.331201 286.1278 318.6988
[157,] 317.6773  9.262373 299.2991 335.6129
[158,] 332.8773 10.727305 311.8783 353.8449
[159,] 348.0774 12.540314 323.1225 372.4208
[160,] 363.2774 14.572054 334.5009 391.3759
[161,] 252.1136 12.690459 227.1782 277.0630
[162,] 261.6450 10.883341 240.2510 282.8993
[163,] 271.1763  9.369709 252.7886 289.3459
[164,] 280.7076  8.311484 264.6521 296.9742
[165,] 290.2390  7.893988 274.5984 305.6398
[166,] 299.7703  8.215493 283.3848 316.0595
[167,] 309.3016  9.198835 291.3596 327.7848
[168,] 318.8329 10.662448 297.5441 339.8157
[169,] 328.3643 12.437925 303.7990 353.0595
[170,] 337.8956 14.410454 309.6507 366.2171
[171,] 263.2971 12.246600 239.1379 288.2641
[172,] 275.0925 10.552147 254.1872 296.4387
[173,] 286.8879  9.126103 269.0793 305.4871
[174,] 298.6832  8.111291 282.9072 315.3188
[175,] 310.4786  7.672658 295.5433 326.0012
[176,] 322.2740  7.906684 306.8320 338.1524
[177,] 334.0693  8.759622 316.7934 351.6822
[178,] 345.8647 10.075497 326.3524 365.7866
[179,] 357.6601 11.699131 335.0255 380.7130
[180,] 369.4555 13.520097 343.6633 395.8334</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.6024769 13.176456  -29.4965148  21.8140218
  [2,]  -15.0564294 11.229063  -36.3050531   7.1615337
  [3,]  -42.5591819  9.562067  -60.8237379 -23.5669106
  [4,]    8.4813656  8.345223   -7.9226323  25.1245052
  [5,]   24.2948131  7.792352    9.1755816  39.9129518
  [6,]   62.5343606  8.041587   47.0137440  78.2244267
  [7,]   10.4494081  9.026730   -6.7653680  27.8975506
  [8,] -101.2044443 10.543480 -121.2368565 -80.7142642
  [9,]   19.6336032 12.398244   -4.2820051  43.6199508
 [10,]   35.8031507 14.461546    7.8675450  63.6505275
 [11,]   11.4472171 13.468765  -14.7655613  37.7126835
 [12,]   -7.8301162 11.524773  -30.4769838  14.7196258
 [13,]  -11.9273496  9.846152  -30.9607729   7.9101571
 [14,]  -12.0073830  8.589909  -28.9179750   5.2108875
 [15,]  -10.8075163  7.958638  -26.5707982   4.9551968
 [16,]   -4.3710497  8.099805  -20.4699390  11.7340610
 [17,]   -8.5117831  8.977043  -26.4898426   9.2616206
 [18,]   -6.2241165 10.405830  -26.6561851  14.2656879
 [19,]   -1.4648498 12.193803  -25.4858202  22.5550210
 [20,]    9.7444168 14.205981  -18.4221673  37.8155575
 [21,]  -13.6325372 13.124029  -38.8895920  13.0603854
 [22,]  -23.3368902 11.268567  -45.0375112  -0.2467180
 [23,]   11.6682568  9.687120   -6.9137105  31.4353864
 [24,]    5.2072039  8.533420  -11.5138066  22.0207232
 [25,]   -3.3096491  7.994839  -18.9961762  12.4145498
 [26,]  -17.1418021  8.193588  -33.3661993  -1.3855623
 [27,]   -7.1615550  9.081386  -25.0693819  10.1582396
 [28,]    8.1860920 10.484632  -12.5540273  28.1507549
 [29,]    8.4648390 12.227129  -15.5406656  31.7712046
 [30,]  -10.0150139 14.184397  -37.5528396  17.5149506
 [31,]   47.3311351 13.149505   20.5227158  72.3053968
 [32,]   20.4372226 11.211071   -2.2676275  42.0718984
 [33,]   -1.8579899  9.554278  -21.3750982  16.6182403
 [34,]   -6.3330024  8.348524  -23.1312786   9.9224872
 [35,]  -11.4202149  7.805700  -26.8006903   3.8340390
 [36,]   -5.3835274  8.060865  -21.0089262  10.2903586
 [37,]  -28.4809399  9.046747  -45.8595242 -10.5296758
 [38,]    3.7892476 10.560644  -16.4374180  24.5658751
 [39,]  -14.8740649 12.410812  -38.6839027   9.3206035
 [40,]   28.0736226 14.468822   -0.2728048  56.4515623
 [41,]   14.1905727 12.925777  -11.6422827  39.6812078
 [42,]    4.1244597 11.085831  -18.1718435  26.0516926
 [43,]   13.4868467  9.524813   -5.5790271  32.2621758
 [44,]   24.3233337  8.399698    7.7592446  40.5448379
 [45,]   13.0271207  7.899004   -2.6530489  28.1535687
 [46,]  -17.3896923  8.138799  -33.2094760  -1.4160947
 [47,]  -28.0916054  9.060480  -45.3552805 -10.4896003
 [48,]    9.1928816 10.485752  -10.8553000  29.5283954
 [49,]  -39.3361314 12.239942  -62.6770052 -15.7630109
 [50,]   31.0398556 14.201683    4.2435899  58.5283056
 [51,]  -25.5381834 12.483888  -50.4090799  -1.2099863
 [52,]  -27.8040601 10.704088  -49.3184439  -7.1339322
 [53,]   -7.8716368  9.221263  -26.4281708  10.0112492
 [54,]   18.7187865  8.198171    2.5552029  34.5453789
 [55,]   16.1958099  7.817447    0.9244369  31.5635203
 [56,]   -1.4865668  8.169399  -17.5078404  14.8470473
 [57,]  132.4606565  9.170050  114.3143570 150.4346782
 [58,]   14.9127799 10.637890   -6.0176920  35.5192822
 [59,]  -11.8350968 12.408212  -36.1296404  12.3422638
 [60,]  -98.4880735 14.369652 -126.8627007 -70.6867831
 [61,]   15.8600911 12.544143   -9.4224421  39.7144197
 [62,]   11.2595212 10.781669  -10.5331226  31.7583199
 [63,]  -11.8393486  9.296649  -30.4357820   6.0875459
 [64,]    0.8878815  8.240475  -15.3175355  17.1918192
 [65,]  -12.0639884  7.789584  -27.4731250   3.6771231
 [66,]   18.6183418  8.046380    2.6053053  34.7277355
 [67,]    2.1651719  8.950156  -15.7521374  19.8009764
 [68,]    8.6654021 10.332512  -11.5942550  29.1165222
 [69,]  -17.1276678 12.029578  -40.2647669   6.7158620
 [70,]    1.2419624 13.926778  -25.7122434  29.0135551
 [71,]   21.1122462 12.095595   -1.4418237  46.1099113
 [72,]   20.3698233 10.378094    0.9260400  41.8195196
 [73,]  -23.9371996  8.937027  -41.0525042  -5.3241463
 [74,]  -24.1001226  7.924660  -39.4763674  -7.8014400
 [75,]  -11.2185455  7.516263  -25.8802835   3.7552262
 [76,]  -17.5222685  7.807200  -33.0549432  -2.3886574
 [77,]   -7.6591914  8.727814  -24.9782728   9.1839389
 [78,]    6.8683857 10.107486  -13.1123162  26.4655689
 [79,]   -0.3781373 11.786094  -23.3092458  22.7164849
 [80,]   29.7034398 13.653825    2.8928635  56.2528307
 [81,]   -8.9414638 13.455921  -35.0485473  17.2717732
 [82,]   23.6106458 11.485398    1.6526834  46.1490110
 [83,]    4.3673554  9.800001  -14.7544665  23.7563538
 [84,]   20.8919650  8.569643    4.1947340  37.8080707
 [85,]    1.7549746  8.006914  -14.0096231  17.0994668
 [86,]    5.1524842  8.249586  -11.4040679  21.0867017
 [87,]   -3.8182062  9.234380  -22.3377522  14.3709113
 [88,]  -13.7462966 10.759415  -34.6990330   7.0227625
 [89,]  -13.0899870 12.630493  -37.4945232  11.4756822
 [90,]  -11.3842774 14.716209  -39.7179765  17.5150846
 [91,]   26.6253355 13.312996   -1.0441245  52.9384325
 [92,]    8.8918629 11.404528  -14.5687815  31.1836638
 [93,]  -32.4754097  9.774891  -52.5235097 -13.7902510
 [94,]    2.8629177  8.584379  -14.5280182  19.3861031
 [95,]    3.3004451  8.030722  -12.7259446  18.8493890
 [96,]   10.2338725  8.243255   -6.1306054  26.1403545
 [97,]    3.4827999  9.168853  -14.5806838  21.2891666
 [98,]   -3.2576727 10.622726  -24.2068337  17.1177288
 [99,]   16.7416548 12.420732   -7.8161439  40.4884493
[100,]    0.6213822 14.434844  -28.3161082  28.0147663
[101,]    9.2406856 12.638266  -14.7773180  34.6656153
[102,]   -8.0829565 10.861026  -28.7571713  13.6252356
[103,]  -11.0111986  9.358854  -29.1154351   7.5314631
[104,]   -6.5519406  8.282788  -22.5543447   9.7199057
[105,]  -22.3007827  7.810963  -37.2611616  -7.1101425
[106,]  -14.7738247  8.050333  -30.7474343   0.7036176
[107,]  -14.5205668  8.943978  -32.3605377   2.7974702
[108,]    0.4794912 10.323360  -19.6575187  20.4736037
[109,]   17.1209491 12.022435   -6.4351759  40.2378419
[110,]   20.9483071 13.924664   -6.4862766  48.0072012
[111,]   17.5270856 13.079934   -7.7681934  43.4324540
[112,]  -12.3168748 11.219103  -34.1754912   9.7471074
[113,]  -16.5680351  9.638004  -35.5730153   2.3573600
[114,]  -34.2469955  8.494306  -50.9990648 -17.5892562
[115,]  -37.8590559  7.978385  -53.4838310 -22.3246425
[116,]    5.9476838  8.209462  -10.3593796  22.0870147
[117,]   38.6660234  9.131000   20.6004364  56.7667399
[118,]    5.1384630 10.563822  -15.3192792  25.8871054
[119,]   19.7058027 12.330967   -3.9931667  43.6273554
[120,]   -2.7301577 14.309103  -30.0167329  25.2671743
[121,]   -5.1292284 12.403468  -30.1574768  18.4144120
[122,]   36.8903772 10.664130   15.2197883  57.1563018
[123,]   -0.7848172  9.216131  -19.1897534  17.0499612
[124,]    2.3988883  8.215003  -13.8436064  18.6552005
[125,]  -13.8743061  7.833979  -29.1108867   1.6803556
[126,]   11.4203995  8.160390   -4.6494242  27.0981159
[127,]  -12.9780949  9.118579  -30.8802493   4.9347012
[128,]  -41.6406894 10.537589  -62.3923478 -20.7477079
[129,]    5.7941162 12.258419  -18.2115525  30.3543930
[130,]   24.3063218 14.171544   -3.7549713  52.5847678
[131,]  -50.2934406 12.416298  -74.8764090 -26.3285219
[132,]   12.1261510 10.703523   -9.2783715  32.8477541
[133,]   26.7135426  9.282460    8.2240727  44.7841355
[134,]   32.5933342  8.304242   16.3046474  49.2981891
[135,]   20.3808258  7.934387    5.0805937  36.4276841
[136,]   10.3721174  8.255075   -5.7817741  27.0734368
[137,]   -2.1271911  9.194331  -20.0968261  16.1356102
[138,]  -10.2183995 10.588809  -30.7956584  10.2231954
[139,]   -9.1076079 12.284452  -32.9146345  14.5029326
[140,]  -10.3037163 14.173578  -37.5182823  16.6433815
[141,]   17.0775057 12.283968   -7.7735873  41.2974052
[142,]    2.2528294 10.592743  -19.1422387  23.0536493
[143,]  -20.2797470  9.184103  -38.6470953  -2.2815685
[144,]  -11.2036233  8.204904  -27.4357719   5.1948792
[145,]   14.6239004  7.818205   -0.8326346  30.1627245
[146,]    5.6771241  8.109216   -9.9438660  22.0457488
[147,]  -24.7391523  9.012525  -42.0620678  -6.9302776
[148,]   13.9103714 10.369330   -5.8227793  33.9713448
[149,]   -5.2706049 12.027119  -28.6062634  18.3450348
[150,]    9.6244187 13.878448  -17.4360320  36.9720471
[151,]   -1.2131008 13.453957  -27.1330518  25.3605438
[152,]   -7.1536358 11.527670  -29.4103979  15.4663392
[153,]  -17.9763709  9.882626  -37.3023614   1.0995532
[154,]  -31.6042060  8.680224  -48.8388150 -14.7934977
[155,]  -19.7399411  8.119554  -35.6120971  -3.9333798
[156,]   41.7164239  8.331201   25.4949356  58.0658926
[157,]  -36.5292112  9.262373  -54.4647626 -18.1510312
[158,]   14.7081537 10.727305   -6.2594238  35.7072316
[159,]   17.0856186 12.540314   -7.2578374  42.0404593
[160,]    8.9513836 14.572054  -19.1470751  37.7279263
[161,]   17.7667610 12.690459   -7.1825802  42.7021642
[162,]   10.7978318 10.883341  -10.4564789  32.1917503
[163,]    6.7226027  9.369709  -11.4470090  25.1103432
[164,]    1.0818735  8.311484  -15.1846627  17.1373510
[165,]  -11.0684556  7.893988  -26.4692503   4.5720961
[166,]  -15.2582848  8.215493  -31.5475337   1.1272129
[167,]  -50.0358139  9.198835  -68.5190419 -32.0937701
[168,]  -14.2023431 10.662448  -35.1850667   7.0865343
[169,]   22.4164277 12.437925   -2.2787843  46.9816929
[170,]   31.5735986 14.410454    3.2520693  59.8185200
[171,]    6.1145791 12.246600  -18.8523547  30.2737640
[172,]   -1.6184917 10.552147  -22.9647079  19.2868230
[173,]   10.7089376  9.126103   -7.8902605  28.5174541
[174,]   11.9483668  8.111291   -4.6872266  27.7244290
[175,]  -23.3060039  7.672658  -38.8286013  -8.3706968
[176,]    7.3336253  7.906684   -8.5447533  22.7756089
[177,]    0.4124546  8.759622  -17.2003626  17.6884407
[178,]   -2.6448162 10.075497  -22.5667440  16.8674976
[179,]   11.4816131 11.699131  -11.5712515  34.1162140
[180,]   -5.3318577 13.520097  -31.7097589  20.4602952</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.5
p_loo        19.4  3.5
looic      1770.1 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   549       
 (0.5, 0.7]   (ok)         2    1.1%   95        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.4
p_loo        34.1  8.6
looic      1722.0 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   582       
 (0.5, 0.7]   (ok)         7    3.9%   97        
   (0.7, 1]   (bad)        2    1.1%   15        
   (1, Inf)   (very bad)   1    0.6%   19        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.1      11.5  
fit_sleep1 -92.3      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.5
p_loo        19.4  3.5
looic      1770.1 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   549       
 (0.5, 0.7]   (ok)         2    1.1%   95        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.4
p_loo        34.1  8.6
looic      1722.0 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   582       
 (0.5, 0.7]   (ok)         7    3.9%   97        
   (0.7, 1]   (bad)        2    1.1%   15        
   (1, Inf)   (very bad)   1    0.6%   19        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.4        34.1    8.6   1722.0
fit_sleep2  -24.1      11.5  -885.0     14.5        19.4    3.5   1770.1
fit_sleep1  -92.3      21.0  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.7  
fit_sleep2   28.9  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.024158e-41 3.573841e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.96      1.58     0.29     5.48       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.04      1.58    -3.27     2.93        5.5      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_5.0.0           compiler_4.2.2      
 [22] cli_3.6.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.19      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.1   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.12       yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.19        V8_4.2.2            
 [88] RcppParallel_5.1.6   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.8         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
