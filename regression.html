<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Isaac T. Petersen">
<meta name="dcterms.date" content="today">
<title>Regression – Data Analysis Guides for the Developmental Psychopathology Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d640c705e8c17715bca3574aa719063f.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9278de052701f0b3f1191ef96b26c196.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TYR0QMREEW', { 'anonymize_ip': true});
</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="includes/custom.css">
<link rel="stylesheet" href="font/css/roboto.css">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/labLogo.png" alt="" class="navbar-logo light-content"><img src="./images/labLogo.png" alt="" class="navbar-logo dark-content"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Data Analysis Guides for the Developmental Psychopathology Lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-datasets" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Datasets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-datasets">
<li>
    <a class="dropdown-item" href="./abcdData.html">
 <span class="dropdown-text">ABCD Study Data</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analysis-techniques" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analysis Techniques</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analysis-techniques">
<li>
    <a class="dropdown-item" href="./bayesian.html">
 <span class="dropdown-text">Bayesian Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dataManagement.html">
 <span class="dropdown-text">Data Management</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dags.html">
 <span class="dropdown-text">Directed Acyclic Graphs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eegERP.html">
 <span class="dropdown-text">Electroencephalography/Event-Related Potentials</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eda.html">
 <span class="dropdown-text">Exploratory Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./factorAnalysis.html">
 <span class="dropdown-text">Factor Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./figures.html">
 <span class="dropdown-text">Figures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./hlm.html">
 <span class="dropdown-text">Hierarchical Linear Modeling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./irt.html">
 <span class="dropdown-text">Item Response Theory</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lda.html">
 <span class="dropdown-text">Longitudinal Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sem.html#mediation">
 <span class="dropdown-text">Mediation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regression.html#moderation">
 <span class="dropdown-text">Moderation/Interaction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./multipleImputation.html">
 <span class="dropdown-text">Multiple Imputation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./pca.html">
 <span class="dropdown-text">Principal Component Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regression.html">
 <span class="dropdown-text">Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./statistics.html">
 <span class="dropdown-text">Statistics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sem.html">
 <span class="dropdown-text">Structural Equation Modeling</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-softwareframeworks" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Software/Frameworks</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-softwareframeworks">
<li>
    <a class="dropdown-item" href="./git.html">
 <span class="dropdown-text">Git, GitLab, and GitHub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./hpc.html">
 <span class="dropdown-text">High-Performance Computing Cluster</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jamovi.html">
 <span class="dropdown-text">jamovi</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jatos.html">
 <span class="dropdown-text">JATOS (Just Another Tool for Online Studies)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jsPsych.html">
 <span class="dropdown-text">jsPsych</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lamp.html">
 <span class="dropdown-text">LAMP (Linux, Apache, MySQL, PHP) Server</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./markdown.html">
 <span class="dropdown-text">Markdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mplus.html">
 <span class="dropdown-text">Mplus</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./osf.html">
 <span class="dropdown-text">Open Science Framework</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://devpsylab.github.io/pythonDataAnalysisGuides">
 <span class="dropdown-text">Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./R.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SPSS.html">
 <span class="dropdown-text">SPSS</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="https://devpsylab.github.io/LabWiki"> 
<span class="menu-text">Lab Wiki</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://developmental-psychopathology.lab.uiowa.edu"> 
<span class="menu-text">Lab Website</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/DevPsyLab/DataAnalysis">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/DevPsyLab/DataAnalysis/issues/new">
            Report a Bug
            </a>
          </li>
      </ul>
</div>
    <a href="https://twitter.com/devpsylab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://www.facebook.com/DevPsyLab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-facebook"></i></a>
    <a href="https://www.instagram.com/devpsylab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-instagram"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./regression.html">Regression</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abcdData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ABCD Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataManagement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Management</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dags.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Directed Acyclic Graphs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eegERP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Electroencephalography/Event-Related Potentials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factorAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Factor Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./figures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Git, GitLab, and GitHub</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hlm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hierarchical Linear Modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">High-Performance Computing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./irt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Item Response Theory</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jamovi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">jamovi</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jatos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JATOS (Just Another Tool for Online Studies)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jsPsych.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">jsPsych</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lamp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LAMP (Linux, Apache, MySQL, PHP) Server</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Longitudinal Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markdown</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html#mediation" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mediation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html#moderation" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Moderation/Interaction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mplus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multipleImputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Imputation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./osf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Open Science Framework</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principal Component Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://devpsylab.github.io/pythonDataAnalysisGuides" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SPSS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SPSS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structural Equation Modeling</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li>
<a href="#preamble" id="toc-preamble" class="nav-link active" data-scroll-target="#preamble"><span class="header-section-number">1</span> Preamble</a>
  <ul>
<li><a href="#install-libraries" id="toc-install-libraries" class="nav-link" data-scroll-target="#install-libraries"><span class="header-section-number">1.1</span> Install Libraries</a></li>
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries"><span class="header-section-number">1.2</span> Load Libraries</a></li>
  </ul>
</li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">2</span> Import Data</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">3</span> Data Preparation</a></li>
  <li><a href="#overview-of-multiple-regression" id="toc-overview-of-multiple-regression" class="nav-link" data-scroll-target="#overview-of-multiple-regression"><span class="header-section-number">4</span> Overview of Multiple Regression</a></li>
  <li>
<a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression"><span class="header-section-number">5</span> Linear Regression</a>
  <ul>
<li>
<a href="#linear-regression-model" id="toc-linear-regression-model" class="nav-link" data-scroll-target="#linear-regression-model"><span class="header-section-number">5.1</span> Linear regression model</a>
  <ul>
<li><a href="#remove-missing-data" id="toc-remove-missing-data" class="nav-link" data-scroll-target="#remove-missing-data"><span class="header-section-number">5.1.1</span> Remove missing data</a></li>
  </ul>
</li>
  <li><a href="#linear-regression-model-on-correlationcovariance-matrix-for-pairwise-deletion" id="toc-linear-regression-model-on-correlationcovariance-matrix-for-pairwise-deletion" class="nav-link" data-scroll-target="#linear-regression-model-on-correlationcovariance-matrix-for-pairwise-deletion"><span class="header-section-number">5.2</span> Linear regression model on correlation/covariance matrix (for pairwise deletion)</a></li>
  <li><a href="#linear-regression-model-with-robust-covariance-matrix-rms" id="toc-linear-regression-model-with-robust-covariance-matrix-rms" class="nav-link" data-scroll-target="#linear-regression-model-with-robust-covariance-matrix-rms"><span class="header-section-number">5.3</span> Linear regression model with robust covariance matrix (rms)</a></li>
  <li><a href="#robust-linear-regression-mm-type-iteratively-reweighted-least-squares-regression" id="toc-robust-linear-regression-mm-type-iteratively-reweighted-least-squares-regression" class="nav-link" data-scroll-target="#robust-linear-regression-mm-type-iteratively-reweighted-least-squares-regression"><span class="header-section-number">5.4</span> Robust linear regression (MM-type iteratively reweighted least squares regression)</a></li>
  <li><a href="#least-trimmed-squares-regression-for-removing-outliers" id="toc-least-trimmed-squares-regression-for-removing-outliers" class="nav-link" data-scroll-target="#least-trimmed-squares-regression-for-removing-outliers"><span class="header-section-number">5.5</span> Least trimmed squares regression (for removing outliers)</a></li>
  <li><a href="#bayesian-linear-regression" id="toc-bayesian-linear-regression" class="nav-link" data-scroll-target="#bayesian-linear-regression"><span class="header-section-number">5.6</span> Bayesian linear regression</a></li>
  </ul>
</li>
  <li>
<a href="#generalized-linear-regression" id="toc-generalized-linear-regression" class="nav-link" data-scroll-target="#generalized-linear-regression"><span class="header-section-number">6</span> Generalized Linear Regression</a>
  <ul>
<li><a href="#generalized-regression-model" id="toc-generalized-regression-model" class="nav-link" data-scroll-target="#generalized-regression-model"><span class="header-section-number">6.1</span> Generalized regression model</a></li>
  <li><a href="#generalized-regression-model-rms" id="toc-generalized-regression-model-rms" class="nav-link" data-scroll-target="#generalized-regression-model-rms"><span class="header-section-number">6.2</span> Generalized regression model (rms)</a></li>
  <li><a href="#bayesian-generalized-linear-model" id="toc-bayesian-generalized-linear-model" class="nav-link" data-scroll-target="#bayesian-generalized-linear-model"><span class="header-section-number">6.3</span> Bayesian generalized linear model</a></li>
  <li><a href="#robust-generalized-regression" id="toc-robust-generalized-regression" class="nav-link" data-scroll-target="#robust-generalized-regression"><span class="header-section-number">6.4</span> Robust generalized regression</a></li>
  <li><a href="#ordinal-regression-model" id="toc-ordinal-regression-model" class="nav-link" data-scroll-target="#ordinal-regression-model"><span class="header-section-number">6.5</span> Ordinal regression model</a></li>
  <li><a href="#bayesian-ordinal-regression-model" id="toc-bayesian-ordinal-regression-model" class="nav-link" data-scroll-target="#bayesian-ordinal-regression-model"><span class="header-section-number">6.6</span> Bayesian ordinal regression model</a></li>
  <li><a href="#bayesian-count-regression-model" id="toc-bayesian-count-regression-model" class="nav-link" data-scroll-target="#bayesian-count-regression-model"><span class="header-section-number">6.7</span> Bayesian count regression model</a></li>
  <li><a href="#logistic-regression-model-rms" id="toc-logistic-regression-model-rms" class="nav-link" data-scroll-target="#logistic-regression-model-rms"><span class="header-section-number">6.8</span> Logistic regression model (rms)</a></li>
  <li><a href="#bayesian-logistic-regression-model" id="toc-bayesian-logistic-regression-model" class="nav-link" data-scroll-target="#bayesian-logistic-regression-model"><span class="header-section-number">6.9</span> Bayesian logistic regression model</a></li>
  </ul>
</li>
  <li><a href="#hierarchical-linear-regression" id="toc-hierarchical-linear-regression" class="nav-link" data-scroll-target="#hierarchical-linear-regression"><span class="header-section-number">7</span> Hierarchical Linear Regression</a></li>
  <li>
<a href="#sec-moderation" id="toc-sec-moderation" class="nav-link" data-scroll-target="#sec-moderation"><span class="header-section-number">8</span> Moderated Multiple Regression</a>
  <ul>
<li><a href="#mean-center-predictors" id="toc-mean-center-predictors" class="nav-link" data-scroll-target="#mean-center-predictors"><span class="header-section-number">8.1</span> Mean Center Predictors</a></li>
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model"><span class="header-section-number">8.2</span> Model</a></li>
  <li><a href="#plots" id="toc-plots" class="nav-link" data-scroll-target="#plots"><span class="header-section-number">8.3</span> Plots</a></li>
  <li><a href="#simple-slopes-analysis" id="toc-simple-slopes-analysis" class="nav-link" data-scroll-target="#simple-slopes-analysis"><span class="header-section-number">8.4</span> Simple Slopes Analysis</a></li>
  <li><a href="#johnson-neyman-intervals" id="toc-johnson-neyman-intervals" class="nav-link" data-scroll-target="#johnson-neyman-intervals"><span class="header-section-number">8.5</span> Johnson-Neyman intervals</a></li>
  </ul>
</li>
  <li><a href="#sec-compareCorrelations" id="toc-sec-compareCorrelations" class="nav-link" data-scroll-target="#sec-compareCorrelations"><span class="header-section-number">9</span> Comparing Correlations</a></li>
  <li>
<a href="#sec-missingness" id="toc-sec-missingness" class="nav-link" data-scroll-target="#sec-missingness"><span class="header-section-number">10</span> Approaches to Handling Missingness</a>
  <ul>
<li><a href="#sec-listwiseDeletion" id="toc-sec-listwiseDeletion" class="nav-link" data-scroll-target="#sec-listwiseDeletion"><span class="header-section-number">10.1</span> Listwise deletion</a></li>
  <li><a href="#sec-pairwiseDeletion" id="toc-sec-pairwiseDeletion" class="nav-link" data-scroll-target="#sec-pairwiseDeletion"><span class="header-section-number">10.2</span> Pairwise deletion</a></li>
  <li><a href="#sec-fiml" id="toc-sec-fiml" class="nav-link" data-scroll-target="#sec-fiml"><span class="header-section-number">10.3</span> Full-information maximum likelihood (FIML)</a></li>
  <li><a href="#sec-imputation" id="toc-sec-imputation" class="nav-link" data-scroll-target="#sec-imputation"><span class="header-section-number">10.4</span> Multiple imputation</a></li>
  </ul>
</li>
  <li><a href="#sec-squaredSemiPartialCorrelation" id="toc-sec-squaredSemiPartialCorrelation" class="nav-link" data-scroll-target="#sec-squaredSemiPartialCorrelation"><span class="header-section-number">11</span> Squared Semi-Partial Correlation (<span class="math inline">\(sr^2\)</span>)</a></li>
  <li><a href="#sec-partialRegressionPlot" id="toc-sec-partialRegressionPlot" class="nav-link" data-scroll-target="#sec-partialRegressionPlot"><span class="header-section-number">12</span> Partial Regression Plot</a></li>
  <li><a href="#sec-dominanceAnalysis" id="toc-sec-dominanceAnalysis" class="nav-link" data-scroll-target="#sec-dominanceAnalysis"><span class="header-section-number">13</span> Dominance Analysis</a></li>
  <li><a href="#sec-commonalityAnalysis" id="toc-sec-commonalityAnalysis" class="nav-link" data-scroll-target="#sec-commonalityAnalysis"><span class="header-section-number">14</span> Commonality Analysis</a></li>
  <li><a href="#model-building-steps" id="toc-model-building-steps" class="nav-link" data-scroll-target="#model-building-steps"><span class="header-section-number">15</span> Model Building Steps</a></li>
  <li>
<a href="#bootstrapped-estimates" id="toc-bootstrapped-estimates" class="nav-link" data-scroll-target="#bootstrapped-estimates"><span class="header-section-number">16</span> Bootstrapped Estimates</a>
  <ul>
<li><a href="#linear-regression-1" id="toc-linear-regression-1" class="nav-link" data-scroll-target="#linear-regression-1"><span class="header-section-number">16.1</span> Linear Regression</a></li>
  <li><a href="#generalized-regression" id="toc-generalized-regression" class="nav-link" data-scroll-target="#generalized-regression"><span class="header-section-number">16.2</span> Generalized Regression</a></li>
  </ul>
</li>
  <li>
<a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation"><span class="header-section-number">17</span> Cross Validation</a>
  <ul>
<li><a href="#k-fold-cross-validation" id="toc-k-fold-cross-validation" class="nav-link" data-scroll-target="#k-fold-cross-validation"><span class="header-section-number">17.1</span> K-fold cross validation</a></li>
  </ul>
</li>
  <li>
<a href="#examining-model-fits" id="toc-examining-model-fits" class="nav-link" data-scroll-target="#examining-model-fits"><span class="header-section-number">18</span> Examining Model Fits</a>
  <ul>
<li><a href="#effect-plots" id="toc-effect-plots" class="nav-link" data-scroll-target="#effect-plots"><span class="header-section-number">18.1</span> Effect Plots</a></li>
  <li><a href="#confidence-ellipses" id="toc-confidence-ellipses" class="nav-link" data-scroll-target="#confidence-ellipses"><span class="header-section-number">18.2</span> Confidence Ellipses</a></li>
  <li><a href="#data-ellipse" id="toc-data-ellipse" class="nav-link" data-scroll-target="#data-ellipse"><span class="header-section-number">18.3</span> Data Ellipse</a></li>
  </ul>
</li>
  <li>
<a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics"><span class="header-section-number">19</span> Diagnostics</a>
  <ul>
<li>
<a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions"><span class="header-section-number">19.1</span> Assumptions</a>
  <ul>
<li>
<a href="#sec-linearAssociation" id="toc-sec-linearAssociation" class="nav-link" data-scroll-target="#sec-linearAssociation"><span class="header-section-number">19.1.1</span> 1. Linear relation between predictors and outcome</a>
  <ul class="collapse">
<li>
<a href="#ways-to-test" id="toc-ways-to-test" class="nav-link" data-scroll-target="#ways-to-test"><span class="header-section-number">19.1.1.1</span> Ways to Test</a>
  <ul class="collapse">
<li><a href="#before-model-fitting" id="toc-before-model-fitting" class="nav-link" data-scroll-target="#before-model-fitting"><span class="header-section-number">19.1.1.1.1</span> Before Model Fitting</a></li>
  <li><a href="#after-model-fitting" id="toc-after-model-fitting" class="nav-link" data-scroll-target="#after-model-fitting"><span class="header-section-number">19.1.1.1.2</span> After Model Fitting</a></li>
  </ul>
</li>
  <li>
<a href="#ways-to-handle" id="toc-ways-to-handle" class="nav-link" data-scroll-target="#ways-to-handle"><span class="header-section-number">19.1.1.2</span> Ways to Handle</a>
  <ul class="collapse">
<li><a href="#semi-parametric-or-non-parametric-regression-models" id="toc-semi-parametric-or-non-parametric-regression-models" class="nav-link" data-scroll-target="#semi-parametric-or-non-parametric-regression-models"><span class="header-section-number">19.1.1.2.1</span> Semi-parametric or non-parametric regression models</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#exogeneity" id="toc-exogeneity" class="nav-link" data-scroll-target="#exogeneity"><span class="header-section-number">19.1.2</span> 2. Exogeneity</a>
  <ul class="collapse">
<li>
<a href="#ways-to-test-1" id="toc-ways-to-test-1" class="nav-link" data-scroll-target="#ways-to-test-1"><span class="header-section-number">19.1.2.1</span> Ways to Test</a>
  <ul class="collapse">
<li><a href="#durbin-wu-hausman-test-of-endogeneity" id="toc-durbin-wu-hausman-test-of-endogeneity" class="nav-link" data-scroll-target="#durbin-wu-hausman-test-of-endogeneity"><span class="header-section-number">19.1.2.1.1</span> Durbin-Wu-Hausman test of endogeneity</a></li>
  </ul>
</li>
  <li><a href="#ways-to-handle-1" id="toc-ways-to-handle-1" class="nav-link" data-scroll-target="#ways-to-handle-1"><span class="header-section-number">19.1.2.2</span> Ways to Handle</a></li>
  </ul>
</li>
  <li>
<a href="#homoscedasticity-of-residuals" id="toc-homoscedasticity-of-residuals" class="nav-link" data-scroll-target="#homoscedasticity-of-residuals"><span class="header-section-number">19.1.3</span> 3. Homoscedasticity of residuals</a>
  <ul class="collapse">
<li>
<a href="#ways-to-test-2" id="toc-ways-to-test-2" class="nav-link" data-scroll-target="#ways-to-test-2"><span class="header-section-number">19.1.3.1</span> Ways to Test</a>
  <ul class="collapse">
<li><a href="#residuals-vs.-outcome-and-predictor-variables" id="toc-residuals-vs.-outcome-and-predictor-variables" class="nav-link" data-scroll-target="#residuals-vs.-outcome-and-predictor-variables"><span class="header-section-number">19.1.3.1.1</span> Residuals vs.&nbsp;outcome and predictor variables</a></li>
  <li><a href="#spread-level-plot" id="toc-spread-level-plot" class="nav-link" data-scroll-target="#spread-level-plot"><span class="header-section-number">19.1.3.1.2</span> Spread-level plot</a></li>
  <li><a href="#breusch-pagan-test" id="toc-breusch-pagan-test" class="nav-link" data-scroll-target="#breusch-pagan-test"><span class="header-section-number">19.1.3.1.3</span> Breusch-Pagan test</a></li>
  <li><a href="#goldfeld-quandt-test" id="toc-goldfeld-quandt-test" class="nav-link" data-scroll-target="#goldfeld-quandt-test"><span class="header-section-number">19.1.3.1.4</span> Goldfeld-Quandt Test</a></li>
  <li><a href="#test-of-dependence-of-spread-on-level" id="toc-test-of-dependence-of-spread-on-level" class="nav-link" data-scroll-target="#test-of-dependence-of-spread-on-level"><span class="header-section-number">19.1.3.1.5</span> Test of dependence of spread on level</a></li>
  <li><a href="#test-of-dependence-of-spread-on-predictors" id="toc-test-of-dependence-of-spread-on-predictors" class="nav-link" data-scroll-target="#test-of-dependence-of-spread-on-predictors"><span class="header-section-number">19.1.3.1.6</span> Test of dependence of spread on predictors</a></li>
  </ul>
</li>
  <li>
<a href="#ways-to-handle-2" id="toc-ways-to-handle-2" class="nav-link" data-scroll-target="#ways-to-handle-2"><span class="header-section-number">19.1.3.2</span> Ways to Handle</a>
  <ul class="collapse">
<li><a href="#huber-white-standard-errors" id="toc-huber-white-standard-errors" class="nav-link" data-scroll-target="#huber-white-standard-errors"><span class="header-section-number">19.1.3.2.1</span> Huber-White standard errors</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#errors-are-independent" id="toc-errors-are-independent" class="nav-link" data-scroll-target="#errors-are-independent"><span class="header-section-number">19.1.4</span> 4. Errors are independent</a>
  <ul class="collapse">
<li><a href="#ways-to-test-3" id="toc-ways-to-test-3" class="nav-link" data-scroll-target="#ways-to-test-3"><span class="header-section-number">19.1.4.1</span> Ways to Test</a></li>
  <li><a href="#ways-to-handle-3" id="toc-ways-to-handle-3" class="nav-link" data-scroll-target="#ways-to-handle-3"><span class="header-section-number">19.1.4.2</span> Ways to Handle</a></li>
  </ul>
</li>
  <li>
<a href="#no-multicollinearity" id="toc-no-multicollinearity" class="nav-link" data-scroll-target="#no-multicollinearity"><span class="header-section-number">19.1.5</span> 5. No multicollinearity</a>
  <ul class="collapse">
<li>
<a href="#ways-to-test-4" id="toc-ways-to-test-4" class="nav-link" data-scroll-target="#ways-to-test-4"><span class="header-section-number">19.1.5.1</span> Ways to Test</a>
  <ul class="collapse">
<li><a href="#variance-inflation-factor-vif" id="toc-variance-inflation-factor-vif" class="nav-link" data-scroll-target="#variance-inflation-factor-vif"><span class="header-section-number">19.1.5.1.1</span> Variance Inflation Factor (VIF)</a></li>
  <li><a href="#generalized-variance-inflation-factor-gvif" id="toc-generalized-variance-inflation-factor-gvif" class="nav-link" data-scroll-target="#generalized-variance-inflation-factor-gvif"><span class="header-section-number">19.1.5.1.2</span> Generalized Variance Inflation Factor (GVIF)</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="header-section-number">19.1.5.1.3</span> Correlation</a></li>
  <li><a href="#tolerance" id="toc-tolerance" class="nav-link" data-scroll-target="#tolerance"><span class="header-section-number">19.1.5.1.4</span> Tolerance</a></li>
  <li><a href="#condition-index" id="toc-condition-index" class="nav-link" data-scroll-target="#condition-index"><span class="header-section-number">19.1.5.1.5</span> Condition Index</a></li>
  </ul>
</li>
  <li><a href="#ways-to-handle-4" id="toc-ways-to-handle-4" class="nav-link" data-scroll-target="#ways-to-handle-4"><span class="header-section-number">19.1.5.2</span> Ways to Handle</a></li>
  </ul>
</li>
  <li>
<a href="#errors-are-normally-distributed" id="toc-errors-are-normally-distributed" class="nav-link" data-scroll-target="#errors-are-normally-distributed"><span class="header-section-number">19.1.6</span> 6. Errors are normally distributed</a>
  <ul class="collapse">
<li><a href="#ways-to-test-5" id="toc-ways-to-test-5" class="nav-link" data-scroll-target="#ways-to-test-5"><span class="header-section-number">19.1.6.1</span> Ways to Test</a></li>
  <li>
<a href="#ways-to-handle-5" id="toc-ways-to-handle-5" class="nav-link" data-scroll-target="#ways-to-handle-5"><span class="header-section-number">19.1.6.2</span> Ways to Handle</a>
  <ul class="collapse">
<li><a href="#transformations-of-outcome-variable" id="toc-transformations-of-outcome-variable" class="nav-link" data-scroll-target="#transformations-of-outcome-variable"><span class="header-section-number">19.1.6.2.1</span> Transformations of Outcome Variable</a></li>
  <li><a href="#transformations-of-predictor-variable" id="toc-transformations-of-predictor-variable" class="nav-link" data-scroll-target="#transformations-of-predictor-variable"><span class="header-section-number">19.1.6.2.2</span> Transformations of Predictor Variable</a></li>
  <li><a href="#robust-models" id="toc-robust-models" class="nav-link" data-scroll-target="#robust-models"><span class="header-section-number">19.1.6.2.3</span> Robust models</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#examining-model-assumptions" id="toc-examining-model-assumptions" class="nav-link" data-scroll-target="#examining-model-assumptions"><span class="header-section-number">19.2</span> Examining Model Assumptions</a>
  <ul>
<li>
<a href="#distribution-of-residuals" id="toc-distribution-of-residuals" class="nav-link" data-scroll-target="#distribution-of-residuals"><span class="header-section-number">19.2.1</span> Distribution of Residuals</a>
  <ul class="collapse">
<li><a href="#sec-qqPlot" id="toc-sec-qqPlot" class="nav-link" data-scroll-target="#sec-qqPlot"><span class="header-section-number">19.2.1.1</span> QQ plots</a></li>
  <li><a href="#sec-ppPlot" id="toc-sec-ppPlot" class="nav-link" data-scroll-target="#sec-ppPlot"><span class="header-section-number">19.2.1.2</span> PP plots</a></li>
  <li><a href="#sec-densityPlotResiduals" id="toc-sec-densityPlotResiduals" class="nav-link" data-scroll-target="#sec-densityPlotResiduals"><span class="header-section-number">19.2.1.3</span> Density Plot of Residuals</a></li>
  </ul>
</li>
  <li><a href="#sec-residualPlots" id="toc-sec-residualPlots" class="nav-link" data-scroll-target="#sec-residualPlots"><span class="header-section-number">19.2.2</span> Residual Plots</a></li>
  <li><a href="#sec-marginalModelPlots" id="toc-sec-marginalModelPlots" class="nav-link" data-scroll-target="#sec-marginalModelPlots"><span class="header-section-number">19.2.3</span> Marginal Model Plots</a></li>
  <li>
<a href="#sec-addedVariablePlots" id="toc-sec-addedVariablePlots" class="nav-link" data-scroll-target="#sec-addedVariablePlots"><span class="header-section-number">19.2.4</span> Added-Variable Plots</a>
  <ul class="collapse">
<li><a href="#refit-model-removing-jointly-influential-observations" id="toc-refit-model-removing-jointly-influential-observations" class="nav-link" data-scroll-target="#refit-model-removing-jointly-influential-observations"><span class="header-section-number">19.2.4.1</span> Refit model removing jointly influential observations</a></li>
  </ul>
</li>
  <li><a href="#outlier-test" id="toc-outlier-test" class="nav-link" data-scroll-target="#outlier-test"><span class="header-section-number">19.2.5</span> Outlier test</a></li>
  <li><a href="#observations-with-high-leverage" id="toc-observations-with-high-leverage" class="nav-link" data-scroll-target="#observations-with-high-leverage"><span class="header-section-number">19.2.6</span> Observations with high leverage</a></li>
  <li><a href="#observations-with-high-influence-on-ols-regression-coefficients" id="toc-observations-with-high-influence-on-ols-regression-coefficients" class="nav-link" data-scroll-target="#observations-with-high-influence-on-ols-regression-coefficients"><span class="header-section-number">19.2.7</span> Observations with high influence (on OLS regression coefficients)</a></li>
  <li><a href="#sec-dfbeta" id="toc-sec-dfbeta" class="nav-link" data-scroll-target="#sec-dfbeta"><span class="header-section-number">19.2.8</span> DFBETA</a></li>
  <li><a href="#sec-dffits" id="toc-sec-dffits" class="nav-link" data-scroll-target="#sec-dffits"><span class="header-section-number">19.2.9</span> DFFITS</a></li>
  <li>
<a href="#sec-cooksDistance" id="toc-sec-cooksDistance" class="nav-link" data-scroll-target="#sec-cooksDistance"><span class="header-section-number">19.2.10</span> Cook’s Distance</a>
  <ul class="collapse">
<li>
<a href="#refit-model-removing-values-with-high-cooks-distance" id="toc-refit-model-removing-values-with-high-cooks-distance" class="nav-link" data-scroll-target="#refit-model-removing-values-with-high-cooks-distance"><span class="header-section-number">19.2.10.1</span> Refit model removing values with high cook’s distance</a>
  <ul class="collapse">
<li><a href="#examine-how-much-regression-coefficients-change-when-excluding-influential-observations" id="toc-examine-how-much-regression-coefficients-change-when-excluding-influential-observations" class="nav-link" data-scroll-target="#examine-how-much-regression-coefficients-change-when-excluding-influential-observations"><span class="header-section-number">19.2.10.1.1</span> Examine how much regression coefficients change when excluding influential observations</a></li>
  </ul>
</li>
  <li><a href="#examine-how-much-regression-coefficients-change-when-using-least-trimmed-squares-lts-that-is-resistant-to-outliers" id="toc-examine-how-much-regression-coefficients-change-when-using-least-trimmed-squares-lts-that-is-resistant-to-outliers" class="nav-link" data-scroll-target="#examine-how-much-regression-coefficients-change-when-using-least-trimmed-squares-lts-that-is-resistant-to-outliers"><span class="header-section-number">19.2.10.2</span> Examine how much regression coefficients change when using least trimmed squares (LTS) that is resistant to outliers</a></li>
  </ul>
</li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources"><span class="header-section-number">19.2.11</span> Resources</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">20</span> Session Info</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/DevPsyLab/DataAnalysis/edit/main/regression.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/blob/main/regression.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Regression</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="preamble" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Preamble</h1>
<section id="install-libraries" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="install-libraries">
<span class="header-section-number">1.1</span> Install Libraries</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#install.packages("remotes")</span></span>
<span><span class="co">#remotes::install_github("DevPsyLab/petersenlab")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="load-libraries" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="load-libraries">
<span class="header-section-number">1.2</span> Load Libraries</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/DevPsyLab/petersenlab">"petersenlab"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">"MASS"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://personality-project.org/r/psych/">"psych"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://hbiostat.org/R/rms/">"rms"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://robustbase.R-forge.R-project.org/">"robustbase"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/paul-buerkner/brms">"brms"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"cvTools"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://r-forge.r-project.org/projects/car/">"car"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"mgcv"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"AER"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://svn.r-project.org/R-packages/trunk/foreign/">"foreign"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://olsrr.rsquaredacademy.com/">"olsrr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://www.r-project.org">"quantreg"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://www.r-project.org">"mblm"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://cran.r-project.org/package=effects">"effects"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://easystats.github.io/correlation/">"correlation"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://interactions.jacob-long.com">"interactions"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://lavaan.ugent.be">"lavaan"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/matloff/regtools">"regtools"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/amices/mice">"mice"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"XICOR"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://comparingcorrelations.org">"cocor"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://easystats.github.io/effectsize/">"effectsize"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"rockchalk"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"yhat"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section><section id="import-data" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Import Data</h1>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"https://osf.io/8syp5/download"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="data-preparation" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Data Preparation</h1>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">countVariable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">bpi_antisocialT2Sum</span><span class="op">)</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">orderedVariable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">countVariable</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">female</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">female</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"male"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">female</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="overview-of-multiple-regression" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Overview of Multiple Regression</h1>
<p><a href="https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/multiple-regression.html" class="uri">https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/multiple-regression.html</a></p>
</section><section id="linear-regression" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Linear Regression</h1>
<section id="linear-regression-model" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="linear-regression-model">
<span class="header-section-number">5.1</span> Linear regression model</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">multipleRegressionModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.3755 -1.2337 -0.2212  0.9911 12.8017 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              1.19830    0.05983  20.029  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.979 on 2871 degrees of freedom
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.262, Adjusted R-squared:  0.2615 
F-statistic: 509.6 on 2 and 2871 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                            2.5 %    97.5 %
(Intercept)             1.0809881 1.3156128
bpi_antisocialT1Sum     0.4290884 0.5019688
bpi_anxiousDepressedSum 0.1035825 0.2179258</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |        95% CI
----------------------------------------------------
(Intercept)             |   1.62e-16 | [-0.03, 0.03]
bpi antisocialT1Sum     |       0.46 | [ 0.42, 0.49]
bpi anxiousDepressedSum |       0.10 | [ 0.06, 0.14]</code></pre>
</div>
</div>
<section id="remove-missing-data" class="level3" data-number="5.1.1"><h3 data-number="5.1.1" class="anchored" data-anchor-id="remove-missing-data">
<span class="header-section-number">5.1.1</span> Remove missing data</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">multipleRegressionModelNoMissing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span></span>
<span><span class="va">multipleRegressionModelNoMissing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html">select</a></span><span class="op">(</span><span class="va">bpi_antisocialT2Sum</span>, <span class="va">bpi_antisocialT1Sum</span>, <span class="va">bpi_anxiousDepressedSum</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">na.omit</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section><section id="linear-regression-model-on-correlationcovariance-matrix-for-pairwise-deletion" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="linear-regression-model-on-correlationcovariance-matrix-for-pairwise-deletion">
<span class="header-section-number">5.2</span> Linear regression model on correlation/covariance matrix (for pairwise deletion)</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">multipleRegressionModelPairwise</span> <span class="op">&lt;-</span> <span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/lmCor.html">setCor</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bpi_antisocialT2Sum"</span>,<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span><span class="op">)</span><span class="op">]</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span>,</span>
<span>  n.obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="regression_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">multipleRegressionModelPairwise</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Multiple Regression from matrix input 
psych::setCor(y = "bpi_antisocialT2Sum", x = c("bpi_antisocialT1Sum", 
    "bpi_anxiousDepressedSum"), data = cov(mydata[, c("bpi_antisocialT2Sum", 
    "bpi_antisocialT1Sum", "bpi_anxiousDepressedSum")], use = "pairwise.complete.obs"), 
    n.obs = nrow(mydata))

Multiple Regression from matrix input 

Beta weights 
                        bpi_antisocialT2Sum
bpi_antisocialT1Sum                    0.46
bpi_anxiousDepressedSum                0.09

Multiple R 
bpi_antisocialT2Sum 
               0.51 

Multiple R2 
bpi_antisocialT2Sum 
               0.26 

Cohen's set correlation R2 
[1] 0.26

Squared Canonical Correlations
NULL</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">multipleRegressionModelPairwise</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"coefficients"</span>,<span class="st">"se"</span>,<span class="st">"Probability"</span>,<span class="st">"R2"</span>,<span class="st">"shrunkenR2"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$coefficients
                        bpi_antisocialT2Sum
bpi_antisocialT1Sum               0.4560961
bpi_anxiousDepressedSum           0.0899642

$se
                        bpi_antisocialT2Sum
bpi_antisocialT1Sum             0.009253718
bpi_anxiousDepressedSum         0.009253718

$Probability
                        bpi_antisocialT2Sum
bpi_antisocialT1Sum            0.000000e+00
bpi_anxiousDepressedSum        2.959352e-22

$R2
bpi_antisocialT2Sum 
           0.256918 

$shrunkenR2
bpi_antisocialT2Sum 
           0.256789 </code></pre>
</div>
</div>
</section><section id="linear-regression-model-with-robust-covariance-matrix-rms" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="linear-regression-model-with-robust-covariance-matrix-rms">
<span class="header-section-number">5.3</span> Linear regression model with robust covariance matrix (rms)</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rmsMultipleRegressionModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rms/man/robcov.html">robcov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/rms/man/ols.html">ols</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rmsMultipleRegressionModel</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
    bpi_antisocialT2Sum     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
                   7501                    7613                    7616 

Linear Regression Model

ols(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, x = TRUE, y = TRUE)

                Model Likelihood    Discrimination    
                      Ratio Test           Indexes    
Obs    2874    LR chi2    873.09    R2       0.262    
sigma1.9786    d.f.            2    R2 adj   0.261    
d.f.   2871    Pr(&gt; chi2) 0.0000    g        1.278    

Residuals

    Min      1Q  Median      3Q     Max 
-8.3755 -1.2337 -0.2212  0.9911 12.8017 

                        Coef   S.E.   t     Pr(&gt;|t|)
Intercept               1.1983 0.0622 19.26 &lt;0.0001 
bpi_antisocialT1Sum     0.4655 0.0229 20.30 &lt;0.0001 
bpi_anxiousDepressedSum 0.1608 0.0330  4.87 &lt;0.0001 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">rmsMultipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                             2.5 %    97.5 %
Intercept               1.07631713 1.3202837
bpi_antisocialT1Sum     0.42056957 0.5104877
bpi_anxiousDepressedSum 0.09606644 0.2254418</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">rmsMultipleRegressionModel</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |        95% CI
----------------------------------------------------
Intercept               |   1.62e-16 | [-0.03, 0.03]
bpi antisocialT1Sum     |       0.46 | [ 0.42, 0.49]
bpi anxiousDepressedSum |       0.10 | [ 0.06, 0.14]</code></pre>
</div>
</div>
</section><section id="robust-linear-regression-mm-type-iteratively-reweighted-least-squares-regression" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="robust-linear-regression-mm-type-iteratively-reweighted-least-squares-regression">
<span class="header-section-number">5.4</span> Robust linear regression (MM-type iteratively reweighted least squares regression)</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">robustLinearRegression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/robustbase/man/lmrob.html">lmrob</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">robustLinearRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lmrob(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, na.action = na.exclude)
 \--&gt; method = "MM"
Residuals:
     Min       1Q   Median       3Q      Max 
-8.43518 -1.06680 -0.06707  1.14090 13.05599 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              0.94401    0.05406  17.464  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.49135    0.02237  21.966  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.15766    0.03102   5.083 3.96e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Robust residual standard error: 1.628 
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.326, Adjusted R-squared:  0.3255 
Convergence in 14 IRWLS iterations

Robustness weights: 
 12 observations c(52,347,354,517,709,766,768,979,1618,2402,2403,2404)
     are outliers with |weight| = 0 ( &lt; 3.5e-05); 
 283 weights are ~= 1. The remaining 2579 ones are summarized as
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
0.0001311 0.8599000 0.9470000 0.8814000 0.9816000 0.9990000 
Algorithmic parameters: 
       tuning.chi                bb        tuning.psi        refine.tol 
        1.548e+00         5.000e-01         4.685e+00         1.000e-07 
          rel.tol         scale.tol         solve.tol          zero.tol 
        1.000e-07         1.000e-10         1.000e-07         1.000e-10 
      eps.outlier             eps.x warn.limit.reject warn.limit.meanrw 
        3.479e-05         2.365e-11         5.000e-01         5.000e-01 
     nResample         max.it         groups        n.group       best.r.s 
           500             50              5            400              2 
      k.fast.s          k.max    maxit.scale      trace.lev            mts 
             1            200            200              0           1000 
    compute.rd fast.s.large.n 
             0           2000 
                  psi           subsampling                   cov 
           "bisquare"         "nonsingular"         ".vcov.avar1" 
compute.outlier.stats 
                 "SM" 
seed : int(0) </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">robustLinearRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                             2.5 %    97.5 %
(Intercept)             0.83801565 1.0499981
bpi_antisocialT1Sum     0.44749135 0.5352118
bpi_anxiousDepressedSum 0.09683728 0.2184779</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">robustLinearRegression</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |         95% CI
-----------------------------------------------------
(Intercept)             |      -0.08 | [-0.11, -0.05]
bpi antisocialT1Sum     |       0.48 | [ 0.44,  0.52]
bpi anxiousDepressedSum |       0.10 | [ 0.06,  0.14]</code></pre>
</div>
</div>
</section><section id="least-trimmed-squares-regression-for-removing-outliers" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="least-trimmed-squares-regression-for-removing-outliers">
<span class="header-section-number">5.5</span> Least trimmed squares regression (for removing outliers)</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ltsRegression</span> <span class="op">&lt;-</span> <span class="fu">robustbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/robustbase/man/ltsReg.html">ltsReg</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ltsRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
ltsReg.formula(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
    bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)

Residuals (from reweighted LS):
    Min      1Q  Median      3Q     Max 
-3.8820 -0.8888  0.0000  1.0146  3.9168 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
Intercept                0.74524    0.04813  15.485  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.55667    0.01528  36.428  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.12006    0.02351   5.107  3.5e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.541 on 2713 degrees of freedom
Multiple R-Squared: 0.4158, Adjusted R-squared: 0.4153 
F-statistic: 965.4 on 2 and 2713 DF,  p-value: &lt; 2.2e-16 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">robustLinearRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                             2.5 %    97.5 %
(Intercept)             0.83801565 1.0499981
bpi_antisocialT1Sum     0.44749135 0.5352118
bpi_anxiousDepressedSum 0.09683728 0.2184779</code></pre>
</div>
</div>
</section><section id="bayesian-linear-regression" class="level2" data-number="5.6"><h2 data-number="5.6" class="anchored" data-anchor-id="bayesian-linear-regression">
<span class="header-section-number">5.6</span> Bayesian linear regression</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bayesianRegularizedRegression</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">52242</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bayesianRegularizedRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity 
Formula: bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum 
   Data: mydata (Number of observations: 2874) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                   1.20      0.06     1.08     1.32 1.00     4472
bpi_antisocialT1Sum         0.47      0.02     0.43     0.50 1.00     3350
bpi_anxiousDepressedSum     0.16      0.03     0.10     0.22 1.00     3184
                        Tail_ESS
Intercept                   3070
bpi_antisocialT1Sum         3292
bpi_anxiousDepressedSum     2958

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     1.98      0.03     1.93     2.03 1.00     4104     3454

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">bayesianRegularizedRegression</span>, method <span class="op">=</span> <span class="st">"basic"</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: basic

Component   |               Parameter | Std. Median |       95% CI
------------------------------------------------------------------
conditional |             (Intercept) |        0.00 | [0.00, 0.00]
conditional |     bpi_antisocialT1Sum |        0.46 | [0.42, 0.49]
conditional | bpi_anxiousDepressedSum |        0.10 | [0.07, 0.14]
sigma       |                   sigma |        1.98 | [1.93, 2.03]</code></pre>
</div>
</div>
</section></section><section id="generalized-linear-regression" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Generalized Linear Regression</h1>
<section id="generalized-regression-model" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="generalized-regression-model">
<span class="header-section-number">6.1</span> Generalized regression model</h2>
<p>In this example, we predict a count variable that has a poisson distribution. We could change the distribution.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">generalizedRegressionModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span></span>
<span>  <span class="va">countVariable</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">generalizedRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    family = "poisson", data = mydata, na.action = na.exclude)

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             0.459999   0.019650  23.410  &lt; 2e-16 ***
bpi_antisocialT1Sum     0.141577   0.004891  28.948  &lt; 2e-16 ***
bpi_anxiousDepressedSum 0.047567   0.008036   5.919 3.23e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 5849.4  on 2873  degrees of freedom
Residual deviance: 4562.6  on 2871  degrees of freedom
  (8656 observations deleted due to missingness)
AIC: 11482

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">generalizedRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                             2.5 %     97.5 %
(Intercept)             0.42136094 0.49838751
bpi_antisocialT1Sum     0.13196544 0.15113708
bpi_anxiousDepressedSum 0.03177425 0.06327445</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">generalizedRegressionModel</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |       95% CI
---------------------------------------------------
(Intercept)             |       0.91 | [0.89, 0.94]
bpi antisocialT1Sum     |       0.32 | [0.30, 0.34]
bpi anxiousDepressedSum |       0.07 | [0.05, 0.09]

- Response is unstandardized.</code></pre>
</div>
</div>
</section><section id="generalized-regression-model-rms" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="generalized-regression-model-rms">
<span class="header-section-number">6.2</span> Generalized regression model (rms)</h2>
<p>In this example, we predict a count variable that has a poisson distribution. We could change the distribution.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rmsGeneralizedRegressionModel</span> <span class="op">&lt;-</span> <span class="fu">rms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rms/man/Glm.html">Glm</a></span><span class="op">(</span></span>
<span>  <span class="va">countVariable</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rmsGeneralizedRegressionModel</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
          countVariable     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
                   7501                    7613                    7616 

General Linear Model

rms::Glm(formula = countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    family = "poisson", data = mydata, x = TRUE, y = TRUE)

                       Model Likelihood    
                             Ratio Test    
          Obs2874    LR chi2    1286.72    
Residual d.f.2871    d.f.             2    
          g 0.387    Pr(&gt; chi2) &lt;0.0001    

                        Coef   S.E.   Wald Z Pr(&gt;|Z|)
Intercept               0.4600 0.0196 23.41  &lt;0.0001 
bpi_antisocialT1Sum     0.1416 0.0049 28.95  &lt;0.0001 
bpi_anxiousDepressedSum 0.0476 0.0080  5.92  &lt;0.0001 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">rmsGeneralizedRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `summary.rms()`:
! adjustment values not defined here or with datadist for bpi_antisocialT1Sum bpi_anxiousDepressedSum</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">rmsGeneralizedRegressionModel</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |       95% CI
---------------------------------------------------
Intercept               |       0.91 | [0.89, 0.94]
bpi antisocialT1Sum     |       0.32 | [0.30, 0.34]
bpi anxiousDepressedSum |       0.07 | [0.05, 0.09]

- Response is unstandardized.</code></pre>
</div>
</div>
</section><section id="bayesian-generalized-linear-model" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="bayesian-generalized-linear-model">
<span class="header-section-number">6.3</span> Bayesian generalized linear model</h2>
<p>In this example, we predict a count variable that has a poisson distribution. We could change the distribution. For example, we could use Gamma regression, <code>family = Gamma</code>, when the response variable is continuous and positive, and the coefficient of variation–rather than the variance–is constant.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bayesianGeneralizedLinearRegression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">countVariable</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  family <span class="op">=</span> <span class="va">poisson</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">52242</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bayesianGeneralizedLinearRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Family: poisson 
  Links: mu = log 
Formula: countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum 
   Data: mydata (Number of observations: 2874) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                   0.46      0.02     0.42     0.50 1.00     3095
bpi_antisocialT1Sum         0.14      0.00     0.13     0.15 1.00     2776
bpi_anxiousDepressedSum     0.05      0.01     0.03     0.06 1.00     2620
                        Tail_ESS
Intercept                   2987
bpi_antisocialT1Sum         2762
bpi_anxiousDepressedSum     2689

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">bayesianGeneralizedLinearRegression</span>, method <span class="op">=</span> <span class="st">"basic"</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: basic

Parameter               | Std. Median |       95% CI
----------------------------------------------------
(Intercept)             |        0.00 | [0.00, 0.00]
bpi_antisocialT1Sum     |        0.32 | [0.30, 0.34]
bpi_anxiousDepressedSum |        0.07 | [0.05, 0.09]

- Response is unstandardized.</code></pre>
</div>
</div>
</section><section id="robust-generalized-regression" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="robust-generalized-regression">
<span class="header-section-number">6.4</span> Robust generalized regression</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">robustGeneralizedRegression</span> <span class="op">&lt;-</span> <span class="fu">robustbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/robustbase/man/glmrob.html">glmrob</a></span><span class="op">(</span></span>
<span>  <span class="va">countVariable</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">robustGeneralizedRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:  robustbase::glmrob(formula = countVariable ~ bpi_antisocialT1Sum +      bpi_anxiousDepressedSum, family = "poisson", data = mydata,      na.action = na.exclude) 


Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             0.365934   0.020794  17.598  &lt; 2e-16 ***
bpi_antisocialT1Sum     0.156275   0.005046  30.969  &lt; 2e-16 ***
bpi_anxiousDepressedSum 0.050526   0.008332   6.064 1.32e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
Robustness weights w.r * w.x: 
 2273 weights are ~= 1. The remaining 601 ones are summarized as
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1286  0.5550  0.7574  0.7183  0.8874  0.9982 

Number of observations: 2874 
Fitted by method 'Mqle'  (in 5 iterations)

(Dispersion parameter for poisson family taken to be 1)

No deviance values available 
Algorithmic parameters: 
   acc    tcc 
0.0001 1.3450 
maxit 
   50 
test.acc 
  "coef" </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">robustGeneralizedRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `glm.control()`:
! unused arguments (acc = 1e-04, test.acc = "coef", tcc = 1.345)</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">robustGeneralizedRegression</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |       95% CI
---------------------------------------------------
(Intercept)             |       0.87 | [0.84, 0.89]
bpi antisocialT1Sum     |       0.35 | [0.33, 0.38]
bpi anxiousDepressedSum |       0.07 | [0.05, 0.10]

- Response is unstandardized.</code></pre>
</div>
</div>
</section><section id="ordinal-regression-model" class="level2" data-number="6.5"><h2 data-number="6.5" class="anchored" data-anchor-id="ordinal-regression-model">
<span class="header-section-number">6.5</span> Ordinal regression model</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ordinalRegressionModel1</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/polr.html">polr</a></span><span class="op">(</span></span>
<span>  <span class="va">orderedVariable</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ordinalRegressionModel2</span> <span class="op">&lt;-</span> <span class="fu">rms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rms/man/lrm.html">lrm</a></span><span class="op">(</span></span>
<span>  <span class="va">orderedVariable</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ordinalRegressionModel3</span> <span class="op">&lt;-</span> <span class="fu">rms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rms/man/orm.html">orm</a></span><span class="op">(</span></span>
<span>  <span class="va">orderedVariable</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ordinalRegressionModel1</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Call:
MASS::polr(formula = orderedVariable ~ bpi_antisocialT1Sum + 
    bpi_anxiousDepressedSum, data = mydata)

Coefficients:
                         Value Std. Error t value
bpi_antisocialT1Sum     0.4404    0.01862  23.647
bpi_anxiousDepressedSum 0.1427    0.02615   5.457

Intercepts:
      Value   Std. Error t value
0|1   -0.6001  0.0630    -9.5185
1|2    0.6766  0.0585    11.5656
2|3    1.5801  0.0634    24.9191
3|4    2.4110  0.0720    33.4816
4|5    3.1617  0.0825    38.3006
5|6    3.8560  0.0949    40.6120
6|7    4.5367  0.1106    41.0316
7|8    5.1667  0.1291    40.0147
8|9    5.8129  0.1545    37.6263
9|10   6.5364  0.1962    33.3193
10|11  7.1835  0.2513    28.5820
11|12  7.8469  0.3331    23.5566
12|14  8.7818  0.5113    17.1741

Residual Deviance: 11088.49 
AIC: 11118.49 
(8656 observations deleted due to missingness)</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">ordinalRegressionModel1</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                             2.5 %    97.5 %
bpi_antisocialT1Sum     0.40403039 0.4770422
bpi_anxiousDepressedSum 0.09149919 0.1940080</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ordinalRegressionModel2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
        orderedVariable     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
                   7501                    7613                    7616 

Logistic Regression Model

rms::lrm(formula = orderedVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, x = TRUE, y = TRUE)


Frequencies of Responses

  0   1   2   3   4   5   6   7   8   9  10  11  12  14 
455 597 527 444 313 205 133  80  52  33  16   9   6   4 

                       Model Likelihood       Discrimination    Rank Discrim.    
                             Ratio Test              Indexes          Indexes    
Obs          2874    LR chi2     881.26       R2       0.268    C       0.705    
max |deriv| 6e-06    d.f.             2      R2(2,2874)0.264    Dxy     0.410    
                     Pr(&gt; chi2) &lt;0.0001    R2(2,2803.4)0.269    gamma   0.426    
                                              Brier    0.195    tau-a   0.350    

                        Coef   S.E.   Wald Z Pr(&gt;|Z|)
bpi_antisocialT1Sum     0.4404 0.0186 23.65  &lt;0.0001 
bpi_anxiousDepressedSum 0.1427 0.0261  5.46  &lt;0.0001 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">ordinalRegressionModel2</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |         95% CI
-----------------------------------------------------
y&gt;=1                    |       2.01 | [ 1.90,  2.12]
y&gt;=2                    |       0.73 | [ 0.65,  0.81]
y&gt;=3                    |      -0.17 | [-0.25, -0.09]
y&gt;=4                    |      -1.00 | [-1.09, -0.91]
y&gt;=5                    |      -1.75 | [-1.86, -1.65]
y&gt;=6                    |      -2.45 | [-2.58, -2.32]
y&gt;=7                    |      -3.13 | [-3.29, -2.97]
y&gt;=8                    |      -3.76 | [-3.96, -3.56]
y&gt;=9                    |      -4.40 | [-4.66, -4.14]
y&gt;=10                   |      -5.13 | [-5.48, -4.78]
y&gt;=11                   |      -5.78 | [-6.24, -5.31]
y&gt;=12                   |      -6.44 | [-7.07, -5.81]
y&gt;=14                   |      -7.37 | [-8.36, -6.39]
bpi antisocialT1Sum     |       0.99 | [ 0.91,  1.08]
bpi anxiousDepressedSum |       0.21 | [ 0.13,  0.28]

- Response is unstandardized.</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ordinalRegressionModel3</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
        orderedVariable     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
                   7501                    7613                    7616 

Logistic (Proportional Odds) Ordinal Regression Model

rms::orm(formula = orderedVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, x = TRUE, y = TRUE)


Frequencies of Responses

  0   1   2   3   4   5   6   7   8   9  10  11  12  14 
455 597 527 444 313 205 133  80  52  33  16   9   6   4 

                        Model Likelihood               Discrimination    Rank Discrim.    
                              Ratio Test                      Indexes          Indexes    
Obs           2874    LR chi2     881.26    R2                  0.268    rho     0.506    
ESS         2803.4    d.f.             2    R2(2,2874)          0.264    Dxy     0.410    
Distinct Y      14    Pr(&gt; chi2) &lt;0.0001    R2(2,2803.4)        0.269                     
Median Y         3    Score chi2  916.79    |Pr(Y&gt;=median)-0.5| 0.188                     
max |deriv|  2e-12    Pr(&gt; chi2) &lt;0.0001                                                  

                        Coef   S.E.   Wald Z Pr(&gt;|Z|)
bpi_antisocialT1Sum     0.4404 0.0186 23.65  &lt;0.0001 
bpi_anxiousDepressedSum 0.1427 0.0261  5.46  &lt;0.0001 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">ordinalRegressionModel3</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                              2.5 %     97.5 %
y&gt;=1                             NA         NA
y&gt;=2                    -0.79129972 -0.5619711
y&gt;=3                             NA         NA
y&gt;=4                             NA         NA
y&gt;=5                             NA         NA
y&gt;=6                             NA         NA
y&gt;=7                             NA         NA
y&gt;=8                             NA         NA
y&gt;=9                             NA         NA
y&gt;=10                            NA         NA
y&gt;=11                            NA         NA
y&gt;=12                            NA         NA
y&gt;=14                            NA         NA
bpi_antisocialT1Sum      0.40390078  0.4769035
bpi_anxiousDepressedSum  0.09143921  0.1939303</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">ordinalRegressionModel3</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |       95% CI
---------------------------------------------------
y&gt;=2                    |       0.73 | [0.65, 0.81]
bpi antisocialT1Sum     |       0.99 | [0.91, 1.08]
bpi anxiousDepressedSum |       0.21 | [0.13, 0.28]

- Response is unstandardized.</code></pre>
</div>
</div>
</section><section id="bayesian-ordinal-regression-model" class="level2" data-number="6.6"><h2 data-number="6.6" class="anchored" data-anchor-id="bayesian-ordinal-regression-model">
<span class="header-section-number">6.6</span> Bayesian ordinal regression model</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bayesianOrdinalRegression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">orderedVariable</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html">cumulative</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">52242</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bayesianOrdinalRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Family: cumulative 
  Links: mu = logit 
Formula: orderedVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum 
   Data: mydata (Number of observations: 2874) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept[1]               -0.60      0.06    -0.73    -0.48 1.00     4659
Intercept[2]                0.67      0.06     0.55     0.79 1.00     6134
Intercept[3]                1.57      0.06     1.45     1.70 1.00     5916
Intercept[4]                2.40      0.07     2.26     2.54 1.00     5305
Intercept[5]                3.15      0.08     2.99     3.31 1.00     4846
Intercept[6]                3.84      0.09     3.66     4.03 1.00     4741
Intercept[7]                4.52      0.11     4.31     4.74 1.00     4796
Intercept[8]                5.15      0.13     4.90     5.40 1.00     4908
Intercept[9]                5.79      0.15     5.50     6.11 1.00     5172
Intercept[10]               6.51      0.20     6.14     6.90 1.00     5196
Intercept[11]               7.17      0.25     6.69     7.69 1.00     5867
Intercept[12]               7.87      0.34     7.25     8.56 1.00     5503
Intercept[13]               8.91      0.53     7.99    10.06 1.00     5868
bpi_antisocialT1Sum         0.44      0.02     0.40     0.48 1.00     4321
bpi_anxiousDepressedSum     0.14      0.03     0.09     0.19 1.00     4514
                        Tail_ESS
Intercept[1]                3538
Intercept[2]                3487
Intercept[3]                3551
Intercept[4]                3532
Intercept[5]                3866
Intercept[6]                3599
Intercept[7]                3222
Intercept[8]                3125
Intercept[9]                2991
Intercept[10]               3098
Intercept[11]               3043
Intercept[12]               2906
Intercept[13]               2873
bpi_antisocialT1Sum         2945
bpi_anxiousDepressedSum     3156

Further Distributional Parameters:
     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
disc     1.00      0.00     1.00     1.00   NA       NA       NA

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">bayesianOrdinalRegression</span>, method <span class="op">=</span> <span class="st">"basic"</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: basic

Parameter               | Std. Median |         95% CI
------------------------------------------------------
Intercept[1]            |        0.00 | [ 0.00,  0.00]
Intercept[2]            |        1.51 | [ 1.25,  1.78]
Intercept[3]            |        2.26 | [ 2.08,  2.45]
Intercept[4]            |        2.40 | [ 2.26,  2.54]
Intercept[5]            |        3.15 | [ 2.99,  3.31]
Intercept[6]            |        3.84 | [ 3.66,  4.03]
Intercept[7]            |        4.52 | [ 4.31,  4.74]
Intercept[8]            |        5.14 | [ 4.90,  5.40]
Intercept[9]            |        5.78 | [ 5.50,  6.11]
Intercept[10]           |        6.50 | [ 6.14,  6.90]
Intercept[11]           |        7.15 | [ 6.69,  7.69]
Intercept[12]           |        7.84 | [ 7.25,  8.56]
Intercept[13]           |        8.87 | [ 7.99, 10.06]
bpi_antisocialT1Sum     |        0.44 | [ 0.40,  0.48]
bpi_anxiousDepressedSum |        0.14 | [ 0.09,  0.19]

- Response is unstandardized.</code></pre>
</div>
</div>
</section><section id="bayesian-count-regression-model" class="level2" data-number="6.7"><h2 data-number="6.7" class="anchored" data-anchor-id="bayesian-count-regression-model">
<span class="header-section-number">6.7</span> Bayesian count regression model</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bayesianCountRegression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">countVariable</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">52242</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bayesianCountRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Family: poisson 
  Links: mu = log 
Formula: countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum 
   Data: mydata (Number of observations: 2874) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                   0.46      0.02     0.42     0.50 1.00     3095
bpi_antisocialT1Sum         0.14      0.00     0.13     0.15 1.00     2776
bpi_anxiousDepressedSum     0.05      0.01     0.03     0.06 1.00     2620
                        Tail_ESS
Intercept                   2987
bpi_antisocialT1Sum         2762
bpi_anxiousDepressedSum     2689

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">bayesianCountRegression</span>, method <span class="op">=</span> <span class="st">"basic"</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: basic

Parameter               | Std. Median |       95% CI
----------------------------------------------------
(Intercept)             |        0.00 | [0.00, 0.00]
bpi_antisocialT1Sum     |        0.32 | [0.30, 0.34]
bpi_anxiousDepressedSum |        0.07 | [0.05, 0.09]

- Response is unstandardized.</code></pre>
</div>
</div>
</section><section id="logistic-regression-model-rms" class="level2" data-number="6.8"><h2 data-number="6.8" class="anchored" data-anchor-id="logistic-regression-model-rms">
<span class="header-section-number">6.8</span> Logistic regression model (rms)</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">logisticRegressionModel</span> <span class="op">&lt;-</span> <span class="fu">rms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rms/man/robcov.html">robcov</a></span><span class="op">(</span><span class="fu">rms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rms/man/lrm.html">lrm</a></span><span class="op">(</span></span>
<span>  <span class="va">female</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">logisticRegressionModel</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
                 female     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
                      2                    7613                    7616 

Logistic Regression Model

rms::lrm(formula = female ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, x = TRUE, y = TRUE)

                       Model Likelihood       Discrimination    Rank Discrim.    
                             Ratio Test              Indexes          Indexes    
Obs          3914    LR chi2      66.63       R2       0.023    C       0.571    
 0           1965    d.f.             2      R2(2,3914)0.016    Dxy     0.142    
 1           1949    Pr(&gt; chi2) &lt;0.0001    R2(2,2935.5)0.022    gamma   0.147    
max |deriv| 1e-07                             Brier    0.246    tau-a   0.071    

                        Coef    S.E.   Wald Z Pr(&gt;|Z|)
Intercept                0.3002 0.0529  5.67  &lt;0.0001 
bpi_antisocialT1Sum     -0.1244 0.0166 -7.48  &lt;0.0001 
bpi_anxiousDepressedSum  0.0382 0.0253  1.51  0.1314  </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">logisticRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `summary.rms()`:
! adjustment values not defined here or with datadist for bpi_antisocialT1Sum bpi_anxiousDepressedSum</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">logisticRegressionModel</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |         95% CI
-----------------------------------------------------
Intercept               |  -9.88e-03 | [-0.07,  0.05]
bpi antisocialT1Sum     |      -0.29 | [-0.36, -0.21]
bpi anxiousDepressedSum |       0.06 | [-0.02,  0.13]

- Response is unstandardized.</code></pre>
</div>
</div>
</section><section id="bayesian-logistic-regression-model" class="level2" data-number="6.9"><h2 data-number="6.9" class="anchored" data-anchor-id="bayesian-logistic-regression-model">
<span class="header-section-number">6.9</span> Bayesian logistic regression model</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bayesianLogisticRegression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">female</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  family <span class="op">=</span> <span class="va">bernoulli</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">52242</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bayesianLogisticRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: female ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum 
   Data: mydata (Number of observations: 3914) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                   0.30      0.05     0.20     0.41 1.00     4125
bpi_antisocialT1Sum        -0.13      0.02    -0.16    -0.09 1.00     2943
bpi_anxiousDepressedSum     0.04      0.03    -0.01     0.09 1.00     3084
                        Tail_ESS
Intercept                   3269
bpi_antisocialT1Sum         2857
bpi_anxiousDepressedSum     2730

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">bayesianLogisticRegression</span>, method <span class="op">=</span> <span class="st">"basic"</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: basic

Parameter               | Std. Median |         95% CI
------------------------------------------------------
(Intercept)             |        0.00 | [ 0.00,  0.00]
bpi_antisocialT1Sum     |       -0.29 | [-0.36, -0.22]
bpi_anxiousDepressedSum |        0.06 | [-0.02,  0.13]

- Response is unstandardized.</code></pre>
</div>
</div>
</section></section><section id="hierarchical-linear-regression" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> Hierarchical Linear Regression</h1>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html">select</a></span><span class="op">(</span><span class="va">bpi_antisocialT2Sum</span>, <span class="va">bpi_antisocialT1Sum</span>, <span class="va">bpi_anxiousDepressedSum</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">na.omit</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html">select</a></span><span class="op">(</span><span class="va">bpi_antisocialT2Sum</span>, <span class="va">bpi_antisocialT1Sum</span>, <span class="va">bpi_anxiousDepressedSum</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">na.omit</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2614694</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model1</span>, <span class="va">model2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"2872","2":"11358.86","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"2871","2":"11239.86","3":"1","4":"119.0016","5":"30.39663","6":"3.834142e-08","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.007559301</code></pre>
</div>
</div>
</section><section id="sec-moderation" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> Moderated Multiple Regression</h1>
<p>When testing for the possibility of moderation/interaction, it is first important to think about what shape the interaction might take. If you expect a bilinear interaction (i.e., the slope of the regression line between <code>X</code> and <code>Y</code> changes as a <em>linear</em> function of a third variable, <code>Z</code>), it is appropriate to treat the moderator as continuous in moderated multiple regression. However, if you expect that the interaction might take a different form (e.g., a threshold effect), you may need to consider other approaches, such as using categorical variables, polynomial interactions, spline functions, generalized additive models (GAMs), or machine learning.</p>
<p>For information on the (low) power to detect interactions and how to improve it, see: <a href="https://isaactpetersen.github.io/Principles-Psychological-Assessment/reliability.html#sec-productTerm-reliability" class="uri">https://isaactpetersen.github.io/Principles-Psychological-Assessment/reliability.html#sec-productTerm-reliability</a></p>
<p>The examples below use the <code>interactions</code> package in R. <a href="https://cran.r-project.org/web/packages/interactions/vignettes/interactions.html" class="uri">https://cran.r-project.org/web/packages/interactions/vignettes/interactions.html</a> (archived at <a href="https://perma.cc/P34H-7BH3" class="uri">https://perma.cc/P34H-7BH3</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span></span>
<span><span class="va">states</span><span class="op">$</span><span class="va">HS.Grad</span> <span class="op">&lt;-</span> <span class="va">states</span><span class="op">$</span><span class="va">`HS Grad`</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="mean-center-predictors" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="mean-center-predictors">
<span class="header-section-number">8.1</span> Mean Center Predictors</h2>
<p>Make sure to mean-center or orthogonalize predictors before computing the interaction term.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">states</span><span class="op">$</span><span class="va">Illiteracy_centered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">states</span><span class="op">$</span><span class="va">Illiteracy</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">states</span><span class="op">$</span><span class="va">Murder_centered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">states</span><span class="op">$</span><span class="va">Murder</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="model" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="model">
<span class="header-section-number">8.2</span> Model</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">interactionModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">Income</span> <span class="op">~</span> <span class="va">Illiteracy_centered</span> <span class="op">+</span> <span class="va">Murder_centered</span> <span class="op">+</span> <span class="va">Illiteracy_centered</span><span class="op">:</span><span class="va">Murder_centered</span> <span class="op">+</span> <span class="va">HS.Grad</span>,</span>
<span>  data <span class="op">=</span> <span class="va">states</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">interactionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Income ~ Illiteracy_centered + Murder_centered + 
    Illiteracy_centered:Murder_centered + HS.Grad, data = states)

Residuals:
    Min      1Q  Median      3Q     Max 
-916.27 -244.42   28.42  228.14 1221.16 

Coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                          2421.46     594.36   4.074 0.000185 ***
Illiteracy_centered                    37.12     192.56   0.193 0.848005    
Murder_centered                        17.07      25.52   0.669 0.507085    
HS.Grad                                40.76      10.92   3.733 0.000530 ***
Illiteracy_centered:Murder_centered   -97.04      35.86  -2.706 0.009584 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 459.5 on 45 degrees of freedom
Multiple R-squared:  0.4864,    Adjusted R-squared:  0.4407 
F-statistic: 10.65 on 4 and 45 DF,  p-value: 3.689e-06</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">interactionModel</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter                             | Std. Coef. |         95% CI
-------------------------------------------------------------------
(Intercept)                           |       0.24 | [-0.04,  0.53]
Illiteracy centered                   |       0.04 | [-0.35,  0.42]
Murder centered                       |       0.10 | [-0.21,  0.41]
HS Grad                               |       0.54 | [ 0.25,  0.82]
Illiteracy centered × Murder centered |      -0.36 | [-0.62, -0.09]</code></pre>
</div>
</div>
</section><section id="plots" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="plots">
<span class="header-section-number">8.3</span> Plots</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">interactions</span><span class="fu">::</span><span class="fu">interact_plot</span><span class="op">(</span></span>
<span>  <span class="va">interactionModel</span>,</span>
<span>  pred <span class="op">=</span> <span class="va">Illiteracy_centered</span>,</span>
<span>  modx <span class="op">=</span> <span class="va">Murder_centered</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-31-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="regression_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">interactions</span><span class="fu">::</span><span class="fu">interact_plot</span><span class="op">(</span></span>
<span>  <span class="va">interactionModel</span>,</span>
<span>  pred <span class="op">=</span> <span class="va">Illiteracy_centered</span>,</span>
<span>  modx <span class="op">=</span> <span class="va">Murder_centered</span>,</span>
<span>  plot.points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-31-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="regression_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">interactions</span><span class="fu">::</span><span class="fu">interact_plot</span><span class="op">(</span></span>
<span>  <span class="va">interactionModel</span>,</span>
<span>  pred <span class="op">=</span> <span class="va">Illiteracy_centered</span>,</span>
<span>  modx <span class="op">=</span> <span class="va">Murder_centered</span>,</span>
<span>  interval <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-31-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="regression_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">interactions</span><span class="fu">::</span><span class="fu">johnson_neyman</span><span class="op">(</span></span>
<span>  <span class="va">interactionModel</span>,</span>
<span>  pred <span class="op">=</span> <span class="va">Illiteracy_centered</span>,</span>
<span>  modx <span class="op">=</span> <span class="va">Murder_centered</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>JOHNSON-NEYMAN INTERVAL

When Murder_centered is OUTSIDE the interval [-8.13, 4.37], the slope of
Illiteracy_centered is p &lt; .05.

Note: The range of observed values of Murder_centered is [-5.98, 7.72]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-31-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="regression_files/figure-html/unnamed-chunk-31-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="simple-slopes-analysis" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="simple-slopes-analysis">
<span class="header-section-number">8.4</span> Simple Slopes Analysis</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">interactions</span><span class="fu">::</span><span class="fu">sim_slopes</span><span class="op">(</span></span>
<span>  <span class="va">interactionModel</span>,</span>
<span>  pred <span class="op">=</span> <span class="va">Illiteracy_centered</span>,</span>
<span>  modx <span class="op">=</span> <span class="va">Murder_centered</span>,</span>
<span>  johnson_neyman <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

Slope of Illiteracy_centered when Murder_centered = -3.69154e+00 (- 1 SD): 

    Est.     S.E.   t val.      p
-------- -------- -------- ------
  395.34   274.84     1.44   0.16

Slope of Illiteracy_centered when Murder_centered = -1.24345e-16 (Mean): 

   Est.     S.E.   t val.      p
------- -------- -------- ------
  37.12   192.56     0.19   0.85

Slope of Illiteracy_centered when Murder_centered =  3.69154e+00 (+ 1 SD): 

     Est.     S.E.   t val.      p
--------- -------- -------- ------
  -321.10   183.49    -1.75   0.09</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">interactions</span><span class="fu">::</span><span class="fu">sim_slopes</span><span class="op">(</span></span>
<span>  <span class="va">interactionModel</span>,</span>
<span>  pred <span class="op">=</span> <span class="va">Illiteracy_centered</span>,</span>
<span>  modx <span class="op">=</span> <span class="va">Murder_centered</span>,</span>
<span>  modx.values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  johnson_neyman <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

Slope of Illiteracy_centered when Murder_centered =  0.00: 

   Est.     S.E.   t val.      p
------- -------- -------- ------
  37.12   192.56     0.19   0.85

Slope of Illiteracy_centered when Murder_centered =  5.00: 

     Est.     S.E.   t val.      p
--------- -------- -------- ------
  -448.07   202.17    -2.22   0.03

Slope of Illiteracy_centered when Murder_centered = 10.00: 

     Est.     S.E.   t val.      p
--------- -------- -------- ------
  -933.27   330.10    -2.83   0.01</code></pre>
</div>
</div>
</section><section id="johnson-neyman-intervals" class="level2" data-number="8.5"><h2 data-number="8.5" class="anchored" data-anchor-id="johnson-neyman-intervals">
<span class="header-section-number">8.5</span> Johnson-Neyman intervals</h2>
<p>Indicates all the values of the moderator for which the slope of the predictor is statistically significant.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">interactions</span><span class="fu">::</span><span class="fu">sim_slopes</span><span class="op">(</span></span>
<span>  <span class="va">interactionModel</span>,</span>
<span>  pred <span class="op">=</span> <span class="va">Illiteracy_centered</span>,</span>
<span>  modx <span class="op">=</span> <span class="va">Murder_centered</span>,</span>
<span>  johnson_neyman <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>JOHNSON-NEYMAN INTERVAL

When Murder_centered is OUTSIDE the interval [-8.13, 4.37], the slope of
Illiteracy_centered is p &lt; .05.

Note: The range of observed values of Murder_centered is [-5.98, 7.72]

SIMPLE SLOPES ANALYSIS

Slope of Illiteracy_centered when Murder_centered = -3.69154e+00 (- 1 SD): 

    Est.     S.E.   t val.      p
-------- -------- -------- ------
  395.34   274.84     1.44   0.16

Slope of Illiteracy_centered when Murder_centered = -1.24345e-16 (Mean): 

   Est.     S.E.   t val.      p
------- -------- -------- ------
  37.12   192.56     0.19   0.85

Slope of Illiteracy_centered when Murder_centered =  3.69154e+00 (+ 1 SD): 

     Est.     S.E.   t val.      p
--------- -------- -------- ------
  -321.10   183.49    -1.75   0.09</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">interactions</span><span class="fu">::</span><span class="fu">probe_interaction</span><span class="op">(</span></span>
<span>  <span class="va">interactionModel</span>,</span>
<span>  pred <span class="op">=</span> <span class="va">Illiteracy_centered</span>,</span>
<span>  modx <span class="op">=</span> <span class="va">Murder_centered</span>,</span>
<span>  cond.int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  jnplot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>JOHNSON-NEYMAN INTERVAL

When Murder_centered is OUTSIDE the interval [-8.13, 4.37], the slope of
Illiteracy_centered is p &lt; .05.

Note: The range of observed values of Murder_centered is [-5.98, 7.72]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-33-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="regression_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

When Murder_centered = -3.69154e+00 (- 1 SD): 

                                        Est.     S.E.   t val.      p
---------------------------------- --------- -------- -------- ------
Slope of Illiteracy_centered          395.34   274.84     1.44   0.16
Conditional intercept                4523.23   134.99    33.51   0.00

When Murder_centered = -1.24345e-16 (Mean): 

                                        Est.     S.E.   t val.      p
---------------------------------- --------- -------- -------- ------
Slope of Illiteracy_centered           37.12   192.56     0.19   0.85
Conditional intercept                4586.22    85.52    53.63   0.00

When Murder_centered =  3.69154e+00 (+ 1 SD): 

                                        Est.     S.E.   t val.      p
---------------------------------- --------- -------- -------- ------
Slope of Illiteracy_centered         -321.10   183.49    -1.75   0.09
Conditional intercept                4649.22   118.97    39.08   0.00</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-33-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="regression_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section></section><section id="sec-compareCorrelations" class="level1" data-number="9"><h1 data-number="9">
<span class="header-section-number">9</span> Comparing Correlations</h1>
<p>Fisher’s <em>r</em>-to-<em>z</em> test.</p>
<p><a href="http://comparingcorrelations.org" class="uri">http://comparingcorrelations.org</a> (archived at <a href="https://perma.cc/X3EU-24GL" class="uri">https://perma.cc/X3EU-24GL</a>)</p>
<p>Independent groups (two different groups):</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">cocor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cocor/man/cocor.indep.groups.html">cocor.indep.groups</a></span><span class="op">(</span></span>
<span>  r1.jk <span class="op">=</span> <span class="fl">.7</span>,</span>
<span>  r2.hm <span class="op">=</span> <span class="fl">.6</span>,</span>
<span>  n1 <span class="op">=</span> <span class="fl">305</span>,</span>
<span>  n2 <span class="op">=</span> <span class="fl">210</span>,</span>
<span>  data.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"group1"</span>, <span class="st">"group2"</span><span class="op">)</span>,</span>
<span>  var.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"intelligence"</span>, <span class="st">"age"</span>, <span class="st">"intelligence"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  Results of a comparison of two correlations based on independent groups

Comparison between r1.jk (age, intelligence) = 0.7 and r2.hm (age, intelligence) = 0.6
Difference: r1.jk - r2.hm = 0.1
Data: group1: j = age, k = intelligence; group2: h = age, m = intelligence
Group sizes: n1 = 305, n2 = 210
Null hypothesis: r1.jk is equal to r2.hm
Alternative hypothesis: r1.jk is not equal to r2.hm (two-sided)
Alpha: 0.05

fisher1925: Fisher's z (1925)
  z = 1.9300, p-value = 0.0536
  Null hypothesis retained

zou2007: Zou's (2007) confidence interval
  95% confidence interval for r1.jk - r2.hm: -0.0014 0.2082
  Null hypothesis retained (Interval includes 0)</code></pre>
</div>
</div>
<p>Dependent groups (same group), overlapping correlation (shares a variable in common—in this case, the variable <code>age</code> is shared in both correlations):</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">cocor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cocor/man/cocor.dep.groups.overlap.html">cocor.dep.groups.overlap</a></span><span class="op">(</span></span>
<span>  r.jk <span class="op">=</span> <span class="fl">.2</span>, <span class="co"># Correlation (age, intelligence)</span></span>
<span>  r.jh <span class="op">=</span> <span class="fl">.5</span>, <span class="co"># Correlation (age, shoe size)</span></span>
<span>  r.kh <span class="op">=</span> <span class="fl">.1</span>, <span class="co"># Correlation (intelligence, shoe index)</span></span>
<span>  n <span class="op">=</span> <span class="fl">315</span>,</span>
<span>  var.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"intelligence"</span>, <span class="st">"shoe size"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  Results of a comparison of two overlapping correlations based on dependent groups

Comparison between r.jk (age, intelligence) = 0.2 and r.jh (age, shoe size) = 0.5
Difference: r.jk - r.jh = -0.3
Related correlation: r.kh = 0.1
Data: j = age, k = intelligence, h = shoe size
Group size: n = 315
Null hypothesis: r.jk is equal to r.jh
Alternative hypothesis: r.jk is not equal to r.jh (two-sided)
Alpha: 0.05

pearson1898: Pearson and Filon's z (1898)
  z = -4.4807, p-value = 0.0000
  Null hypothesis rejected

hotelling1940: Hotelling's t (1940)
  t = -4.6314, df = 312, p-value = 0.0000
  Null hypothesis rejected

williams1959: Williams' t (1959)
  t = -4.4950, df = 312, p-value = 0.0000
  Null hypothesis rejected

olkin1967: Olkin's z (1967)
  z = -4.4807, p-value = 0.0000
  Null hypothesis rejected

dunn1969: Dunn and Clark's z (1969)
  z = -4.4412, p-value = 0.0000
  Null hypothesis rejected

hendrickson1970: Hendrickson, Stanley, and Hills' (1970) modification of Williams' t (1959)
  t = -4.6313, df = 312, p-value = 0.0000
  Null hypothesis rejected

steiger1980: Steiger's (1980) modification of Dunn and Clark's z (1969) using average correlations
  z = -4.4152, p-value = 0.0000
  Null hypothesis rejected

meng1992: Meng, Rosenthal, and Rubin's z (1992)
  z = -4.3899, p-value = 0.0000
  Null hypothesis rejected
  95% confidence interval for r.jk - r.jh: -0.5013 -0.1918
  Null hypothesis rejected (Interval does not include 0)

hittner2003: Hittner, May, and Silver's (2003) modification of Dunn and Clark's z (1969) using a backtransformed average Fisher's (1921) Z procedure
  z = -4.4077, p-value = 0.0000
  Null hypothesis rejected

zou2007: Zou's (2007) confidence interval
  95% confidence interval for r.jk - r.jh: -0.4307 -0.1675
  Null hypothesis rejected (Interval does not include 0)</code></pre>
</div>
</div>
<p>Dependent groups (same group), non-overlapping correlation (does not share a variable in common):</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">cocor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cocor/man/cocor.dep.groups.nonoverlap.html">cocor.dep.groups.nonoverlap</a></span><span class="op">(</span></span>
<span>  r.jk <span class="op">=</span> <span class="fl">.2</span>, <span class="co"># Correlation (age, intelligence)</span></span>
<span>  r.hm <span class="op">=</span> <span class="fl">.7</span>, <span class="co"># Correlation (body mass index, shoe size)</span></span>
<span>  r.jh <span class="op">=</span> <span class="fl">.4</span>, <span class="co"># Correlation (age, body mass index)</span></span>
<span>  r.jm <span class="op">=</span> <span class="fl">.5</span>, <span class="co"># Correlation (age, shoe size)</span></span>
<span>  r.kh <span class="op">=</span> <span class="fl">.1</span>, <span class="co"># Correlation (intelligence, body mass index)</span></span>
<span>  r.km <span class="op">=</span> <span class="fl">.3</span>, <span class="co"># Correlation (intelligence, shoe size)</span></span>
<span>  n <span class="op">=</span> <span class="fl">232</span>,</span>
<span>  var.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"intelligence"</span>, <span class="st">"body mass index"</span>, <span class="st">"shoe size"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  Results of a comparison of two nonoverlapping correlations based on dependent groups

Comparison between r.jk (age, intelligence) = 0.2 and r.hm (body mass index, shoe size) = 0.7
Difference: r.jk - r.hm = -0.5
Related correlations: r.jh = 0.4, r.jm = 0.5, r.kh = 0.1, r.km = 0.3
Data: j = age, k = intelligence, h = body mass index, m = shoe size
Group size: n = 232
Null hypothesis: r.jk is equal to r.hm
Alternative hypothesis: r.jk is not equal to r.hm (two-sided)
Alpha: 0.05

pearson1898: Pearson and Filon's z (1898)
  z = -7.1697, p-value = 0.0000
  Null hypothesis rejected

dunn1969: Dunn and Clark's z (1969)
  z = -7.3134, p-value = 0.0000
  Null hypothesis rejected

steiger1980: Steiger's (1980) modification of Dunn and Clark's z (1969) using average correlations
  z = -7.3010, p-value = 0.0000
  Null hypothesis rejected

raghunathan1996: Raghunathan, Rosenthal, and Rubin's (1996) modification of Pearson and Filon's z (1898)
  z = -7.3134, p-value = 0.0000
  Null hypothesis rejected

silver2004: Silver, Hittner, and May's (2004) modification of Dunn and Clark's z (1969) using a backtransformed average Fisher's (1921) Z procedure
  z = -7.2737, p-value = 0.0000
  Null hypothesis rejected

zou2007: Zou's (2007) confidence interval
  95% confidence interval for r.jk - r.hm: -0.6375 -0.3629
  Null hypothesis rejected (Interval does not include 0)</code></pre>
</div>
</div>
</section><section id="sec-missingness" class="level1" data-number="10"><h1 data-number="10">
<span class="header-section-number">10</span> Approaches to Handling Missingness</h1>
<section id="sec-listwiseDeletion" class="level2" data-number="10.1"><h2 data-number="10.1" class="anchored" data-anchor-id="sec-listwiseDeletion">
<span class="header-section-number">10.1</span> Listwise deletion</h2>
<p>Listwise deletion deletes every row in the data file that has a missing value for one of the model variables.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">listwiseDeletionModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">listwiseDeletionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.3755 -1.2337 -0.2212  0.9911 12.8017 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              1.19830    0.05983  20.029  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.979 on 2871 degrees of freedom
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.262, Adjusted R-squared:  0.2615 
F-statistic: 509.6 on 2 and 2871 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">listwiseDeletionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                            2.5 %    97.5 %
(Intercept)             1.0809881 1.3156128
bpi_antisocialT1Sum     0.4290884 0.5019688
bpi_anxiousDepressedSum 0.1035825 0.2179258</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="va">listwiseDeletionModel</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |        95% CI
----------------------------------------------------
(Intercept)             |   1.62e-16 | [-0.03, 0.03]
bpi antisocialT1Sum     |       0.46 | [ 0.42, 0.49]
bpi anxiousDepressedSum |       0.10 | [ 0.06, 0.14]</code></pre>
</div>
</div>
</section><section id="sec-pairwiseDeletion" class="level2" data-number="10.2"><h2 data-number="10.2" class="anchored" data-anchor-id="sec-pairwiseDeletion">
<span class="header-section-number">10.2</span> Pairwise deletion</h2>
<p>Also see here:</p>
<ul>
<li>
<a href="https://stats.stackexchange.com/questions/158366/fit-multiple-regression-model-with-pairwise-deletion-or-on-a-correlation-covari/173002#173002" class="uri">https://stats.stackexchange.com/questions/158366/fit-multiple-regression-model-with-pairwise-deletion-or-on-a-correlation-covari/173002#173002</a> (archived at <a href="https://perma.cc/GH5T-RXD9" class="uri">https://perma.cc/GH5T-RXD9</a>)</li>
<li>
<a href="https://stats.stackexchange.com/questions/299792/r-lm-covariance-matrix-manual-calculation-failure" class="uri">https://stats.stackexchange.com/questions/299792/r-lm-covariance-matrix-manual-calculation-failure</a> (archived at <a href="https://perma.cc/F7EL-AUFZ" class="uri">https://perma.cc/F7EL-AUFZ</a>)</li>
<li>
<a href="https://stats.stackexchange.com/questions/107597/is-there-a-way-to-use-the-covariance-matrix-to-find-coefficients-for-multiple-re" class="uri">https://stats.stackexchange.com/questions/107597/is-there-a-way-to-use-the-covariance-matrix-to-find-coefficients-for-multiple-re</a> (archived at <a href="https://perma.cc/KU3X-FB2C" class="uri">https://perma.cc/KU3X-FB2C</a>)</li>
<li>
<a href="https://stats.stackexchange.com/questions/105006/how-to-perform-a-bivariate-regression-using-pairwise-deletion-of-missing-values" class="uri">https://stats.stackexchange.com/questions/105006/how-to-perform-a-bivariate-regression-using-pairwise-deletion-of-missing-values</a> (archived at <a href="https://perma.cc/QWQ5-2TLW" class="uri">https://perma.cc/QWQ5-2TLW</a>)</li>
<li>
<a href="https://dl.dropboxusercontent.com/s/4sf0et3p47ykctx/MissingPairwise.sps" class="uri">https://dl.dropboxusercontent.com/s/4sf0et3p47ykctx/MissingPairwise.sps</a> (archived at <a href="https://perma.cc/UC4K-2L9T" class="uri">https://perma.cc/UC4K-2L9T</a>)</li>
</ul>
<p>Adapted from here: <a href="https://stefvanbuuren.name/fimd/sec-simplesolutions.html#sec:pairwise" class="uri">https://stefvanbuuren.name/fimd/sec-simplesolutions.html#sec:pairwise</a> (archived at <a href="https://perma.cc/EGU6-3M3Q" class="uri">https://perma.cc/EGU6-3M3Q</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelData</span> <span class="op">&lt;-</span> <span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bpi_antisocialT2Sum"</span>,<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">varMeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">modelData</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">varCovariances</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">modelData</span>, use <span class="op">=</span> <span class="st">"pairwise"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pairwiseRegression_syntax</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum</span></span>
<span><span class="st">  bpi_antisocialT2Sum ~~ bpi_antisocialT2Sum</span></span>
<span><span class="st">  bpi_antisocialT2Sum ~ 1</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="va">pairwiseRegression_fit</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html">lavaan</a></span><span class="op">(</span></span>
<span>  <span class="va">pairwiseRegression_syntax</span>,</span>
<span>  sample.mean <span class="op">=</span> <span class="va">varMeans</span>,</span>
<span>  sample.cov <span class="op">=</span> <span class="va">varCovariances</span>,</span>
<span>  sample.nobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">modelData</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span></span>
<span>  <span class="va">pairwiseRegression_fit</span>,</span>
<span>  standardized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rsquare <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         4

  Number of observations                          2874

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                        Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  bpi_antisocialT2Sum ~                                                      
    bpi_antsclT1Sm         0.441    0.018   24.611    0.000    0.441    0.456
    bp_nxsDprssdSm         0.137    0.028    4.854    0.000    0.137    0.090

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .bpi_antsclT2Sm    1.175    0.058   20.125    0.000    1.175    0.523

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .bpi_antsclT2Sm    3.755    0.099   37.908    0.000    3.755    0.743

R-Square:
                   Estimate
    bpi_antsclT2Sm    0.257</code></pre>
</div>
</div>
</section><section id="sec-fiml" class="level2" data-number="10.3"><h2 data-number="10.3" class="anchored" data-anchor-id="sec-fiml">
<span class="header-section-number">10.3</span> Full-information maximum likelihood (FIML)</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fimlRegression_syntax</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum</span></span>
<span><span class="st">  bpi_antisocialT2Sum ~~ bpi_antisocialT2Sum</span></span>
<span><span class="st">  bpi_antisocialT2Sum ~ 1</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="va">fimlRegression_fit</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html">lavaan</a></span><span class="op">(</span></span>
<span>  <span class="va">fimlRegression_syntax</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  missing <span class="op">=</span> <span class="st">"ML"</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span></span>
<span>  <span class="va">fimlRegression_fit</span>,</span>
<span>  standardized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rsquare <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 11 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         4

                                                  Used       Total
  Number of observations                          3914       11530
  Number of missing patterns                         2            

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Regressions:
                        Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  bpi_antisocialT2Sum ~                                                      
    bpi_antsclT1Sm         0.466    0.019   25.062    0.000    0.466    0.466
    bp_nxsDprssdSm         0.161    0.029    5.516    0.000    0.161    0.102

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .bpi_antsclT2Sm    1.198    0.060   20.039    0.000    1.198    0.516

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .bpi_antsclT2Sm    3.911    0.103   37.908    0.000    3.911    0.725

R-Square:
                   Estimate
    bpi_antsclT2Sm    0.275</code></pre>
</div>
</div>
</section><section id="sec-imputation" class="level2" data-number="10.4"><h2 data-number="10.4" class="anchored" data-anchor-id="sec-imputation">
<span class="header-section-number">10.4</span> Multiple imputation</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelData_imputed</span> <span class="op">&lt;-</span> <span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/mice.html">mice</a></span><span class="op">(</span></span>
<span>  <span class="va">modelData</span>,</span>
<span>  m <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"pmm"</span><span class="op">)</span> <span class="co"># predictive mean matching; can choose among many methods</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  1   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  1   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  1   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  1   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  2   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  2   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  2   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  2   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  2   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  3   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  3   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  3   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  3   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  3   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  4   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  4   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  4   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  4   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  4   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  5   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  5   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  5   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  5   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  5   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">imputedData_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span></span>
<span>  <span class="va">modelData_imputed</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">imputedData_pooledEstimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/pool.html">pool</a></span><span class="op">(</span><span class="va">imputedData_fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">imputedData_pooledEstimates</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["fct"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"1.2739358","3":"0.24220517","4":"5.259738","5":"4.021269","6":"0.006164190"},{"1":"bpi_antisocialT1Sum","2":"0.3970312","3":"0.07459691","4":"5.322354","5":"4.043767","6":"0.005815087"},{"1":"bpi_anxiousDepressedSum","2":"0.1703248","3":"0.06522080","4":"2.611510","5":"4.458482","6":"0.053234123"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="sec-squaredSemiPartialCorrelation" class="level1" data-number="11"><h1 data-number="11">
<span class="header-section-number">11</span> Squared Semi-Partial Correlation (<span class="math inline">\(sr^2\)</span>)</h1>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb140"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">rockchalk</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rockchalk/man/getDeltaRsquare.html">getDeltaRsquare</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>The deltaR-square values: the change in the R-square
      observed when a single term is removed.
Same as the square of the 'semi-partial correlation coefficient'
                        deltaRsquare
bpi_antisocialT1Sum      0.161297120
bpi_anxiousDepressedSum  0.007813728</code></pre>
</div>
</div>
</section><section id="sec-partialRegressionPlot" class="level1" data-number="12"><h1 data-number="12">
<span class="header-section-number">12</span> Partial Regression Plot</h1>
<p>A partial regression plot (aka added-variable) examines the association between the predictor and the outcome after controlling for the covariates.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb142"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/avPlots.html">avPlots</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-42-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="regression_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Manually:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># DV residuals (outcome residualized on covariates)</span></span>
<span><span class="va">ry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span>, </span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>, na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predictor residuals (focal predictor residualized on covariates)</span></span>
<span><span class="va">rx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_anxiousDepressedSum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>, na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the partial regression plot</span></span>
<span><span class="va">df_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">rx</span>, <span class="va">ry</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df_plot</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rx</span>, y <span class="op">=</span> <span class="va">ry</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Residualized bpi_antisocialT1Sum"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Residualized bpi_antisocialT2Sum"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Partial Regression Plot\nbpi_antisocialT2Sum ~ bpi_antisocialT1Sum controlling for bpi_anxiousDepressedSum"</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-43-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="regression_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="sec-dominanceAnalysis" class="level1" data-number="13"><h1 data-number="13">
<span class="header-section-number">13</span> Dominance Analysis</h1>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">parameters</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/dominance_analysis.html">dominance_analysis</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Dominance Analysis Results

Model R2 Value:  0.262 

General Dominance Statistics

Parameter               | General Dominance | Percent | Ranks |                  Subset
---------------------------------------------------------------------------------------
(Intercept)             |                   |         |       |                constant
bpi_antisocialT1Sum     |             0.208 |   0.793 |     1 |     bpi_antisocialT1Sum
bpi_anxiousDepressedSum |             0.054 |   0.207 |     2 | bpi_anxiousDepressedSum

Conditional Dominance Statistics

Subset                  | IVs: 1 | IVs: 2
-----------------------------------------
bpi_antisocialT1Sum     |  0.254 |  0.161
bpi_anxiousDepressedSum |  0.101 |  0.008

Complete Dominance Designations

Subset                  | &lt; bpi_antisocialT1Sum | &lt; bpi_anxiousDepressedSum
---------------------------------------------------------------------------
bpi_antisocialT1Sum     |                       |                     FALSE
bpi_anxiousDepressedSum |                  TRUE |                          </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">allPossibleSubsetsRegression</span> <span class="op">&lt;-</span> <span class="fu">yhat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yhat/man/aps.html">aps</a></span><span class="op">(</span></span>
<span>  dataMatrix <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  dv <span class="op">=</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span>  ivlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"bpi_antisocialT1Sum"</span>, <span class="st">"bpi_anxiousDepressedSum"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">yhat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yhat/man/dominance.html">dominance</a></span><span class="op">(</span><span class="va">allPossibleSubsetsRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$DA
                                            k        R2 bpi_antisocialT1Sum.Inc
bpi_antisocialT1Sum                         1 0.2541698                      NA
bpi_anxiousDepressedSum                     1 0.1006864               0.1612971
bpi_antisocialT1Sum,bpi_anxiousDepressedSum 2 0.2619835                      NA
                                            bpi_anxiousDepressedSum.Inc
bpi_antisocialT1Sum                                         0.007813728
bpi_anxiousDepressedSum                                              NA
bpi_antisocialT1Sum,bpi_anxiousDepressedSum                          NA

$CD
     bpi_antisocialT1Sum bpi_anxiousDepressedSum
CD:0           0.2541698             0.100686422
CD:1           0.1612971             0.007813728

$GD
    bpi_antisocialT1Sum bpi_anxiousDepressedSum 
             0.20773347              0.05425008 </code></pre>
</div>
</div>
</section><section id="sec-commonalityAnalysis" class="level1" data-number="14"><h1 data-number="14">
<span class="header-section-number">14</span> Commonality Analysis</h1>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb148"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">yhat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yhat/man/calc.yhat.html">calc.yhat</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$PredictorMetrics
                            b  Beta     r    rs   rs2 Unique Common  CD:0  CD:1
bpi_antisocialT1Sum     0.466 0.456 0.504 0.985 0.970  0.161  0.093 0.254 0.161
bpi_anxiousDepressedSum 0.161 0.100 0.317 0.620 0.384  0.008  0.093 0.101 0.008
Total                      NA    NA    NA    NA 1.354  0.169  0.186 0.355 0.169
                        GenDom Pratt   RLW
bpi_antisocialT1Sum      0.208 0.230 0.208
bpi_anxiousDepressedSum  0.054 0.032 0.054
Total                    0.262 0.262 0.262

$OrderedPredictorMetrics
                        b Beta r rs rs2 Unique Common CD:0 CD:1 GenDom Pratt
bpi_antisocialT1Sum     1    1 1  1   1      1      1    1    1      1     1
bpi_anxiousDepressedSum 2    2 2  2   2      2      2    2    2      2     2
                        RLW
bpi_antisocialT1Sum       1
bpi_anxiousDepressedSum   2

$PairedDominanceMetrics
                                            Comp Cond Gen
bpi_antisocialT1Sum&gt;bpi_anxiousDepressedSum    1    1   1

$APSRelatedMetrics
                                            Commonality  % Total    R2
bpi_antisocialT1Sum                               0.161    0.616 0.254
bpi_anxiousDepressedSum                           0.008    0.030 0.101
bpi_antisocialT1Sum,bpi_anxiousDepressedSum       0.093    0.354 0.262
Total                                             0.262    1.000    NA
                                            bpi_antisocialT1Sum.Inc
bpi_antisocialT1Sum                                              NA
bpi_anxiousDepressedSum                                       0.161
bpi_antisocialT1Sum,bpi_anxiousDepressedSum                      NA
Total                                                            NA
                                            bpi_anxiousDepressedSum.Inc
bpi_antisocialT1Sum                                               0.008
bpi_anxiousDepressedSum                                              NA
bpi_antisocialT1Sum,bpi_anxiousDepressedSum                          NA
Total                                                                NA</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">allPossibleSubsetsRegression</span> <span class="op">&lt;-</span> <span class="fu">yhat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yhat/man/aps.html">aps</a></span><span class="op">(</span></span>
<span>  dataMatrix <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  dv <span class="op">=</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span>  ivlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"bpi_antisocialT1Sum"</span>, <span class="st">"bpi_anxiousDepressedSum"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">yhat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yhat/man/commonality.html">commonality</a></span><span class="op">(</span><span class="va">allPossibleSubsetsRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                                            Coefficient    % Total
bpi_antisocialT1Sum                         0.161297120 0.61567654
bpi_anxiousDepressedSum                     0.007813728 0.02982526
bpi_antisocialT1Sum,bpi_anxiousDepressedSum 0.092872694 0.35449820</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb152"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">commonalityAnalysis</span> <span class="op">&lt;-</span> <span class="fu">yhat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yhat/man/commonalityCoefficients.html">commonalityCoefficients</a></span><span class="op">(</span></span>
<span>  dataMatrix <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  dv <span class="op">=</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span>  ivlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"bpi_antisocialT1Sum"</span>, <span class="st">"bpi_anxiousDepressedSum"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">commonalityAnalysis</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$CC
                                                           Coefficient
Unique to bpi_antisocialT1Sum                                   0.1613
Unique to bpi_anxiousDepressedSum                               0.0078
Common to bpi_antisocialT1Sum, and bpi_anxiousDepressedSum      0.0929
Total                                                           0.2620
                                                               % Total
Unique to bpi_antisocialT1Sum                                    61.57
Unique to bpi_anxiousDepressedSum                                 2.98
Common to bpi_antisocialT1Sum, and bpi_anxiousDepressedSum       35.45
Total                                                           100.00

$CCTotalbyVar
                        Unique Common  Total
bpi_antisocialT1Sum     0.1613 0.0929 0.2542
bpi_anxiousDepressedSum 0.0078 0.0929 0.1007</code></pre>
</div>
</div>
</section><section id="model-building-steps" class="level1" data-number="15"><h1 data-number="15">
<span class="header-section-number">15</span> Model Building Steps</h1>
<ol type="1">
<li>Examine extent and type of missing data, consider <a href="#sec-missingness">how to handle missing values</a> (<a href="#imputation">multiple imputation</a>, <a href="#sec-fiml">FIML</a>, <a href="#sec-pairwiseDeletion">pairwise deletion</a>, <a href="#sec-listwiseDeletion">listwise deletion</a>)
<ul>
<li>Little’s MCAR test from <code>mcar_test()</code> function of the <code>njtierney/naniar</code> package</li>
<li>Bayesian handling of missing data: <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_missings.html" class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_missings.html</a> (archived at <a href="https://perma.cc/Z4HT-QXWR" class="uri">https://perma.cc/Z4HT-QXWR</a>)</li>
</ul>
</li>
<li>Examine descriptive statistics, consider variable transformations</li>
<li>Examine scatterplot matrix to examine whether associations between predictor and outcomes are linear or nonlinear</li>
<li>Model building: theory and empiricism (stepwise regression, likelihood ratio tests, k-fold cross validation to check for over-fitting compared to simpler model)</li>
<li>Test assumptions
<ul>
<li>Examine whether predictors have linear association with outcome (Residual Plots, Marginal Model Plots, Added-Variable Plots—check for non-horizontal lines)</li>
<li>Examine whether residuals have constant variance across levels of outcome and predictors Residual Plots, Spread-Level Plots—check for fan-shaped plot or other increasing/decreasing structure)</li>
<li>Examine whether predictors show multicollinearity (VIF)</li>
<li>Examine whether residuals are normally distributed (QQ plot and density plot)</li>
<li>Examine influence of influential observations (high outlyingness and leverage) on parameter stimates by iteratively removing influential observations and refitting (Added-Variable Plots)</li>
</ul>
</li>
<li>Handle violated assumptions, select final set of predictors/outcomes and transformation of each</li>
<li>Use k-fold cross validation to identify the best estimation procedure (OLS, MM, or LTS) on the final model</li>
<li>Use identified estimation procedure to fit final model and determine the best parameter point estimates</li>
<li>Calculate bootstrapped estimates to determine the confidence intervals around the parameter estimates of the final model</li>
</ol></section><section id="bootstrapped-estimates" class="level1" data-number="16"><h1 data-number="16">
<span class="header-section-number">16</span> Bootstrapped Estimates</h1>
<p>To determine the confidence intervals of parameter estimates</p>
<section id="linear-regression-1" class="level2" data-number="16.1"><h2 data-number="16.1" class="anchored" data-anchor-id="linear-regression-1">
<span class="header-section-number">16.1</span> Linear Regression</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">multipleRegressionModelBootstrapped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Boot.html">Boot</a></span><span class="op">(</span><span class="va">multipleRegressionModelNoMissing</span>, R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">multipleRegressionModelBootstrapped</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["R"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["original"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["bootBias"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["bootSE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["bootMed"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1000","2":"1.1983004","3":"-1.453995e-05","4":"0.06309435","5":"1.1961315","_rn_":"(Intercept)"},{"1":"1000","2":"0.4655286","3":"7.331947e-04","4":"0.02333470","5":"0.4654838","_rn_":"bpi_antisocialT1Sum"},{"1":"1000","2":"0.1607541","3":"-1.539172e-03","4":"0.03241759","5":"0.1588251","_rn_":"bpi_anxiousDepressedSum"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb155"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">multipleRegressionModelBootstrapped</span>, level <span class="op">=</span> <span class="fl">.95</span>, type <span class="op">=</span> <span class="st">"bca"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Bootstrap percent confidence intervals

                             2.5 %    97.5 %
(Intercept)             1.07603757 1.3211174
bpi_antisocialT1Sum     0.42396203 0.5121889
bpi_anxiousDepressedSum 0.09785392 0.2244764</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb157"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">multipleRegressionModelBootstrapped</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-47-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="regression_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="generalized-regression" class="level2" data-number="16.2"><h2 data-number="16.2" class="anchored" data-anchor-id="generalized-regression">
<span class="header-section-number">16.2</span> Generalized Regression</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">generalizedRegressionModelBootstrapped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Boot.html">Boot</a></span><span class="op">(</span><span class="va">multipleRegressionModelNoMissing</span>, R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">generalizedRegressionModelBootstrapped</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["R"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["original"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["bootBias"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["bootSE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["bootMed"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1000","2":"1.1983004","3":"0.0012203102","4":"0.06124432","5":"1.1994118","_rn_":"(Intercept)"},{"1":"1000","2":"0.4655286","3":"0.0001763300","4":"0.02258108","5":"0.4653653","_rn_":"bpi_antisocialT1Sum"},{"1":"1000","2":"0.1607541","3":"-0.0006661964","4":"0.03252041","5":"0.1614111","_rn_":"bpi_anxiousDepressedSum"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb159"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">generalizedRegressionModelBootstrapped</span>, level <span class="op">=</span> <span class="fl">.95</span>, type <span class="op">=</span> <span class="st">"bca"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Bootstrap percent confidence intervals

                             2.5 %    97.5 %
(Intercept)             1.07979774 1.3158442
bpi_antisocialT1Sum     0.42267260 0.5137521
bpi_anxiousDepressedSum 0.09678506 0.2275173</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb161"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">generalizedRegressionModelBootstrapped</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-48-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="regression_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section></section><section id="cross-validation" class="level1" data-number="17"><h1 data-number="17">
<span class="header-section-number">17</span> Cross Validation</h1>
<p>To examine degree of prediction error and over-fitting to determine best model</p>
<p><a href="https://stats.stackexchange.com/questions/103459/how-do-i-know-which-method-of-cross-validation-is-best" class="uri">https://stats.stackexchange.com/questions/103459/how-do-i-know-which-method-of-cross-validation-is-best</a> (archived at <a href="https://perma.cc/38BL-KLRJ" class="uri">https://perma.cc/38BL-KLRJ</a>)</p>
<section id="k-fold-cross-validation" class="level2" data-number="17.1"><h2 data-number="17.1" class="anchored" data-anchor-id="k-fold-cross-validation">
<span class="header-section-number">17.1</span> K-fold cross validation</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb162"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kFolds</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">replications</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cvTools/man/cvFolds.html">cvFolds</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span>, K <span class="op">=</span> <span class="va">kFolds</span>, R <span class="op">=</span> <span class="va">replications</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fitLm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="st">"na.exclude"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fitLmrob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/robustbase/man/lmrob.html">lmrob</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="st">"na.exclude"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fitLts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/robustbase/man/ltsReg.html">ltsReg</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="st">"na.exclude"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cvFitLm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cvTools/man/repCV.html">cvLm</a></span><span class="op">(</span></span>
<span>  <span class="va">fitLm</span>,</span>
<span>  K <span class="op">=</span> <span class="va">kFolds</span>,</span>
<span>  R <span class="op">=</span> <span class="va">replications</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cvFitLmrob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cvTools/man/repCV.html">cvLmrob</a></span><span class="op">(</span></span>
<span>  <span class="va">fitLmrob</span>,</span>
<span>  K <span class="op">=</span> <span class="va">kFolds</span>,</span>
<span>  R <span class="op">=</span> <span class="va">replications</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cvFitLts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cvTools/man/repCV.html">cvLts</a></span><span class="op">(</span></span>
<span>  <span class="va">fitLts</span>,</span>
<span>  K <span class="op">=</span> <span class="va">kFolds</span>,</span>
<span>  R <span class="op">=</span> <span class="va">replications</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cvFits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cvTools/man/cvSelect.html">cvSelect</a></span><span class="op">(</span></span>
<span>  OLS <span class="op">=</span> <span class="va">cvFitLm</span>,</span>
<span>  MM <span class="op">=</span> <span class="va">cvFitLmrob</span>,</span>
<span>  LTS <span class="op">=</span> <span class="va">cvFitLts</span><span class="op">)</span></span>
<span><span class="va">cvFits</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
10-fold CV results:
  Fit       CV
1 OLS 1.980362
2  MM 1.026706
3 LTS 1.007042

Best model:
   CV 
"LTS" </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb164"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">bwplot</a></span><span class="op">(</span></span>
<span>  <span class="va">cvFits</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Root Mean Square Error"</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">cvFits</span><span class="op">$</span><span class="va">cv</span><span class="op">$</span><span class="va">CV</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-49-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="regression_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section></section><section id="examining-model-fits" class="level1" data-number="18"><h1 data-number="18">
<span class="header-section-number">18</span> Examining Model Fits</h1>
<section id="effect-plots" class="level2" data-number="18.1"><h2 data-number="18.1" class="anchored" data-anchor-id="effect-plots">
<span class="header-section-number">18.1</span> Effect Plots</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb165"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">allEffects</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> model: bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum

 bpi_antisocialT1Sum effect
bpi_antisocialT1Sum
       0      3.2      6.5      9.8       13 
1.394591 2.884283 4.420527 5.956772 7.446463 

 bpi_anxiousDepressedSum effect
bpi_anxiousDepressedSum
       0        2        4        6        8 
2.502636 2.824145 3.145653 3.467161 3.788669 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb167"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">allEffects</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-50-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="regression_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="confidence-ellipses" class="level2" data-number="18.2"><h2 data-number="18.2" class="anchored" data-anchor-id="confidence-ellipses">
<span class="header-section-number">18.2</span> Confidence Ellipses</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb168"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Ellipses.html">confidenceEllipse</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">.95</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-51-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="regression_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="data-ellipse" class="level2" data-number="18.3"><h2 data-number="18.3" class="anchored" data-anchor-id="data-ellipse">
<span class="header-section-number">18.3</span> Data Ellipse</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb169"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata_nomissing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Ellipses.html">dataEllipse</a></span><span class="op">(</span></span>
<span>  <span class="va">mydata_nomissing</span><span class="op">$</span><span class="va">bpi_antisocialT1Sum</span>,</span>
<span>  <span class="va">mydata_nomissing</span><span class="op">$</span><span class="va">bpi_antisocialT2Sum</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">.95</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-52-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="regression_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section></section><section id="diagnostics" class="level1" data-number="19"><h1 data-number="19">
<span class="header-section-number">19</span> Diagnostics</h1>
<section id="assumptions" class="level2" data-number="19.1"><h2 data-number="19.1" class="anchored" data-anchor-id="assumptions">
<span class="header-section-number">19.1</span> Assumptions</h2>
<section id="sec-linearAssociation" class="level3" data-number="19.1.1"><h3 data-number="19.1.1" class="anchored" data-anchor-id="sec-linearAssociation">
<span class="header-section-number">19.1.1</span> 1. Linear relation between predictors and outcome</h3>
<section id="ways-to-test" class="level4" data-number="19.1.1.1"><h4 data-number="19.1.1.1" class="anchored" data-anchor-id="ways-to-test">
<span class="header-section-number">19.1.1.1</span> Ways to Test</h4>
<section id="before-model-fitting" class="level5" data-number="19.1.1.1.1"><h5 data-number="19.1.1.1.1" class="anchored" data-anchor-id="before-model-fitting">
<span class="header-section-number">19.1.1.1.1</span> Before Model Fitting</h5>
<ul>
<li>scatterplot matrix</li>
<li>distance correlation</li>
</ul>
<section id="scatterplot-matrix" class="level6" data-number="19.1.1.1.1.1"><h6 data-number="19.1.1.1.1.1" class="anchored" data-anchor-id="scatterplot-matrix">
<span class="header-section-number">19.1.1.1.1.1</span> Scatterplot Matrix</h6>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb170"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/scatterplotMatrix.html">scatterplotMatrix</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span> <span class="va">bpi_antisocialT2Sum</span> <span class="op">+</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-53-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="regression_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="distance-correlation" class="level6" data-number="19.1.1.1.1.2"><h6 data-number="19.1.1.1.1.2" class="anchored" data-anchor-id="distance-correlation">
<span class="header-section-number">19.1.1.1.1.2</span> Distance correlation</h6>
<p>The distance correlation is an index of the degree of the linear and non-linear association between two variables.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb171"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/correlation/reference/correlation.html">correlation</a></span><span class="op">(</span></span>
<span>  <span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"distance"</span>,</span>
<span>  p_adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Parameter1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Parameter2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["r"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["t"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df_error"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Method"],"name":[10],"type":["chr"],"align":["left"]},{"label":["n_Obs"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"bpi_antisocialT1Sum","2":"bpi_antisocialT2Sum","3":"0.231721","4":"0.95","5":"0.1968321","6":"0.2660239","7":"484.0006","8":"4128499","9":"0","10":"Distance (Bias Corrected) correlation","11":"2875","_rn_":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="after-model-fitting" class="level5" data-number="19.1.1.1.2"><h5 data-number="19.1.1.1.2" class="anchored" data-anchor-id="after-model-fitting">
<span class="header-section-number">19.1.1.1.2</span> After Model Fitting</h5>
<p>Check for nonlinearities (non-horizontal line) in plots of:</p>
<ul>
<li>Residuals versus fitted values (<a href="#sec-residualPlots">Residual Plots</a>)—best</li>
<li>Residuals versus predictors (<a href="#sec-residualPlots">Residual Plots</a>)</li>
<li>Outcome versus fitted values (<a href="#sec-marginalModelPlots">Marginal Model Plots</a>)</li>
<li>Outcome versus predictors, ignoring other predictors (<a href="#sec-marginalModelPlots">Marginal Model Plots</a>)</li>
<li>Outcome versus predictors, controlling for other predictors (<a href="#sec-addedVariablePlots">Added-Variable Plots</a>)</li>
</ul></section></section><section id="ways-to-handle" class="level4" data-number="19.1.1.2"><h4 data-number="19.1.1.2" class="anchored" data-anchor-id="ways-to-handle">
<span class="header-section-number">19.1.1.2</span> Ways to Handle</h4>
<ul>
<li>Transform outcome/predictor variables (Box-Cox transformations)</li>
<li>Semi-parametric regression models: Generalized additive models (GAM)</li>
<li>Non-parametric regression models: Nearest-Neighbor Kernel Regression</li>
</ul>
<section id="semi-parametric-or-non-parametric-regression-models" class="level5" data-number="19.1.1.2.1"><h5 data-number="19.1.1.2.1" class="anchored" data-anchor-id="semi-parametric-or-non-parametric-regression-models">
<span class="header-section-number">19.1.1.2.1</span> Semi-parametric or non-parametric regression models</h5>
<p><a href="http://www.lisa.stat.vt.edu/?q=node/7517" class="uri">http://www.lisa.stat.vt.edu/?q=node/7517</a> (archived at <a href="https://web.archive.org/web/20180113065042/http://www.lisa.stat.vt.edu/?q=node/7517" class="uri">https://web.archive.org/web/20180113065042/http://www.lisa.stat.vt.edu/?q=node/7517</a>)</p>
<p>Note: using semi-parametric or non-parametric models increases fit in context of nonlinearity at the expense of added complexity. Make sure to avoid fitting an overly complex model (e.g., use k-fold cross validation). Often, the simpler (generalized) linear model is preferable to semi-paremetric or non-parametric approaches</p>
<section id="semi-parametric-generalized-additive-models" class="level6" data-number="19.1.1.2.1.1"><h6 data-number="19.1.1.2.1.1" class="anchored" data-anchor-id="semi-parametric-generalized-additive-models">
<span class="header-section-number">19.1.1.2.1.1</span> Semi-parametric: Generalized Additive Models</h6>
<p><a href="http://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models" class="uri">http://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models</a> (archived at <a href="https://web.archive.org/web/20170213041653/http://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models" class="uri">https://web.archive.org/web/20170213041653/http://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb172"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">generalizedAdditiveModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">generalizedAdditiveModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum

Parametric coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              1.19830    0.05983  20.029  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


R-sq.(adj) =  0.261   Deviance explained = 26.2%
GCV = 3.9191  Scale est. = 3.915     n = 2874</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb174"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">generalizedAdditiveModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `glm.control()`:
! unused arguments (nthreads = 1, ncv.threads = 1, irls.reg = 0, mgcv.tol = 1e-07, mgcv.half = 15, rank.tol = 1.49011611938477e-08, nlm = list(7, 1e-06, 2, 1e-04, 200, FALSE), optim = list(1e+07), newton = list(1e-06, 5, 2, 30, FALSE), idLinksBases = TRUE, scalePenalty = TRUE, efs.lspmax = 15, efs.tol = 0.1, keepData = FALSE, scale.est = "fletcher", edge.correct = FALSE)</code></pre>
</div>
</div>
</section><section id="non-parametric-nearest-neighbor-kernel-regression" class="level6" data-number="19.1.1.2.1.2"><h6 data-number="19.1.1.2.1.2" class="anchored" data-anchor-id="non-parametric-nearest-neighbor-kernel-regression">
<span class="header-section-number">19.1.1.2.1.2</span> Non-parametric: Nearest-Neighbor Kernel Regression</h6>
</section></section></section></section><section id="exogeneity" class="level3" data-number="19.1.2"><h3 data-number="19.1.2" class="anchored" data-anchor-id="exogeneity">
<span class="header-section-number">19.1.2</span> 2. Exogeneity</h3>
<p>Exogeneity means that the association between predictors and outcome is fully causal and unrelated to other variables.</p>
<section id="ways-to-test-1" class="level4" data-number="19.1.2.1"><h4 data-number="19.1.2.1" class="anchored" data-anchor-id="ways-to-test-1">
<span class="header-section-number">19.1.2.1</span> Ways to Test</h4>
<ul>
<li>Durbin-Wu-Hausman test of endogeneity</li>
</ul>
<section id="durbin-wu-hausman-test-of-endogeneity" class="level5" data-number="19.1.2.1.1"><h5 data-number="19.1.2.1.1" class="anchored" data-anchor-id="durbin-wu-hausman-test-of-endogeneity">
<span class="header-section-number">19.1.2.1.1</span> Durbin-Wu-Hausman test of endogeneity</h5>
<p>The instrumental variables (2SLS) estimator is implemented in the <code>R</code> package <code>AER</code> as command:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb176"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/AER/man/ivreg.html">ivreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">w1</span> <span class="op">+</span> <span class="va">w2</span> <span class="op">|</span> <span class="va">z1</span> <span class="op">+</span> <span class="va">z2</span> <span class="op">+</span> <span class="va">z3</span> <span class="op">+</span> <span class="va">w1</span> <span class="op">+</span> <span class="va">w2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>where <code>x1</code> and <code>x2</code> are endogenous regressors, <code>w1</code> and <code>w2</code> exogeneous regressors, and <code>z1</code> to <code>z3</code> are excluded instruments.</p>
<p>Durbin-Wu-Hausman test:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb177"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hsng2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.dta.html">read.dta</a></span><span class="op">(</span><span class="st">"https://www.stata-press.com/data/r11/hsng2.dta"</span><span class="op">)</span> <span class="co">#archived at https://perma.cc/7P2Q-ARKR</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb178"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AER/man/ivreg.html">ivreg</a></span><span class="op">(</span></span>
<span>  <span class="va">rent</span> <span class="op">~</span> <span class="va">hsngval</span> <span class="op">+</span> <span class="va">pcturban</span> <span class="op">|</span> <span class="va">pcturban</span> <span class="op">+</span> <span class="va">faminc</span> <span class="op">+</span> <span class="va">reg2</span> <span class="op">+</span> <span class="va">reg3</span> <span class="op">+</span> <span class="va">reg4</span>,</span>
<span>  data <span class="op">=</span> <span class="va">hsng2</span><span class="op">)</span> <span class="co">#Housing values are likely endogeneous and therefore instrumented by median family income (faminc) and 3 regional dummies (reg2, reg4, reg4)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span></span>
<span>  <span class="va">fiv</span>,</span>
<span>  diagnostics <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
ivreg(formula = rent ~ hsngval + pcturban | pcturban + faminc + 
    reg2 + reg3 + reg4, data = hsng2)

Residuals:
     Min       1Q   Median       3Q      Max 
-84.1948 -11.6023  -0.5239   8.6583  73.6130 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.207e+02  1.571e+01   7.685 7.55e-10 ***
hsngval     2.240e-03  3.388e-04   6.612 3.17e-08 ***
pcturban    8.152e-02  3.082e-01   0.265    0.793    

Diagnostic tests:
                 df1 df2 statistic  p-value    
Weak instruments   4  44     13.30  3.5e-07 ***
Wu-Hausman         1  46     15.91 0.000236 ***
Sargan             3  NA     11.29 0.010268 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 22.86 on 47 degrees of freedom
Multiple R-Squared: 0.5989, Adjusted R-squared: 0.5818 
Wald test: 42.66 on 2 and 47 DF,  p-value: 2.731e-11 </code></pre>
</div>
</div>
<p>The Eicker-Huber-White covariance estimator which is robust to heteroscedastic error terms is reported after estimation with <code>vcov = sandwich</code> in <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest()</a></code></p>
<p>First stage results are reported by explicitly estimating them. For example:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb180"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">first</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">hsngval</span> <span class="op">~</span> <span class="va">pcturban</span> <span class="op">+</span> <span class="va">faminc</span> <span class="op">+</span> <span class="va">reg2</span> <span class="op">+</span> <span class="va">reg3</span> <span class="op">+</span> <span class="va">reg4</span>,</span>
<span>  data <span class="op">=</span> <span class="va">hsng2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">first</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hsngval ~ pcturban + faminc + reg2 + reg3 + reg4, 
    data = hsng2)

Residuals:
   Min     1Q Median     3Q    Max 
-10504  -5223  -1162   2939  46756 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.867e+04  1.200e+04  -1.557 0.126736    
pcturban     1.822e+02  1.150e+02   1.584 0.120289    
faminc       2.731e+00  6.819e-01   4.006 0.000235 ***
reg2        -5.095e+03  4.122e+03  -1.236 0.223007    
reg3        -1.778e+03  4.073e+03  -0.437 0.664552    
reg4         1.341e+04  4.048e+03   3.314 0.001849 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9253 on 44 degrees of freedom
Multiple R-squared:  0.6908,    Adjusted R-squared:  0.6557 
F-statistic: 19.66 on 5 and 44 DF,  p-value: 3.032e-10</code></pre>
</div>
</div>
<p>In case of a single endogenous variable (K = 1), the F-statistic to assess weak instruments is reported after estimating the first stage with, for example:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/waldtest.html">waldtest</a></span><span class="op">(</span></span>
<span>  <span class="va">first</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">faminc</span> <span class="op">-</span> <span class="va">reg2</span> <span class="op">-</span> <span class="va">reg3</span> <span class="op">-</span> <span class="va">reg4</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"44","2":"NA","3":"NA","4":"NA","_rn_":"1"},{"1":"48","2":"-4","3":"13.29778","4":"3.495112e-07","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>or in case of heteroscedatistic errors:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb183"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/waldtest.html">waldtest</a></span><span class="op">(</span></span>
<span>  <span class="va">first</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">faminc</span> <span class="op">-</span> <span class="va">reg2</span> <span class="op">-</span> <span class="va">reg3</span><span class="op">-</span> <span class="va">reg4</span>,</span>
<span>  vcov <span class="op">=</span> <span class="va">sandwich</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"44","2":"NA","3":"NA","4":"NA","_rn_":"1"},{"1":"48","2":"-4","3":"12.97475","4":"4.643466e-07","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="ways-to-handle-1" class="level4" data-number="19.1.2.2"><h4 data-number="19.1.2.2" class="anchored" data-anchor-id="ways-to-handle-1">
<span class="header-section-number">19.1.2.2</span> Ways to Handle</h4>
<ul>
<li>Conduct an experiment/RCT with random assignment</li>
<li>Instrumental variables</li>
</ul></section></section><section id="homoscedasticity-of-residuals" class="level3" data-number="19.1.3"><h3 data-number="19.1.3" class="anchored" data-anchor-id="homoscedasticity-of-residuals">
<span class="header-section-number">19.1.3</span> 3. Homoscedasticity of residuals</h3>
<p>Homoscedasticity of the residuals means that the variance of the residuals does not differ as a function of the outcome/predictors (i.e., the residuals show constant variance as a function of outcome/predictors).</p>
<section id="ways-to-test-2" class="level4" data-number="19.1.3.1"><h4 data-number="19.1.3.1" class="anchored" data-anchor-id="ways-to-test-2">
<span class="header-section-number">19.1.3.1</span> Ways to Test</h4>
<ul>
<li>Plot residuals vs.&nbsp;outcome and predictor variables (<a href="#sec-residualPlots">Residual Plots</a>)</li>
<li>Plot residuals vs.&nbsp;fitted values (<a href="#sec-residualPlots">Residual Plots</a>)</li>
<li>Time Series data: Plot residuals vs.&nbsp;time</li>
<li>Spread-level plot</li>
<li>Breusch-Pagan test: <code><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest()</a></code> function from <code>lmtest</code> package</li>
<li>Goldfeld-Quandt Test</li>
</ul>
<section id="residuals-vs.-outcome-and-predictor-variables" class="level5" data-number="19.1.3.1.1"><h5 data-number="19.1.3.1.1" class="anchored" data-anchor-id="residuals-vs.-outcome-and-predictor-variables">
<span class="header-section-number">19.1.3.1.1</span> Residuals vs.&nbsp;outcome and predictor variables</h5>
<p>Plot residuals, or perhaps their absolute values, versus the outcome and predictor variables (<a href="#sec-residualPlots">Residual Plots</a>). Examine whether residual variance is constant at all levels of other variables or whether it increases/decreases as a function of another variable (or shows some others structure, e.g., small variance at low and high levels of a predictor and high variance in the middle). Note that this is <em>different than whether the residuals show non-linearities</em>—i.e., a non-horizontal line, which would indicate a <a href="#sec-linearAssociation">nonlinear association between variables</a> (see Assumption #1, above). Rather, here we are examining whether there is change in the variance as a function of another variable (e.g., a fan-shaped <a href="#sec-residualPlots">Residual Plot</a>)</p>
</section><section id="spread-level-plot" class="level5" data-number="19.1.3.1.2"><h5 data-number="19.1.3.1.2" class="anchored" data-anchor-id="spread-level-plot">
<span class="header-section-number">19.1.3.1.2</span> Spread-level plot</h5>
<p>Examining whether level (e.g., mean) depends on spread (e.g., variance)—plot of log of the absolute Studentized residuals against the log of the fitted values</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb184"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/spreadLevelPlot.html">spreadLevelPlot</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-63-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="regression_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Suggested power transformation:  0.5304728 </code></pre>
</div>
</div>
</section><section id="breusch-pagan-test" class="level5" data-number="19.1.3.1.3"><h5 data-number="19.1.3.1.3" class="anchored" data-anchor-id="breusch-pagan-test">
<span class="header-section-number">19.1.3.1.3</span> Breusch-Pagan test</h5>
<p><a href="https://www.rdocumentation.org/packages/lmtest/versions/0.9-40/topics/bptest" class="uri">https://www.rdocumentation.org/packages/lmtest/versions/0.9-40/topics/bptest</a> (archived at <a href="https://perma.cc/K4WC-7TVW" class="uri">https://perma.cc/K4WC-7TVW</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb186"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  multipleRegressionModel
BP = 94.638, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
</section><section id="goldfeld-quandt-test" class="level5" data-number="19.1.3.1.4"><h5 data-number="19.1.3.1.4" class="anchored" data-anchor-id="goldfeld-quandt-test">
<span class="header-section-number">19.1.3.1.4</span> Goldfeld-Quandt Test</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb188"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/gqtest.html">gqtest</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Goldfeld-Quandt test

data:  multipleRegressionModel
GQ = 1.0755, df1 = 1434, df2 = 1434, p-value = 0.08417
alternative hypothesis: variance increases from segment 1 to 2</code></pre>
</div>
</div>
</section><section id="test-of-dependence-of-spread-on-level" class="level5" data-number="19.1.3.1.5"><h5 data-number="19.1.3.1.5" class="anchored" data-anchor-id="test-of-dependence-of-spread-on-level">
<span class="header-section-number">19.1.3.1.5</span> Test of dependence of spread on level</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb190"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/ncvTest.html">ncvTest</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 232.1196, Df = 1, p = &lt; 2.22e-16</code></pre>
</div>
</div>
</section><section id="test-of-dependence-of-spread-on-predictors" class="level5" data-number="19.1.3.1.6"><h5 data-number="19.1.3.1.6" class="anchored" data-anchor-id="test-of-dependence-of-spread-on-predictors">
<span class="header-section-number">19.1.3.1.6</span> Test of dependence of spread on predictors</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb192"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/ncvTest.html">ncvTest</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel</span>,</span>
<span>  <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Non-constant Variance Score Test 
Variance formula: ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum 
Chisquare = 233.2878, Df = 2, p = &lt; 2.22e-16</code></pre>
</div>
</div>
</section></section><section id="ways-to-handle-2" class="level4" data-number="19.1.3.2"><h4 data-number="19.1.3.2" class="anchored" data-anchor-id="ways-to-handle-2">
<span class="header-section-number">19.1.3.2</span> Ways to Handle</h4>
<ul>
<li>If residual variance increases as a function of the fitted values, consider a poisson regression model (especially for count data), for which the variance does increase with the mean</li>
<li>If residual variance differs as a function of model predictors, consider adding interactions/product terms (the effect of one variable depends on the level of another variable)</li>
<li>Try transforming the outcome variable to be normally distributed (log-transform if the errors seem consistent in percentage rather than absolute terms)</li>
<li>If the error variance is proportional to a variable <span class="math inline">\(z\)</span>, then fit the model using Weighted Least Squares (WLS), with the weights given be <span class="math inline">\(1/z\)</span>
</li>
<li>Weighted least squares (WLS) using the “weights” argument of the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function; to get weights, see: <a href="https://stats.stackexchange.com/a/100410/20338" class="uri">https://stats.stackexchange.com/a/100410/20338</a> (archived at <a href="https://perma.cc/C6BY-G9MS" class="uri">https://perma.cc/C6BY-G9MS</a>)</li>
<li>Huber-White standard errors (a.k.a. “Sandwich” estimates) from a heteroscedasticity-corrected covariance matrix
<ul>
<li>
<code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest()</a></code> function from the <code>sandwich</code> package along with hccm sandwich estimates from the <code>car</code> package</li>
<li>
<code><a href="https://rdrr.io/pkg/rms/man/robcov.html">robcov()</a></code> function from the <code>rms</code> package</li>
</ul>
</li>
<li>Time series data: ARCH (auto-regressive conditional heteroscedasticity) models</li>
<li>Time series data: seasonal patterns can be addressed by applying log transformation to outcome variable</li>
</ul>
<section id="huber-white-standard-errors" class="level5" data-number="19.1.3.2.1"><h5 data-number="19.1.3.2.1" class="anchored" data-anchor-id="huber-white-standard-errors">
<span class="header-section-number">19.1.3.2.1</span> Huber-White standard errors</h5>
<p>Standard errors (SEs) on the diagonal increase</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb194"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                          (Intercept) bpi_antisocialT1Sum
(Intercept)              0.0035795220       -0.0006533375
bpi_antisocialT1Sum     -0.0006533375        0.0003453814
bpi_anxiousDepressedSum -0.0003167540       -0.0002574524
                        bpi_anxiousDepressedSum
(Intercept)                       -0.0003167540
bpi_antisocialT1Sum               -0.0002574524
bpi_anxiousDepressedSum            0.0008501565</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb196"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/hccm.html">hccm</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `V %*% t(X) %*% apply(X, 2, "*", (e^2) / factor)`:
! non-conformable arguments</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb198"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.3755 -1.2337 -0.2212  0.9911 12.8017 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              1.19830    0.05983  20.029  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.979 on 2871 degrees of freedom
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.262, Adjusted R-squared:  0.2615 
F-statistic: 509.6 on 2 and 2871 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb200"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span>, vcov <span class="op">=</span> <span class="va">sandwich</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

                        Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)             1.198300   0.062211 19.2618 &lt; 2.2e-16 ***
bpi_antisocialT1Sum     0.465529   0.022929 20.3030 &lt; 2.2e-16 ***
bpi_anxiousDepressedSum 0.160754   0.032991  4.8727  1.16e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb202"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span>, vcov <span class="op">=</span> <span class="va">hccm</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `V %*% t(X) %*% apply(X, 2, "*", (e^2) / factor)`:
! non-conformable arguments</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb204"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/rms/man/robcov.html">robcov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/rms/man/ols.html">ols</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
    bpi_antisocialT2Sum     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
                   7501                    7613                    7616 

Linear Regression Model

ols(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, x = TRUE, y = TRUE)

                Model Likelihood    Discrimination    
                      Ratio Test           Indexes    
Obs    2874    LR chi2    873.09    R2       0.262    
sigma1.9786    d.f.            2    R2 adj   0.261    
d.f.   2871    Pr(&gt; chi2) 0.0000    g        1.278    

Residuals

    Min      1Q  Median      3Q     Max 
-8.3755 -1.2337 -0.2212  0.9911 12.8017 

                        Coef   S.E.   t     Pr(&gt;|t|)
Intercept               1.1983 0.0622 19.26 &lt;0.0001 
bpi_antisocialT1Sum     0.4655 0.0229 20.30 &lt;0.0001 
bpi_anxiousDepressedSum 0.1608 0.0330  4.87 &lt;0.0001 </code></pre>
</div>
</div>
<p>Use “cluster” variable to account for nested data within-subject:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb206"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/rms/man/robcov.html">robcov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/rms/man/ols.html">ols</a></span><span class="op">(</span></span>
<span>  <span class="va">t_ext</span> <span class="op">~</span> <span class="va">m_ext</span> <span class="op">+</span> <span class="va">age</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  cluster <span class="op">=</span> <span class="va">mydata</span><span class="op">$</span><span class="va">tcid</span><span class="op">)</span> <span class="co">#account for nested data within subject</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section></section><section id="errors-are-independent" class="level3" data-number="19.1.4"><h3 data-number="19.1.4" class="anchored" data-anchor-id="errors-are-independent">
<span class="header-section-number">19.1.4</span> 4. Errors are independent</h3>
<p>Independent errors means that the errors are uncorrelated with each other.</p>
<section id="ways-to-test-3" class="level4" data-number="19.1.4.1"><h4 data-number="19.1.4.1" class="anchored" data-anchor-id="ways-to-test-3">
<span class="header-section-number">19.1.4.1</span> Ways to Test</h4>
<ul>
<li>Intraclass correlation coefficient (ICC) from mixed model</li>
<li>Plot residuals vs.&nbsp;predictors (<a href="#sec-residualPlots">Residual Plots</a>)</li>
<li>Time Series data: Residual time series plot (residuals vs.&nbsp;row number)</li>
<li>Time Series data: Table or plot of residual autocorrelations</li>
<li>Time Series data: Durbin-Watson statistic for test of significant residual autocorrelation at lag 1</li>
</ul></section><section id="ways-to-handle-3" class="level4" data-number="19.1.4.2"><h4 data-number="19.1.4.2" class="anchored" data-anchor-id="ways-to-handle-3">
<span class="header-section-number">19.1.4.2</span> Ways to Handle</h4>
<ul>
<li>Generalized least squares (GLS) models are capable of handling correlated errors: <a href="https://stat.ethz.ch/R-manual/R-devel/library/nlme/html/gls.html" class="uri">https://stat.ethz.ch/R-manual/R-devel/library/nlme/html/gls.html</a> (archived at <a href="https://perma.cc/RHZ6-5GT8" class="uri">https://perma.cc/RHZ6-5GT8</a>)</li>
<li>Regression with cluster variable
<ul>
<li>
<code><a href="https://rdrr.io/pkg/rms/man/robcov.html">robcov()</a></code> from <code>rms</code> package</li>
</ul>
</li>
<li>
<a href="./hlm.html">Hierarchical linear modeling</a>
<ul>
<li><a href="./hlm.html#sec-linear">Linear mixed effects models</a></li>
<li><a href="./hlm.html#sec-generalized">Generalized linear mixed effects models</a></li>
<li><a href="./hlm.html#sec-nonlinear">Nonlinear mixed effects models</a></li>
</ul>
</li>
</ul></section></section><section id="no-multicollinearity" class="level3" data-number="19.1.5"><h3 data-number="19.1.5" class="anchored" data-anchor-id="no-multicollinearity">
<span class="header-section-number">19.1.5</span> 5. No multicollinearity</h3>
<p>Multicollinearity occurs when the predictors are correlated with each other.</p>
<section id="ways-to-test-4" class="level4" data-number="19.1.5.1"><h4 data-number="19.1.5.1" class="anchored" data-anchor-id="ways-to-test-4">
<span class="header-section-number">19.1.5.1</span> Ways to Test</h4>
<ul>
<li>Variance Inflation Factor (VIF)</li>
<li>Generalized Variance Inflation Factor (GVIF)—when models have related regressors (multiple polynomial terms or contrasts from same predictor)</li>
<li>Correlation</li>
<li>Tolerance</li>
<li>Condition Index</li>
</ul>
<section id="variance-inflation-factor-vif" class="level5" data-number="19.1.5.1.1"><h5 data-number="19.1.5.1.1" class="anchored" data-anchor-id="variance-inflation-factor-vif">
<span class="header-section-number">19.1.5.1.1</span> Variance Inflation Factor (VIF)</h5>
<p><span class="math display">\[
\text{VIF} = 1/\text{Tolerance}
\]</span></p>
<p>If the variance inflation factor of a predictor variable were 5.27 (<span class="math inline">\(\sqrt{5.27} = 2.3\)</span>), this means that the standard error for the coefficient of that predictor variable is 2.3 times as large (i.e., confidence interval is 2.3 times wider) as it would be if that predictor variable were uncorrelated with the other predictor variables.</p>
<p>VIF = 1: Not correlated<br>
1 &lt; VIF &lt; 5: Moderately correlated<br>
VIF &gt; 5 to 10: Highly correlated (multicollinearity present)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb207"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/rms/man/vif.html">vif</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>    bpi_antisocialT1Sum bpi_anxiousDepressedSum 
               1.291545                1.291545 </code></pre>
</div>
</div>
</section><section id="generalized-variance-inflation-factor-gvif" class="level5" data-number="19.1.5.1.2"><h5 data-number="19.1.5.1.2" class="anchored" data-anchor-id="generalized-variance-inflation-factor-gvif">
<span class="header-section-number">19.1.5.1.2</span> Generalized Variance Inflation Factor (GVIF)</h5>
<p>Useful when models have related regressors (multiple polynomial terms or contrasts from same predictor)</p>
</section><section id="correlation" class="level5" data-number="19.1.5.1.3"><h5 data-number="19.1.5.1.3" class="anchored" data-anchor-id="correlation">
<span class="header-section-number">19.1.5.1.3</span> Correlation</h5>
<p>correlation among all independent variables the correlation coefficients should be smaller than .08</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb209"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span></span>
<span>  <span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                        bpi_antisocialT1Sum bpi_anxiousDepressedSum
bpi_antisocialT1Sum                1.000000                0.497279
bpi_anxiousDepressedSum            0.497279                1.000000</code></pre>
</div>
</div>
</section><section id="tolerance" class="level5" data-number="19.1.5.1.4"><h5 data-number="19.1.5.1.4" class="anchored" data-anchor-id="tolerance">
<span class="header-section-number">19.1.5.1.4</span> Tolerance</h5>
<p>The tolerance is an index of the influence of one independent variable on all other independent variables.</p>
<p><span class="math display">\[
\text{tolerance} = 1/\text{VIF}
\]</span></p>
<p>T &lt; 0.2: there might be multicollinearity in the data<br>
T &lt; 0.01: there certainly is multicollinarity in the data</p>
</section><section id="condition-index" class="level5" data-number="19.1.5.1.5"><h5 data-number="19.1.5.1.5" class="anchored" data-anchor-id="condition-index">
<span class="header-section-number">19.1.5.1.5</span> Condition Index</h5>
<p>The condition index is calculated using a factor analysis on the independent variables. Values of 10-30 indicate a mediocre multicollinearity in the regression variables. Values &gt; 30 indicate strong multicollinearity.</p>
<p>For how to interpret, see here: <a href="https://stats.stackexchange.com/a/87610/20338" class="uri">https://stats.stackexchange.com/a/87610/20338</a> (archived at <a href="https://perma.cc/Y4J8-MY7Q" class="uri">https://perma.cc/Y4J8-MY7Q</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb211"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_coll_diag.html">ols_eigen_cindex</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Eigenvalue"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Condition Index"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["intercept"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["bpi_antisocialT1Sum"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["bpi_anxiousDepressedSum"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2.4393975","2":"1.000000","3":"0.05150939","4":"0.04435009","5":"0.05806627"},{"1":"0.3575629","2":"2.611951","3":"0.40330814","4":"0.01600701","5":"0.75801976"},{"1":"0.2030395","2":"3.466179","3":"0.54518247","4":"0.93964290","5":"0.18391397"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="ways-to-handle-4" class="level4" data-number="19.1.5.2"><h4 data-number="19.1.5.2" class="anchored" data-anchor-id="ways-to-handle-4">
<span class="header-section-number">19.1.5.2</span> Ways to Handle</h4>
<ul>
<li>Remove highly correlated (i.e., redundant) predictors</li>
<li>Average the correlated predictors</li>
<li>
<a href="./pca.html">Principal Component Analysis</a> for data reduction</li>
<li>Standardize predictors</li>
<li>Center the data (deduct the mean)</li>
<li>Singular-value decomposition of the model matrix or the mean-centered model matrix</li>
<li>Conduct a <a href="#factorAnalysis.qmd">factor analysis</a> and rotate the factors to ensure independence of the factors</li>
</ul></section></section><section id="errors-are-normally-distributed" class="level3" data-number="19.1.6"><h3 data-number="19.1.6" class="anchored" data-anchor-id="errors-are-normally-distributed">
<span class="header-section-number">19.1.6</span> 6. Errors are normally distributed</h3>
<section id="ways-to-test-5" class="level4" data-number="19.1.6.1"><h4 data-number="19.1.6.1" class="anchored" data-anchor-id="ways-to-test-5">
<span class="header-section-number">19.1.6.1</span> Ways to Test</h4>
<ul>
<li>Probability Plots
<ul>
<li>
<a href="#qqPlot">Normal Quantile (QQ) Plots</a> (based on non-cumulative distribution of residuals)</li>
<li>
<a href="#ppPlot">Normal Probability (PP) Plots</a> (based on cumulative distribution of residuals)</li>
</ul>
</li>
<li><a href="#densityPlotResiduals">Density Plot of Residuals</a></li>
<li>Statistical Tests
<ul>
<li>Kolmogorov-Smirnov test</li>
<li>Shapiro-Wilk test</li>
<li>Jarque-Bera test</li>
<li>Anderson-Darling test (best test)</li>
</ul>
</li>
<li>Examine influence of outliers</li>
</ul></section><section id="ways-to-handle-5" class="level4" data-number="19.1.6.2"><h4 data-number="19.1.6.2" class="anchored" data-anchor-id="ways-to-handle-5">
<span class="header-section-number">19.1.6.2</span> Ways to Handle</h4>
<ul>
<li>Apply a transformation to the predictor or outcome variable</li>
<li>Exclude outliers</li>
<li>Robust regression
<ul>
<li>Best when no outliers: MM-type regression estimator
<ul>
<li>
<code><a href="https://rdrr.io/pkg/robustbase/man/lmrob.html">lmrob()</a></code>/<code><a href="https://rdrr.io/pkg/robustbase/man/glmrob.html">glmrob()</a></code> function of <code>robustbase</code> package</li>
<li>Iteratively reweighted least squares (IRLS): <code>rlm(, method = "MM")</code> function of <code>MASS</code> package: <a href="http://www.ats.ucla.edu/stat/r/dae/rreg.htm" class="uri">http://www.ats.ucla.edu/stat/r/dae/rreg.htm</a> (archived at <a href="https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm" class="uri">https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm</a>)</li>
</ul>
</li>
<li>Most resistant to outliers: Least trimmed squares (LTS)—but not good as a standalone estimator, better for identifying outliers
<ul>
<li>
<code><a href="https://rdrr.io/pkg/robustbase/man/ltsReg.html">ltsReg()</a></code> function of <code>robustbase</code> package (best)</li>
</ul>
</li>
<li>Best when single predictor: Theil-Sen estimator
<ul>
<li>
<code>mblm(, repeated = FALSE)</code> function of <code>mblm</code> package</li>
</ul>
</li>
<li>Robust correlation
<ul>
<li>Spearman’s rho: <code>cor(, method = "spearman")</code>
</li>
<li>Percentage bend correlation</li>
<li>Minimum vollume ellipsoid</li>
<li>Minimum covariance determinant:</li>
<li>Winsorized correlation</li>
<li>Biweight midcorrelation</li>
<li>Xi (<span class="math inline">\(\xi\)</span>) correlation</li>
</ul>
</li>
<li>Not great options:
<ul>
<li>Quantile (L1) regression: <code><a href="https://rdrr.io/pkg/quantreg/man/rq.html">rq()</a></code> function of <code>quantreg</code> package</li>
</ul>
</li>
</ul>
</li>
</ul>
<section id="transformations-of-outcome-variable" class="level5" data-number="19.1.6.2.1"><h5 data-number="19.1.6.2.1" class="anchored" data-anchor-id="transformations-of-outcome-variable">
<span class="header-section-number">19.1.6.2.1</span> Transformations of Outcome Variable</h5>
<section id="box-cox-transformation" class="level6" data-number="19.1.6.2.1.1"><h6 data-number="19.1.6.2.1.1" class="anchored" data-anchor-id="box-cox-transformation">
<span class="header-section-number">19.1.6.2.1.1</span> Box-Cox Transformation</h6>
<p>Useful if the outcome is strictly positive (or add a constant to outcome to make it strictly positive)</p>
<p>lambda = -1: inverse transformation<br>
lambda = -0.5: 1/sqrt(Y)<br>
lambda = 0: log transformation<br>
lambda = 0.5: square root<br>
lambda = 0.333: cube root<br>
lambda = 1: no transformation<br>
lambda = 2: squared<br></p>
<section id="raw-distribution" class="level7"><p class="heading">Raw distribution</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb212"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">bpi_antisocialT2Sum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-73-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="regression_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="add-constant-to-outcome-to-make-it-strictly-positive" class="level7"><p class="heading">Add constant to outcome to make it strictly positive</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb213"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">strictlyPositiveDV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="identify-best-power-transformation-lambda" class="level7"><p class="heading">Identify best power transformation (lambda)</p>
<p>Consider rounding the power to a common value (square root = .5; cube root = .333; squared = 2)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb214"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/boxCox.html">boxCox</a></span><span class="op">(</span><span class="va">strictlyPositiveDV</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-75-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="regression_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb215"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/powerTransform.html">powerTransform</a></span><span class="op">(</span><span class="va">strictlyPositiveDV</span><span class="op">)</span> </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Estimated transformation parameter 
      Y1 
0.234032 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb217"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">transformedDV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/powerTransform.html">powerTransform</a></span><span class="op">(</span><span class="va">strictlyPositiveDV</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">transformedDV</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>bcPower Transformation to Normality 
   Est Power Rounded Pwr Wald Lwr Bnd Wald Upr Bnd
Y1     0.234        0.23       0.1825       0.2856

Likelihood ratio test that transformation parameter is equal to 0
 (log transformation)
                           LRT df       pval
LR test, lambda = (0) 78.04052  1 &lt; 2.22e-16

Likelihood ratio test that no transformation is needed
                           LRT df       pval
LR test, lambda = (1) 853.8675  1 &lt; 2.22e-16</code></pre>
</div>
</div>
</section><section id="transform-the-dv" class="level7"><p class="heading">Transform the DV</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb219"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">bpi_antisocialT2SumTransformed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/bcPower.html">bcPower</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">bpi_antisocialT2Sum</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">transformedDV</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">bpi_antisocialT2SumTransformed</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-76-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="regression_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="compare-residuals-from-model-with-and-without-transformation" class="level7"><p class="heading">Compare residuals from model with and without transformation</p>
<section id="model-without-transformation" class="level8"><p class="heading">Model without transformation</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb220"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelWithoutTransformation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bpi_antisocialT2Sum + 1 ~ bpi_antisocialT1Sum + 
    bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.3755 -1.2337 -0.2212  0.9911 12.8017 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              2.19830    0.05983  36.743  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.979 on 2871 degrees of freedom
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.262, Adjusted R-squared:  0.2615 
F-statistic: 509.6 on 2 and 2871 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb222"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/studres.html">studres</a></span><span class="op">(</span><span class="va">modelWithoutTransformation</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-77-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="regression_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="model-with-transformation" class="level8"><p class="heading">Model with transformation</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb223"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelWithTransformation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2SumTransformed</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bpi_antisocialT2SumTransformed ~ bpi_antisocialT1Sum + 
    bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.3429 -0.4868  0.0096  0.4922  2.9799 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             0.800373   0.022024  36.342  &lt; 2e-16 ***
bpi_antisocialT1Sum     0.165476   0.006841  24.189  &lt; 2e-16 ***
bpi_anxiousDepressedSum 0.055910   0.010733   5.209 2.03e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7283 on 2871 degrees of freedom
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.2477,    Adjusted R-squared:  0.2472 
F-statistic: 472.7 on 2 and 2871 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb225"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/studres.html">studres</a></span><span class="op">(</span><span class="va">modelWithTransformation</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-78-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="regression_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section></section><section id="constructed-variable-test-plot" class="level7"><p class="heading">Constructed Variable Test &amp; Plot</p>
<p>A significant <em>p</em>-value indicates a strong need to transform variable:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb226"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">multipleRegressionModel_constructedVariable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/boxCoxVariable.html">boxCoxVariable</a></span><span class="op">(</span><span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">multipleRegressionModel_constructedVariable</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="st">"boxCoxVariable(bpi_antisocialT1Sum + 1)"</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                                           Estimate Std. Error   t value
boxCoxVariable(bpi_antisocialT1Sum + 1) -0.06064732 0.04683415 -1.294938
                                         Pr(&gt;|t|)
boxCoxVariable(bpi_antisocialT1Sum + 1) 0.1954457</code></pre>
</div>
</div>
<p>Plot allows us to see whether the need for transformation is spread through data or whether it is just dependent on a small fraction of observations:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb228"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/avPlots.html">avPlots</a></span><span class="op">(</span><span class="va">multipleRegressionModel_constructedVariable</span>, <span class="st">"boxCoxVariable(bpi_antisocialT1Sum + 1)"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-80-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="regression_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="inverse-response-plot" class="level7"><p class="heading">Inverse Response Plot</p>
<p>The black line is the best-fitting power transformation:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb229"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/invResPlot.html">inverseResponsePlot</a></span><span class="op">(</span><span class="va">strictlyPositiveDV</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,<span class="fl">.5</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-81-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="regression_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["lambda"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.8481126","2":"2940.938"},{"1":"-1.0000000","2":"3329.131"},{"1":"-0.5000000","2":"3189.376"},{"1":"0.0000000","2":"3052.679"},{"1":"0.3333333","2":"2984.003"},{"1":"0.5000000","2":"2960.827"},{"1":"1.0000000","2":"2944.657"},{"1":"2.0000000","2":"3116.590"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="yeo-johnson-transformations" class="level6" data-number="19.1.6.2.1.2"><h6 data-number="19.1.6.2.1.2" class="anchored" data-anchor-id="yeo-johnson-transformations">
<span class="header-section-number">19.1.6.2.1.2</span> Yeo-Johnson Transformations</h6>
<p>Useful if the outcome is not strictly positive.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb230"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/bcPower.html">yjPower</a></span><span class="op">(</span><span class="va">DV</span>, <span class="va">lambda</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section><section id="transformations-of-predictor-variable" class="level5" data-number="19.1.6.2.2"><h5 data-number="19.1.6.2.2" class="anchored" data-anchor-id="transformations-of-predictor-variable">
<span class="header-section-number">19.1.6.2.2</span> Transformations of Predictor Variable</h5>
<section id="component-plus-residual-plots-partial-residual-plots" class="level6" data-number="19.1.6.2.2.1"><h6 data-number="19.1.6.2.2.1" class="anchored" data-anchor-id="component-plus-residual-plots-partial-residual-plots">
<span class="header-section-number">19.1.6.2.2.1</span> Component-Plus-Residual Plots (Partial Residual Plots)</h6>
<p>Linear model:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb231"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/crPlots.html">crPlots</a></span><span class="op">(</span><span class="va">multipleRegressionModelNoMissing</span>, order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-83-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="regression_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Quadratic model:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb232"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/crPlots.html">crPlots</a></span><span class="op">(</span><span class="va">multipleRegressionModelNoMissing</span>, order <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-84-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="regression_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb233"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">multipleRegressionModel_quadratic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">bpi_antisocialT1Sum</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">multipleRegressionModel_quadratic</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + I(bpi_antisocialT1Sum^2) + 
    bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.6238 -1.2610 -0.2484  0.9923 12.9008 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               1.099237   0.076509  14.367  &lt; 2e-16 ***
bpi_antisocialT1Sum       0.547680   0.043723  12.526  &lt; 2e-16 ***
I(bpi_antisocialT1Sum^2) -0.010221   0.004925  -2.075    0.038 *  
bpi_anxiousDepressedSum   0.161734   0.029144   5.549 3.13e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.977 on 2870 degrees of freedom
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.2631,    Adjusted R-squared:  0.2623 
F-statistic: 341.5 on 3 and 2870 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb235"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel_quadratic</span>,</span>
<span>  <span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"2870","2":"11223.01","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"2871","2":"11239.86","3":"-1","4":"-16.84449","5":"4.307551","6":"0.03803241","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb236"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/crPlots.html">crPlots</a></span><span class="op">(</span><span class="va">multipleRegressionModel_quadratic</span>, order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-85-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="regression_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="ceres-plot-combining-conditional-expectations-and-residuals" class="level6" data-number="19.1.6.2.2.2"><h6 data-number="19.1.6.2.2.2" class="anchored" data-anchor-id="ceres-plot-combining-conditional-expectations-and-residuals">
<span class="header-section-number">19.1.6.2.2.2</span> CERES Plot (Combining conditional Expectations and RESiduals)</h6>
<p>Useful when nonlinear associations among the predictors are very strong (component-plus-residual plots may appear nonlinear even though the true partial regression is linear, a phenonomen called leakage)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb237"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/ceresPlots.html">ceresPlots</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-86-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="regression_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb238"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/ceresPlots.html">ceresPlots</a></span><span class="op">(</span><span class="va">multipleRegressionModel_quadratic</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `plot.window()`:
! need finite 'ylim' values</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-86-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="regression_files/figure-html/unnamed-chunk-86-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="box-tidwell-method-for-choosing-predictor-transformations" class="level6" data-number="19.1.6.2.2.3"><h6 data-number="19.1.6.2.2.3" class="anchored" data-anchor-id="box-tidwell-method-for-choosing-predictor-transformations">
<span class="header-section-number">19.1.6.2.2.3</span> Box-Tidwell Method for Choosing Predictor Transformations</h6>
<p>predictors must be strictly positive (or add a constant to make it strictly positive)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb240"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/boxTidwell.html">boxTidwell</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">bpi_anxiousDepressedSum</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  other.x <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">#list variables not to be transformed in other.x</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                               MLE of lambda Score Statistic (t) Pr(&gt;|t|)
I(bpi_antisocialT1Sum + 1)           0.90820             -1.0591   0.2897
I(bpi_anxiousDepressedSum + 1)       0.36689             -1.0650   0.2870

iterations =  4 

Score test for null hypothesis that all lambdas = 1:
F = 1.4056, df = 2 and 2869, Pr(&gt;F) = 0.2454</code></pre>
</div>
</div>
</section><section id="constructed-variables-plot" class="level6" data-number="19.1.6.2.2.4"><h6 data-number="19.1.6.2.2.4" class="anchored" data-anchor-id="constructed-variables-plot">
<span class="header-section-number">19.1.6.2.2.4</span> Constructed-Variables Plot</h6>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb242"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">multipleRegressionModel_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">bpi_anxiousDepressedSum</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">bpi_antisocialT1Sum</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">bpi_antisocialT1Sum</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">bpi_anxiousDepressedSum</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">bpi_anxiousDepressedSum</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">multipleRegressionModel_cv</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="st">"I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum))"</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                                                    Estimate Std. Error
I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum)) -0.1691003 0.06887107
                                                    t value   Pr(&gt;|t|)
I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum)) -2.455317 0.01418393</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb244"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">multipleRegressionModel_cv</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="st">"I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum))"</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                                                            Estimate Std. Error
I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum)) 0.00828867  0.1384918
                                                             t value  Pr(&gt;|t|)
I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum)) 0.05984953 0.9522831</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb246"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/avPlots.html">avPlots</a></span><span class="op">(</span><span class="va">multipleRegressionModel_cv</span>, <span class="st">"I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum))"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-88-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="regression_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb247"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/avPlots.html">avPlots</a></span><span class="op">(</span><span class="va">multipleRegressionModel_cv</span>, <span class="st">"I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum))"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-88-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="regression_files/figure-html/unnamed-chunk-88-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section></section><section id="robust-models" class="level5" data-number="19.1.6.2.3"><h5 data-number="19.1.6.2.3" class="anchored" data-anchor-id="robust-models">
<span class="header-section-number">19.1.6.2.3</span> Robust models</h5>
<p>Resources</p>
<ul>
<li>For comparison of methods, see Book: “Modern Methods for Robust Regression”</li>
<li>
<a href="http://www.ats.ucla.edu/stat/r/dae/rreg.htm" class="uri">http://www.ats.ucla.edu/stat/r/dae/rreg.htm</a> (archived at <a href="https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm" class="uri">https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm</a>)</li>
<li>
<a href="https://stats.stackexchange.com/a/46234/20338" class="uri">https://stats.stackexchange.com/a/46234/20338</a> (archived at <a href="https://perma.cc/WC57-9GA7" class="uri">https://perma.cc/WC57-9GA7</a>)</li>
<li>
<a href="https://cran.r-project.org/web/views/Robust.html" class="uri">https://cran.r-project.org/web/views/Robust.html</a> (archived at <a href="https://perma.cc/THN5-KNY3" class="uri">https://perma.cc/THN5-KNY3</a>)</li>
</ul>
<section id="robust-correlation" class="level6" data-number="19.1.6.2.3.1"><h6 data-number="19.1.6.2.3.1" class="anchored" data-anchor-id="robust-correlation">
<span class="header-section-number">19.1.6.2.3.1</span> Robust correlation</h6>
<section id="spearmans-rho" class="level7"><p class="heading">Spearman’s rho</p>
<p>Spearman’s rho is a non-parametric correlation.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb248"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span></span>
<span>  <span class="va">mydata</span><span class="op">$</span><span class="va">bpi_antisocialT1Sum</span>,</span>
<span>  <span class="va">mydata</span><span class="op">$</span><span class="va">bpi_antisocialT2Sum</span><span class="op">)</span> <span class="co">#Pearson r, correlation that is sensitive to outliers</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  mydata$bpi_antisocialT1Sum and mydata$bpi_antisocialT2Sum
t = 31.274, df = 2873, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.4761758 0.5307381
sample estimates:
      cor 
0.5039595 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb250"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span></span>
<span>  <span class="va">mydata</span><span class="op">$</span><span class="va">bpi_antisocialT1Sum</span>,</span>
<span>  <span class="va">mydata</span><span class="op">$</span><span class="va">bpi_antisocialT2Sum</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span> <span class="co">#Spearman's rho, a rank correlation that is less sensitive to outliers</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  mydata$bpi_antisocialT1Sum and mydata$bpi_antisocialT2Sum
S = 1997347186, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.4956973 </code></pre>
</div>
</div>
</section><section id="minimum-vollume-ellipsoid" class="level7"><p class="heading">Minimum vollume ellipsoid</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb252"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/cov.rob.html">cov.mve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$center
bpi_antisocialT1Sum bpi_antisocialT2Sum 
           2.422714            2.286199 

$cov
                    bpi_antisocialT1Sum bpi_antisocialT2Sum
bpi_antisocialT1Sum            3.202032            2.032802
bpi_antisocialT2Sum            2.032802            3.085717

$msg
[1] "159 singular samples of size 3 out of 1500"

$crit
[1] 4.041517

$best
[1]  1  3  7  8  9 10

$cor
                    bpi_antisocialT1Sum bpi_antisocialT2Sum
bpi_antisocialT1Sum            1.000000            0.646702
bpi_antisocialT2Sum            0.646702            1.000000

$n.obs
[1] 2875</code></pre>
</div>
</div>
</section><section id="minimum-covariance-determinant" class="level7"><p class="heading">Minimum covariance determinant</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb254"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/cov.rob.html">cov.mcd</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$center
bpi_antisocialT1Sum bpi_antisocialT2Sum 
           2.181181            2.094954 

$cov
                    bpi_antisocialT1Sum bpi_antisocialT2Sum
bpi_antisocialT1Sum            2.379036            1.096437
bpi_antisocialT2Sum            1.096437            2.482409

$msg
[1] "153 singular samples of size 3 out of 1500"

$crit
[1] -0.3817849

$best
[1]  1  3  8  9 10 12

$cor
                    bpi_antisocialT1Sum bpi_antisocialT2Sum
bpi_antisocialT1Sum           1.0000000           0.4511764
bpi_antisocialT2Sum           0.4511764           1.0000000

$n.obs
[1] 2875</code></pre>
</div>
</div>
</section><section id="winsorized-correlation" class="level7"><p class="heading">Winsorized correlation</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb256"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/correlation/reference/correlation.html">correlation</a></span><span class="op">(</span></span>
<span>  <span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  winsorize <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  p_adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Parameter1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Parameter2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["r"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["t"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df_error"],"name":[8],"type":["int"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Method"],"name":[10],"type":["chr"],"align":["left"]},{"label":["n_Obs"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"bpi_antisocialT1Sum","2":"bpi_antisocialT2Sum","3":"0.4651836","4":"0.95","5":"0.4360424","6":"0.4933503","7":"28.16721","8":"2873","9":"2.369015e-154","10":"Winsorized Pearson correlation","11":"2875","_rn_":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="percentage-bend-correlation" class="level7"><p class="heading">Percentage bend correlation</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb257"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/correlation/reference/correlation.html">correlation</a></span><span class="op">(</span></span>
<span>  <span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"percentage"</span>,</span>
<span>  p_adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Parameter1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Parameter2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["r"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["t"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df_error"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Method"],"name":[10],"type":["chr"],"align":["left"]},{"label":["n_Obs"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"bpi_antisocialT1Sum","2":"bpi_antisocialT2Sum","3":"0.4837302","4":"0.95","5":"0.4552238","6":"0.511246","7":"29.62478","8":"2873","9":"1.536055e-168","10":"Percentage Bend correlation","11":"2875","_rn_":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="biweight-midcorrelation" class="level7"><p class="heading">Biweight midcorrelation</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb258"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/correlation/reference/correlation.html">correlation</a></span><span class="op">(</span></span>
<span>  <span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"biweight"</span>,</span>
<span>  p_adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Parameter1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Parameter2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["r"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["t"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df_error"],"name":[8],"type":["int"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Method"],"name":[10],"type":["chr"],"align":["left"]},{"label":["n_Obs"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"bpi_antisocialT1Sum","2":"bpi_antisocialT2Sum","3":"0.4792883","4":"0.95","5":"0.465104","6":"0.4932265","7":"58.63389","8":"2873","9":"0","10":"Biweight correlation","11":"2875","_rn_":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="xi-xi" class="level7"><p class="heading">Xi (<span class="math inline">\(\xi\)</span>)</p>
<p>Xi (<span class="math inline">\(\xi\)</span>) is an index of the degree of dependence between two variables</p>
<p>Chatterjee, S. (2021). A new coefficient of correlation. <em>Journal of the American Statistical Association, 116</em>(536), 2009-2022. <a href="https://doi.org/10.1080/01621459.2020.1758115" class="uri">https://doi.org/10.1080/01621459.2020.1758115</a></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb259"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">52242</span><span class="op">)</span> <span class="co"># for reproducibility</span></span>
<span></span>
<span><span class="fu">XICOR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/XICOR/man/xicor.html">xicor</a></span><span class="op">(</span></span>
<span>  <span class="va">mydata</span><span class="op">$</span><span class="va">bpi_antisocialT1Sum</span>,</span>
<span>  <span class="va">mydata</span><span class="op">$</span><span class="va">bpi_antisocialT2Sum</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"permutation"</span>,</span>
<span>  pvalue <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$xi
[1] 0.1751217

$sd
[1] 0.012695

$pval
[1] 0</code></pre>
</div>
</div>
</section></section><section id="robust-regression-with-a-single-predictor" class="level6" data-number="19.1.6.2.3.2"><h6 data-number="19.1.6.2.3.2" class="anchored" data-anchor-id="robust-regression-with-a-single-predictor">
<span class="header-section-number">19.1.6.2.3.2</span> Robust regression with a single predictor</h6>
<section id="theil-sen-estimator" class="level7"><p class="heading">Theil-Sen estimator</p>
<p>The Theil-Sen single median estimator is robust to outliers; have to remove missing values first</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb261"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">400</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/mblm/man/mblm.html">mblm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span>,</span>
<span>  dataframe <span class="op">=</span> <span class="va">mydata_subset</span>,</span>
<span>  repeated <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
mblm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum, dataframe = mydata_subset, 
    repeated = FALSE)

Coefficients:
        (Intercept)  bpi_antisocialT1Sum  
                1.0                  0.6  </code></pre>
</div>
</div>
</section></section><section id="robust-multiple-regression" class="level6" data-number="19.1.6.2.3.3"><h6 data-number="19.1.6.2.3.3" class="anchored" data-anchor-id="robust-multiple-regression">
<span class="header-section-number">19.1.6.2.3.3</span> Robust multiple regression</h6>
<p>Best when no outliers: MM-type regression estimator</p>
<section id="robust-linear-regression" class="level7"><p class="heading">Robust linear regression</p>
<p>MM-type regression estimator (best):</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb263"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/robustbase/man/lmrob.html">lmrob</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lmrob(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,     data = mydata, na.action = na.exclude)
 \--&gt; method = "MM"
Coefficients:
            (Intercept)      bpi_antisocialT1Sum  bpi_anxiousDepressedSum  
                 0.9440                   0.4914                   0.1577  </code></pre>
</div>
</div>
<p>Iteratively reweighted least squares (IRLS): <a href="http://www.ats.ucla.edu/stat/r/dae/rreg.htm" class="uri">http://www.ats.ucla.edu/stat/r/dae/rreg.htm</a> (archived at <a href="https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm" class="uri">https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb265"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/rlm.html">rlm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Call:
rlm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, na.action = na.exclude)
Converged in 6 iterations

Coefficients:
            (Intercept)     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
              0.9838033               0.4873118               0.1620020 

Degrees of freedom: 2874 total; 2871 residual
  (8656 observations deleted due to missingness)
Scale estimate: 1.62 </code></pre>
</div>
</div>
</section><section id="robust-generalized-regression-1" class="level7"><p class="heading">Robust generalized regression</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb267"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/robustbase/man/glmrob.html">glmrob</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="st">"na.exclude"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:  glmrob(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum +      bpi_anxiousDepressedSum, family = "poisson", data = mydata,      na.action = "na.exclude") 

Coefficients:
            (Intercept)      bpi_antisocialT1Sum  bpi_anxiousDepressedSum  
                0.37281                  0.15589                  0.05026  

Number of observations: 2874 
Fitted by method  'Mqle' </code></pre>
</div>
</div>
<p>Most resistant to outliers: Least trimmed squares (LTS)—but not good as a standalone estimator, better for identifying outliers</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb269"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/robustbase/man/ltsReg.html">ltsReg</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
ltsReg.formula(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum +     bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)

Coefficients:
              Intercept      bpi_antisocialT1Sum  bpi_anxiousDepressedSum  
                 0.7813                   0.5145                   0.1318  

Scale estimate 1.75 </code></pre>
</div>
</div>
<section id="not-great-options" class="level8"><p class="heading">Not great options:</p>
<p>Quantile (L1) regression: <code><a href="https://rdrr.io/pkg/quantreg/man/rq.html">rq()</a></code> function of quantreg package</p>
<p><a href="https://data.library.virginia.edu/getting-started-with-quantile-regression/" class="uri">https://data.library.virginia.edu/getting-started-with-quantile-regression/</a> (archived at <a href="https://perma.cc/FSV4-5DCR" class="uri">https://perma.cc/FSV4-5DCR</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb271"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">quantiles</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">/</span><span class="fl">10</span></span>
<span></span>
<span><span class="va">quantileRegressionModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/quantreg/man/rq.html">rq</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  tau <span class="op">=</span> <span class="va">quantiles</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="va">quantileRegressionModel</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Call:
rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

Coefficients:
                           tau= 0.1  tau= 0.2   tau= 0.3 tau= 0.4 tau= 0.5
(Intercept)             -0.19607843 0.0000000 0.09090909      0.5     0.88
bpi_antisocialT1Sum      0.19607843 0.3333333 0.45454545      0.5     0.52
bpi_anxiousDepressedSum  0.09803922 0.1111111 0.13636364      0.1     0.12
                         tau= 0.6 tau= 0.7 tau= 0.8  tau= 0.9
(Intercept)             1.0000000   1.3750   2.1250 3.1000000
bpi_antisocialT1Sum     0.5913978   0.6250   0.6250 0.6428571
bpi_anxiousDepressedSum 0.2043011   0.1875   0.1875 0.2285714

Degrees of freedom: 11530 total; 11527 residual</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb273"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">quantileRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.1

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)             -0.19608  0.05341   -3.67101  0.00025
bpi_antisocialT1Sum      0.19608  0.03492    5.61452  0.00000
bpi_anxiousDepressedSum  0.09804  0.03536    2.77276  0.00559

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.2

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              0.00000  0.04196    0.00000  1.00000
bpi_antisocialT1Sum      0.33333  0.02103   15.85299  0.00000
bpi_anxiousDepressedSum  0.11111  0.02669    4.16376  0.00003

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.3

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              0.09091  0.05830    1.55945  0.11900
bpi_antisocialT1Sum      0.45455  0.02584   17.59380  0.00000
bpi_anxiousDepressedSum  0.13636  0.03601    3.78723  0.00016

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.4

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              0.50000  0.06410    7.80035  0.00000
bpi_antisocialT1Sum      0.50000  0.02374   21.06425  0.00000
bpi_anxiousDepressedSum  0.10000  0.03372    2.96584  0.00304

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.5

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              0.88000  0.06584   13.36547  0.00000
bpi_antisocialT1Sum      0.52000  0.02491   20.87561  0.00000
bpi_anxiousDepressedSum  0.12000  0.03771    3.18245  0.00148

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.6

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              1.00000  0.04246   23.55356  0.00000
bpi_antisocialT1Sum      0.59140  0.02146   27.55553  0.00000
bpi_anxiousDepressedSum  0.20430  0.03156    6.47422  0.00000

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.7

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              1.37500  0.07716   17.82011  0.00000
bpi_antisocialT1Sum      0.62500  0.02397   26.07659  0.00000
bpi_anxiousDepressedSum  0.18750  0.03760    4.98623  0.00000

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.8

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              2.12500  0.09498   22.37224  0.00000
bpi_antisocialT1Sum      0.62500  0.03524   17.73509  0.00000
bpi_anxiousDepressedSum  0.18750  0.05040    3.72020  0.00020

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.9

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              3.10000  0.11730   26.42749  0.00000
bpi_antisocialT1Sum      0.64286  0.04797   13.40136  0.00000
bpi_anxiousDepressedSum  0.22857  0.06439    3.54960  0.00039</code></pre>
</div>
</div>
<p>Plot to examine the association between the predictor and the outcome at different levels (i.e., quantiles) of the predictor:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb275"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">mydata</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">bpi_antisocialT1Sum</span>, <span class="va">bpi_antisocialT2Sum</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_quantile.html">geom_quantile</a></span><span class="op">(</span></span>
<span>    quantiles <span class="op">=</span> <span class="va">quantiles</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">quantile</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-105-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="regression_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Below is a plot that examines the difference in quantile coefficients (and associated confidence intervals) at different levels (i.e., quantiles) of the predictor. The x-axis is the quantile of the predictor. The y-axis is the slope coefficient. Each black dot is the slope coefficient for the given quantile of the predictor. The red lines are the least squares estimate of the slope coefficient and its confidence interval.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb276"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">quantileRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-106-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="regression_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb277"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">quantileRegressionModel</span><span class="op">)</span>,</span>
<span>  parm <span class="op">=</span> <span class="st">"bpi_antisocialT1Sum"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-106-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="regression_files/figure-html/unnamed-chunk-106-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section></section></section></section></section></section></section><section id="examining-model-assumptions" class="level2" data-number="19.2"><h2 data-number="19.2" class="anchored" data-anchor-id="examining-model-assumptions">
<span class="header-section-number">19.2</span> Examining Model Assumptions</h2>
<section id="distribution-of-residuals" class="level3" data-number="19.2.1"><h3 data-number="19.2.1" class="anchored" data-anchor-id="distribution-of-residuals">
<span class="header-section-number">19.2.1</span> Distribution of Residuals</h3>
<section id="sec-qqPlot" class="level4" data-number="19.2.1.1"><h4 data-number="19.2.1.1" class="anchored" data-anchor-id="sec-qqPlot">
<span class="header-section-number">19.2.1.1</span> QQ plots</h4>
<p><a href="https://www.ucd.ie/ecomodel/Resources/QQplots_WebVersion.html" class="uri">https://www.ucd.ie/ecomodel/Resources/QQplots_WebVersion.html</a> (archived at <a href="https://perma.cc/9UC3-3WRX" class="uri">https://perma.cc/9UC3-3WRX</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb278"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span>, main <span class="op">=</span> <span class="st">"QQ Plot"</span>, id <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-107-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="regression_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8955 8956</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb280"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-107-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36"><img src="regression_files/figure-html/unnamed-chunk-107-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb281"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">rmsMultipleRegressionModel</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">robustLinearRegression</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-107-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37"><img src="regression_files/figure-html/unnamed-chunk-107-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb282"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">ltsRegression</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-107-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38"><img src="regression_files/figure-html/unnamed-chunk-107-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb283"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">generalizedRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-107-5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39"><img src="regression_files/figure-html/unnamed-chunk-107-5.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb284"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">rmsGeneralizedRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `residuals.Glm()`:
! argument "type" is missing, with no default</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb286"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">robustGeneralizedRegression</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-107-6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40"><img src="regression_files/figure-html/unnamed-chunk-107-6.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb287"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">multilevelRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `h()`:
! error in evaluating the argument 'object' in selecting a method for function 'resid': object 'multilevelRegressionModel' not found</code></pre>
</div>
</div>
</section><section id="sec-ppPlot" class="level4" data-number="19.2.1.2"><h4 data-number="19.2.1.2" class="anchored" data-anchor-id="sec-ppPlot">
<span class="header-section-number">19.2.1.2</span> PP plots</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb289"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://devpsylab.github.io/petersenlab/reference/ppPlot.html">ppPlot</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-108-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-41"><img src="regression_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb290"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://devpsylab.github.io/petersenlab/reference/ppPlot.html">ppPlot</a></span><span class="op">(</span><span class="va">rmsMultipleRegressionModel</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://devpsylab.github.io/petersenlab/reference/ppPlot.html">ppPlot</a></span><span class="op">(</span><span class="va">robustLinearRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-108-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42"><img src="regression_files/figure-html/unnamed-chunk-108-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb291"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://devpsylab.github.io/petersenlab/reference/ppPlot.html">ppPlot</a></span><span class="op">(</span><span class="va">ltsRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-108-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43"><img src="regression_files/figure-html/unnamed-chunk-108-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb292"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://devpsylab.github.io/petersenlab/reference/ppPlot.html">ppPlot</a></span><span class="op">(</span><span class="va">generalizedRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-108-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44"><img src="regression_files/figure-html/unnamed-chunk-108-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb293"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://devpsylab.github.io/petersenlab/reference/ppPlot.html">ppPlot</a></span><span class="op">(</span><span class="va">rmsGeneralizedRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `residuals.Glm()`:
! argument "type" is missing, with no default</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb295"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://devpsylab.github.io/petersenlab/reference/ppPlot.html">ppPlot</a></span><span class="op">(</span><span class="va">robustGeneralizedRegression</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-108-5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-45"><img src="regression_files/figure-html/unnamed-chunk-108-5.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="sec-densityPlotResiduals" class="level4" data-number="19.2.1.3"><h4 data-number="19.2.1.3" class="anchored" data-anchor-id="sec-densityPlotResiduals">
<span class="header-section-number">19.2.1.3</span> Density Plot of Residuals</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb296"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">studentizedResiduals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">studentizedResiduals</span><span class="op">)</span>,</span>
<span>  col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="va">xfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">studentizedResiduals</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">studentizedResiduals</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  length <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span></span>
<span>  <span class="va">xfit</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">xfit</span><span class="op">)</span>,</span>
<span>  col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span> <span class="co">#compare to normal distribution</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-109-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-46"><img src="regression_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section></section><section id="sec-residualPlots" class="level3" data-number="19.2.2"><h3 data-number="19.2.2" class="anchored" data-anchor-id="sec-residualPlots">
<span class="header-section-number">19.2.2</span> Residual Plots</h3>
<p>Residual plots are plots of the residuals versus observed/fitted values.</p>
<p>Includes plots of a) model residuals versus observed values on predictors and b) model residuals versus model fitted values.</p>
<p>Note: have to remove <code>na.action = na.exclude</code></p>
<p>Tests include:</p>
<ul>
<li>lack-of-fit test for every numeric predictor, t-test for the regressor, added to the model, indicating no lack-of-fit for this type</li>
<li>Tukey’s test for nonadditivity: adding the squares of the fitted values to the model and refitting (evaluates adequacy of model fit)</li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb297"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/residualPlots.html">residualPlots</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModelNoMissing</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-110-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-47"><img src="regression_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Test stat Pr(&gt;|Test stat|)  
bpi_antisocialT1Sum       -2.0755          0.03803 *
bpi_anxiousDepressedSum   -1.2769          0.20175  
Tukey test                -2.3351          0.01954 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section><section id="sec-marginalModelPlots" class="level3" data-number="19.2.3"><h3 data-number="19.2.3" class="anchored" data-anchor-id="sec-marginalModelPlots">
<span class="header-section-number">19.2.3</span> Marginal Model Plots</h3>
<p>Marginal model plots are plots of the outcome versus predictors/fitted values.</p>
<p>Includes plots of a) observed outcome values versus values on predictors (ignoring the other predictors) and b) observed outcome values versus model fitted values.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb299"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/marginalModelPlot.html">marginalModelPlots</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel</span>,</span>
<span>  sd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-111-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-48"><img src="regression_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="sec-addedVariablePlots" class="level3" data-number="19.2.4"><h3 data-number="19.2.4" class="anchored" data-anchor-id="sec-addedVariablePlots">
<span class="header-section-number">19.2.4</span> Added-Variable Plots</h3>
<p>Added-variable plots are plots of the partial association between the outcome and each predictor, controlling for all other predictors.</p>
<p>Useful for identifying jointly influential observations and studying the impact of observations on the regression coefficients.</p>
<p>y-axis: residuals from model with all predictors excluding the predictor of interest</p>
<p>x-axis: residuals from model regressing predictor of interest on all other predictors</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb300"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/avPlots.html">avPlots</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-112-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-49"><img src="regression_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<section id="refit-model-removing-jointly-influential-observations" class="level4" data-number="19.2.4.1"><h4 data-number="19.2.4.1" class="anchored" data-anchor-id="refit-model-removing-jointly-influential-observations">
<span class="header-section-number">19.2.4.1</span> Refit model removing jointly influential observations</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb301"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">multipleRegressionModel_removeJointlyInfluentialObs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  subset <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6318</span>,<span class="fl">6023</span>,<span class="fl">4022</span>,<span class="fl">4040</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/avPlots.html">avPlots</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel_removeJointlyInfluentialObs</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-113-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-50"><img src="regression_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb302"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/compareCoefs.html">compareCoefs</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel</span>,</span>
<span>  <span class="va">multipleRegressionModel_removeJointlyInfluentialObs</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Calls:
1: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)
2: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(6318, 6023, 4022, 4040),
   na.action = na.exclude)

                        Model 1 Model 2
(Intercept)              1.1983  1.1949
SE                       0.0598  0.0599
                                       
bpi_antisocialT1Sum      0.4655  0.4649
SE                       0.0186  0.0188
                                       
bpi_anxiousDepressedSum  0.1608  0.1665
SE                       0.0292  0.0295
                                       </code></pre>
</div>
</div>
</section></section><section id="outlier-test" class="level3" data-number="19.2.5"><h3 data-number="19.2.5" class="anchored" data-anchor-id="outlier-test">
<span class="header-section-number">19.2.5</span> Outlier test</h3>
<p>Locates the largest Studentized residuals in absolute value and computes the Bonferroni-corrected p-values based on a t-test for linear models.</p>
<p>Test of outlyingness, i.e., how likely one would have a residual of a given magnitude in a normal distribution with the same sample size</p>
<p>Note: it does not test how extreme an observation is relative to its distribution (i.e., leverage)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb304"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/outlierTest.html">outlierTest</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     rstudent unadjusted p-value Bonferroni p
8955 6.519574         8.2999e-11   2.3854e-07
8956 6.519574         8.2999e-11   2.3854e-07
8957 6.182195         7.2185e-10   2.0746e-06
2560 4.914941         9.3800e-07   2.6958e-03
1385 4.573975         4.9884e-06   1.4337e-02</code></pre>
</div>
</div>
</section><section id="observations-with-high-leverage" class="level3" data-number="19.2.6"><h3 data-number="19.2.6" class="anchored" data-anchor-id="observations-with-high-leverage">
<span class="header-section-number">19.2.6</span> Observations with high leverage</h3>
<p>Identifies observations with high leverage (i.e., high hat values)</p>
<p>hat values are an index of leverage (observations that are far from the center of the regressor space and have greater influence on OLS regression coefficients)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb306"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hatvalues</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-115-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-51"><img src="regression_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb307"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hatvalues</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-115-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-52"><img src="regression_files/figure-html/unnamed-chunk-115-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb308"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/infIndexPlot.html">influenceIndexPlot</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-115-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-53"><img src="regression_files/figure-html/unnamed-chunk-115-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb309"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/influencePlot.html">influencePlot</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># circle size is proportional to Cook's Distance</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-115-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-54"><img src="regression_files/figure-html/unnamed-chunk-115-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["StudRes"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Hat"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["CookD"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"-3.940128","2":"0.006990052","3":"0.03624388","_rn_":"5286"},{"1":"-4.264903","2":"0.009024093","3":"0.05488391","_rn_":"10898"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb310"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/leveragePlots.html">leveragePlots</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-115-5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-55"><img src="regression_files/figure-html/unnamed-chunk-115-5.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="observations-with-high-influence-on-ols-regression-coefficients" class="level3" data-number="19.2.7"><h3 data-number="19.2.7" class="anchored" data-anchor-id="observations-with-high-influence-on-ols-regression-coefficients">
<span class="header-section-number">19.2.7</span> Observations with high influence (on OLS regression coefficients)</h3>
<p><a href="https://cran.r-project.org/web/packages/olsrr/vignettes/influence_measures.html" class="uri">https://cran.r-project.org/web/packages/olsrr/vignettes/influence_measures.html</a> (archived at <a href="https://perma.cc/T2TS-PZZ4" class="uri">https://perma.cc/T2TS-PZZ4</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb311"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">influence.measures</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">$</span><span class="va">infmat</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>        dfb.1_     dfb.b_T1     dfb.b_DS       dffit     cov.r       cook.d
1  0.000000000  0.000000000  0.000000000          NA 1.0000000           NA
2  0.000000000  0.000000000  0.000000000          NA 1.0000000           NA
3 -0.006546394  0.008357248 -0.006308529 -0.01004886 1.0024362 0.0000336708
4  0.042862749 -0.025185789 -0.007782877  0.04286275 0.9998621 0.0006121902
5  0.000000000  0.000000000  0.000000000          NA 1.0000000           NA
6 -0.018327367  0.010769006  0.003327823 -0.01832737 1.0015775 0.0001119888
           hat
1 0.0000000000
2 0.0000000000
3 0.0014593072
4 0.0009143185
5 0.0000000000
6 0.0009143185</code></pre>
</div>
</div>
</section><section id="sec-dfbeta" class="level3" data-number="19.2.8"><h3 data-number="19.2.8" class="anchored" data-anchor-id="sec-dfbeta">
<span class="header-section-number">19.2.8</span> DFBETA</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb313"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dfbeta</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>    (Intercept) bpi_antisocialT1Sum bpi_anxiousDepressedSum
1  0.0000000000        0.0000000000            0.000000e+00
2  0.0000000000        0.0000000000            0.000000e+00
3 -0.0003917284        0.0001553400           -1.839704e-04
4  0.0025639901       -0.0004679817           -2.268890e-04
5  0.0000000000        0.0000000000            0.000000e+00
6 -0.0010966309        0.0002001580            9.704151e-05</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb315"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dfbeta</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-117-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-56"><img src="regression_files/figure-html/unnamed-chunk-117-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb316"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/dfbetaPlots.html">dfbetasPlots</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `dfbetasPlots.lm()`:
! argument 2 matches multiple formal arguments</code></pre>
</div>
</div>
</section><section id="sec-dffits" class="level3" data-number="19.2.9"><h3 data-number="19.2.9" class="anchored" data-anchor-id="sec-dffits">
<span class="header-section-number">19.2.9</span> DFFITS</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb318"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dffits</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dffits</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     8472      4468      1917      8955      8956      1986 
0.2664075 0.2428065 0.2237760 0.1972271 0.1972271 0.1923034 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb320"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dffits</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-118-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-57"><img src="regression_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb321"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dffits</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-118-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-58"><img src="regression_files/figure-html/unnamed-chunk-118-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb322"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dffits</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dffits</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-118-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-59"><img src="regression_files/figure-html/unnamed-chunk-118-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="sec-cooksDistance" class="level3" data-number="19.2.10"><h3 data-number="19.2.10" class="anchored" data-anchor-id="sec-cooksDistance">
<span class="header-section-number">19.2.10</span> Cook’s Distance</h3>
<p>Observations that are both outlying (have a high residual from the regression line) and have high leverage (are far from the center of the regressor space) have high influence on the OLS regression coefficients. An observation will have less influence if it lies on the regression line (not an outlier, i.e., has a low residual) or if it has low leverage (i.e., has a value near the center of a predictor’s distribution).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb323"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      2765       1371       2767       8472       6170       6023 
0.05488391 0.03624388 0.03624388 0.02358305 0.02323282 0.02315496 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb325"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-119-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-60"><img src="regression_files/figure-html/unnamed-chunk-119-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb326"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-119-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-61"><img src="regression_files/figure-html/unnamed-chunk-119-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb327"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="va">multipleRegressionModel</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="regression_files/figure-html/unnamed-chunk-119-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-62"><img src="regression_files/figure-html/unnamed-chunk-119-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<section id="refit-model-removing-values-with-high-cooks-distance" class="level4" data-number="19.2.10.1"><h4 data-number="19.2.10.1" class="anchored" data-anchor-id="refit-model-removing-values-with-high-cooks-distance">
<span class="header-section-number">19.2.10.1</span> Refit model removing values with high cook’s distance</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb328"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">multipleRegressionModel_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  subset <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2765</span>,<span class="fl">1371</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">multipleRegressionModel_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  subset <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2765</span>,<span class="fl">1371</span>,<span class="fl">2767</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">multipleRegressionModel_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  subset <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2765</span>,<span class="fl">1371</span>,<span class="fl">2767</span>,<span class="fl">8472</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">multipleRegressionModel_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  subset <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2765</span>,<span class="fl">1371</span>,<span class="fl">2767</span>,<span class="fl">8472</span>,<span class="fl">6170</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">multipleRegressionModel_6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  subset <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2765</span>,<span class="fl">1371</span>,<span class="fl">2767</span>,<span class="fl">8472</span>,<span class="fl">6170</span>,<span class="fl">6023</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">multipleRegressionModel_7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  subset <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2765</span>,<span class="fl">1371</span>,<span class="fl">2767</span>,<span class="fl">8472</span>,<span class="fl">6170</span>,<span class="fl">6023</span>,<span class="fl">2766</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="examine-how-much-regression-coefficients-change-when-excluding-influential-observations" class="level5" data-number="19.2.10.1.1"><h5 data-number="19.2.10.1.1" class="anchored" data-anchor-id="examine-how-much-regression-coefficients-change-when-excluding-influential-observations">
<span class="header-section-number">19.2.10.1.1</span> Examine how much regression coefficients change when excluding influential observations</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb329"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/compareCoefs.html">compareCoefs</a></span><span class="op">(</span></span>
<span>  <span class="va">multipleRegressionModel</span>,</span>
<span>  <span class="va">multipleRegressionModel_2</span>,</span>
<span>  <span class="va">multipleRegressionModel_3</span>,</span>
<span>  <span class="va">multipleRegressionModel_4</span>,</span>
<span>  <span class="va">multipleRegressionModel_5</span>,</span>
<span>  <span class="va">multipleRegressionModel_6</span>,</span>
<span>  <span class="va">multipleRegressionModel_7</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Calls:
1: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)
2: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371), na.action =
   na.exclude)
3: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767), 
  na.action = na.exclude)
4: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767, 8472),
   na.action = na.exclude)
5: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767, 8472, 
  6170), na.action = na.exclude)
6: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767, 8472, 
  6170, 6023), na.action = na.exclude)
7: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767, 8472, 
  6170, 6023, 2766), na.action = na.exclude)

                        Model 1 Model 2 Model 3 Model 4 Model 5 Model 6 Model 7
(Intercept)              1.1983  1.1704  1.1577  1.1676  1.1620  1.1537  1.1439
SE                       0.0598  0.0597  0.0596  0.0596  0.0596  0.0595  0.0595
                                                                               
bpi_antisocialT1Sum      0.4655  0.4739  0.4779  0.4748  0.4744  0.4793  0.4836
SE                       0.0186  0.0185  0.0185  0.0185  0.0185  0.0185  0.0185
                                                                               
bpi_anxiousDepressedSum  0.1608  0.1691  0.1726  0.1699  0.1770  0.1742  0.1743
SE                       0.0292  0.0290  0.0290  0.0289  0.0290  0.0290  0.0289
                                                                               </code></pre>
</div>
</div>
</section></section><section id="examine-how-much-regression-coefficients-change-when-using-least-trimmed-squares-lts-that-is-resistant-to-outliers" class="level4" data-number="19.2.10.2"><h4 data-number="19.2.10.2" class="anchored" data-anchor-id="examine-how-much-regression-coefficients-change-when-using-least-trimmed-squares-lts-that-is-resistant-to-outliers">
<span class="header-section-number">19.2.10.2</span> Examine how much regression coefficients change when using least trimmed squares (LTS) that is resistant to outliers</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb331"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action<span class="op">=</span><span class="st">"na.exclude"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
              1.1983004               0.4655286               0.1607541 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb333"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/robustbase/man/ltsReg.html">ltsReg</a></span><span class="op">(</span></span>
<span>  <span class="va">bpi_antisocialT2Sum</span> <span class="op">~</span> <span class="va">bpi_antisocialT1Sum</span> <span class="op">+</span> <span class="va">bpi_anxiousDepressedSum</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="st">"na.exclude"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>              Intercept     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
              0.7439567               0.5432644               0.1524929 </code></pre>
</div>
</div>
</section></section><section id="resources" class="level3" data-number="19.2.11"><h3 data-number="19.2.11" class="anchored" data-anchor-id="resources">
<span class="header-section-number">19.2.11</span> Resources</h3>
<p>Book: An <code>R</code> Companion to Applied Regression</p>
<p><a href="https://people.duke.edu/~rnau/testing.htm" class="uri">https://people.duke.edu/~rnau/testing.htm</a> (archived at <a href="https://perma.cc/9CXH-GBSN" class="uri">https://perma.cc/9CXH-GBSN</a>)</p>
<p><a href="https://www.statmethods.net/stats/rdiagnostics.html" class="uri">https://www.statmethods.net/stats/rdiagnostics.html</a> (archived at <a href="https://perma.cc/7JX8-K6BY" class="uri">https://perma.cc/7JX8-K6BY</a>)</p>
<p><a href="https://socserv.socsci.mcmaster.ca/jfox/Courses/Brazil-2009/index.html" class="uri">https://socserv.socsci.mcmaster.ca/jfox/Courses/Brazil-2009/index.html</a> (archived at <a href="https://perma.cc/4A2P-9S49" class="uri">https://perma.cc/4A2P-9S49</a>)</p>
<p><a href="https://en.wikipedia.org/wiki/Ordinary_least_squares#Assumptions" class="uri">https://en.wikipedia.org/wiki/Ordinary_least_squares#Assumptions</a> (archived at <a href="https://perma.cc/Q4NS-X8TJ" class="uri">https://perma.cc/Q4NS-X8TJ</a>)</p>
</section></section></section><section id="session-info" class="level1" data-number="20"><h1 data-number="20">
<span class="header-section-number">20</span> Session Info</h1>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb335"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.2 (2025-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] yhat_2.0-5         rockchalk_1.8.157  effectsize_1.0.1   cocor_1.1-4       
 [5] XICOR_0.4.1        mice_3.19.0        regtools_1.7.0     gtools_3.9.5      
 [9] FNN_1.1.4.1        lavaan_0.6-21      interactions_1.2.0 correlation_0.8.8 
[13] effects_4.2-4      mblm_0.12.1        quantreg_6.1       SparseM_1.84-2    
[17] olsrr_0.6.1        foreign_0.8-90     AER_1.2-15         survival_3.8-3    
[21] sandwich_3.1-1     lmtest_0.9-40      zoo_1.8-15         mgcv_1.9-3        
[25] nlme_3.1-168       car_3.1-3          carData_3.0-5      cvTools_0.3.3     
[29] lattice_0.22-7     brms_2.23.0        Rcpp_1.1.0         robustbase_0.99-6 
[33] rms_8.1-0          Hmisc_5.2-4        psych_2.5.6        lubridate_1.9.4   
[37] forcats_1.0.1      stringr_1.6.0      dplyr_1.1.4        purrr_1.2.0       
[41] readr_2.1.6        tidyr_1.3.2        tibble_3.3.0       ggplot2_4.0.1     
[45] tidyverse_2.0.0    MASS_7.3-65        petersenlab_1.2.2 

loaded via a namespace (and not attached):
  [1] domir_1.2.0           splines_4.5.2         polspline_1.1.25     
  [4] R.oo_1.27.1           datawizard_1.3.0      rpart_4.1.24         
  [7] lifecycle_1.0.4       Rdpack_2.6.4          StanHeaders_2.32.10  
 [10] processx_3.8.6        globals_0.18.0        insight_1.4.4        
 [13] backports_1.5.0       survey_4.4-8          magrittr_2.0.4       
 [16] openxlsx_4.2.8.1      rmarkdown_2.30        plotrix_3.8-13       
 [19] yaml_2.3.12           otel_0.2.0            text2vec_0.6.6       
 [22] zip_2.3.3             pkgbuild_1.4.8        DBI_1.2.3            
 [25] minqa_1.2.8           RColorBrewer_1.1-3    multcomp_1.4-29      
 [28] abind_1.4-8           quadprog_1.5-8        nnet_7.3-20          
 [31] TH.data_1.1-5         tensorA_0.36.2.1      psychTools_2.5.7.22  
 [34] jtools_2.3.0          float_0.3-3           inline_0.3.21        
 [37] listenv_0.10.0        nortest_1.0-4         performance_0.15.3   
 [40] MatrixModels_0.5-4    goftest_1.2-3         bridgesampling_1.2-1 
 [43] parallelly_1.46.0     codetools_0.2-20      tidyselect_1.2.1     
 [46] shape_1.4.6.1         bayesplot_1.15.0      farver_2.1.2         
 [49] lme4_1.1-38           broom.mixed_0.2.9.6   matrixStats_1.5.0    
 [52] stats4_4.5.2          base64enc_0.1-3       jsonlite_2.0.0       
 [55] rsparse_0.5.3         mitml_0.4-5           Formula_1.2-5        
 [58] iterators_1.0.14      foreach_1.5.2         tools_4.5.2          
 [61] miscTools_0.6-28      yacca_1.4-2           glue_1.8.0           
 [64] mnormt_2.1.1          gridExtra_2.3         pan_1.9              
 [67] xfun_0.55             distributional_0.5.0  rtf_0.4-14.1         
 [70] rje_1.12.1            loo_2.9.0             withr_3.0.2          
 [73] fastmap_1.2.0         mitools_2.4           boot_1.3-32          
 [76] callr_3.7.6           digest_0.6.39         estimability_1.5.1   
 [79] timechange_0.3.0      R6_2.6.1              colorspace_2.1-2     
 [82] mix_1.0-13            R.methodsS3_1.8.2     RhpcBLASctl_0.23-42  
 [85] generics_0.1.4        data.table_1.18.0     htmlwidgets_1.6.4    
 [88] parameters_0.28.3     pkgconfig_2.0.3       gtable_0.3.6         
 [91] S7_0.2.1              furrr_0.3.1           htmltools_0.5.9      
 [94] scales_1.4.0          posterior_1.6.1       reformulas_0.4.3     
 [97] lgr_0.5.0             knitr_1.51            rstudioapi_0.17.1    
[100] tzdb_0.5.0            reshape2_1.4.5        coda_0.19-4.1        
[103] checkmate_2.3.3       nloptr_2.2.1          parallel_4.5.2       
[106] mlapi_0.1.1           pillar_1.11.1         grid_4.5.2           
[109] vctrs_0.6.5           jomo_2.7-6            xtable_1.8-4         
[112] cluster_2.1.8.1       htmlTable_2.4.3       evaluate_1.0.5       
[115] pbivnorm_0.6.0        kutils_1.73           mvtnorm_1.3-3        
[118] cli_3.6.5             compiler_4.5.2        rlang_1.1.6          
[121] crayon_1.5.3          rstantools_2.5.0      labeling_0.4.3       
[124] ps_1.9.1              plyr_1.8.9            rstan_2.32.7         
[127] stringi_1.8.7         pander_0.6.6          QuickJSR_1.8.1       
[130] viridisLite_0.4.2     glmnet_4.1-10         Brobdingnag_1.2-9    
[133] bayestestR_0.17.0     Matrix_1.7-4          hms_1.1.4            
[136] future_1.68.0         rbibutils_2.4         broom_1.0.11         
[139] RcppParallel_5.1.11-1 DEoptimR_1.1-4       </code></pre>
</div>
</div>


<!-- -->

</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section></div></main><!-- /main --><!-- Add lab logo --><p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%"></a>
</p>

<br><hr>
<br><!-- Add icon library --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!-- Add font awesome icons --><p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/devpsylab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/DevPsyLab\.github\.io\/DataAnalysis\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb337" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Regression"</span></span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span></span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html_document:</span></span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a><span class="co">    code_folding: show</span></span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-8"><a href="#cb337-8" aria-hidden="true" tabindex="-1"></a><span class="fu"># Preamble</span></span>
<span id="cb337-9"><a href="#cb337-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-10"><a href="#cb337-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## Install Libraries</span></span>
<span id="cb337-11"><a href="#cb337-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-14"><a href="#cb337-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-15"><a href="#cb337-15" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("remotes")</span></span>
<span id="cb337-16"><a href="#cb337-16" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("DevPsyLab/petersenlab")</span></span>
<span id="cb337-17"><a href="#cb337-17" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-18"><a href="#cb337-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-19"><a href="#cb337-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Libraries</span></span>
<span id="cb337-20"><a href="#cb337-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-23"><a href="#cb337-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-24"><a href="#cb337-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"petersenlab"</span>)</span>
<span id="cb337-25"><a href="#cb337-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"MASS"</span>)</span>
<span id="cb337-26"><a href="#cb337-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb337-27"><a href="#cb337-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"psych"</span>)</span>
<span id="cb337-28"><a href="#cb337-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rms"</span>)</span>
<span id="cb337-29"><a href="#cb337-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"robustbase"</span>)</span>
<span id="cb337-30"><a href="#cb337-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"brms"</span>)</span>
<span id="cb337-31"><a href="#cb337-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"cvTools"</span>)</span>
<span id="cb337-32"><a href="#cb337-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"car"</span>)</span>
<span id="cb337-33"><a href="#cb337-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mgcv"</span>)</span>
<span id="cb337-34"><a href="#cb337-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"AER"</span>)</span>
<span id="cb337-35"><a href="#cb337-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"foreign"</span>)</span>
<span id="cb337-36"><a href="#cb337-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"olsrr"</span>)</span>
<span id="cb337-37"><a href="#cb337-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"quantreg"</span>)</span>
<span id="cb337-38"><a href="#cb337-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mblm"</span>)</span>
<span id="cb337-39"><a href="#cb337-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"effects"</span>)</span>
<span id="cb337-40"><a href="#cb337-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"correlation"</span>)</span>
<span id="cb337-41"><a href="#cb337-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"interactions"</span>)</span>
<span id="cb337-42"><a href="#cb337-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"lavaan"</span>)</span>
<span id="cb337-43"><a href="#cb337-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"regtools"</span>)</span>
<span id="cb337-44"><a href="#cb337-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mice"</span>)</span>
<span id="cb337-45"><a href="#cb337-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"XICOR"</span>)</span>
<span id="cb337-46"><a href="#cb337-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"cocor"</span>)</span>
<span id="cb337-47"><a href="#cb337-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"effectsize"</span>)</span>
<span id="cb337-48"><a href="#cb337-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rockchalk"</span>)</span>
<span id="cb337-49"><a href="#cb337-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"yhat"</span>)</span>
<span id="cb337-50"><a href="#cb337-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-51"><a href="#cb337-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-52"><a href="#cb337-52" aria-hidden="true" tabindex="-1"></a><span class="fu"># Import Data</span></span>
<span id="cb337-53"><a href="#cb337-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-56"><a href="#cb337-56" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-57"><a href="#cb337-57" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb337-58"><a href="#cb337-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-59"><a href="#cb337-59" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://osf.io/8syp5/download"</span>)</span>
<span id="cb337-60"><a href="#cb337-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-61"><a href="#cb337-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-64"><a href="#cb337-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-65"><a href="#cb337-65" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb337-66"><a href="#cb337-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-67"><a href="#cb337-67" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/cnlsy.csv"</span>) <span class="co">#https://osf.io/8syp5/download</span></span>
<span id="cb337-68"><a href="#cb337-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-69"><a href="#cb337-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-70"><a href="#cb337-70" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Preparation</span></span>
<span id="cb337-71"><a href="#cb337-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-74"><a href="#cb337-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-75"><a href="#cb337-75" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>countVariable <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(mydata<span class="sc">$</span>bpi_antisocialT2Sum)</span>
<span id="cb337-76"><a href="#cb337-76" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>orderedVariable <span class="ot">&lt;-</span> <span class="fu">factor</span>(mydata<span class="sc">$</span>countVariable, <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-77"><a href="#cb337-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-78"><a href="#cb337-78" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>female <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb337-79"><a href="#cb337-79" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>female[<span class="fu">which</span>(mydata<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"male"</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb337-80"><a href="#cb337-80" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>female[<span class="fu">which</span>(mydata<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"female"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb337-81"><a href="#cb337-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-82"><a href="#cb337-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-83"><a href="#cb337-83" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview of Multiple Regression</span></span>
<span id="cb337-84"><a href="#cb337-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-85"><a href="#cb337-85" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/multiple-regression.html&gt;</span></span>
<span id="cb337-86"><a href="#cb337-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-87"><a href="#cb337-87" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linear Regression</span></span>
<span id="cb337-88"><a href="#cb337-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-89"><a href="#cb337-89" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear regression model</span></span>
<span id="cb337-90"><a href="#cb337-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-93"><a href="#cb337-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-94"><a href="#cb337-94" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-95"><a href="#cb337-95" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-96"><a href="#cb337-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-97"><a href="#cb337-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-98"><a href="#cb337-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-99"><a href="#cb337-99" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel)</span>
<span id="cb337-100"><a href="#cb337-100" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(multipleRegressionModel)</span>
<span id="cb337-101"><a href="#cb337-101" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(multipleRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-102"><a href="#cb337-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-103"><a href="#cb337-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-104"><a href="#cb337-104" aria-hidden="true" tabindex="-1"></a><span class="fu">### Remove missing data</span></span>
<span id="cb337-105"><a href="#cb337-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-108"><a href="#cb337-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-109"><a href="#cb337-109" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelNoMissing <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-110"><a href="#cb337-110" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-111"><a href="#cb337-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-112"><a href="#cb337-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit)</span>
<span id="cb337-113"><a href="#cb337-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-114"><a href="#cb337-114" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelNoMissing <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-115"><a href="#cb337-115" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-116"><a href="#cb337-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata <span class="sc">%&gt;%</span> <span class="fu">select</span>(bpi_antisocialT2Sum, bpi_antisocialT1Sum, bpi_anxiousDepressedSum) <span class="sc">%&gt;%</span> na.omit)</span>
<span id="cb337-117"><a href="#cb337-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-118"><a href="#cb337-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-119"><a href="#cb337-119" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear regression model on correlation/covariance matrix (for pairwise deletion)</span></span>
<span id="cb337-120"><a href="#cb337-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-123"><a href="#cb337-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-124"><a href="#cb337-124" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelPairwise <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">setCor</span>(</span>
<span id="cb337-125"><a href="#cb337-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span id="cb337-126"><a href="#cb337-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span>),</span>
<span id="cb337-127"><a href="#cb337-127" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">cov</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT2Sum"</span>,<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span>)], <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>),</span>
<span id="cb337-128"><a href="#cb337-128" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.obs =</span> <span class="fu">nrow</span>(mydata))</span>
<span id="cb337-129"><a href="#cb337-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-130"><a href="#cb337-130" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModelPairwise)</span>
<span id="cb337-131"><a href="#cb337-131" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelPairwise[<span class="fu">c</span>(<span class="st">"coefficients"</span>,<span class="st">"se"</span>,<span class="st">"Probability"</span>,<span class="st">"R2"</span>,<span class="st">"shrunkenR2"</span>)]</span>
<span id="cb337-132"><a href="#cb337-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-133"><a href="#cb337-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-134"><a href="#cb337-134" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear regression model with robust covariance matrix (rms)</span></span>
<span id="cb337-135"><a href="#cb337-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-138"><a href="#cb337-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-139"><a href="#cb337-139" aria-hidden="true" tabindex="-1"></a>rmsMultipleRegressionModel <span class="ot">&lt;-</span> <span class="fu">robcov</span>(<span class="fu">ols</span>(</span>
<span id="cb337-140"><a href="#cb337-140" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-141"><a href="#cb337-141" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-142"><a href="#cb337-142" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-143"><a href="#cb337-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>))</span>
<span id="cb337-144"><a href="#cb337-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-145"><a href="#cb337-145" aria-hidden="true" tabindex="-1"></a>rmsMultipleRegressionModel</span>
<span id="cb337-146"><a href="#cb337-146" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(rmsMultipleRegressionModel)</span>
<span id="cb337-147"><a href="#cb337-147" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(rmsMultipleRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-148"><a href="#cb337-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-149"><a href="#cb337-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-150"><a href="#cb337-150" aria-hidden="true" tabindex="-1"></a><span class="fu">## Robust linear regression (MM-type iteratively reweighted least squares regression)</span></span>
<span id="cb337-151"><a href="#cb337-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-154"><a href="#cb337-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-155"><a href="#cb337-155" aria-hidden="true" tabindex="-1"></a>robustLinearRegression <span class="ot">&lt;-</span> <span class="fu">lmrob</span>(</span>
<span id="cb337-156"><a href="#cb337-156" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-157"><a href="#cb337-157" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-158"><a href="#cb337-158" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-159"><a href="#cb337-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-160"><a href="#cb337-160" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(robustLinearRegression)</span>
<span id="cb337-161"><a href="#cb337-161" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(robustLinearRegression)</span>
<span id="cb337-162"><a href="#cb337-162" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(robustLinearRegression), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-163"><a href="#cb337-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-164"><a href="#cb337-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-165"><a href="#cb337-165" aria-hidden="true" tabindex="-1"></a><span class="fu">## Least trimmed squares regression (for removing outliers)</span></span>
<span id="cb337-166"><a href="#cb337-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-169"><a href="#cb337-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-170"><a href="#cb337-170" aria-hidden="true" tabindex="-1"></a>ltsRegression <span class="ot">&lt;-</span> robustbase<span class="sc">::</span><span class="fu">ltsReg</span>(</span>
<span id="cb337-171"><a href="#cb337-171" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-172"><a href="#cb337-172" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-173"><a href="#cb337-173" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-174"><a href="#cb337-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-175"><a href="#cb337-175" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ltsRegression)</span>
<span id="cb337-176"><a href="#cb337-176" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(robustLinearRegression)</span>
<span id="cb337-177"><a href="#cb337-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-178"><a href="#cb337-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-179"><a href="#cb337-179" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian linear regression</span></span>
<span id="cb337-180"><a href="#cb337-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-183"><a href="#cb337-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-184"><a href="#cb337-184" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb337-185"><a href="#cb337-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-186"><a href="#cb337-186" aria-hidden="true" tabindex="-1"></a>bayesianRegularizedRegression <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb337-187"><a href="#cb337-187" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-188"><a href="#cb337-188" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-189"><a href="#cb337-189" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb337-190"><a href="#cb337-190" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb337-191"><a href="#cb337-191" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>)</span>
<span id="cb337-192"><a href="#cb337-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-193"><a href="#cb337-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-196"><a href="#cb337-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-197"><a href="#cb337-197" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianRegularizedRegression)</span>
<span id="cb337-198"><a href="#cb337-198" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianRegularizedRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-199"><a href="#cb337-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-200"><a href="#cb337-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-201"><a href="#cb337-201" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generalized Linear Regression</span></span>
<span id="cb337-202"><a href="#cb337-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-203"><a href="#cb337-203" aria-hidden="true" tabindex="-1"></a><span class="fu">## Generalized regression model</span></span>
<span id="cb337-204"><a href="#cb337-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-205"><a href="#cb337-205" aria-hidden="true" tabindex="-1"></a>In this example, we predict a count variable that has a poisson distribution.</span>
<span id="cb337-206"><a href="#cb337-206" aria-hidden="true" tabindex="-1"></a>We could change the distribution.</span>
<span id="cb337-207"><a href="#cb337-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-210"><a href="#cb337-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-211"><a href="#cb337-211" aria-hidden="true" tabindex="-1"></a>generalizedRegressionModel <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb337-212"><a href="#cb337-212" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-213"><a href="#cb337-213" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-214"><a href="#cb337-214" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb337-215"><a href="#cb337-215" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-216"><a href="#cb337-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-217"><a href="#cb337-217" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(generalizedRegressionModel)</span>
<span id="cb337-218"><a href="#cb337-218" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(generalizedRegressionModel)</span>
<span id="cb337-219"><a href="#cb337-219" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(generalizedRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-220"><a href="#cb337-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-221"><a href="#cb337-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-222"><a href="#cb337-222" aria-hidden="true" tabindex="-1"></a><span class="fu">## Generalized regression model (rms)</span></span>
<span id="cb337-223"><a href="#cb337-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-224"><a href="#cb337-224" aria-hidden="true" tabindex="-1"></a>In this example, we predict a count variable that has a poisson distribution.</span>
<span id="cb337-225"><a href="#cb337-225" aria-hidden="true" tabindex="-1"></a>We could change the distribution.</span>
<span id="cb337-226"><a href="#cb337-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-229"><a href="#cb337-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-230"><a href="#cb337-230" aria-hidden="true" tabindex="-1"></a>rmsGeneralizedRegressionModel <span class="ot">&lt;-</span> rms<span class="sc">::</span><span class="fu">Glm</span>(</span>
<span id="cb337-231"><a href="#cb337-231" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-232"><a href="#cb337-232" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-233"><a href="#cb337-233" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-234"><a href="#cb337-234" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-235"><a href="#cb337-235" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb337-236"><a href="#cb337-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-237"><a href="#cb337-237" aria-hidden="true" tabindex="-1"></a>rmsGeneralizedRegressionModel</span>
<span id="cb337-238"><a href="#cb337-238" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(rmsGeneralizedRegressionModel)</span>
<span id="cb337-239"><a href="#cb337-239" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(rmsGeneralizedRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-240"><a href="#cb337-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-241"><a href="#cb337-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-242"><a href="#cb337-242" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian generalized linear model</span></span>
<span id="cb337-243"><a href="#cb337-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-244"><a href="#cb337-244" aria-hidden="true" tabindex="-1"></a>In this example, we predict a count variable that has a poisson distribution.</span>
<span id="cb337-245"><a href="#cb337-245" aria-hidden="true" tabindex="-1"></a>We could change the distribution.</span>
<span id="cb337-246"><a href="#cb337-246" aria-hidden="true" tabindex="-1"></a>For example, we could use Gamma regression, <span class="in">`family = Gamma`</span>, when the response variable is continuous and positive, and the coefficient of variation--rather than the variance--is constant.</span>
<span id="cb337-247"><a href="#cb337-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-250"><a href="#cb337-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-251"><a href="#cb337-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb337-252"><a href="#cb337-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-253"><a href="#cb337-253" aria-hidden="true" tabindex="-1"></a>bayesianGeneralizedLinearRegression <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb337-254"><a href="#cb337-254" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-255"><a href="#cb337-255" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-256"><a href="#cb337-256" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> poisson,</span>
<span id="cb337-257"><a href="#cb337-257" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb337-258"><a href="#cb337-258" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>,</span>
<span id="cb337-259"><a href="#cb337-259" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>)</span>
<span id="cb337-260"><a href="#cb337-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-261"><a href="#cb337-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-264"><a href="#cb337-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-265"><a href="#cb337-265" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianGeneralizedLinearRegression)</span>
<span id="cb337-266"><a href="#cb337-266" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianGeneralizedLinearRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-267"><a href="#cb337-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-268"><a href="#cb337-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-269"><a href="#cb337-269" aria-hidden="true" tabindex="-1"></a><span class="fu">## Robust generalized regression</span></span>
<span id="cb337-270"><a href="#cb337-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-273"><a href="#cb337-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-274"><a href="#cb337-274" aria-hidden="true" tabindex="-1"></a>robustGeneralizedRegression <span class="ot">&lt;-</span> robustbase<span class="sc">::</span><span class="fu">glmrob</span>(</span>
<span id="cb337-275"><a href="#cb337-275" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-276"><a href="#cb337-276" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-277"><a href="#cb337-277" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb337-278"><a href="#cb337-278" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-279"><a href="#cb337-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-280"><a href="#cb337-280" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(robustGeneralizedRegression)</span>
<span id="cb337-281"><a href="#cb337-281" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(robustGeneralizedRegression)</span>
<span id="cb337-282"><a href="#cb337-282" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(robustGeneralizedRegression), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-283"><a href="#cb337-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-284"><a href="#cb337-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-285"><a href="#cb337-285" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ordinal regression model</span></span>
<span id="cb337-286"><a href="#cb337-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-289"><a href="#cb337-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-290"><a href="#cb337-290" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel1 <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">polr</span>(</span>
<span id="cb337-291"><a href="#cb337-291" aria-hidden="true" tabindex="-1"></a>  orderedVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-292"><a href="#cb337-292" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata)</span>
<span id="cb337-293"><a href="#cb337-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-294"><a href="#cb337-294" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel2 <span class="ot">&lt;-</span> rms<span class="sc">::</span><span class="fu">lrm</span>(</span>
<span id="cb337-295"><a href="#cb337-295" aria-hidden="true" tabindex="-1"></a>  orderedVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-296"><a href="#cb337-296" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-297"><a href="#cb337-297" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-298"><a href="#cb337-298" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-299"><a href="#cb337-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-300"><a href="#cb337-300" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel3 <span class="ot">&lt;-</span> rms<span class="sc">::</span><span class="fu">orm</span>(</span>
<span id="cb337-301"><a href="#cb337-301" aria-hidden="true" tabindex="-1"></a>  orderedVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-302"><a href="#cb337-302" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-303"><a href="#cb337-303" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-304"><a href="#cb337-304" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-305"><a href="#cb337-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-306"><a href="#cb337-306" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ordinalRegressionModel1)</span>
<span id="cb337-307"><a href="#cb337-307" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(ordinalRegressionModel1)</span>
<span id="cb337-308"><a href="#cb337-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-309"><a href="#cb337-309" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel2</span>
<span id="cb337-310"><a href="#cb337-310" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(ordinalRegressionModel2), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-311"><a href="#cb337-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-312"><a href="#cb337-312" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel3</span>
<span id="cb337-313"><a href="#cb337-313" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(ordinalRegressionModel3)</span>
<span id="cb337-314"><a href="#cb337-314" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(ordinalRegressionModel3), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-315"><a href="#cb337-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-316"><a href="#cb337-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-317"><a href="#cb337-317" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian ordinal regression model</span></span>
<span id="cb337-318"><a href="#cb337-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-321"><a href="#cb337-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-322"><a href="#cb337-322" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb337-323"><a href="#cb337-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-324"><a href="#cb337-324" aria-hidden="true" tabindex="-1"></a>bayesianOrdinalRegression <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb337-325"><a href="#cb337-325" aria-hidden="true" tabindex="-1"></a>  orderedVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-326"><a href="#cb337-326" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-327"><a href="#cb337-327" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">cumulative</span>(),</span>
<span id="cb337-328"><a href="#cb337-328" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb337-329"><a href="#cb337-329" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>,</span>
<span id="cb337-330"><a href="#cb337-330" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>)</span>
<span id="cb337-331"><a href="#cb337-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-332"><a href="#cb337-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-335"><a href="#cb337-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-336"><a href="#cb337-336" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianOrdinalRegression)</span>
<span id="cb337-337"><a href="#cb337-337" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianOrdinalRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-338"><a href="#cb337-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-339"><a href="#cb337-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-340"><a href="#cb337-340" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian count regression model</span></span>
<span id="cb337-341"><a href="#cb337-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-344"><a href="#cb337-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-345"><a href="#cb337-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb337-346"><a href="#cb337-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-347"><a href="#cb337-347" aria-hidden="true" tabindex="-1"></a>bayesianCountRegression <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb337-348"><a href="#cb337-348" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-349"><a href="#cb337-349" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-350"><a href="#cb337-350" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb337-351"><a href="#cb337-351" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb337-352"><a href="#cb337-352" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>,</span>
<span id="cb337-353"><a href="#cb337-353" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>)</span>
<span id="cb337-354"><a href="#cb337-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-355"><a href="#cb337-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-358"><a href="#cb337-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-359"><a href="#cb337-359" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianCountRegression)</span>
<span id="cb337-360"><a href="#cb337-360" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianCountRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-361"><a href="#cb337-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-362"><a href="#cb337-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-363"><a href="#cb337-363" aria-hidden="true" tabindex="-1"></a><span class="fu">## Logistic regression model (rms)</span></span>
<span id="cb337-364"><a href="#cb337-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-367"><a href="#cb337-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-368"><a href="#cb337-368" aria-hidden="true" tabindex="-1"></a>logisticRegressionModel <span class="ot">&lt;-</span> rms<span class="sc">::</span><span class="fu">robcov</span>(rms<span class="sc">::</span><span class="fu">lrm</span>(</span>
<span id="cb337-369"><a href="#cb337-369" aria-hidden="true" tabindex="-1"></a>  female <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-370"><a href="#cb337-370" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-371"><a href="#cb337-371" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-372"><a href="#cb337-372" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>))</span>
<span id="cb337-373"><a href="#cb337-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-374"><a href="#cb337-374" aria-hidden="true" tabindex="-1"></a>logisticRegressionModel</span>
<span id="cb337-375"><a href="#cb337-375" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(logisticRegressionModel)</span>
<span id="cb337-376"><a href="#cb337-376" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(logisticRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-377"><a href="#cb337-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-378"><a href="#cb337-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-379"><a href="#cb337-379" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian logistic regression model</span></span>
<span id="cb337-380"><a href="#cb337-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-383"><a href="#cb337-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-384"><a href="#cb337-384" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb337-385"><a href="#cb337-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-386"><a href="#cb337-386" aria-hidden="true" tabindex="-1"></a>bayesianLogisticRegression <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb337-387"><a href="#cb337-387" aria-hidden="true" tabindex="-1"></a>  female <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-388"><a href="#cb337-388" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-389"><a href="#cb337-389" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> bernoulli,</span>
<span id="cb337-390"><a href="#cb337-390" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb337-391"><a href="#cb337-391" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>,</span>
<span id="cb337-392"><a href="#cb337-392" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>)</span>
<span id="cb337-393"><a href="#cb337-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-394"><a href="#cb337-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-397"><a href="#cb337-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-398"><a href="#cb337-398" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianLogisticRegression)</span>
<span id="cb337-399"><a href="#cb337-399" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianLogisticRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-400"><a href="#cb337-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-401"><a href="#cb337-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-402"><a href="#cb337-402" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hierarchical Linear Regression</span></span>
<span id="cb337-403"><a href="#cb337-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-406"><a href="#cb337-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-407"><a href="#cb337-407" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-408"><a href="#cb337-408" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum,</span>
<span id="cb337-409"><a href="#cb337-409" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata <span class="sc">%&gt;%</span> <span class="fu">select</span>(bpi_antisocialT2Sum, bpi_antisocialT1Sum, bpi_anxiousDepressedSum) <span class="sc">%&gt;%</span> na.omit,</span>
<span id="cb337-410"><a href="#cb337-410" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-411"><a href="#cb337-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-412"><a href="#cb337-412" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-413"><a href="#cb337-413" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-414"><a href="#cb337-414" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata <span class="sc">%&gt;%</span> <span class="fu">select</span>(bpi_antisocialT2Sum, bpi_antisocialT1Sum, bpi_anxiousDepressedSum) <span class="sc">%&gt;%</span> na.omit,</span>
<span id="cb337-415"><a href="#cb337-415" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-416"><a href="#cb337-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-417"><a href="#cb337-417" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)<span class="sc">$</span>adj.r.squared</span>
<span id="cb337-418"><a href="#cb337-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-419"><a href="#cb337-419" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1, model2)</span>
<span id="cb337-420"><a href="#cb337-420" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)<span class="sc">$</span>adj.r.squared <span class="sc">-</span> <span class="fu">summary</span>(model1)<span class="sc">$</span>adj.r.squared</span>
<span id="cb337-421"><a href="#cb337-421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-422"><a href="#cb337-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-423"><a href="#cb337-423" aria-hidden="true" tabindex="-1"></a><span class="fu"># Moderated Multiple Regression {#sec-moderation}</span></span>
<span id="cb337-424"><a href="#cb337-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-425"><a href="#cb337-425" aria-hidden="true" tabindex="-1"></a>When testing for the possibility of moderation/interaction, it is first important to think about what shape the interaction might take.</span>
<span id="cb337-426"><a href="#cb337-426" aria-hidden="true" tabindex="-1"></a>If you expect a bilinear interaction (i.e., the slope of the regression line between <span class="in">`X`</span> and <span class="in">`Y`</span> changes as a *linear* function of a third variable, <span class="in">`Z`</span>), it is appropriate to treat the moderator as continuous in moderated multiple regression.</span>
<span id="cb337-427"><a href="#cb337-427" aria-hidden="true" tabindex="-1"></a>However, if you expect that the interaction might take a different form (e.g., a threshold effect), you may need to consider other approaches, such as using categorical variables, polynomial interactions, spline functions, generalized additive models (GAMs), or machine learning.</span>
<span id="cb337-428"><a href="#cb337-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-429"><a href="#cb337-429" aria-hidden="true" tabindex="-1"></a>For information on the (low) power to detect interactions and how to improve it, see:</span>
<span id="cb337-430"><a href="#cb337-430" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://isaactpetersen.github.io/Principles-Psychological-Assessment/reliability.html#sec-productTerm-reliability&gt;</span></span>
<span id="cb337-431"><a href="#cb337-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-432"><a href="#cb337-432" aria-hidden="true" tabindex="-1"></a>The examples below use the <span class="in">`interactions`</span> package in R.</span>
<span id="cb337-433"><a href="#cb337-433" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://cran.r-project.org/web/packages/interactions/vignettes/interactions.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/P34H-7BH3&gt;</span>)</span>
<span id="cb337-434"><a href="#cb337-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-437"><a href="#cb337-437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-438"><a href="#cb337-438" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(state.x77)</span>
<span id="cb337-439"><a href="#cb337-439" aria-hidden="true" tabindex="-1"></a>states<span class="sc">$</span>HS.Grad <span class="ot">&lt;-</span> states<span class="sc">$</span><span class="st">`</span><span class="at">HS Grad</span><span class="st">`</span></span>
<span id="cb337-440"><a href="#cb337-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-441"><a href="#cb337-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-442"><a href="#cb337-442" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mean Center Predictors</span></span>
<span id="cb337-443"><a href="#cb337-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-444"><a href="#cb337-444" aria-hidden="true" tabindex="-1"></a>Make sure to mean-center or orthogonalize predictors before computing the interaction term.</span>
<span id="cb337-445"><a href="#cb337-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-448"><a href="#cb337-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-449"><a href="#cb337-449" aria-hidden="true" tabindex="-1"></a>states<span class="sc">$</span>Illiteracy_centered <span class="ot">&lt;-</span> <span class="fu">scale</span>(states<span class="sc">$</span>Illiteracy, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb337-450"><a href="#cb337-450" aria-hidden="true" tabindex="-1"></a>states<span class="sc">$</span>Murder_centered <span class="ot">&lt;-</span> <span class="fu">scale</span>(states<span class="sc">$</span>Murder, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb337-451"><a href="#cb337-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-452"><a href="#cb337-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-453"><a href="#cb337-453" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model</span></span>
<span id="cb337-454"><a href="#cb337-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-457"><a href="#cb337-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-458"><a href="#cb337-458" aria-hidden="true" tabindex="-1"></a>interactionModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-459"><a href="#cb337-459" aria-hidden="true" tabindex="-1"></a>  Income <span class="sc">~</span> Illiteracy_centered <span class="sc">+</span> Murder_centered <span class="sc">+</span> Illiteracy_centered<span class="sc">:</span>Murder_centered <span class="sc">+</span> HS.Grad,</span>
<span id="cb337-460"><a href="#cb337-460" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> states)</span>
<span id="cb337-461"><a href="#cb337-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-462"><a href="#cb337-462" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interactionModel)</span>
<span id="cb337-463"><a href="#cb337-463" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(interactionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-464"><a href="#cb337-464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-465"><a href="#cb337-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-466"><a href="#cb337-466" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plots</span></span>
<span id="cb337-467"><a href="#cb337-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-470"><a href="#cb337-470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-471"><a href="#cb337-471" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">interact_plot</span>(</span>
<span id="cb337-472"><a href="#cb337-472" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-473"><a href="#cb337-473" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-474"><a href="#cb337-474" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered)</span>
<span id="cb337-475"><a href="#cb337-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-476"><a href="#cb337-476" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">interact_plot</span>(</span>
<span id="cb337-477"><a href="#cb337-477" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-478"><a href="#cb337-478" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-479"><a href="#cb337-479" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-480"><a href="#cb337-480" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.points =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-481"><a href="#cb337-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-482"><a href="#cb337-482" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">interact_plot</span>(</span>
<span id="cb337-483"><a href="#cb337-483" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-484"><a href="#cb337-484" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-485"><a href="#cb337-485" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-486"><a href="#cb337-486" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-487"><a href="#cb337-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-488"><a href="#cb337-488" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">johnson_neyman</span>(</span>
<span id="cb337-489"><a href="#cb337-489" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-490"><a href="#cb337-490" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-491"><a href="#cb337-491" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-492"><a href="#cb337-492" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> .<span class="dv">05</span>)</span>
<span id="cb337-493"><a href="#cb337-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-494"><a href="#cb337-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-495"><a href="#cb337-495" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simple Slopes Analysis</span></span>
<span id="cb337-496"><a href="#cb337-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-499"><a href="#cb337-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-500"><a href="#cb337-500" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">sim_slopes</span>(</span>
<span id="cb337-501"><a href="#cb337-501" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-502"><a href="#cb337-502" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-503"><a href="#cb337-503" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-504"><a href="#cb337-504" aria-hidden="true" tabindex="-1"></a>  <span class="at">johnson_neyman =</span> <span class="cn">FALSE</span>)</span>
<span id="cb337-505"><a href="#cb337-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-506"><a href="#cb337-506" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">sim_slopes</span>(</span>
<span id="cb337-507"><a href="#cb337-507" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-508"><a href="#cb337-508" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-509"><a href="#cb337-509" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-510"><a href="#cb337-510" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx.values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb337-511"><a href="#cb337-511" aria-hidden="true" tabindex="-1"></a>  <span class="at">johnson_neyman =</span> <span class="cn">FALSE</span>)</span>
<span id="cb337-512"><a href="#cb337-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-513"><a href="#cb337-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-514"><a href="#cb337-514" aria-hidden="true" tabindex="-1"></a><span class="fu">## Johnson-Neyman intervals</span></span>
<span id="cb337-515"><a href="#cb337-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-516"><a href="#cb337-516" aria-hidden="true" tabindex="-1"></a>Indicates all the values of the moderator for which the slope of the predictor is statistically significant.</span>
<span id="cb337-517"><a href="#cb337-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-520"><a href="#cb337-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-521"><a href="#cb337-521" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">sim_slopes</span>(</span>
<span id="cb337-522"><a href="#cb337-522" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-523"><a href="#cb337-523" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-524"><a href="#cb337-524" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-525"><a href="#cb337-525" aria-hidden="true" tabindex="-1"></a>  <span class="at">johnson_neyman =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-526"><a href="#cb337-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-527"><a href="#cb337-527" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">probe_interaction</span>(</span>
<span id="cb337-528"><a href="#cb337-528" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-529"><a href="#cb337-529" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-530"><a href="#cb337-530" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-531"><a href="#cb337-531" aria-hidden="true" tabindex="-1"></a>  <span class="at">cond.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-532"><a href="#cb337-532" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-533"><a href="#cb337-533" aria-hidden="true" tabindex="-1"></a>  <span class="at">jnplot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-534"><a href="#cb337-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-535"><a href="#cb337-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-536"><a href="#cb337-536" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparing Correlations {#sec-compareCorrelations}</span></span>
<span id="cb337-537"><a href="#cb337-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-538"><a href="#cb337-538" aria-hidden="true" tabindex="-1"></a>Fisher's *r*-to-*z* test.</span>
<span id="cb337-539"><a href="#cb337-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-540"><a href="#cb337-540" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;http://comparingcorrelations.org&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/X3EU-24GL&gt;</span>)</span>
<span id="cb337-541"><a href="#cb337-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-542"><a href="#cb337-542" aria-hidden="true" tabindex="-1"></a>Independent groups (two different groups):</span>
<span id="cb337-543"><a href="#cb337-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-546"><a href="#cb337-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-547"><a href="#cb337-547" aria-hidden="true" tabindex="-1"></a>cocor<span class="sc">::</span><span class="fu">cocor.indep.groups</span>(</span>
<span id="cb337-548"><a href="#cb337-548" aria-hidden="true" tabindex="-1"></a>  <span class="at">r1.jk =</span> .<span class="dv">7</span>,</span>
<span id="cb337-549"><a href="#cb337-549" aria-hidden="true" tabindex="-1"></a>  <span class="at">r2.hm =</span> .<span class="dv">6</span>,</span>
<span id="cb337-550"><a href="#cb337-550" aria-hidden="true" tabindex="-1"></a>  <span class="at">n1 =</span> <span class="dv">305</span>,</span>
<span id="cb337-551"><a href="#cb337-551" aria-hidden="true" tabindex="-1"></a>  <span class="at">n2 =</span> <span class="dv">210</span>,</span>
<span id="cb337-552"><a href="#cb337-552" aria-hidden="true" tabindex="-1"></a>  <span class="at">data.name =</span> <span class="fu">c</span>(<span class="st">"group1"</span>, <span class="st">"group2"</span>),</span>
<span id="cb337-553"><a href="#cb337-553" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.labels =</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"intelligence"</span>, <span class="st">"age"</span>, <span class="st">"intelligence"</span>))</span>
<span id="cb337-554"><a href="#cb337-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-555"><a href="#cb337-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-556"><a href="#cb337-556" aria-hidden="true" tabindex="-1"></a>Dependent groups (same group), overlapping correlation (shares a variable in common—in this case, the variable <span class="in">`age`</span> is shared in both correlations):</span>
<span id="cb337-557"><a href="#cb337-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-560"><a href="#cb337-560" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-561"><a href="#cb337-561" aria-hidden="true" tabindex="-1"></a>cocor<span class="sc">::</span><span class="fu">cocor.dep.groups.overlap</span>(</span>
<span id="cb337-562"><a href="#cb337-562" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jk =</span> .<span class="dv">2</span>, <span class="co"># Correlation (age, intelligence)</span></span>
<span id="cb337-563"><a href="#cb337-563" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jh =</span> .<span class="dv">5</span>, <span class="co"># Correlation (age, shoe size)</span></span>
<span id="cb337-564"><a href="#cb337-564" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.kh =</span> .<span class="dv">1</span>, <span class="co"># Correlation (intelligence, shoe index)</span></span>
<span id="cb337-565"><a href="#cb337-565" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">315</span>,</span>
<span id="cb337-566"><a href="#cb337-566" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.labels =</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"intelligence"</span>, <span class="st">"shoe size"</span>))</span>
<span id="cb337-567"><a href="#cb337-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-568"><a href="#cb337-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-569"><a href="#cb337-569" aria-hidden="true" tabindex="-1"></a>Dependent groups (same group), non-overlapping correlation (does not share a variable in common):</span>
<span id="cb337-570"><a href="#cb337-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-573"><a href="#cb337-573" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-574"><a href="#cb337-574" aria-hidden="true" tabindex="-1"></a>cocor<span class="sc">::</span><span class="fu">cocor.dep.groups.nonoverlap</span>(</span>
<span id="cb337-575"><a href="#cb337-575" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jk =</span> .<span class="dv">2</span>, <span class="co"># Correlation (age, intelligence)</span></span>
<span id="cb337-576"><a href="#cb337-576" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.hm =</span> .<span class="dv">7</span>, <span class="co"># Correlation (body mass index, shoe size)</span></span>
<span id="cb337-577"><a href="#cb337-577" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jh =</span> .<span class="dv">4</span>, <span class="co"># Correlation (age, body mass index)</span></span>
<span id="cb337-578"><a href="#cb337-578" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jm =</span> .<span class="dv">5</span>, <span class="co"># Correlation (age, shoe size)</span></span>
<span id="cb337-579"><a href="#cb337-579" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.kh =</span> .<span class="dv">1</span>, <span class="co"># Correlation (intelligence, body mass index)</span></span>
<span id="cb337-580"><a href="#cb337-580" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.km =</span> .<span class="dv">3</span>, <span class="co"># Correlation (intelligence, shoe size)</span></span>
<span id="cb337-581"><a href="#cb337-581" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">232</span>,</span>
<span id="cb337-582"><a href="#cb337-582" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.labels =</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"intelligence"</span>, <span class="st">"body mass index"</span>, <span class="st">"shoe size"</span>))</span>
<span id="cb337-583"><a href="#cb337-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-584"><a href="#cb337-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-585"><a href="#cb337-585" aria-hidden="true" tabindex="-1"></a><span class="fu"># Approaches to Handling Missingness {#sec-missingness}</span></span>
<span id="cb337-586"><a href="#cb337-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-587"><a href="#cb337-587" aria-hidden="true" tabindex="-1"></a><span class="fu">## Listwise deletion {#sec-listwiseDeletion}</span></span>
<span id="cb337-588"><a href="#cb337-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-589"><a href="#cb337-589" aria-hidden="true" tabindex="-1"></a>Listwise deletion deletes every row in the data file that has a missing value for one of the model variables.</span>
<span id="cb337-590"><a href="#cb337-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-593"><a href="#cb337-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-594"><a href="#cb337-594" aria-hidden="true" tabindex="-1"></a>listwiseDeletionModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-595"><a href="#cb337-595" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-596"><a href="#cb337-596" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-597"><a href="#cb337-597" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-598"><a href="#cb337-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-599"><a href="#cb337-599" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(listwiseDeletionModel)</span>
<span id="cb337-600"><a href="#cb337-600" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(listwiseDeletionModel)</span>
<span id="cb337-601"><a href="#cb337-601" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(listwiseDeletionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-602"><a href="#cb337-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-603"><a href="#cb337-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-604"><a href="#cb337-604" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pairwise deletion {#sec-pairwiseDeletion}</span></span>
<span id="cb337-605"><a href="#cb337-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-606"><a href="#cb337-606" aria-hidden="true" tabindex="-1"></a>Also see here:</span>
<span id="cb337-607"><a href="#cb337-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-608"><a href="#cb337-608" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://stats.stackexchange.com/questions/158366/fit-multiple-regression-model-with-pairwise-deletion-or-on-a-correlation-covari/173002#173002&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/GH5T-RXD9&gt;</span>)</span>
<span id="cb337-609"><a href="#cb337-609" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://stats.stackexchange.com/questions/299792/r-lm-covariance-matrix-manual-calculation-failure&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/F7EL-AUFZ&gt;</span>)</span>
<span id="cb337-610"><a href="#cb337-610" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://stats.stackexchange.com/questions/107597/is-there-a-way-to-use-the-covariance-matrix-to-find-coefficients-for-multiple-re&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/KU3X-FB2C&gt;</span>)</span>
<span id="cb337-611"><a href="#cb337-611" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://stats.stackexchange.com/questions/105006/how-to-perform-a-bivariate-regression-using-pairwise-deletion-of-missing-values&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/QWQ5-2TLW&gt;</span>)</span>
<span id="cb337-612"><a href="#cb337-612" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://dl.dropboxusercontent.com/s/4sf0et3p47ykctx/MissingPairwise.sps&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/UC4K-2L9T&gt;</span>)</span>
<span id="cb337-613"><a href="#cb337-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-614"><a href="#cb337-614" aria-hidden="true" tabindex="-1"></a>Adapted from here: <span class="ot">&lt;https://stefvanbuuren.name/fimd/sec-simplesolutions.html#sec:pairwise&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/EGU6-3M3Q&gt;</span>)</span>
<span id="cb337-615"><a href="#cb337-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-618"><a href="#cb337-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-619"><a href="#cb337-619" aria-hidden="true" tabindex="-1"></a>modelData <span class="ot">&lt;-</span> mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT2Sum"</span>,<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span>)]</span>
<span id="cb337-620"><a href="#cb337-620" aria-hidden="true" tabindex="-1"></a>varMeans <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(modelData, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-621"><a href="#cb337-621" aria-hidden="true" tabindex="-1"></a>varCovariances <span class="ot">&lt;-</span> <span class="fu">cov</span>(modelData, <span class="at">use =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb337-622"><a href="#cb337-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-623"><a href="#cb337-623" aria-hidden="true" tabindex="-1"></a>pairwiseRegression_syntax <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb337-624"><a href="#cb337-624" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum</span></span>
<span id="cb337-625"><a href="#cb337-625" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~~ bpi_antisocialT2Sum</span></span>
<span id="cb337-626"><a href="#cb337-626" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~ 1</span></span>
<span id="cb337-627"><a href="#cb337-627" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb337-628"><a href="#cb337-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-629"><a href="#cb337-629" aria-hidden="true" tabindex="-1"></a>pairwiseRegression_fit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">lavaan</span>(</span>
<span id="cb337-630"><a href="#cb337-630" aria-hidden="true" tabindex="-1"></a>  pairwiseRegression_syntax,</span>
<span id="cb337-631"><a href="#cb337-631" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.mean =</span> varMeans,</span>
<span id="cb337-632"><a href="#cb337-632" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.cov =</span> varCovariances,</span>
<span id="cb337-633"><a href="#cb337-633" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.nobs =</span> <span class="fu">sum</span>(<span class="fu">complete.cases</span>(modelData))</span>
<span id="cb337-634"><a href="#cb337-634" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb337-635"><a href="#cb337-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-636"><a href="#cb337-636" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(</span>
<span id="cb337-637"><a href="#cb337-637" aria-hidden="true" tabindex="-1"></a>  pairwiseRegression_fit,</span>
<span id="cb337-638"><a href="#cb337-638" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-639"><a href="#cb337-639" aria-hidden="true" tabindex="-1"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-640"><a href="#cb337-640" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-641"><a href="#cb337-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-642"><a href="#cb337-642" aria-hidden="true" tabindex="-1"></a><span class="fu">## Full-information maximum likelihood (FIML) {#sec-fiml}</span></span>
<span id="cb337-643"><a href="#cb337-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-646"><a href="#cb337-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-647"><a href="#cb337-647" aria-hidden="true" tabindex="-1"></a>fimlRegression_syntax <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb337-648"><a href="#cb337-648" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum</span></span>
<span id="cb337-649"><a href="#cb337-649" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~~ bpi_antisocialT2Sum</span></span>
<span id="cb337-650"><a href="#cb337-650" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~ 1</span></span>
<span id="cb337-651"><a href="#cb337-651" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb337-652"><a href="#cb337-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-653"><a href="#cb337-653" aria-hidden="true" tabindex="-1"></a>fimlRegression_fit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">lavaan</span>(</span>
<span id="cb337-654"><a href="#cb337-654" aria-hidden="true" tabindex="-1"></a>  fimlRegression_syntax,</span>
<span id="cb337-655"><a href="#cb337-655" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-656"><a href="#cb337-656" aria-hidden="true" tabindex="-1"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb337-657"><a href="#cb337-657" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb337-658"><a href="#cb337-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-659"><a href="#cb337-659" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(</span>
<span id="cb337-660"><a href="#cb337-660" aria-hidden="true" tabindex="-1"></a>  fimlRegression_fit,</span>
<span id="cb337-661"><a href="#cb337-661" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-662"><a href="#cb337-662" aria-hidden="true" tabindex="-1"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-663"><a href="#cb337-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-664"><a href="#cb337-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-665"><a href="#cb337-665" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple imputation {#sec-imputation}</span></span>
<span id="cb337-666"><a href="#cb337-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-669"><a href="#cb337-669" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-670"><a href="#cb337-670" aria-hidden="true" tabindex="-1"></a>modelData_imputed <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">mice</span>(</span>
<span id="cb337-671"><a href="#cb337-671" aria-hidden="true" tabindex="-1"></a>  modelData,</span>
<span id="cb337-672"><a href="#cb337-672" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="dv">5</span>,</span>
<span id="cb337-673"><a href="#cb337-673" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"pmm"</span>) <span class="co"># predictive mean matching; can choose among many methods</span></span>
<span id="cb337-674"><a href="#cb337-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-675"><a href="#cb337-675" aria-hidden="true" tabindex="-1"></a>imputedData_fit <span class="ot">&lt;-</span> <span class="fu">with</span>(</span>
<span id="cb337-676"><a href="#cb337-676" aria-hidden="true" tabindex="-1"></a>  modelData_imputed,</span>
<span id="cb337-677"><a href="#cb337-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum))</span>
<span id="cb337-678"><a href="#cb337-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-679"><a href="#cb337-679" aria-hidden="true" tabindex="-1"></a>imputedData_pooledEstimates <span class="ot">&lt;-</span> <span class="fu">pool</span>(imputedData_fit)</span>
<span id="cb337-680"><a href="#cb337-680" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(imputedData_pooledEstimates)</span>
<span id="cb337-681"><a href="#cb337-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-682"><a href="#cb337-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-683"><a href="#cb337-683" aria-hidden="true" tabindex="-1"></a><span class="fu"># Squared Semi-Partial Correlation ($sr^2$) {#sec-squaredSemiPartialCorrelation}</span></span>
<span id="cb337-684"><a href="#cb337-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-687"><a href="#cb337-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-688"><a href="#cb337-688" aria-hidden="true" tabindex="-1"></a>rockchalk<span class="sc">::</span><span class="fu">getDeltaRsquare</span>(multipleRegressionModel)</span>
<span id="cb337-689"><a href="#cb337-689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-690"><a href="#cb337-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-691"><a href="#cb337-691" aria-hidden="true" tabindex="-1"></a><span class="fu"># Partial Regression Plot {#sec-partialRegressionPlot}</span></span>
<span id="cb337-692"><a href="#cb337-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-693"><a href="#cb337-693" aria-hidden="true" tabindex="-1"></a>A partial regression plot (aka added-variable) examines the association between the predictor and the outcome after controlling for the covariates.</span>
<span id="cb337-694"><a href="#cb337-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-697"><a href="#cb337-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-698"><a href="#cb337-698" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">avPlots</span>(</span>
<span id="cb337-699"><a href="#cb337-699" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-700"><a href="#cb337-700" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">FALSE</span>)</span>
<span id="cb337-701"><a href="#cb337-701" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-702"><a href="#cb337-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-703"><a href="#cb337-703" aria-hidden="true" tabindex="-1"></a>Manually:</span>
<span id="cb337-704"><a href="#cb337-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-707"><a href="#cb337-707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-708"><a href="#cb337-708" aria-hidden="true" tabindex="-1"></a><span class="co"># DV residuals (outcome residualized on covariates)</span></span>
<span id="cb337-709"><a href="#cb337-709" aria-hidden="true" tabindex="-1"></a>ry <span class="ot">&lt;-</span> <span class="fu">resid</span>(<span class="fu">lm</span>(</span>
<span id="cb337-710"><a href="#cb337-710" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum, </span>
<span id="cb337-711"><a href="#cb337-711" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata, <span class="at">na.action =</span> na.exclude))</span>
<span id="cb337-712"><a href="#cb337-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-713"><a href="#cb337-713" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictor residuals (focal predictor residualized on covariates)</span></span>
<span id="cb337-714"><a href="#cb337-714" aria-hidden="true" tabindex="-1"></a>rx <span class="ot">&lt;-</span> <span class="fu">resid</span>(<span class="fu">lm</span>(</span>
<span id="cb337-715"><a href="#cb337-715" aria-hidden="true" tabindex="-1"></a>  bpi_anxiousDepressedSum <span class="sc">~</span> bpi_antisocialT1Sum,</span>
<span id="cb337-716"><a href="#cb337-716" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata, <span class="at">na.action =</span> na.exclude))</span>
<span id="cb337-717"><a href="#cb337-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-718"><a href="#cb337-718" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the partial regression plot</span></span>
<span id="cb337-719"><a href="#cb337-719" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(rx, ry)</span>
<span id="cb337-720"><a href="#cb337-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-721"><a href="#cb337-721" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb337-722"><a href="#cb337-722" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_plot,</span>
<span id="cb337-723"><a href="#cb337-723" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> rx, <span class="at">y =</span> ry)) <span class="sc">+</span></span>
<span id="cb337-724"><a href="#cb337-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb337-725"><a href="#cb337-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb337-726"><a href="#cb337-726" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb337-727"><a href="#cb337-727" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb337-728"><a href="#cb337-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb337-729"><a href="#cb337-729" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Residualized bpi_antisocialT1Sum"</span>,</span>
<span id="cb337-730"><a href="#cb337-730" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residualized bpi_antisocialT2Sum"</span>,</span>
<span id="cb337-731"><a href="#cb337-731" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Partial Regression Plot</span><span class="sc">\n</span><span class="st">bpi_antisocialT2Sum ~ bpi_antisocialT1Sum controlling for bpi_anxiousDepressedSum"</span></span>
<span id="cb337-732"><a href="#cb337-732" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb337-733"><a href="#cb337-733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-734"><a href="#cb337-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-735"><a href="#cb337-735" aria-hidden="true" tabindex="-1"></a><span class="fu"># Dominance Analysis {#sec-dominanceAnalysis}</span></span>
<span id="cb337-736"><a href="#cb337-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-739"><a href="#cb337-739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-740"><a href="#cb337-740" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">dominance_analysis</span>(multipleRegressionModel)</span>
<span id="cb337-741"><a href="#cb337-741" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-742"><a href="#cb337-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-745"><a href="#cb337-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-746"><a href="#cb337-746" aria-hidden="true" tabindex="-1"></a>allPossibleSubsetsRegression <span class="ot">&lt;-</span> yhat<span class="sc">::</span><span class="fu">aps</span>(</span>
<span id="cb337-747"><a href="#cb337-747" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataMatrix =</span> mydata,</span>
<span id="cb337-748"><a href="#cb337-748" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span id="cb337-749"><a href="#cb337-749" aria-hidden="true" tabindex="-1"></a>  <span class="at">ivlist =</span> <span class="fu">list</span>(<span class="st">"bpi_antisocialT1Sum"</span>, <span class="st">"bpi_anxiousDepressedSum"</span>))</span>
<span id="cb337-750"><a href="#cb337-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-751"><a href="#cb337-751" aria-hidden="true" tabindex="-1"></a>yhat<span class="sc">::</span><span class="fu">dominance</span>(allPossibleSubsetsRegression)</span>
<span id="cb337-752"><a href="#cb337-752" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-753"><a href="#cb337-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-754"><a href="#cb337-754" aria-hidden="true" tabindex="-1"></a><span class="fu"># Commonality Analysis {#sec-commonalityAnalysis}</span></span>
<span id="cb337-755"><a href="#cb337-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-758"><a href="#cb337-758" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-759"><a href="#cb337-759" aria-hidden="true" tabindex="-1"></a>yhat<span class="sc">::</span><span class="fu">calc.yhat</span>(multipleRegressionModel)</span>
<span id="cb337-760"><a href="#cb337-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-761"><a href="#cb337-761" aria-hidden="true" tabindex="-1"></a>allPossibleSubsetsRegression <span class="ot">&lt;-</span> yhat<span class="sc">::</span><span class="fu">aps</span>(</span>
<span id="cb337-762"><a href="#cb337-762" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataMatrix =</span> mydata,</span>
<span id="cb337-763"><a href="#cb337-763" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span id="cb337-764"><a href="#cb337-764" aria-hidden="true" tabindex="-1"></a>  <span class="at">ivlist =</span> <span class="fu">list</span>(<span class="st">"bpi_antisocialT1Sum"</span>, <span class="st">"bpi_anxiousDepressedSum"</span>))</span>
<span id="cb337-765"><a href="#cb337-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-766"><a href="#cb337-766" aria-hidden="true" tabindex="-1"></a>yhat<span class="sc">::</span><span class="fu">commonality</span>(allPossibleSubsetsRegression)</span>
<span id="cb337-767"><a href="#cb337-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-768"><a href="#cb337-768" aria-hidden="true" tabindex="-1"></a>commonalityAnalysis <span class="ot">&lt;-</span> yhat<span class="sc">::</span><span class="fu">commonalityCoefficients</span>(</span>
<span id="cb337-769"><a href="#cb337-769" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataMatrix =</span> mydata,</span>
<span id="cb337-770"><a href="#cb337-770" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span id="cb337-771"><a href="#cb337-771" aria-hidden="true" tabindex="-1"></a>  <span class="at">ivlist =</span> <span class="fu">list</span>(<span class="st">"bpi_antisocialT1Sum"</span>, <span class="st">"bpi_anxiousDepressedSum"</span>))</span>
<span id="cb337-772"><a href="#cb337-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-773"><a href="#cb337-773" aria-hidden="true" tabindex="-1"></a>commonalityAnalysis</span>
<span id="cb337-774"><a href="#cb337-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-775"><a href="#cb337-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-776"><a href="#cb337-776" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model Building Steps</span></span>
<span id="cb337-777"><a href="#cb337-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-778"><a href="#cb337-778" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Examine extent and type of missing data, consider <span class="co">[</span><span class="ot">how to handle missing values</span><span class="co">](#sec-missingness)</span> (<span class="co">[</span><span class="ot">multiple imputation</span><span class="co">](#imputation)</span>, <span class="co">[</span><span class="ot">FIML</span><span class="co">](#sec-fiml)</span>, <span class="co">[</span><span class="ot">pairwise deletion</span><span class="co">](#sec-pairwiseDeletion)</span>, <span class="co">[</span><span class="ot">listwise deletion</span><span class="co">](#sec-listwiseDeletion)</span>)</span>
<span id="cb337-779"><a href="#cb337-779" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Little's MCAR test from <span class="in">`mcar_test()`</span> function of the <span class="in">`njtierney/naniar`</span> package</span>
<span id="cb337-780"><a href="#cb337-780" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Bayesian handling of missing data: <span class="ot">&lt;https://cran.r-project.org/web/packages/brms/vignettes/brms_missings.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/Z4HT-QXWR&gt;</span>)</span>
<span id="cb337-781"><a href="#cb337-781" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Examine descriptive statistics, consider variable transformations</span>
<span id="cb337-782"><a href="#cb337-782" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Examine scatterplot matrix to examine whether associations between predictor and outcomes are linear or nonlinear</span>
<span id="cb337-783"><a href="#cb337-783" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Model building: theory and empiricism (stepwise regression, likelihood ratio tests, k-fold cross validation to check for over-fitting compared to simpler model)</span>
<span id="cb337-784"><a href="#cb337-784" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Test assumptions</span>
<span id="cb337-785"><a href="#cb337-785" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Examine whether predictors have linear association with outcome (Residual Plots, Marginal Model Plots, Added-Variable Plots—check for non-horizontal lines)</span>
<span id="cb337-786"><a href="#cb337-786" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Examine whether residuals have constant variance across levels of outcome and predictors Residual Plots, Spread-Level Plots—check for fan-shaped plot or other increasing/decreasing structure)</span>
<span id="cb337-787"><a href="#cb337-787" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Examine whether predictors show multicollinearity (VIF)</span>
<span id="cb337-788"><a href="#cb337-788" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Examine whether residuals are normally distributed (QQ plot and density plot)</span>
<span id="cb337-789"><a href="#cb337-789" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Examine influence of influential observations (high outlyingness and leverage) on parameter stimates by iteratively removing influential observations and refitting (Added-Variable Plots)</span>
<span id="cb337-790"><a href="#cb337-790" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Handle violated assumptions, select final set of predictors/outcomes and transformation of each</span>
<span id="cb337-791"><a href="#cb337-791" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use k-fold cross validation to identify the best estimation procedure (OLS, MM, or LTS) on the final model</span>
<span id="cb337-792"><a href="#cb337-792" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use identified estimation procedure to fit final model and determine the best parameter point estimates</span>
<span id="cb337-793"><a href="#cb337-793" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Calculate bootstrapped estimates to determine the confidence intervals around the parameter estimates of the final model</span>
<span id="cb337-794"><a href="#cb337-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-795"><a href="#cb337-795" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bootstrapped Estimates</span></span>
<span id="cb337-796"><a href="#cb337-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-797"><a href="#cb337-797" aria-hidden="true" tabindex="-1"></a>To determine the confidence intervals of parameter estimates</span>
<span id="cb337-798"><a href="#cb337-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-799"><a href="#cb337-799" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear Regression</span></span>
<span id="cb337-800"><a href="#cb337-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-803"><a href="#cb337-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-804"><a href="#cb337-804" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelBootstrapped <span class="ot">&lt;-</span> <span class="fu">Boot</span>(multipleRegressionModelNoMissing, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb337-805"><a href="#cb337-805" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModelBootstrapped)</span>
<span id="cb337-806"><a href="#cb337-806" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(multipleRegressionModelBootstrapped, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">type =</span> <span class="st">"bca"</span>)</span>
<span id="cb337-807"><a href="#cb337-807" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(multipleRegressionModelBootstrapped)</span>
<span id="cb337-808"><a href="#cb337-808" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-809"><a href="#cb337-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-810"><a href="#cb337-810" aria-hidden="true" tabindex="-1"></a><span class="fu">## Generalized Regression</span></span>
<span id="cb337-811"><a href="#cb337-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-814"><a href="#cb337-814" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-815"><a href="#cb337-815" aria-hidden="true" tabindex="-1"></a>generalizedRegressionModelBootstrapped <span class="ot">&lt;-</span> <span class="fu">Boot</span>(multipleRegressionModelNoMissing, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb337-816"><a href="#cb337-816" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(generalizedRegressionModelBootstrapped)</span>
<span id="cb337-817"><a href="#cb337-817" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(generalizedRegressionModelBootstrapped, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">type =</span> <span class="st">"bca"</span>)</span>
<span id="cb337-818"><a href="#cb337-818" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(generalizedRegressionModelBootstrapped)</span>
<span id="cb337-819"><a href="#cb337-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-820"><a href="#cb337-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-821"><a href="#cb337-821" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cross Validation</span></span>
<span id="cb337-822"><a href="#cb337-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-823"><a href="#cb337-823" aria-hidden="true" tabindex="-1"></a>To examine degree of prediction error and over-fitting to determine best model</span>
<span id="cb337-824"><a href="#cb337-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-825"><a href="#cb337-825" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.stackexchange.com/questions/103459/how-do-i-know-which-method-of-cross-validation-is-best&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/38BL-KLRJ&gt;</span>)</span>
<span id="cb337-826"><a href="#cb337-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-827"><a href="#cb337-827" aria-hidden="true" tabindex="-1"></a><span class="fu">## K-fold cross validation</span></span>
<span id="cb337-828"><a href="#cb337-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-831"><a href="#cb337-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-832"><a href="#cb337-832" aria-hidden="true" tabindex="-1"></a>kFolds <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb337-833"><a href="#cb337-833" aria-hidden="true" tabindex="-1"></a>replications <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb337-834"><a href="#cb337-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-835"><a href="#cb337-835" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">cvFolds</span>(<span class="fu">nrow</span>(mydata), <span class="at">K =</span> kFolds, <span class="at">R =</span> replications)</span>
<span id="cb337-836"><a href="#cb337-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-837"><a href="#cb337-837" aria-hidden="true" tabindex="-1"></a>fitLm <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-838"><a href="#cb337-838" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-839"><a href="#cb337-839" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-840"><a href="#cb337-840" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>)</span>
<span id="cb337-841"><a href="#cb337-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-842"><a href="#cb337-842" aria-hidden="true" tabindex="-1"></a>fitLmrob <span class="ot">&lt;-</span> <span class="fu">lmrob</span>(</span>
<span id="cb337-843"><a href="#cb337-843" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-844"><a href="#cb337-844" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-845"><a href="#cb337-845" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>)</span>
<span id="cb337-846"><a href="#cb337-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-847"><a href="#cb337-847" aria-hidden="true" tabindex="-1"></a>fitLts <span class="ot">&lt;-</span> <span class="fu">ltsReg</span>(</span>
<span id="cb337-848"><a href="#cb337-848" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-849"><a href="#cb337-849" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-850"><a href="#cb337-850" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>)</span>
<span id="cb337-851"><a href="#cb337-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-852"><a href="#cb337-852" aria-hidden="true" tabindex="-1"></a>cvFitLm <span class="ot">&lt;-</span> <span class="fu">cvLm</span>(</span>
<span id="cb337-853"><a href="#cb337-853" aria-hidden="true" tabindex="-1"></a>  fitLm,</span>
<span id="cb337-854"><a href="#cb337-854" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> kFolds,</span>
<span id="cb337-855"><a href="#cb337-855" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> replications)</span>
<span id="cb337-856"><a href="#cb337-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-857"><a href="#cb337-857" aria-hidden="true" tabindex="-1"></a>cvFitLmrob <span class="ot">&lt;-</span> <span class="fu">cvLmrob</span>(</span>
<span id="cb337-858"><a href="#cb337-858" aria-hidden="true" tabindex="-1"></a>  fitLmrob,</span>
<span id="cb337-859"><a href="#cb337-859" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> kFolds,</span>
<span id="cb337-860"><a href="#cb337-860" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> replications)</span>
<span id="cb337-861"><a href="#cb337-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-862"><a href="#cb337-862" aria-hidden="true" tabindex="-1"></a>cvFitLts <span class="ot">&lt;-</span> <span class="fu">cvLts</span>(</span>
<span id="cb337-863"><a href="#cb337-863" aria-hidden="true" tabindex="-1"></a>  fitLts,</span>
<span id="cb337-864"><a href="#cb337-864" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> kFolds,</span>
<span id="cb337-865"><a href="#cb337-865" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> replications)</span>
<span id="cb337-866"><a href="#cb337-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-867"><a href="#cb337-867" aria-hidden="true" tabindex="-1"></a>cvFits <span class="ot">&lt;-</span> <span class="fu">cvSelect</span>(</span>
<span id="cb337-868"><a href="#cb337-868" aria-hidden="true" tabindex="-1"></a>  <span class="at">OLS =</span> cvFitLm,</span>
<span id="cb337-869"><a href="#cb337-869" aria-hidden="true" tabindex="-1"></a>  <span class="at">MM =</span> cvFitLmrob,</span>
<span id="cb337-870"><a href="#cb337-870" aria-hidden="true" tabindex="-1"></a>  <span class="at">LTS =</span> cvFitLts)</span>
<span id="cb337-871"><a href="#cb337-871" aria-hidden="true" tabindex="-1"></a>cvFits</span>
<span id="cb337-872"><a href="#cb337-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-873"><a href="#cb337-873" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(</span>
<span id="cb337-874"><a href="#cb337-874" aria-hidden="true" tabindex="-1"></a>  cvFits,</span>
<span id="cb337-875"><a href="#cb337-875" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Root Mean Square Error"</span>,</span>
<span id="cb337-876"><a href="#cb337-876" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(cvFits<span class="sc">$</span>cv<span class="sc">$</span>CV) <span class="sc">+</span> <span class="fl">0.2</span>))</span>
<span id="cb337-877"><a href="#cb337-877" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-878"><a href="#cb337-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-879"><a href="#cb337-879" aria-hidden="true" tabindex="-1"></a><span class="fu"># Examining Model Fits</span></span>
<span id="cb337-880"><a href="#cb337-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-881"><a href="#cb337-881" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effect Plots</span></span>
<span id="cb337-882"><a href="#cb337-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-885"><a href="#cb337-885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-886"><a href="#cb337-886" aria-hidden="true" tabindex="-1"></a><span class="fu">allEffects</span>(multipleRegressionModel)</span>
<span id="cb337-887"><a href="#cb337-887" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(multipleRegressionModel))</span>
<span id="cb337-888"><a href="#cb337-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-889"><a href="#cb337-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-890"><a href="#cb337-890" aria-hidden="true" tabindex="-1"></a><span class="fu">## Confidence Ellipses</span></span>
<span id="cb337-891"><a href="#cb337-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-894"><a href="#cb337-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-895"><a href="#cb337-895" aria-hidden="true" tabindex="-1"></a><span class="fu">confidenceEllipse</span>(</span>
<span id="cb337-896"><a href="#cb337-896" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-897"><a href="#cb337-897" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, .<span class="dv">95</span>))</span>
<span id="cb337-898"><a href="#cb337-898" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-899"><a href="#cb337-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-900"><a href="#cb337-900" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Ellipse</span></span>
<span id="cb337-901"><a href="#cb337-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-904"><a href="#cb337-904" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-905"><a href="#cb337-905" aria-hidden="true" tabindex="-1"></a>mydata_nomissing <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)])</span>
<span id="cb337-906"><a href="#cb337-906" aria-hidden="true" tabindex="-1"></a><span class="fu">dataEllipse</span>(</span>
<span id="cb337-907"><a href="#cb337-907" aria-hidden="true" tabindex="-1"></a>  mydata_nomissing<span class="sc">$</span>bpi_antisocialT1Sum,</span>
<span id="cb337-908"><a href="#cb337-908" aria-hidden="true" tabindex="-1"></a>  mydata_nomissing<span class="sc">$</span>bpi_antisocialT2Sum,</span>
<span id="cb337-909"><a href="#cb337-909" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, .<span class="dv">95</span>))</span>
<span id="cb337-910"><a href="#cb337-910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-911"><a href="#cb337-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-912"><a href="#cb337-912" aria-hidden="true" tabindex="-1"></a><span class="fu"># Diagnostics</span></span>
<span id="cb337-913"><a href="#cb337-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-914"><a href="#cb337-914" aria-hidden="true" tabindex="-1"></a><span class="fu">## Assumptions</span></span>
<span id="cb337-915"><a href="#cb337-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-916"><a href="#cb337-916" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1. Linear relation between predictors and outcome {#sec-linearAssociation}</span></span>
<span id="cb337-917"><a href="#cb337-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-918"><a href="#cb337-918" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Test</span></span>
<span id="cb337-919"><a href="#cb337-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-920"><a href="#cb337-920" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Before Model Fitting</span></span>
<span id="cb337-921"><a href="#cb337-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-922"><a href="#cb337-922" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>scatterplot matrix</span>
<span id="cb337-923"><a href="#cb337-923" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>distance correlation</span>
<span id="cb337-924"><a href="#cb337-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-925"><a href="#cb337-925" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Scatterplot Matrix</span></span>
<span id="cb337-926"><a href="#cb337-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-929"><a href="#cb337-929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-930"><a href="#cb337-930" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplotMatrix</span>(</span>
<span id="cb337-931"><a href="#cb337-931" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> bpi_antisocialT2Sum <span class="sc">+</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-932"><a href="#cb337-932" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata)</span>
<span id="cb337-933"><a href="#cb337-933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-934"><a href="#cb337-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-935"><a href="#cb337-935" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Distance correlation</span></span>
<span id="cb337-936"><a href="#cb337-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-937"><a href="#cb337-937" aria-hidden="true" tabindex="-1"></a>The distance correlation is an index of the degree of the linear and non-linear association between two variables.</span>
<span id="cb337-938"><a href="#cb337-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-941"><a href="#cb337-941" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-942"><a href="#cb337-942" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(</span>
<span id="cb337-943"><a href="#cb337-943" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)],</span>
<span id="cb337-944"><a href="#cb337-944" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"distance"</span>,</span>
<span id="cb337-945"><a href="#cb337-945" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb337-946"><a href="#cb337-946" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-947"><a href="#cb337-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-948"><a href="#cb337-948" aria-hidden="true" tabindex="-1"></a><span class="fu">##### After Model Fitting</span></span>
<span id="cb337-949"><a href="#cb337-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-950"><a href="#cb337-950" aria-hidden="true" tabindex="-1"></a>Check for nonlinearities (non-horizontal line) in plots of:</span>
<span id="cb337-951"><a href="#cb337-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-952"><a href="#cb337-952" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Residuals versus fitted values (<span class="co">[</span><span class="ot">Residual Plots</span><span class="co">](#sec-residualPlots)</span>)—best</span>
<span id="cb337-953"><a href="#cb337-953" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Residuals versus predictors (<span class="co">[</span><span class="ot">Residual Plots</span><span class="co">](#sec-residualPlots)</span>)</span>
<span id="cb337-954"><a href="#cb337-954" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Outcome versus fitted values (<span class="co">[</span><span class="ot">Marginal Model Plots</span><span class="co">](#sec-marginalModelPlots)</span>)</span>
<span id="cb337-955"><a href="#cb337-955" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Outcome versus predictors, ignoring other predictors (<span class="co">[</span><span class="ot">Marginal Model Plots</span><span class="co">](#sec-marginalModelPlots)</span>)</span>
<span id="cb337-956"><a href="#cb337-956" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Outcome versus predictors, controlling for other predictors (<span class="co">[</span><span class="ot">Added-Variable Plots</span><span class="co">](#sec-addedVariablePlots)</span>)</span>
<span id="cb337-957"><a href="#cb337-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-958"><a href="#cb337-958" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Handle</span></span>
<span id="cb337-959"><a href="#cb337-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-960"><a href="#cb337-960" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Transform outcome/predictor variables (Box-Cox transformations)</span>
<span id="cb337-961"><a href="#cb337-961" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Semi-parametric regression models: Generalized additive models (GAM)</span>
<span id="cb337-962"><a href="#cb337-962" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Non-parametric regression models: Nearest-Neighbor Kernel Regression</span>
<span id="cb337-963"><a href="#cb337-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-964"><a href="#cb337-964" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Semi-parametric or non-parametric regression models</span></span>
<span id="cb337-965"><a href="#cb337-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-966"><a href="#cb337-966" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;http://www.lisa.stat.vt.edu/?q=node/7517&gt;</span> (archived at <span class="ot">&lt;https://web.archive.org/web/20180113065042/http://www.lisa.stat.vt.edu/?q=node/7517&gt;</span>)</span>
<span id="cb337-967"><a href="#cb337-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-968"><a href="#cb337-968" aria-hidden="true" tabindex="-1"></a>Note: using semi-parametric or non-parametric models increases fit in context of nonlinearity at the expense of added complexity.</span>
<span id="cb337-969"><a href="#cb337-969" aria-hidden="true" tabindex="-1"></a>Make sure to avoid fitting an overly complex model (e.g., use k-fold cross validation).</span>
<span id="cb337-970"><a href="#cb337-970" aria-hidden="true" tabindex="-1"></a>Often, the simpler (generalized) linear model is preferable to semi-paremetric or non-parametric approaches</span>
<span id="cb337-971"><a href="#cb337-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-972"><a href="#cb337-972" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Semi-parametric: Generalized Additive Models</span></span>
<span id="cb337-973"><a href="#cb337-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-974"><a href="#cb337-974" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;http://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models&gt;</span> (archived at <span class="ot">&lt;https://web.archive.org/web/20170213041653/http://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models&gt;</span>)</span>
<span id="cb337-975"><a href="#cb337-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-978"><a href="#cb337-978" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-979"><a href="#cb337-979" aria-hidden="true" tabindex="-1"></a>generalizedAdditiveModel <span class="ot">&lt;-</span> <span class="fu">gam</span>(</span>
<span id="cb337-980"><a href="#cb337-980" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-981"><a href="#cb337-981" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb337-982"><a href="#cb337-982" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-983"><a href="#cb337-983" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-984"><a href="#cb337-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-985"><a href="#cb337-985" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(generalizedAdditiveModel)</span>
<span id="cb337-986"><a href="#cb337-986" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(generalizedAdditiveModel)</span>
<span id="cb337-987"><a href="#cb337-987" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-988"><a href="#cb337-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-989"><a href="#cb337-989" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Non-parametric: Nearest-Neighbor Kernel Regression</span></span>
<span id="cb337-990"><a href="#cb337-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-991"><a href="#cb337-991" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2. Exogeneity</span></span>
<span id="cb337-992"><a href="#cb337-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-993"><a href="#cb337-993" aria-hidden="true" tabindex="-1"></a>Exogeneity means that the association between predictors and outcome is fully causal and unrelated to other variables.</span>
<span id="cb337-994"><a href="#cb337-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-995"><a href="#cb337-995" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Test</span></span>
<span id="cb337-996"><a href="#cb337-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-997"><a href="#cb337-997" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Durbin-Wu-Hausman test of endogeneity</span>
<span id="cb337-998"><a href="#cb337-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-999"><a href="#cb337-999" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Durbin-Wu-Hausman test of endogeneity</span></span>
<span id="cb337-1000"><a href="#cb337-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1001"><a href="#cb337-1001" aria-hidden="true" tabindex="-1"></a>The instrumental variables (2SLS) estimator is implemented in the <span class="in">`R`</span> package <span class="in">`AER`</span> as command:</span>
<span id="cb337-1002"><a href="#cb337-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1005"><a href="#cb337-1005" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1006"><a href="#cb337-1006" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb337-1007"><a href="#cb337-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1008"><a href="#cb337-1008" aria-hidden="true" tabindex="-1"></a><span class="fu">ivreg</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> w1 <span class="sc">+</span> w2 <span class="sc">|</span> z1 <span class="sc">+</span> z2 <span class="sc">+</span> z3 <span class="sc">+</span> w1 <span class="sc">+</span> w2)</span>
<span id="cb337-1009"><a href="#cb337-1009" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1010"><a href="#cb337-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1011"><a href="#cb337-1011" aria-hidden="true" tabindex="-1"></a>where <span class="in">`x1`</span> and <span class="in">`x2`</span> are endogenous regressors, <span class="in">`w1`</span> and <span class="in">`w2`</span> exogeneous regressors, and <span class="in">`z1`</span> to <span class="in">`z3`</span> are excluded instruments.</span>
<span id="cb337-1012"><a href="#cb337-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1013"><a href="#cb337-1013" aria-hidden="true" tabindex="-1"></a>Durbin-Wu-Hausman test:</span>
<span id="cb337-1014"><a href="#cb337-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1017"><a href="#cb337-1017" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1018"><a href="#cb337-1018" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb337-1019"><a href="#cb337-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1020"><a href="#cb337-1020" aria-hidden="true" tabindex="-1"></a>hsng2 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"https://www.stata-press.com/data/r11/hsng2.dta"</span>) <span class="co">#archived at https://perma.cc/7P2Q-ARKR</span></span>
<span id="cb337-1021"><a href="#cb337-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1022"><a href="#cb337-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1025"><a href="#cb337-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1026"><a href="#cb337-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb337-1027"><a href="#cb337-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1028"><a href="#cb337-1028" aria-hidden="true" tabindex="-1"></a>hsng2 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"./data/hsng2.dta"</span>) <span class="co">#https://www.stata-press.com/data/r11/hsng2.dta archived at https://perma.cc/7P2Q-ARKR</span></span>
<span id="cb337-1029"><a href="#cb337-1029" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1030"><a href="#cb337-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1033"><a href="#cb337-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1034"><a href="#cb337-1034" aria-hidden="true" tabindex="-1"></a>fiv <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(</span>
<span id="cb337-1035"><a href="#cb337-1035" aria-hidden="true" tabindex="-1"></a>  rent <span class="sc">~</span> hsngval <span class="sc">+</span> pcturban <span class="sc">|</span> pcturban <span class="sc">+</span> faminc <span class="sc">+</span> reg2 <span class="sc">+</span> reg3 <span class="sc">+</span> reg4,</span>
<span id="cb337-1036"><a href="#cb337-1036" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hsng2) <span class="co">#Housing values are likely endogeneous and therefore instrumented by median family income (faminc) and 3 regional dummies (reg2, reg4, reg4)</span></span>
<span id="cb337-1037"><a href="#cb337-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1038"><a href="#cb337-1038" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(</span>
<span id="cb337-1039"><a href="#cb337-1039" aria-hidden="true" tabindex="-1"></a>  fiv,</span>
<span id="cb337-1040"><a href="#cb337-1040" aria-hidden="true" tabindex="-1"></a>  <span class="at">diagnostics =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1041"><a href="#cb337-1041" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1042"><a href="#cb337-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1043"><a href="#cb337-1043" aria-hidden="true" tabindex="-1"></a>The Eicker-Huber-White covariance estimator which is robust to heteroscedastic error terms is reported after estimation with <span class="in">`vcov = sandwich`</span> in <span class="in">`coeftest()`</span></span>
<span id="cb337-1044"><a href="#cb337-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1045"><a href="#cb337-1045" aria-hidden="true" tabindex="-1"></a>First stage results are reported by explicitly estimating them.</span>
<span id="cb337-1046"><a href="#cb337-1046" aria-hidden="true" tabindex="-1"></a>For example:</span>
<span id="cb337-1047"><a href="#cb337-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1050"><a href="#cb337-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1051"><a href="#cb337-1051" aria-hidden="true" tabindex="-1"></a>first <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1052"><a href="#cb337-1052" aria-hidden="true" tabindex="-1"></a>  hsngval <span class="sc">~</span> pcturban <span class="sc">+</span> faminc <span class="sc">+</span> reg2 <span class="sc">+</span> reg3 <span class="sc">+</span> reg4,</span>
<span id="cb337-1053"><a href="#cb337-1053" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hsng2)</span>
<span id="cb337-1054"><a href="#cb337-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1055"><a href="#cb337-1055" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(first)</span>
<span id="cb337-1056"><a href="#cb337-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1057"><a href="#cb337-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1058"><a href="#cb337-1058" aria-hidden="true" tabindex="-1"></a>In case of a single endogenous variable (K = 1), the F-statistic to assess weak instruments is reported after estimating the first stage with, for example:</span>
<span id="cb337-1059"><a href="#cb337-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1062"><a href="#cb337-1062" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1063"><a href="#cb337-1063" aria-hidden="true" tabindex="-1"></a><span class="fu">waldtest</span>(</span>
<span id="cb337-1064"><a href="#cb337-1064" aria-hidden="true" tabindex="-1"></a>  first,</span>
<span id="cb337-1065"><a href="#cb337-1065" aria-hidden="true" tabindex="-1"></a>  . <span class="sc">~</span> . <span class="sc">-</span> faminc <span class="sc">-</span> reg2 <span class="sc">-</span> reg3 <span class="sc">-</span> reg4)</span>
<span id="cb337-1066"><a href="#cb337-1066" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1067"><a href="#cb337-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1068"><a href="#cb337-1068" aria-hidden="true" tabindex="-1"></a>or in case of heteroscedatistic errors:</span>
<span id="cb337-1069"><a href="#cb337-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1072"><a href="#cb337-1072" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1073"><a href="#cb337-1073" aria-hidden="true" tabindex="-1"></a><span class="fu">waldtest</span>(</span>
<span id="cb337-1074"><a href="#cb337-1074" aria-hidden="true" tabindex="-1"></a>  first,</span>
<span id="cb337-1075"><a href="#cb337-1075" aria-hidden="true" tabindex="-1"></a>  . <span class="sc">~</span> . <span class="sc">-</span> faminc <span class="sc">-</span> reg2 <span class="sc">-</span> reg3<span class="sc">-</span> reg4,</span>
<span id="cb337-1076"><a href="#cb337-1076" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> sandwich)</span>
<span id="cb337-1077"><a href="#cb337-1077" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1078"><a href="#cb337-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1079"><a href="#cb337-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Handle</span></span>
<span id="cb337-1080"><a href="#cb337-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1081"><a href="#cb337-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Conduct an experiment/RCT with random assignment</span>
<span id="cb337-1082"><a href="#cb337-1082" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Instrumental variables</span>
<span id="cb337-1083"><a href="#cb337-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1084"><a href="#cb337-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3. Homoscedasticity of residuals</span></span>
<span id="cb337-1085"><a href="#cb337-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1086"><a href="#cb337-1086" aria-hidden="true" tabindex="-1"></a>Homoscedasticity of the residuals means that the variance of the residuals does not differ as a function of the outcome/predictors (i.e., the residuals show constant variance as a function of outcome/predictors).</span>
<span id="cb337-1087"><a href="#cb337-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1088"><a href="#cb337-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Test</span></span>
<span id="cb337-1089"><a href="#cb337-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1090"><a href="#cb337-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Plot residuals vs. outcome and predictor variables (<span class="co">[</span><span class="ot">Residual Plots</span><span class="co">](#sec-residualPlots)</span>)</span>
<span id="cb337-1091"><a href="#cb337-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Plot residuals vs. fitted values (<span class="co">[</span><span class="ot">Residual Plots</span><span class="co">](#sec-residualPlots)</span>)</span>
<span id="cb337-1092"><a href="#cb337-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Time Series data: Plot residuals vs. time</span>
<span id="cb337-1093"><a href="#cb337-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Spread-level plot</span>
<span id="cb337-1094"><a href="#cb337-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Breusch-Pagan test: <span class="in">`bptest()`</span> function from <span class="in">`lmtest`</span> package</span>
<span id="cb337-1095"><a href="#cb337-1095" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Goldfeld-Quandt Test</span>
<span id="cb337-1096"><a href="#cb337-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1097"><a href="#cb337-1097" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Residuals vs. outcome and predictor variables</span></span>
<span id="cb337-1098"><a href="#cb337-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1099"><a href="#cb337-1099" aria-hidden="true" tabindex="-1"></a>Plot residuals, or perhaps their absolute values, versus the outcome and predictor variables (<span class="co">[</span><span class="ot">Residual Plots</span><span class="co">](#sec-residualPlots)</span>).</span>
<span id="cb337-1100"><a href="#cb337-1100" aria-hidden="true" tabindex="-1"></a>Examine whether residual variance is constant at all levels of other variables or whether it increases/decreases as a function of another variable (or shows some others structure, e.g., small variance at low and high levels of a predictor and high variance in the middle).</span>
<span id="cb337-1101"><a href="#cb337-1101" aria-hidden="true" tabindex="-1"></a>Note that this is *different than whether the residuals show non-linearities*—i.e., a non-horizontal line, which would indicate a <span class="co">[</span><span class="ot">nonlinear association between variables</span><span class="co">](#sec-linearAssociation)</span> (see Assumption #1, above).</span>
<span id="cb337-1102"><a href="#cb337-1102" aria-hidden="true" tabindex="-1"></a>Rather, here we are examining whether there is change in the variance as a function of another variable (e.g., a fan-shaped <span class="co">[</span><span class="ot">Residual Plot</span><span class="co">](#sec-residualPlots)</span>)</span>
<span id="cb337-1103"><a href="#cb337-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1104"><a href="#cb337-1104" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Spread-level plot</span></span>
<span id="cb337-1105"><a href="#cb337-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1106"><a href="#cb337-1106" aria-hidden="true" tabindex="-1"></a>Examining whether level (e.g., mean) depends on spread (e.g., variance)—plot of log of the absolute Studentized residuals against the log of the fitted values</span>
<span id="cb337-1107"><a href="#cb337-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1110"><a href="#cb337-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1111"><a href="#cb337-1111" aria-hidden="true" tabindex="-1"></a><span class="fu">spreadLevelPlot</span>(multipleRegressionModel)</span>
<span id="cb337-1112"><a href="#cb337-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1113"><a href="#cb337-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1114"><a href="#cb337-1114" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Breusch-Pagan test</span></span>
<span id="cb337-1115"><a href="#cb337-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1116"><a href="#cb337-1116" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://www.rdocumentation.org/packages/lmtest/versions/0.9-40/topics/bptest&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/K4WC-7TVW&gt;</span>)</span>
<span id="cb337-1117"><a href="#cb337-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1120"><a href="#cb337-1120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1121"><a href="#cb337-1121" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(multipleRegressionModel)</span>
<span id="cb337-1122"><a href="#cb337-1122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1123"><a href="#cb337-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1124"><a href="#cb337-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Goldfeld-Quandt Test</span></span>
<span id="cb337-1125"><a href="#cb337-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1128"><a href="#cb337-1128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1129"><a href="#cb337-1129" aria-hidden="true" tabindex="-1"></a><span class="fu">gqtest</span>(multipleRegressionModel)</span>
<span id="cb337-1130"><a href="#cb337-1130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1131"><a href="#cb337-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1132"><a href="#cb337-1132" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Test of dependence of spread on level</span></span>
<span id="cb337-1133"><a href="#cb337-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1136"><a href="#cb337-1136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1137"><a href="#cb337-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">ncvTest</span>(multipleRegressionModel)</span>
<span id="cb337-1138"><a href="#cb337-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1139"><a href="#cb337-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1140"><a href="#cb337-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Test of dependence of spread on predictors</span></span>
<span id="cb337-1141"><a href="#cb337-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1144"><a href="#cb337-1144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1145"><a href="#cb337-1145" aria-hidden="true" tabindex="-1"></a><span class="fu">ncvTest</span>(</span>
<span id="cb337-1146"><a href="#cb337-1146" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1147"><a href="#cb337-1147" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum)</span>
<span id="cb337-1148"><a href="#cb337-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1149"><a href="#cb337-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1150"><a href="#cb337-1150" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Handle</span></span>
<span id="cb337-1151"><a href="#cb337-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1152"><a href="#cb337-1152" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If residual variance increases as a function of the fitted values, consider a poisson regression model (especially for count data), for which the variance does increase with the mean</span>
<span id="cb337-1153"><a href="#cb337-1153" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If residual variance differs as a function of model predictors, consider adding interactions/product terms (the effect of one variable depends on the level of another variable)</span>
<span id="cb337-1154"><a href="#cb337-1154" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Try transforming the outcome variable to be normally distributed (log-transform if the errors seem consistent in percentage rather than absolute terms)</span>
<span id="cb337-1155"><a href="#cb337-1155" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the error variance is proportional to a variable $z$, then fit the model using Weighted Least Squares (WLS), with the weights given be $1/z$</span>
<span id="cb337-1156"><a href="#cb337-1156" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Weighted least squares (WLS) using the "weights" argument of the <span class="in">`lm()`</span> function; to get weights, see: <span class="ot">&lt;https://stats.stackexchange.com/a/100410/20338&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/C6BY-G9MS&gt;</span>)</span>
<span id="cb337-1157"><a href="#cb337-1157" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Huber-White standard errors (a.k.a. "Sandwich" estimates) from a heteroscedasticity-corrected covariance matrix</span>
<span id="cb337-1158"><a href="#cb337-1158" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="in">`coeftest()`</span> function from the <span class="in">`sandwich`</span> package along with hccm sandwich estimates from the <span class="in">`car`</span> package </span>
<span id="cb337-1159"><a href="#cb337-1159" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="in">`robcov()`</span> function from the <span class="in">`rms`</span> package</span>
<span id="cb337-1160"><a href="#cb337-1160" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Time series data: ARCH (auto-regressive conditional heteroscedasticity) models</span>
<span id="cb337-1161"><a href="#cb337-1161" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Time series data: seasonal patterns can be addressed by applying log transformation to outcome variable</span>
<span id="cb337-1162"><a href="#cb337-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1163"><a href="#cb337-1163" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Huber-White standard errors</span></span>
<span id="cb337-1164"><a href="#cb337-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1165"><a href="#cb337-1165" aria-hidden="true" tabindex="-1"></a>Standard errors (SEs) on the diagonal increase</span>
<span id="cb337-1166"><a href="#cb337-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1169"><a href="#cb337-1169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1170"><a href="#cb337-1170" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(multipleRegressionModel)</span>
<span id="cb337-1171"><a href="#cb337-1171" aria-hidden="true" tabindex="-1"></a><span class="fu">hccm</span>(multipleRegressionModel)</span>
<span id="cb337-1172"><a href="#cb337-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1173"><a href="#cb337-1173" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel)</span>
<span id="cb337-1174"><a href="#cb337-1174" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(multipleRegressionModel, <span class="at">vcov =</span> sandwich)</span>
<span id="cb337-1175"><a href="#cb337-1175" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(multipleRegressionModel, <span class="at">vcov =</span> hccm)</span>
<span id="cb337-1176"><a href="#cb337-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1177"><a href="#cb337-1177" aria-hidden="true" tabindex="-1"></a><span class="fu">robcov</span>(<span class="fu">ols</span>(</span>
<span id="cb337-1178"><a href="#cb337-1178" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1179"><a href="#cb337-1179" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1180"><a href="#cb337-1180" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-1181"><a href="#cb337-1181" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>))</span>
<span id="cb337-1182"><a href="#cb337-1182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1183"><a href="#cb337-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1184"><a href="#cb337-1184" aria-hidden="true" tabindex="-1"></a>Use "cluster" variable to account for nested data within-subject:</span>
<span id="cb337-1185"><a href="#cb337-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1188"><a href="#cb337-1188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1189"><a href="#cb337-1189" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb337-1190"><a href="#cb337-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1191"><a href="#cb337-1191" aria-hidden="true" tabindex="-1"></a><span class="fu">robcov</span>(<span class="fu">ols</span>(</span>
<span id="cb337-1192"><a href="#cb337-1192" aria-hidden="true" tabindex="-1"></a>  t_ext <span class="sc">~</span> m_ext <span class="sc">+</span> age,</span>
<span id="cb337-1193"><a href="#cb337-1193" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1194"><a href="#cb337-1194" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-1195"><a href="#cb337-1195" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>),</span>
<span id="cb337-1196"><a href="#cb337-1196" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster =</span> mydata<span class="sc">$</span>tcid) <span class="co">#account for nested data within subject</span></span>
<span id="cb337-1197"><a href="#cb337-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1198"><a href="#cb337-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1199"><a href="#cb337-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1200"><a href="#cb337-1200" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4. Errors are independent</span></span>
<span id="cb337-1201"><a href="#cb337-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1202"><a href="#cb337-1202" aria-hidden="true" tabindex="-1"></a>Independent errors means that the errors are uncorrelated with each other.</span>
<span id="cb337-1203"><a href="#cb337-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1204"><a href="#cb337-1204" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Test</span></span>
<span id="cb337-1205"><a href="#cb337-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1206"><a href="#cb337-1206" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Intraclass correlation coefficient (ICC) from mixed model</span>
<span id="cb337-1207"><a href="#cb337-1207" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Plot residuals vs. predictors (<span class="co">[</span><span class="ot">Residual Plots</span><span class="co">](#sec-residualPlots)</span>)</span>
<span id="cb337-1208"><a href="#cb337-1208" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Time Series data: Residual time series plot (residuals vs. row number)</span>
<span id="cb337-1209"><a href="#cb337-1209" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Time Series data: Table or plot of residual autocorrelations</span>
<span id="cb337-1210"><a href="#cb337-1210" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Time Series data: Durbin-Watson statistic for test of significant residual autocorrelation at lag 1</span>
<span id="cb337-1211"><a href="#cb337-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1212"><a href="#cb337-1212" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Handle</span></span>
<span id="cb337-1213"><a href="#cb337-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1214"><a href="#cb337-1214" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Generalized least squares (GLS) models are capable of handling correlated errors: <span class="ot">&lt;https://stat.ethz.ch/R-manual/R-devel/library/nlme/html/gls.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/RHZ6-5GT8&gt;</span>)</span>
<span id="cb337-1215"><a href="#cb337-1215" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Regression with cluster variable</span>
<span id="cb337-1216"><a href="#cb337-1216" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="in">`robcov()`</span> from <span class="in">`rms`</span> package</span>
<span id="cb337-1217"><a href="#cb337-1217" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Hierarchical linear modeling</span><span class="co">](hlm.qmd)</span></span>
<span id="cb337-1218"><a href="#cb337-1218" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Linear mixed effects models</span><span class="co">](hlm.qmd#sec-linear)</span></span>
<span id="cb337-1219"><a href="#cb337-1219" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Generalized linear mixed effects models</span><span class="co">](hlm.qmd#sec-generalized)</span></span>
<span id="cb337-1220"><a href="#cb337-1220" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Nonlinear mixed effects models</span><span class="co">](hlm.qmd#sec-nonlinear)</span></span>
<span id="cb337-1221"><a href="#cb337-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1222"><a href="#cb337-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5. No multicollinearity</span></span>
<span id="cb337-1223"><a href="#cb337-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1224"><a href="#cb337-1224" aria-hidden="true" tabindex="-1"></a>Multicollinearity occurs when the predictors are correlated with each other.</span>
<span id="cb337-1225"><a href="#cb337-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1226"><a href="#cb337-1226" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Test</span></span>
<span id="cb337-1227"><a href="#cb337-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1228"><a href="#cb337-1228" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Variance Inflation Factor (VIF)</span>
<span id="cb337-1229"><a href="#cb337-1229" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Generalized Variance Inflation Factor (GVIF)—when models have related regressors (multiple polynomial terms or contrasts from same predictor)</span>
<span id="cb337-1230"><a href="#cb337-1230" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Correlation</span>
<span id="cb337-1231"><a href="#cb337-1231" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tolerance</span>
<span id="cb337-1232"><a href="#cb337-1232" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Condition Index</span>
<span id="cb337-1233"><a href="#cb337-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1234"><a href="#cb337-1234" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Variance Inflation Factor (VIF)</span></span>
<span id="cb337-1235"><a href="#cb337-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1236"><a href="#cb337-1236" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb337-1237"><a href="#cb337-1237" aria-hidden="true" tabindex="-1"></a>\text{VIF} = 1/\text{Tolerance}</span>
<span id="cb337-1238"><a href="#cb337-1238" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb337-1239"><a href="#cb337-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1240"><a href="#cb337-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1241"><a href="#cb337-1241" aria-hidden="true" tabindex="-1"></a>If the variance inflation factor of a predictor variable were 5.27 ($\sqrt{5.27} = 2.3$), this means that the standard error for the coefficient of that predictor variable is 2.3 times as large (i.e., confidence interval is 2.3 times wider) as it would be if that predictor variable were uncorrelated with the other predictor variables.</span>
<span id="cb337-1242"><a href="#cb337-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1243"><a href="#cb337-1243" aria-hidden="true" tabindex="-1"></a>VIF = 1: Not correlated\</span>
<span id="cb337-1244"><a href="#cb337-1244" aria-hidden="true" tabindex="-1"></a>1 &lt; VIF &lt; 5: Moderately correlated\</span>
<span id="cb337-1245"><a href="#cb337-1245" aria-hidden="true" tabindex="-1"></a>VIF &gt; 5 to 10: Highly correlated (multicollinearity present)</span>
<span id="cb337-1246"><a href="#cb337-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1249"><a href="#cb337-1249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1250"><a href="#cb337-1250" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(multipleRegressionModel)</span>
<span id="cb337-1251"><a href="#cb337-1251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1252"><a href="#cb337-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1253"><a href="#cb337-1253" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Generalized Variance Inflation Factor (GVIF)</span></span>
<span id="cb337-1254"><a href="#cb337-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1255"><a href="#cb337-1255" aria-hidden="true" tabindex="-1"></a>Useful when models have related regressors (multiple polynomial terms or contrasts from same predictor)</span>
<span id="cb337-1256"><a href="#cb337-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1257"><a href="#cb337-1257" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Correlation</span></span>
<span id="cb337-1258"><a href="#cb337-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1259"><a href="#cb337-1259" aria-hidden="true" tabindex="-1"></a>correlation among all independent variables the correlation coefficients should be smaller than .08</span>
<span id="cb337-1260"><a href="#cb337-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1263"><a href="#cb337-1263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1264"><a href="#cb337-1264" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(</span>
<span id="cb337-1265"><a href="#cb337-1265" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span>)],</span>
<span id="cb337-1266"><a href="#cb337-1266" aria-hidden="true" tabindex="-1"></a>  <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb337-1267"><a href="#cb337-1267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1268"><a href="#cb337-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1269"><a href="#cb337-1269" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tolerance</span></span>
<span id="cb337-1270"><a href="#cb337-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1271"><a href="#cb337-1271" aria-hidden="true" tabindex="-1"></a>The tolerance is an index of the influence of one independent variable on all other independent variables.</span>
<span id="cb337-1272"><a href="#cb337-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1273"><a href="#cb337-1273" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb337-1274"><a href="#cb337-1274" aria-hidden="true" tabindex="-1"></a>\text{tolerance} = 1/\text{VIF}</span>
<span id="cb337-1275"><a href="#cb337-1275" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb337-1276"><a href="#cb337-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1277"><a href="#cb337-1277" aria-hidden="true" tabindex="-1"></a>T &lt; 0.2: there might be multicollinearity in the data\</span>
<span id="cb337-1278"><a href="#cb337-1278" aria-hidden="true" tabindex="-1"></a>T &lt; 0.01: there certainly is multicollinarity in the data</span>
<span id="cb337-1279"><a href="#cb337-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1280"><a href="#cb337-1280" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Condition Index</span></span>
<span id="cb337-1281"><a href="#cb337-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1282"><a href="#cb337-1282" aria-hidden="true" tabindex="-1"></a>The condition index is calculated using a factor analysis on the independent variables.</span>
<span id="cb337-1283"><a href="#cb337-1283" aria-hidden="true" tabindex="-1"></a>Values of 10-30 indicate a mediocre multicollinearity in the regression variables.</span>
<span id="cb337-1284"><a href="#cb337-1284" aria-hidden="true" tabindex="-1"></a>Values &gt; 30 indicate strong multicollinearity.</span>
<span id="cb337-1285"><a href="#cb337-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1286"><a href="#cb337-1286" aria-hidden="true" tabindex="-1"></a>For how to interpret, see here: <span class="ot">&lt;https://stats.stackexchange.com/a/87610/20338&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/Y4J8-MY7Q&gt;</span>)</span>
<span id="cb337-1287"><a href="#cb337-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1290"><a href="#cb337-1290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1291"><a href="#cb337-1291" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_eigen_cindex</span>(multipleRegressionModel)</span>
<span id="cb337-1292"><a href="#cb337-1292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1293"><a href="#cb337-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1294"><a href="#cb337-1294" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Handle</span></span>
<span id="cb337-1295"><a href="#cb337-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1296"><a href="#cb337-1296" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Remove highly correlated (i.e., redundant) predictors</span>
<span id="cb337-1297"><a href="#cb337-1297" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Average the correlated predictors</span>
<span id="cb337-1298"><a href="#cb337-1298" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Principal Component Analysis</span><span class="co">](pca.qmd)</span> for data reduction</span>
<span id="cb337-1299"><a href="#cb337-1299" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Standardize predictors</span>
<span id="cb337-1300"><a href="#cb337-1300" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Center the data (deduct the mean)</span>
<span id="cb337-1301"><a href="#cb337-1301" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Singular-value decomposition of the model matrix or the mean-centered model matrix</span>
<span id="cb337-1302"><a href="#cb337-1302" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Conduct a <span class="co">[</span><span class="ot">factor analysis</span><span class="co">](#factorAnalysis.qmd)</span> and rotate the factors to ensure independence of the factors</span>
<span id="cb337-1303"><a href="#cb337-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1304"><a href="#cb337-1304" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6. Errors are normally distributed</span></span>
<span id="cb337-1305"><a href="#cb337-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1306"><a href="#cb337-1306" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Test</span></span>
<span id="cb337-1307"><a href="#cb337-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1308"><a href="#cb337-1308" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Probability Plots</span>
<span id="cb337-1309"><a href="#cb337-1309" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Normal Quantile (QQ) Plots</span><span class="co">](#qqPlot)</span> (based on non-cumulative distribution of residuals)</span>
<span id="cb337-1310"><a href="#cb337-1310" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Normal Probability (PP) Plots</span><span class="co">](#ppPlot)</span> (based on cumulative distribution of residuals)</span>
<span id="cb337-1311"><a href="#cb337-1311" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Density Plot of Residuals</span><span class="co">](#densityPlotResiduals)</span></span>
<span id="cb337-1312"><a href="#cb337-1312" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Statistical Tests</span>
<span id="cb337-1313"><a href="#cb337-1313" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Kolmogorov-Smirnov test</span>
<span id="cb337-1314"><a href="#cb337-1314" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Shapiro-Wilk test</span>
<span id="cb337-1315"><a href="#cb337-1315" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Jarque-Bera test</span>
<span id="cb337-1316"><a href="#cb337-1316" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Anderson-Darling test (best test)</span>
<span id="cb337-1317"><a href="#cb337-1317" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Examine influence of outliers</span>
<span id="cb337-1318"><a href="#cb337-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1319"><a href="#cb337-1319" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Handle</span></span>
<span id="cb337-1320"><a href="#cb337-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1321"><a href="#cb337-1321" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Apply a transformation to the predictor or outcome variable</span>
<span id="cb337-1322"><a href="#cb337-1322" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Exclude outliers</span>
<span id="cb337-1323"><a href="#cb337-1323" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Robust regression</span>
<span id="cb337-1324"><a href="#cb337-1324" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Best when no outliers: MM-type regression estimator</span>
<span id="cb337-1325"><a href="#cb337-1325" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`lmrob()`</span>/<span class="in">`glmrob()`</span> function of <span class="in">`robustbase`</span> package</span>
<span id="cb337-1326"><a href="#cb337-1326" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Iteratively reweighted least squares (IRLS): <span class="in">`rlm(, method = "MM")`</span> function of <span class="in">`MASS`</span> package: <span class="ot">&lt;http://www.ats.ucla.edu/stat/r/dae/rreg.htm&gt;</span> (archived at <span class="ot">&lt;https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm&gt;</span>)</span>
<span id="cb337-1327"><a href="#cb337-1327" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Most resistant to outliers: Least trimmed squares (LTS)—but not good as a standalone estimator, better for identifying outliers</span>
<span id="cb337-1328"><a href="#cb337-1328" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`ltsReg()`</span> function of <span class="in">`robustbase`</span> package (best)</span>
<span id="cb337-1329"><a href="#cb337-1329" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Best when single predictor: Theil-Sen estimator</span>
<span id="cb337-1330"><a href="#cb337-1330" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`mblm(, repeated = FALSE)`</span> function of <span class="in">`mblm`</span> package</span>
<span id="cb337-1331"><a href="#cb337-1331" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Robust correlation</span>
<span id="cb337-1332"><a href="#cb337-1332" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Spearman's rho: <span class="in">`cor(, method = "spearman")`</span></span>
<span id="cb337-1333"><a href="#cb337-1333" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Percentage bend correlation</span>
<span id="cb337-1334"><a href="#cb337-1334" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Minimum vollume ellipsoid</span>
<span id="cb337-1335"><a href="#cb337-1335" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Minimum covariance determinant:</span>
<span id="cb337-1336"><a href="#cb337-1336" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Winsorized correlation</span>
<span id="cb337-1337"><a href="#cb337-1337" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Biweight midcorrelation</span>
<span id="cb337-1338"><a href="#cb337-1338" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Xi ($\xi$) correlation</span>
<span id="cb337-1339"><a href="#cb337-1339" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Not great options:</span>
<span id="cb337-1340"><a href="#cb337-1340" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Quantile (L1) regression: <span class="in">`rq()`</span> function of <span class="in">`quantreg`</span> package</span>
<span id="cb337-1341"><a href="#cb337-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1342"><a href="#cb337-1342" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Transformations of Outcome Variable</span></span>
<span id="cb337-1343"><a href="#cb337-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1344"><a href="#cb337-1344" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Box-Cox Transformation</span></span>
<span id="cb337-1345"><a href="#cb337-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1346"><a href="#cb337-1346" aria-hidden="true" tabindex="-1"></a>Useful if the outcome is strictly positive (or add a constant to outcome to make it strictly positive)</span>
<span id="cb337-1347"><a href="#cb337-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1348"><a href="#cb337-1348" aria-hidden="true" tabindex="-1"></a>lambda = -1: inverse transformation\</span>
<span id="cb337-1349"><a href="#cb337-1349" aria-hidden="true" tabindex="-1"></a>lambda = -0.5: 1/sqrt(Y)\</span>
<span id="cb337-1350"><a href="#cb337-1350" aria-hidden="true" tabindex="-1"></a>lambda = 0: log transformation\</span>
<span id="cb337-1351"><a href="#cb337-1351" aria-hidden="true" tabindex="-1"></a>lambda = 0.5: square root\</span>
<span id="cb337-1352"><a href="#cb337-1352" aria-hidden="true" tabindex="-1"></a>lambda = 0.333: cube root\</span>
<span id="cb337-1353"><a href="#cb337-1353" aria-hidden="true" tabindex="-1"></a>lambda = 1: no transformation\</span>
<span id="cb337-1354"><a href="#cb337-1354" aria-hidden="true" tabindex="-1"></a>lambda = 2: squared\</span>
<span id="cb337-1355"><a href="#cb337-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1356"><a href="#cb337-1356" aria-hidden="true" tabindex="-1"></a>####### Raw distribution</span>
<span id="cb337-1357"><a href="#cb337-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1360"><a href="#cb337-1360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1361"><a href="#cb337-1361" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">na.omit</span>(mydata<span class="sc">$</span>bpi_antisocialT2Sum)))</span>
<span id="cb337-1362"><a href="#cb337-1362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1363"><a href="#cb337-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1364"><a href="#cb337-1364" aria-hidden="true" tabindex="-1"></a>####### Add constant to outcome to make it strictly positive</span>
<span id="cb337-1365"><a href="#cb337-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1368"><a href="#cb337-1368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1369"><a href="#cb337-1369" aria-hidden="true" tabindex="-1"></a>strictlyPositiveDV <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1370"><a href="#cb337-1370" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">+</span> <span class="dv">1</span> <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1371"><a href="#cb337-1371" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1372"><a href="#cb337-1372" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1373"><a href="#cb337-1373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1374"><a href="#cb337-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1375"><a href="#cb337-1375" aria-hidden="true" tabindex="-1"></a>####### Identify best power transformation (lambda)</span>
<span id="cb337-1376"><a href="#cb337-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1377"><a href="#cb337-1377" aria-hidden="true" tabindex="-1"></a>Consider rounding the power to a common value (square root = .5; cube root = .333; squared = 2)</span>
<span id="cb337-1378"><a href="#cb337-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1381"><a href="#cb337-1381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1382"><a href="#cb337-1382" aria-hidden="true" tabindex="-1"></a><span class="fu">boxCox</span>(strictlyPositiveDV)</span>
<span id="cb337-1383"><a href="#cb337-1383" aria-hidden="true" tabindex="-1"></a><span class="fu">powerTransform</span>(strictlyPositiveDV) </span>
<span id="cb337-1384"><a href="#cb337-1384" aria-hidden="true" tabindex="-1"></a>transformedDV <span class="ot">&lt;-</span> <span class="fu">powerTransform</span>(strictlyPositiveDV)</span>
<span id="cb337-1385"><a href="#cb337-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1386"><a href="#cb337-1386" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(transformedDV)</span>
<span id="cb337-1387"><a href="#cb337-1387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1388"><a href="#cb337-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1389"><a href="#cb337-1389" aria-hidden="true" tabindex="-1"></a>####### Transform the DV</span>
<span id="cb337-1390"><a href="#cb337-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1393"><a href="#cb337-1393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1394"><a href="#cb337-1394" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>bpi_antisocialT2SumTransformed <span class="ot">&lt;-</span> <span class="fu">bcPower</span>(mydata<span class="sc">$</span>bpi_antisocialT2Sum <span class="sc">+</span> <span class="dv">1</span>, <span class="fu">coef</span>(transformedDV))</span>
<span id="cb337-1395"><a href="#cb337-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1396"><a href="#cb337-1396" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">na.omit</span>(mydata<span class="sc">$</span>bpi_antisocialT2SumTransformed)))</span>
<span id="cb337-1397"><a href="#cb337-1397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1398"><a href="#cb337-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1399"><a href="#cb337-1399" aria-hidden="true" tabindex="-1"></a>####### Compare residuals from model with and without transformation</span>
<span id="cb337-1400"><a href="#cb337-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1401"><a href="#cb337-1401" aria-hidden="true" tabindex="-1"></a>######## Model without transformation</span>
<span id="cb337-1402"><a href="#cb337-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1405"><a href="#cb337-1405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1406"><a href="#cb337-1406" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelWithoutTransformation <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1407"><a href="#cb337-1407" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">+</span> <span class="dv">1</span> <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1408"><a href="#cb337-1408" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1409"><a href="#cb337-1409" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude))</span>
<span id="cb337-1410"><a href="#cb337-1410" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">na.omit</span>(<span class="fu">studres</span>(modelWithoutTransformation))))</span>
<span id="cb337-1411"><a href="#cb337-1411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1412"><a href="#cb337-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1413"><a href="#cb337-1413" aria-hidden="true" tabindex="-1"></a>######## Model with transformation</span>
<span id="cb337-1414"><a href="#cb337-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1417"><a href="#cb337-1417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1418"><a href="#cb337-1418" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelWithTransformation <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1419"><a href="#cb337-1419" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2SumTransformed <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1420"><a href="#cb337-1420" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1421"><a href="#cb337-1421" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude))</span>
<span id="cb337-1422"><a href="#cb337-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1423"><a href="#cb337-1423" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">na.omit</span>(<span class="fu">studres</span>(modelWithTransformation))))</span>
<span id="cb337-1424"><a href="#cb337-1424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1425"><a href="#cb337-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1426"><a href="#cb337-1426" aria-hidden="true" tabindex="-1"></a>####### Constructed Variable Test &amp; Plot</span>
<span id="cb337-1427"><a href="#cb337-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1428"><a href="#cb337-1428" aria-hidden="true" tabindex="-1"></a>A significant *p*-value indicates a strong need to transform variable:</span>
<span id="cb337-1429"><a href="#cb337-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1432"><a href="#cb337-1432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1433"><a href="#cb337-1433" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_constructedVariable <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb337-1434"><a href="#cb337-1434" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1435"><a href="#cb337-1435" aria-hidden="true" tabindex="-1"></a>  . <span class="sc">~</span> . <span class="sc">+</span> <span class="fu">boxCoxVariable</span>(bpi_antisocialT1Sum <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb337-1436"><a href="#cb337-1436" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel_constructedVariable)<span class="sc">$</span>coef[<span class="st">"boxCoxVariable(bpi_antisocialT1Sum + 1)"</span>, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb337-1437"><a href="#cb337-1437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1438"><a href="#cb337-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1439"><a href="#cb337-1439" aria-hidden="true" tabindex="-1"></a>Plot allows us to see whether the need for transformation is spread through data or whether it is just dependent on a small fraction of observations:</span>
<span id="cb337-1440"><a href="#cb337-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1443"><a href="#cb337-1443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1444"><a href="#cb337-1444" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(multipleRegressionModel_constructedVariable, <span class="st">"boxCoxVariable(bpi_antisocialT1Sum + 1)"</span>)</span>
<span id="cb337-1445"><a href="#cb337-1445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1446"><a href="#cb337-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1447"><a href="#cb337-1447" aria-hidden="true" tabindex="-1"></a>####### Inverse Response Plot</span>
<span id="cb337-1448"><a href="#cb337-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1449"><a href="#cb337-1449" aria-hidden="true" tabindex="-1"></a>The black line is the best-fitting power transformation:</span>
<span id="cb337-1450"><a href="#cb337-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1453"><a href="#cb337-1453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1454"><a href="#cb337-1454" aria-hidden="true" tabindex="-1"></a><span class="fu">inverseResponsePlot</span>(strictlyPositiveDV, <span class="at">lambda =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb337-1455"><a href="#cb337-1455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1456"><a href="#cb337-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1457"><a href="#cb337-1457" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Yeo-Johnson Transformations</span></span>
<span id="cb337-1458"><a href="#cb337-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1459"><a href="#cb337-1459" aria-hidden="true" tabindex="-1"></a>Useful if the outcome is not strictly positive.</span>
<span id="cb337-1460"><a href="#cb337-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1463"><a href="#cb337-1463" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1464"><a href="#cb337-1464" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb337-1465"><a href="#cb337-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1466"><a href="#cb337-1466" aria-hidden="true" tabindex="-1"></a><span class="fu">yjPower</span>(DV, lambda)</span>
<span id="cb337-1467"><a href="#cb337-1467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1468"><a href="#cb337-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1469"><a href="#cb337-1469" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Transformations of Predictor Variable</span></span>
<span id="cb337-1470"><a href="#cb337-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1471"><a href="#cb337-1471" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Component-Plus-Residual Plots (Partial Residual Plots)</span></span>
<span id="cb337-1472"><a href="#cb337-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1473"><a href="#cb337-1473" aria-hidden="true" tabindex="-1"></a>Linear model:</span>
<span id="cb337-1474"><a href="#cb337-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1477"><a href="#cb337-1477" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1478"><a href="#cb337-1478" aria-hidden="true" tabindex="-1"></a><span class="fu">crPlots</span>(multipleRegressionModelNoMissing, <span class="at">order =</span> <span class="dv">1</span>)</span>
<span id="cb337-1479"><a href="#cb337-1479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1480"><a href="#cb337-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1481"><a href="#cb337-1481" aria-hidden="true" tabindex="-1"></a>Quadratic model:</span>
<span id="cb337-1482"><a href="#cb337-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1485"><a href="#cb337-1485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1486"><a href="#cb337-1486" aria-hidden="true" tabindex="-1"></a><span class="fu">crPlots</span>(multipleRegressionModelNoMissing, <span class="at">order =</span> <span class="dv">2</span>)</span>
<span id="cb337-1487"><a href="#cb337-1487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1488"><a href="#cb337-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1489"><a href="#cb337-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1492"><a href="#cb337-1492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1493"><a href="#cb337-1493" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_quadratic <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1494"><a href="#cb337-1494" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> <span class="fu">I</span>(bpi_antisocialT1Sum<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1495"><a href="#cb337-1495" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1496"><a href="#cb337-1496" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1497"><a href="#cb337-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1498"><a href="#cb337-1498" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel_quadratic)</span>
<span id="cb337-1499"><a href="#cb337-1499" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(</span>
<span id="cb337-1500"><a href="#cb337-1500" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_quadratic,</span>
<span id="cb337-1501"><a href="#cb337-1501" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel)</span>
<span id="cb337-1502"><a href="#cb337-1502" aria-hidden="true" tabindex="-1"></a><span class="fu">crPlots</span>(multipleRegressionModel_quadratic, <span class="at">order =</span> <span class="dv">1</span>)</span>
<span id="cb337-1503"><a href="#cb337-1503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1504"><a href="#cb337-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1505"><a href="#cb337-1505" aria-hidden="true" tabindex="-1"></a><span class="fu">###### CERES Plot (Combining conditional Expectations and RESiduals)</span></span>
<span id="cb337-1506"><a href="#cb337-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1507"><a href="#cb337-1507" aria-hidden="true" tabindex="-1"></a>Useful when nonlinear associations among the predictors are very strong (component-plus-residual plots may appear nonlinear even though the true partial regression is linear, a phenonomen called leakage)</span>
<span id="cb337-1508"><a href="#cb337-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1511"><a href="#cb337-1511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1512"><a href="#cb337-1512" aria-hidden="true" tabindex="-1"></a><span class="fu">ceresPlots</span>(multipleRegressionModel)</span>
<span id="cb337-1513"><a href="#cb337-1513" aria-hidden="true" tabindex="-1"></a><span class="fu">ceresPlots</span>(multipleRegressionModel_quadratic)</span>
<span id="cb337-1514"><a href="#cb337-1514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1515"><a href="#cb337-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1516"><a href="#cb337-1516" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Box-Tidwell Method for Choosing Predictor Transformations</span></span>
<span id="cb337-1517"><a href="#cb337-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1518"><a href="#cb337-1518" aria-hidden="true" tabindex="-1"></a>predictors must be strictly positive (or add a constant to make it strictly positive)</span>
<span id="cb337-1519"><a href="#cb337-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1522"><a href="#cb337-1522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1523"><a href="#cb337-1523" aria-hidden="true" tabindex="-1"></a><span class="fu">boxTidwell</span>(</span>
<span id="cb337-1524"><a href="#cb337-1524" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> <span class="fu">I</span>(bpi_antisocialT1Sum <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">I</span>(bpi_anxiousDepressedSum <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb337-1525"><a href="#cb337-1525" aria-hidden="true" tabindex="-1"></a>  <span class="at">other.x =</span> <span class="cn">NULL</span>, <span class="co">#list variables not to be transformed in other.x</span></span>
<span id="cb337-1526"><a href="#cb337-1526" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1527"><a href="#cb337-1527" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1528"><a href="#cb337-1528" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1529"><a href="#cb337-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1530"><a href="#cb337-1530" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Constructed-Variables Plot</span></span>
<span id="cb337-1531"><a href="#cb337-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1534"><a href="#cb337-1534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1535"><a href="#cb337-1535" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_cv <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1536"><a href="#cb337-1536" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> <span class="fu">I</span>(bpi_antisocialT1Sum <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">I</span>(bpi_anxiousDepressedSum <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">I</span>(bpi_antisocialT1Sum <span class="sc">*</span> <span class="fu">log</span>(bpi_antisocialT1Sum)) <span class="sc">+</span> <span class="fu">I</span>(bpi_anxiousDepressedSum <span class="sc">*</span> <span class="fu">log</span>(bpi_anxiousDepressedSum)),</span>
<span id="cb337-1537"><a href="#cb337-1537" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1538"><a href="#cb337-1538" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1539"><a href="#cb337-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1540"><a href="#cb337-1540" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel_cv)<span class="sc">$</span>coef[<span class="st">"I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum))"</span>, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb337-1541"><a href="#cb337-1541" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel_cv)<span class="sc">$</span>coef[<span class="st">"I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum))"</span>, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb337-1542"><a href="#cb337-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1543"><a href="#cb337-1543" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(multipleRegressionModel_cv, <span class="st">"I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum))"</span>)</span>
<span id="cb337-1544"><a href="#cb337-1544" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(multipleRegressionModel_cv, <span class="st">"I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum))"</span>)</span>
<span id="cb337-1545"><a href="#cb337-1545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1546"><a href="#cb337-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1547"><a href="#cb337-1547" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Robust models</span></span>
<span id="cb337-1548"><a href="#cb337-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1549"><a href="#cb337-1549" aria-hidden="true" tabindex="-1"></a>Resources</span>
<span id="cb337-1550"><a href="#cb337-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1551"><a href="#cb337-1551" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For comparison of methods, see Book: "Modern Methods for Robust Regression"</span>
<span id="cb337-1552"><a href="#cb337-1552" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;http://www.ats.ucla.edu/stat/r/dae/rreg.htm&gt;</span> (archived at <span class="ot">&lt;https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm&gt;</span>)</span>
<span id="cb337-1553"><a href="#cb337-1553" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://stats.stackexchange.com/a/46234/20338&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/WC57-9GA7&gt;</span>)</span>
<span id="cb337-1554"><a href="#cb337-1554" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://cran.r-project.org/web/views/Robust.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/THN5-KNY3&gt;</span>)</span>
<span id="cb337-1555"><a href="#cb337-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1556"><a href="#cb337-1556" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Robust correlation</span></span>
<span id="cb337-1557"><a href="#cb337-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1558"><a href="#cb337-1558" aria-hidden="true" tabindex="-1"></a>####### Spearman's rho</span>
<span id="cb337-1559"><a href="#cb337-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1560"><a href="#cb337-1560" aria-hidden="true" tabindex="-1"></a>Spearman's rho is a non-parametric correlation.</span>
<span id="cb337-1561"><a href="#cb337-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1564"><a href="#cb337-1564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1565"><a href="#cb337-1565" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(</span>
<span id="cb337-1566"><a href="#cb337-1566" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT1Sum,</span>
<span id="cb337-1567"><a href="#cb337-1567" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT2Sum) <span class="co">#Pearson r, correlation that is sensitive to outliers</span></span>
<span id="cb337-1568"><a href="#cb337-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1569"><a href="#cb337-1569" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(</span>
<span id="cb337-1570"><a href="#cb337-1570" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT1Sum,</span>
<span id="cb337-1571"><a href="#cb337-1571" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT2Sum, <span class="at">method =</span> <span class="st">"spearman"</span>) <span class="co">#Spearman's rho, a rank correlation that is less sensitive to outliers</span></span>
<span id="cb337-1572"><a href="#cb337-1572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1573"><a href="#cb337-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1574"><a href="#cb337-1574" aria-hidden="true" tabindex="-1"></a>####### Minimum vollume ellipsoid</span>
<span id="cb337-1575"><a href="#cb337-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1578"><a href="#cb337-1578" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1579"><a href="#cb337-1579" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb337-1580"><a href="#cb337-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1581"><a href="#cb337-1581" aria-hidden="true" tabindex="-1"></a><span class="fu">cov.mve</span>(</span>
<span id="cb337-1582"><a href="#cb337-1582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)]),</span>
<span id="cb337-1583"><a href="#cb337-1583" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1584"><a href="#cb337-1584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1585"><a href="#cb337-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1588"><a href="#cb337-1588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1589"><a href="#cb337-1589" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb337-1590"><a href="#cb337-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1591"><a href="#cb337-1591" aria-hidden="true" tabindex="-1"></a>cov.mve.fit <span class="ot">&lt;-</span> <span class="fu">cov.mve</span>(</span>
<span id="cb337-1592"><a href="#cb337-1592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)]),</span>
<span id="cb337-1593"><a href="#cb337-1593" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1594"><a href="#cb337-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1595"><a href="#cb337-1595" aria-hidden="true" tabindex="-1"></a>cov.mve.fit<span class="sc">$</span>best <span class="ot">&lt;-</span> <span class="fu">head</span>(cov.mve.fit<span class="sc">$</span>best)</span>
<span id="cb337-1596"><a href="#cb337-1596" aria-hidden="true" tabindex="-1"></a>cov.mve.fit</span>
<span id="cb337-1597"><a href="#cb337-1597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1598"><a href="#cb337-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1599"><a href="#cb337-1599" aria-hidden="true" tabindex="-1"></a>####### Minimum covariance determinant</span>
<span id="cb337-1600"><a href="#cb337-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1603"><a href="#cb337-1603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1604"><a href="#cb337-1604" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1605"><a href="#cb337-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1608"><a href="#cb337-1608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1609"><a href="#cb337-1609" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb337-1610"><a href="#cb337-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1611"><a href="#cb337-1611" aria-hidden="true" tabindex="-1"></a><span class="fu">cov.mcd</span>(</span>
<span id="cb337-1612"><a href="#cb337-1612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)]),</span>
<span id="cb337-1613"><a href="#cb337-1613" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1614"><a href="#cb337-1614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1615"><a href="#cb337-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1618"><a href="#cb337-1618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1619"><a href="#cb337-1619" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb337-1620"><a href="#cb337-1620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1621"><a href="#cb337-1621" aria-hidden="true" tabindex="-1"></a>cov.mcd.fit <span class="ot">&lt;-</span> <span class="fu">cov.mcd</span>(</span>
<span id="cb337-1622"><a href="#cb337-1622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)]),</span>
<span id="cb337-1623"><a href="#cb337-1623" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1624"><a href="#cb337-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1625"><a href="#cb337-1625" aria-hidden="true" tabindex="-1"></a>cov.mcd.fit<span class="sc">$</span>best <span class="ot">&lt;-</span> <span class="fu">head</span>(cov.mcd.fit<span class="sc">$</span>best)</span>
<span id="cb337-1626"><a href="#cb337-1626" aria-hidden="true" tabindex="-1"></a>cov.mcd.fit</span>
<span id="cb337-1627"><a href="#cb337-1627" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1628"><a href="#cb337-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1629"><a href="#cb337-1629" aria-hidden="true" tabindex="-1"></a>####### Winsorized correlation</span>
<span id="cb337-1630"><a href="#cb337-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1633"><a href="#cb337-1633" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1634"><a href="#cb337-1634" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(</span>
<span id="cb337-1635"><a href="#cb337-1635" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)],</span>
<span id="cb337-1636"><a href="#cb337-1636" aria-hidden="true" tabindex="-1"></a>  <span class="at">winsorize =</span> <span class="fl">0.2</span>,</span>
<span id="cb337-1637"><a href="#cb337-1637" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb337-1638"><a href="#cb337-1638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1639"><a href="#cb337-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1640"><a href="#cb337-1640" aria-hidden="true" tabindex="-1"></a>####### Percentage bend correlation</span>
<span id="cb337-1641"><a href="#cb337-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1644"><a href="#cb337-1644" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1645"><a href="#cb337-1645" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(</span>
<span id="cb337-1646"><a href="#cb337-1646" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)],</span>
<span id="cb337-1647"><a href="#cb337-1647" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"percentage"</span>,</span>
<span id="cb337-1648"><a href="#cb337-1648" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb337-1649"><a href="#cb337-1649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1650"><a href="#cb337-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1651"><a href="#cb337-1651" aria-hidden="true" tabindex="-1"></a>####### Biweight midcorrelation</span>
<span id="cb337-1652"><a href="#cb337-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1655"><a href="#cb337-1655" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1656"><a href="#cb337-1656" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(</span>
<span id="cb337-1657"><a href="#cb337-1657" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)],</span>
<span id="cb337-1658"><a href="#cb337-1658" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"biweight"</span>,</span>
<span id="cb337-1659"><a href="#cb337-1659" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb337-1660"><a href="#cb337-1660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1661"><a href="#cb337-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1662"><a href="#cb337-1662" aria-hidden="true" tabindex="-1"></a>####### Xi ($\xi$)</span>
<span id="cb337-1663"><a href="#cb337-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1664"><a href="#cb337-1664" aria-hidden="true" tabindex="-1"></a>Xi ($\xi$) is an index of the degree of dependence between two variables</span>
<span id="cb337-1665"><a href="#cb337-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1666"><a href="#cb337-1666" aria-hidden="true" tabindex="-1"></a>Chatterjee, S. (2021). A new coefficient of correlation. *Journal of the American Statistical Association, 116*(536), 2009-2022. <span class="ot">&lt;https://doi.org/10.1080/01621459.2020.1758115&gt;</span></span>
<span id="cb337-1667"><a href="#cb337-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1670"><a href="#cb337-1670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1671"><a href="#cb337-1671" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>) <span class="co"># for reproducibility</span></span>
<span id="cb337-1672"><a href="#cb337-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1673"><a href="#cb337-1673" aria-hidden="true" tabindex="-1"></a>XICOR<span class="sc">::</span><span class="fu">xicor</span>(</span>
<span id="cb337-1674"><a href="#cb337-1674" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT1Sum,</span>
<span id="cb337-1675"><a href="#cb337-1675" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT2Sum,</span>
<span id="cb337-1676"><a href="#cb337-1676" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"permutation"</span>,</span>
<span id="cb337-1677"><a href="#cb337-1677" aria-hidden="true" tabindex="-1"></a>  <span class="at">pvalue =</span> <span class="cn">TRUE</span></span>
<span id="cb337-1678"><a href="#cb337-1678" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb337-1679"><a href="#cb337-1679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1680"><a href="#cb337-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1681"><a href="#cb337-1681" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Robust regression with a single predictor</span></span>
<span id="cb337-1682"><a href="#cb337-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1683"><a href="#cb337-1683" aria-hidden="true" tabindex="-1"></a>####### Theil-Sen estimator</span>
<span id="cb337-1684"><a href="#cb337-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1685"><a href="#cb337-1685" aria-hidden="true" tabindex="-1"></a>The Theil-Sen single median estimator is robust to outliers; have to remove missing values first</span>
<span id="cb337-1686"><a href="#cb337-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1689"><a href="#cb337-1689" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1690"><a href="#cb337-1690" aria-hidden="true" tabindex="-1"></a>mydata_subset <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)])[<span class="dv">1</span><span class="sc">:</span><span class="dv">400</span>,]</span>
<span id="cb337-1691"><a href="#cb337-1691" aria-hidden="true" tabindex="-1"></a><span class="fu">mblm</span>(</span>
<span id="cb337-1692"><a href="#cb337-1692" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum,</span>
<span id="cb337-1693"><a href="#cb337-1693" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataframe =</span> mydata_subset,</span>
<span id="cb337-1694"><a href="#cb337-1694" aria-hidden="true" tabindex="-1"></a>  <span class="at">repeated =</span> <span class="cn">FALSE</span>)</span>
<span id="cb337-1695"><a href="#cb337-1695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1696"><a href="#cb337-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1697"><a href="#cb337-1697" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Robust multiple regression</span></span>
<span id="cb337-1698"><a href="#cb337-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1699"><a href="#cb337-1699" aria-hidden="true" tabindex="-1"></a>Best when no outliers: MM-type regression estimator</span>
<span id="cb337-1700"><a href="#cb337-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1701"><a href="#cb337-1701" aria-hidden="true" tabindex="-1"></a>####### Robust linear regression</span>
<span id="cb337-1702"><a href="#cb337-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1703"><a href="#cb337-1703" aria-hidden="true" tabindex="-1"></a>MM-type regression estimator (best):</span>
<span id="cb337-1704"><a href="#cb337-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1707"><a href="#cb337-1707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1708"><a href="#cb337-1708" aria-hidden="true" tabindex="-1"></a><span class="fu">lmrob</span>(</span>
<span id="cb337-1709"><a href="#cb337-1709" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1710"><a href="#cb337-1710" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1711"><a href="#cb337-1711" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1712"><a href="#cb337-1712" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1713"><a href="#cb337-1713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1714"><a href="#cb337-1714" aria-hidden="true" tabindex="-1"></a>Iteratively reweighted least squares (IRLS): <span class="ot">&lt;http://www.ats.ucla.edu/stat/r/dae/rreg.htm&gt;</span> (archived at <span class="ot">&lt;https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm&gt;</span>)</span>
<span id="cb337-1715"><a href="#cb337-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1718"><a href="#cb337-1718" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1719"><a href="#cb337-1719" aria-hidden="true" tabindex="-1"></a><span class="fu">rlm</span>(</span>
<span id="cb337-1720"><a href="#cb337-1720" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1721"><a href="#cb337-1721" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1722"><a href="#cb337-1722" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1723"><a href="#cb337-1723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1724"><a href="#cb337-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1725"><a href="#cb337-1725" aria-hidden="true" tabindex="-1"></a>####### Robust generalized regression</span>
<span id="cb337-1726"><a href="#cb337-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1729"><a href="#cb337-1729" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1730"><a href="#cb337-1730" aria-hidden="true" tabindex="-1"></a><span class="fu">glmrob</span>(</span>
<span id="cb337-1731"><a href="#cb337-1731" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1732"><a href="#cb337-1732" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1733"><a href="#cb337-1733" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb337-1734"><a href="#cb337-1734" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>)</span>
<span id="cb337-1735"><a href="#cb337-1735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1736"><a href="#cb337-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1737"><a href="#cb337-1737" aria-hidden="true" tabindex="-1"></a>Most resistant to outliers: Least trimmed squares (LTS)—but not good as a standalone estimator, better for identifying outliers</span>
<span id="cb337-1738"><a href="#cb337-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1741"><a href="#cb337-1741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1742"><a href="#cb337-1742" aria-hidden="true" tabindex="-1"></a><span class="fu">ltsReg</span>(</span>
<span id="cb337-1743"><a href="#cb337-1743" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1744"><a href="#cb337-1744" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1745"><a href="#cb337-1745" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1746"><a href="#cb337-1746" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1747"><a href="#cb337-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1748"><a href="#cb337-1748" aria-hidden="true" tabindex="-1"></a>######## Not great options:</span>
<span id="cb337-1749"><a href="#cb337-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1750"><a href="#cb337-1750" aria-hidden="true" tabindex="-1"></a>Quantile (L1) regression: <span class="in">`rq()`</span> function of quantreg package</span>
<span id="cb337-1751"><a href="#cb337-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1752"><a href="#cb337-1752" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://data.library.virginia.edu/getting-started-with-quantile-regression/&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/FSV4-5DCR&gt;</span>)</span>
<span id="cb337-1753"><a href="#cb337-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1756"><a href="#cb337-1756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1757"><a href="#cb337-1757" aria-hidden="true" tabindex="-1"></a>quantiles <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span><span class="sc">/</span><span class="dv">10</span></span>
<span id="cb337-1758"><a href="#cb337-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1759"><a href="#cb337-1759" aria-hidden="true" tabindex="-1"></a>quantileRegressionModel <span class="ot">&lt;-</span> <span class="fu">rq</span>(</span>
<span id="cb337-1760"><a href="#cb337-1760" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1761"><a href="#cb337-1761" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1762"><a href="#cb337-1762" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau =</span> quantiles,</span>
<span id="cb337-1763"><a href="#cb337-1763" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1764"><a href="#cb337-1764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1765"><a href="#cb337-1765" aria-hidden="true" tabindex="-1"></a>quantileRegressionModel</span>
<span id="cb337-1766"><a href="#cb337-1766" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quantileRegressionModel)</span>
<span id="cb337-1767"><a href="#cb337-1767" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1768"><a href="#cb337-1768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1769"><a href="#cb337-1769" aria-hidden="true" tabindex="-1"></a>Plot to examine the association between the predictor and the outcome at different levels (i.e., quantiles) of the predictor:</span>
<span id="cb337-1770"><a href="#cb337-1770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1773"><a href="#cb337-1773" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1774"><a href="#cb337-1774" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb337-1775"><a href="#cb337-1775" aria-hidden="true" tabindex="-1"></a>  mydata,</span>
<span id="cb337-1776"><a href="#cb337-1776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(bpi_antisocialT1Sum, bpi_antisocialT2Sum)) <span class="sc">+</span> </span>
<span id="cb337-1777"><a href="#cb337-1777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb337-1778"><a href="#cb337-1778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quantile</span>(</span>
<span id="cb337-1779"><a href="#cb337-1779" aria-hidden="true" tabindex="-1"></a>    <span class="at">quantiles =</span> quantiles,</span>
<span id="cb337-1780"><a href="#cb337-1780" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(<span class="fu">after_stat</span>(quantile))))</span>
<span id="cb337-1781"><a href="#cb337-1781" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1782"><a href="#cb337-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1783"><a href="#cb337-1783" aria-hidden="true" tabindex="-1"></a>Below is a plot that examines the difference in quantile coefficients (and associated confidence intervals) at different levels (i.e., quantiles) of the predictor.</span>
<span id="cb337-1784"><a href="#cb337-1784" aria-hidden="true" tabindex="-1"></a>The x-axis is the quantile of the predictor.</span>
<span id="cb337-1785"><a href="#cb337-1785" aria-hidden="true" tabindex="-1"></a>The y-axis is the slope coefficient.</span>
<span id="cb337-1786"><a href="#cb337-1786" aria-hidden="true" tabindex="-1"></a>Each black dot is the slope coefficient for the given quantile of the predictor.</span>
<span id="cb337-1787"><a href="#cb337-1787" aria-hidden="true" tabindex="-1"></a>The red lines are the least squares estimate of the slope coefficient and its confidence interval.</span>
<span id="cb337-1788"><a href="#cb337-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1791"><a href="#cb337-1791" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1792"><a href="#cb337-1792" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(quantileRegressionModel))</span>
<span id="cb337-1793"><a href="#cb337-1793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1794"><a href="#cb337-1794" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb337-1795"><a href="#cb337-1795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(quantileRegressionModel),</span>
<span id="cb337-1796"><a href="#cb337-1796" aria-hidden="true" tabindex="-1"></a>  <span class="at">parm =</span> <span class="st">"bpi_antisocialT1Sum"</span>)</span>
<span id="cb337-1797"><a href="#cb337-1797" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1798"><a href="#cb337-1798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1799"><a href="#cb337-1799" aria-hidden="true" tabindex="-1"></a><span class="fu">## Examining Model Assumptions</span></span>
<span id="cb337-1800"><a href="#cb337-1800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1801"><a href="#cb337-1801" aria-hidden="true" tabindex="-1"></a><span class="fu">### Distribution of Residuals</span></span>
<span id="cb337-1802"><a href="#cb337-1802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1803"><a href="#cb337-1803" aria-hidden="true" tabindex="-1"></a><span class="fu">#### QQ plots {#sec-qqPlot}</span></span>
<span id="cb337-1804"><a href="#cb337-1804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1805"><a href="#cb337-1805" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://www.ucd.ie/ecomodel/Resources/QQplots_WebVersion.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/9UC3-3WRX&gt;</span>)</span>
<span id="cb337-1806"><a href="#cb337-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1809"><a href="#cb337-1809" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1810"><a href="#cb337-1810" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(multipleRegressionModel, <span class="at">main =</span> <span class="st">"QQ Plot"</span>, <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1811"><a href="#cb337-1811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1812"><a href="#cb337-1812" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(multipleRegressionModel))</span>
<span id="cb337-1813"><a href="#cb337-1813" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(rmsMultipleRegressionModel))</span>
<span id="cb337-1814"><a href="#cb337-1814" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(robustLinearRegression))</span>
<span id="cb337-1815"><a href="#cb337-1815" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(ltsRegression))</span>
<span id="cb337-1816"><a href="#cb337-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1817"><a href="#cb337-1817" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(generalizedRegressionModel))</span>
<span id="cb337-1818"><a href="#cb337-1818" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(rmsGeneralizedRegressionModel))</span>
<span id="cb337-1819"><a href="#cb337-1819" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(robustGeneralizedRegression))</span>
<span id="cb337-1820"><a href="#cb337-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1821"><a href="#cb337-1821" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(multilevelRegressionModel))</span>
<span id="cb337-1822"><a href="#cb337-1822" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1823"><a href="#cb337-1823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1824"><a href="#cb337-1824" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PP plots {#sec-ppPlot}</span></span>
<span id="cb337-1825"><a href="#cb337-1825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1828"><a href="#cb337-1828" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1829"><a href="#cb337-1829" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(multipleRegressionModel)</span>
<span id="cb337-1830"><a href="#cb337-1830" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(rmsMultipleRegressionModel)</span>
<span id="cb337-1831"><a href="#cb337-1831" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(robustLinearRegression)</span>
<span id="cb337-1832"><a href="#cb337-1832" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(ltsRegression)</span>
<span id="cb337-1833"><a href="#cb337-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1834"><a href="#cb337-1834" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(generalizedRegressionModel)</span>
<span id="cb337-1835"><a href="#cb337-1835" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(rmsGeneralizedRegressionModel)</span>
<span id="cb337-1836"><a href="#cb337-1836" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(robustGeneralizedRegression)</span>
<span id="cb337-1837"><a href="#cb337-1837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1838"><a href="#cb337-1838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1839"><a href="#cb337-1839" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Density Plot of Residuals {#sec-densityPlotResiduals}</span></span>
<span id="cb337-1840"><a href="#cb337-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1843"><a href="#cb337-1843" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1844"><a href="#cb337-1844" aria-hidden="true" tabindex="-1"></a>studentizedResiduals <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">rstudent</span>(multipleRegressionModel))</span>
<span id="cb337-1845"><a href="#cb337-1845" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb337-1846"><a href="#cb337-1846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">density</span>(studentizedResiduals),</span>
<span id="cb337-1847"><a href="#cb337-1847" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb337-1848"><a href="#cb337-1848" aria-hidden="true" tabindex="-1"></a>xfit <span class="ot">&lt;-</span> <span class="fu">seq</span>(</span>
<span id="cb337-1849"><a href="#cb337-1849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(studentizedResiduals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb337-1850"><a href="#cb337-1850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(studentizedResiduals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb337-1851"><a href="#cb337-1851" aria-hidden="true" tabindex="-1"></a>  <span class="at">length =</span> <span class="dv">40</span>)</span>
<span id="cb337-1852"><a href="#cb337-1852" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(</span>
<span id="cb337-1853"><a href="#cb337-1853" aria-hidden="true" tabindex="-1"></a>  xfit,</span>
<span id="cb337-1854"><a href="#cb337-1854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(xfit),</span>
<span id="cb337-1855"><a href="#cb337-1855" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="st">"gray"</span>) <span class="co">#compare to normal distribution</span></span>
<span id="cb337-1856"><a href="#cb337-1856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1857"><a href="#cb337-1857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1858"><a href="#cb337-1858" aria-hidden="true" tabindex="-1"></a><span class="fu">### Residual Plots {#sec-residualPlots}</span></span>
<span id="cb337-1859"><a href="#cb337-1859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1860"><a href="#cb337-1860" aria-hidden="true" tabindex="-1"></a>Residual plots are plots of the residuals versus observed/fitted values.</span>
<span id="cb337-1861"><a href="#cb337-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1862"><a href="#cb337-1862" aria-hidden="true" tabindex="-1"></a>Includes plots of a) model residuals versus observed values on predictors and b) model residuals versus model fitted values.</span>
<span id="cb337-1863"><a href="#cb337-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1864"><a href="#cb337-1864" aria-hidden="true" tabindex="-1"></a>Note: have to remove <span class="in">`na.action = na.exclude`</span></span>
<span id="cb337-1865"><a href="#cb337-1865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1866"><a href="#cb337-1866" aria-hidden="true" tabindex="-1"></a>Tests include:</span>
<span id="cb337-1867"><a href="#cb337-1867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1868"><a href="#cb337-1868" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>lack-of-fit test for every numeric predictor, t-test for the regressor, added to the model, indicating no lack-of-fit for this type</span>
<span id="cb337-1869"><a href="#cb337-1869" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tukey's test for nonadditivity: adding the squares of the fitted values to the model and refitting (evaluates adequacy of model fit)</span>
<span id="cb337-1870"><a href="#cb337-1870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1873"><a href="#cb337-1873" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1874"><a href="#cb337-1874" aria-hidden="true" tabindex="-1"></a><span class="fu">residualPlots</span>(</span>
<span id="cb337-1875"><a href="#cb337-1875" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModelNoMissing,</span>
<span id="cb337-1876"><a href="#cb337-1876" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1877"><a href="#cb337-1877" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1878"><a href="#cb337-1878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1879"><a href="#cb337-1879" aria-hidden="true" tabindex="-1"></a><span class="fu">### Marginal Model Plots {#sec-marginalModelPlots}</span></span>
<span id="cb337-1880"><a href="#cb337-1880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1881"><a href="#cb337-1881" aria-hidden="true" tabindex="-1"></a>Marginal model plots are plots of the outcome versus predictors/fitted values.</span>
<span id="cb337-1882"><a href="#cb337-1882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1883"><a href="#cb337-1883" aria-hidden="true" tabindex="-1"></a>Includes plots of a) observed outcome values versus values on predictors (ignoring the other predictors) and b) observed outcome values versus model fitted values.</span>
<span id="cb337-1884"><a href="#cb337-1884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1887"><a href="#cb337-1887" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1888"><a href="#cb337-1888" aria-hidden="true" tabindex="-1"></a><span class="fu">marginalModelPlots</span>(</span>
<span id="cb337-1889"><a href="#cb337-1889" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1890"><a href="#cb337-1890" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-1891"><a href="#cb337-1891" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1892"><a href="#cb337-1892" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1893"><a href="#cb337-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1894"><a href="#cb337-1894" aria-hidden="true" tabindex="-1"></a><span class="fu">### Added-Variable Plots {#sec-addedVariablePlots}</span></span>
<span id="cb337-1895"><a href="#cb337-1895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1896"><a href="#cb337-1896" aria-hidden="true" tabindex="-1"></a>Added-variable plots are plots of the partial association between the outcome and each predictor, controlling for all other predictors.</span>
<span id="cb337-1897"><a href="#cb337-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1898"><a href="#cb337-1898" aria-hidden="true" tabindex="-1"></a>Useful for identifying jointly influential observations and studying the impact of observations on the regression coefficients.</span>
<span id="cb337-1899"><a href="#cb337-1899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1900"><a href="#cb337-1900" aria-hidden="true" tabindex="-1"></a>y-axis: residuals from model with all predictors excluding the predictor of interest</span>
<span id="cb337-1901"><a href="#cb337-1901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1902"><a href="#cb337-1902" aria-hidden="true" tabindex="-1"></a>x-axis: residuals from model regressing predictor of interest on all other predictors</span>
<span id="cb337-1903"><a href="#cb337-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1906"><a href="#cb337-1906" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1907"><a href="#cb337-1907" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(</span>
<span id="cb337-1908"><a href="#cb337-1908" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1909"><a href="#cb337-1909" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1910"><a href="#cb337-1910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1911"><a href="#cb337-1911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1912"><a href="#cb337-1912" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Refit model removing jointly influential observations</span></span>
<span id="cb337-1913"><a href="#cb337-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1916"><a href="#cb337-1916" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1917"><a href="#cb337-1917" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_removeJointlyInfluentialObs <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1918"><a href="#cb337-1918" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1919"><a href="#cb337-1919" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1920"><a href="#cb337-1920" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-1921"><a href="#cb337-1921" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">6318</span>,<span class="dv">6023</span>,<span class="dv">4022</span>,<span class="dv">4040</span>))</span>
<span id="cb337-1922"><a href="#cb337-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1923"><a href="#cb337-1923" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(</span>
<span id="cb337-1924"><a href="#cb337-1924" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_removeJointlyInfluentialObs,</span>
<span id="cb337-1925"><a href="#cb337-1925" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1926"><a href="#cb337-1926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1927"><a href="#cb337-1927" aria-hidden="true" tabindex="-1"></a><span class="fu">compareCoefs</span>(</span>
<span id="cb337-1928"><a href="#cb337-1928" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1929"><a href="#cb337-1929" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_removeJointlyInfluentialObs)</span>
<span id="cb337-1930"><a href="#cb337-1930" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1931"><a href="#cb337-1931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1932"><a href="#cb337-1932" aria-hidden="true" tabindex="-1"></a><span class="fu">### Outlier test</span></span>
<span id="cb337-1933"><a href="#cb337-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1934"><a href="#cb337-1934" aria-hidden="true" tabindex="-1"></a>Locates the largest Studentized residuals in absolute value and computes the Bonferroni-corrected p-values based on a t-test for linear models.</span>
<span id="cb337-1935"><a href="#cb337-1935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1936"><a href="#cb337-1936" aria-hidden="true" tabindex="-1"></a>Test of outlyingness, i.e., how likely one would have a residual of a given magnitude in a normal distribution with the same sample size</span>
<span id="cb337-1937"><a href="#cb337-1937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1938"><a href="#cb337-1938" aria-hidden="true" tabindex="-1"></a>Note: it does not test how extreme an observation is relative to its distribution (i.e., leverage)</span>
<span id="cb337-1939"><a href="#cb337-1939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1942"><a href="#cb337-1942" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1943"><a href="#cb337-1943" aria-hidden="true" tabindex="-1"></a><span class="fu">outlierTest</span>(multipleRegressionModel)</span>
<span id="cb337-1944"><a href="#cb337-1944" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1945"><a href="#cb337-1945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1946"><a href="#cb337-1946" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observations with high leverage</span></span>
<span id="cb337-1947"><a href="#cb337-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1948"><a href="#cb337-1948" aria-hidden="true" tabindex="-1"></a>Identifies observations with high leverage (i.e., high hat values)</span>
<span id="cb337-1949"><a href="#cb337-1949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1950"><a href="#cb337-1950" aria-hidden="true" tabindex="-1"></a>hat values are an index of leverage (observations that are far from the center of the regressor space and have greater influence on OLS regression coefficients)</span>
<span id="cb337-1951"><a href="#cb337-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1954"><a href="#cb337-1954" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1955"><a href="#cb337-1955" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">hatvalues</span>(multipleRegressionModel))</span>
<span id="cb337-1956"><a href="#cb337-1956" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hatvalues</span>(multipleRegressionModel))</span>
<span id="cb337-1957"><a href="#cb337-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1958"><a href="#cb337-1958" aria-hidden="true" tabindex="-1"></a><span class="fu">influenceIndexPlot</span>(</span>
<span id="cb337-1959"><a href="#cb337-1959" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1960"><a href="#cb337-1960" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1961"><a href="#cb337-1961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1962"><a href="#cb337-1962" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(</span>
<span id="cb337-1963"><a href="#cb337-1963" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1964"><a href="#cb337-1964" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>) <span class="co"># circle size is proportional to Cook's Distance</span></span>
<span id="cb337-1965"><a href="#cb337-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1966"><a href="#cb337-1966" aria-hidden="true" tabindex="-1"></a><span class="fu">leveragePlots</span>(</span>
<span id="cb337-1967"><a href="#cb337-1967" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1968"><a href="#cb337-1968" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1969"><a href="#cb337-1969" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1970"><a href="#cb337-1970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1971"><a href="#cb337-1971" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observations with high influence (on OLS regression coefficients)</span></span>
<span id="cb337-1972"><a href="#cb337-1972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1973"><a href="#cb337-1973" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://cran.r-project.org/web/packages/olsrr/vignettes/influence_measures.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/T2TS-PZZ4&gt;</span>)</span>
<span id="cb337-1974"><a href="#cb337-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1977"><a href="#cb337-1977" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1978"><a href="#cb337-1978" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">influence.measures</span>(multipleRegressionModel)<span class="sc">$</span>infmat)</span>
<span id="cb337-1979"><a href="#cb337-1979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1980"><a href="#cb337-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1981"><a href="#cb337-1981" aria-hidden="true" tabindex="-1"></a><span class="fu">### DFBETA {#sec-dfbeta}</span></span>
<span id="cb337-1982"><a href="#cb337-1982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1985"><a href="#cb337-1985" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1986"><a href="#cb337-1986" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">dfbeta</span>(multipleRegressionModel))</span>
<span id="cb337-1987"><a href="#cb337-1987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1988"><a href="#cb337-1988" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">dfbeta</span>(multipleRegressionModel))</span>
<span id="cb337-1989"><a href="#cb337-1989" aria-hidden="true" tabindex="-1"></a><span class="fu">dfbetasPlots</span>(</span>
<span id="cb337-1990"><a href="#cb337-1990" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1991"><a href="#cb337-1991" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1992"><a href="#cb337-1992" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1993"><a href="#cb337-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1994"><a href="#cb337-1994" aria-hidden="true" tabindex="-1"></a><span class="fu">### DFFITS {#sec-dffits}</span></span>
<span id="cb337-1995"><a href="#cb337-1995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1998"><a href="#cb337-1998" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1999"><a href="#cb337-1999" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">dffits</span>(multipleRegressionModel)[<span class="fu">order</span>(<span class="fu">dffits</span>(multipleRegressionModel), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])</span>
<span id="cb337-2000"><a href="#cb337-2000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2001"><a href="#cb337-2001" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">dffits</span>(multipleRegressionModel))</span>
<span id="cb337-2002"><a href="#cb337-2002" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dffits</span>(multipleRegressionModel))</span>
<span id="cb337-2003"><a href="#cb337-2003" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dffits</span>(multipleRegressionModel)[<span class="fu">order</span>(<span class="fu">dffits</span>(multipleRegressionModel), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])</span>
<span id="cb337-2004"><a href="#cb337-2004" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-2005"><a href="#cb337-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2006"><a href="#cb337-2006" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cook's Distance {#sec-cooksDistance}</span></span>
<span id="cb337-2007"><a href="#cb337-2007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2008"><a href="#cb337-2008" aria-hidden="true" tabindex="-1"></a>Observations that are both outlying (have a high residual from the regression line) and have high leverage (are far from the center of the regressor space) have high influence on the OLS regression coefficients.</span>
<span id="cb337-2009"><a href="#cb337-2009" aria-hidden="true" tabindex="-1"></a>An observation will have less influence if it lies on the regression line (not an outlier, i.e., has a low residual) or if it has low leverage (i.e., has a value near the center of a predictor's distribution).</span>
<span id="cb337-2010"><a href="#cb337-2010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2013"><a href="#cb337-2013" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-2014"><a href="#cb337-2014" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel)[<span class="fu">order</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])</span>
<span id="cb337-2015"><a href="#cb337-2015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2016"><a href="#cb337-2016" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel))</span>
<span id="cb337-2017"><a href="#cb337-2017" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel))</span>
<span id="cb337-2018"><a href="#cb337-2018" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel)[<span class="fu">order</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])</span>
<span id="cb337-2019"><a href="#cb337-2019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-2020"><a href="#cb337-2020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2021"><a href="#cb337-2021" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Refit model removing values with high cook's distance</span></span>
<span id="cb337-2022"><a href="#cb337-2022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2025"><a href="#cb337-2025" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-2026"><a href="#cb337-2026" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-2027"><a href="#cb337-2027" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2028"><a href="#cb337-2028" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2029"><a href="#cb337-2029" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-2030"><a href="#cb337-2030" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>))</span>
<span id="cb337-2031"><a href="#cb337-2031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2032"><a href="#cb337-2032" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-2033"><a href="#cb337-2033" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2034"><a href="#cb337-2034" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2035"><a href="#cb337-2035" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-2036"><a href="#cb337-2036" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>))</span>
<span id="cb337-2037"><a href="#cb337-2037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2038"><a href="#cb337-2038" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-2039"><a href="#cb337-2039" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2040"><a href="#cb337-2040" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2041"><a href="#cb337-2041" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-2042"><a href="#cb337-2042" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>,<span class="dv">8472</span>))</span>
<span id="cb337-2043"><a href="#cb337-2043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2044"><a href="#cb337-2044" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-2045"><a href="#cb337-2045" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2046"><a href="#cb337-2046" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2047"><a href="#cb337-2047" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-2048"><a href="#cb337-2048" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>,<span class="dv">8472</span>,<span class="dv">6170</span>))</span>
<span id="cb337-2049"><a href="#cb337-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2050"><a href="#cb337-2050" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-2051"><a href="#cb337-2051" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2052"><a href="#cb337-2052" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2053"><a href="#cb337-2053" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-2054"><a href="#cb337-2054" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>,<span class="dv">8472</span>,<span class="dv">6170</span>,<span class="dv">6023</span>))</span>
<span id="cb337-2055"><a href="#cb337-2055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2056"><a href="#cb337-2056" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-2057"><a href="#cb337-2057" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2058"><a href="#cb337-2058" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2059"><a href="#cb337-2059" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-2060"><a href="#cb337-2060" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>,<span class="dv">8472</span>,<span class="dv">6170</span>,<span class="dv">6023</span>,<span class="dv">2766</span>))</span>
<span id="cb337-2061"><a href="#cb337-2061" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-2062"><a href="#cb337-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2063"><a href="#cb337-2063" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Examine how much regression coefficients change when excluding influential observations</span></span>
<span id="cb337-2064"><a href="#cb337-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2067"><a href="#cb337-2067" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-2068"><a href="#cb337-2068" aria-hidden="true" tabindex="-1"></a><span class="fu">compareCoefs</span>(</span>
<span id="cb337-2069"><a href="#cb337-2069" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-2070"><a href="#cb337-2070" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_2,</span>
<span id="cb337-2071"><a href="#cb337-2071" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_3,</span>
<span id="cb337-2072"><a href="#cb337-2072" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_4,</span>
<span id="cb337-2073"><a href="#cb337-2073" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_5,</span>
<span id="cb337-2074"><a href="#cb337-2074" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_6,</span>
<span id="cb337-2075"><a href="#cb337-2075" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_7)</span>
<span id="cb337-2076"><a href="#cb337-2076" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-2077"><a href="#cb337-2077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2078"><a href="#cb337-2078" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examine how much regression coefficients change when using least trimmed squares (LTS) that is resistant to outliers</span></span>
<span id="cb337-2079"><a href="#cb337-2079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2082"><a href="#cb337-2082" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-2083"><a href="#cb337-2083" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(</span>
<span id="cb337-2084"><a href="#cb337-2084" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2085"><a href="#cb337-2085" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2086"><a href="#cb337-2086" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action=</span><span class="st">"na.exclude"</span>))</span>
<span id="cb337-2087"><a href="#cb337-2087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2088"><a href="#cb337-2088" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">ltsReg</span>(</span>
<span id="cb337-2089"><a href="#cb337-2089" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2090"><a href="#cb337-2090" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2091"><a href="#cb337-2091" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>))</span>
<span id="cb337-2092"><a href="#cb337-2092" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-2093"><a href="#cb337-2093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2094"><a href="#cb337-2094" aria-hidden="true" tabindex="-1"></a><span class="fu">### Resources</span></span>
<span id="cb337-2095"><a href="#cb337-2095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2096"><a href="#cb337-2096" aria-hidden="true" tabindex="-1"></a>Book: An <span class="in">`R`</span> Companion to Applied Regression</span>
<span id="cb337-2097"><a href="#cb337-2097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2098"><a href="#cb337-2098" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://people.duke.edu/~rnau/testing.htm&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/9CXH-GBSN&gt;</span>)</span>
<span id="cb337-2099"><a href="#cb337-2099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2100"><a href="#cb337-2100" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://www.statmethods.net/stats/rdiagnostics.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/7JX8-K6BY&gt;</span>)</span>
<span id="cb337-2101"><a href="#cb337-2101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2102"><a href="#cb337-2102" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://socserv.socsci.mcmaster.ca/jfox/Courses/Brazil-2009/index.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/4A2P-9S49&gt;</span>)</span>
<span id="cb337-2103"><a href="#cb337-2103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2104"><a href="#cb337-2104" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://en.wikipedia.org/wiki/Ordinary_least_squares#Assumptions&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/Q4NS-X8TJ&gt;</span>)</span>
<span id="cb337-2105"><a href="#cb337-2105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2106"><a href="#cb337-2106" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session Info</span></span>
<span id="cb337-2107"><a href="#cb337-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2110"><a href="#cb337-2110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-2111"><a href="#cb337-2111" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb337-2112"><a href="#cb337-2112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2113"><a href="#cb337-2113" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb337-2114"><a href="#cb337-2114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/DevPsyLab/DataAnalysis/edit/main/regression.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/blob/main/regression.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>