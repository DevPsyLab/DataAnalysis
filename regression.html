<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Isaac T. Petersen">
<meta name="dcterms.date" content="today">

<title>Regression – Data Analysis Guides for the Developmental Psychopathology Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d640c705e8c17715bca3574aa719063f.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9278de052701f0b3f1191ef96b26c196.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TYR0QMREEW', { 'anonymize_ip': true});
</script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="includes/custom.css">
<link rel="stylesheet" href="font/css/roboto.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/labLogo.png" alt="" class="navbar-logo light-content">
    <img src="./images/labLogo.png" alt="" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Data Analysis Guides for the Developmental Psychopathology Lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-datasets" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Datasets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-datasets">    
        <li>
    <a class="dropdown-item" href="./abcdData.html">
 <span class="dropdown-text">ABCD Study Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analysis-techniques" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analysis Techniques</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analysis-techniques">    
        <li>
    <a class="dropdown-item" href="./bayesian.html">
 <span class="dropdown-text">Bayesian Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dataManagement.html">
 <span class="dropdown-text">Data Management</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dags.html">
 <span class="dropdown-text">Directed Acyclic Graphs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eegERP.html">
 <span class="dropdown-text">Electroencephalography/Event-Related Potentials</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eda.html">
 <span class="dropdown-text">Exploratory Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./factorAnalysis.html">
 <span class="dropdown-text">Factor Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./figures.html">
 <span class="dropdown-text">Figures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./hlm.html">
 <span class="dropdown-text">Hierarchical Linear Modeling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./irt.html">
 <span class="dropdown-text">Item Response Theory</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lda.html">
 <span class="dropdown-text">Longitudinal Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sem.html#mediation">
 <span class="dropdown-text">Mediation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regression.html#moderation">
 <span class="dropdown-text">Moderation/Interaction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./multipleImputation.html">
 <span class="dropdown-text">Multiple Imputation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./pca.html">
 <span class="dropdown-text">Principal Component Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regression.html">
 <span class="dropdown-text">Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./statistics.html">
 <span class="dropdown-text">Statistics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sem.html">
 <span class="dropdown-text">Structural Equation Modeling</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-softwareframeworks" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Software/Frameworks</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-softwareframeworks">    
        <li>
    <a class="dropdown-item" href="./git.html">
 <span class="dropdown-text">Git, GitLab, and GitHub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./hpc.html">
 <span class="dropdown-text">High-Performance Computing Cluster</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jamovi.html">
 <span class="dropdown-text">jamovi</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jatos.html">
 <span class="dropdown-text">JATOS (Just Another Tool for Online Studies)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jsPsych.html">
 <span class="dropdown-text">jsPsych</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lamp.html">
 <span class="dropdown-text">LAMP (Linux, Apache, MySQL, PHP)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./markdown.html">
 <span class="dropdown-text">Markdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mplus.html">
 <span class="dropdown-text">Mplus</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./osf.html">
 <span class="dropdown-text">Open Science Framework</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://devpsylab.github.io/pythonDataAnalysisGuides">
 <span class="dropdown-text">Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./R.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SPSS.html">
 <span class="dropdown-text">SPSS</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://devpsylab.github.io/LabWiki"> 
<span class="menu-text">Lab Wiki</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://developmental-psychopathology.lab.uiowa.edu"> 
<span class="menu-text">Lab Website</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/DevPsyLab/DataAnalysis">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/DevPsyLab/DataAnalysis/issues/new">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
    <a href="https://twitter.com/devpsylab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://www.facebook.com/DevPsyLab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-facebook"></i></a>
    <a href="https://www.instagram.com/dev_psy_lab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-instagram"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./regression.html">Regression</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abcdData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ABCD Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataManagement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Management</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./developmentalScaling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Developmental Scaling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dags.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Directed Acyclic Graphs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eegERP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Electroencephalography/Event-Related Potentials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factorAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Factor Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./figures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Git, GitLab, and GitHub</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hlm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hierarchical Linear Modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">High-Performance Computing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./irt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Item Response Theory</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jamovi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">jamovi</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jatos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JATOS (Just Another Tool for Online Studies)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jsPsych.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">jsPsych</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lamp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LAMP (Linux, Apache, MySQL, PHP)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Longitudinal Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markdown</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html#mediation" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mediation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html#moderation" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Moderation/Interaction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mplus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multipleImputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Imputation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./osf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Open Science Framework</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principal Component Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://devpsylab.github.io/pythonDataAnalysisGuides" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SPSS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SPSS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structural Equation Modeling</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#preamble" id="toc-preamble" class="nav-link active" data-scroll-target="#preamble"><span class="header-section-number">1</span> Preamble</a>
  <ul>
  <li><a href="#install-libraries" id="toc-install-libraries" class="nav-link" data-scroll-target="#install-libraries"><span class="header-section-number">1.1</span> Install Libraries</a></li>
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries"><span class="header-section-number">1.2</span> Load Libraries</a></li>
  </ul></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">2</span> Import Data</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">3</span> Data Preparation</a></li>
  <li><a href="#overview-of-multiple-regression" id="toc-overview-of-multiple-regression" class="nav-link" data-scroll-target="#overview-of-multiple-regression"><span class="header-section-number">4</span> Overview of Multiple Regression</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression"><span class="header-section-number">5</span> Linear Regression</a>
  <ul>
  <li><a href="#linear-regression-model" id="toc-linear-regression-model" class="nav-link" data-scroll-target="#linear-regression-model"><span class="header-section-number">5.1</span> Linear regression model</a>
  <ul>
  <li><a href="#remove-missing-data" id="toc-remove-missing-data" class="nav-link" data-scroll-target="#remove-missing-data"><span class="header-section-number">5.1.1</span> Remove missing data</a></li>
  </ul></li>
  <li><a href="#linear-regression-model-on-correlationcovariance-matrix-for-pairwise-deletion" id="toc-linear-regression-model-on-correlationcovariance-matrix-for-pairwise-deletion" class="nav-link" data-scroll-target="#linear-regression-model-on-correlationcovariance-matrix-for-pairwise-deletion"><span class="header-section-number">5.2</span> Linear regression model on correlation/covariance matrix (for pairwise deletion)</a></li>
  <li><a href="#linear-regression-model-with-robust-covariance-matrix-rms" id="toc-linear-regression-model-with-robust-covariance-matrix-rms" class="nav-link" data-scroll-target="#linear-regression-model-with-robust-covariance-matrix-rms"><span class="header-section-number">5.3</span> Linear regression model with robust covariance matrix (rms)</a></li>
  <li><a href="#robust-linear-regression-mm-type-iteratively-reweighted-least-squares-regression" id="toc-robust-linear-regression-mm-type-iteratively-reweighted-least-squares-regression" class="nav-link" data-scroll-target="#robust-linear-regression-mm-type-iteratively-reweighted-least-squares-regression"><span class="header-section-number">5.4</span> Robust linear regression (MM-type iteratively reweighted least squares regression)</a></li>
  <li><a href="#least-trimmed-squares-regression-for-removing-outliers" id="toc-least-trimmed-squares-regression-for-removing-outliers" class="nav-link" data-scroll-target="#least-trimmed-squares-regression-for-removing-outliers"><span class="header-section-number">5.5</span> Least trimmed squares regression (for removing outliers)</a></li>
  <li><a href="#bayesian-linear-regression" id="toc-bayesian-linear-regression" class="nav-link" data-scroll-target="#bayesian-linear-regression"><span class="header-section-number">5.6</span> Bayesian linear regression</a></li>
  </ul></li>
  <li><a href="#generalized-linear-regression" id="toc-generalized-linear-regression" class="nav-link" data-scroll-target="#generalized-linear-regression"><span class="header-section-number">6</span> Generalized Linear Regression</a>
  <ul>
  <li><a href="#generalized-regression-model" id="toc-generalized-regression-model" class="nav-link" data-scroll-target="#generalized-regression-model"><span class="header-section-number">6.1</span> Generalized regression model</a></li>
  <li><a href="#generalized-regression-model-rms" id="toc-generalized-regression-model-rms" class="nav-link" data-scroll-target="#generalized-regression-model-rms"><span class="header-section-number">6.2</span> Generalized regression model (rms)</a></li>
  <li><a href="#bayesian-generalized-linear-model" id="toc-bayesian-generalized-linear-model" class="nav-link" data-scroll-target="#bayesian-generalized-linear-model"><span class="header-section-number">6.3</span> Bayesian generalized linear model</a></li>
  <li><a href="#robust-generalized-regression" id="toc-robust-generalized-regression" class="nav-link" data-scroll-target="#robust-generalized-regression"><span class="header-section-number">6.4</span> Robust generalized regression</a></li>
  <li><a href="#ordinal-regression-model" id="toc-ordinal-regression-model" class="nav-link" data-scroll-target="#ordinal-regression-model"><span class="header-section-number">6.5</span> Ordinal regression model</a></li>
  <li><a href="#bayesian-ordinal-regression-model" id="toc-bayesian-ordinal-regression-model" class="nav-link" data-scroll-target="#bayesian-ordinal-regression-model"><span class="header-section-number">6.6</span> Bayesian ordinal regression model</a></li>
  <li><a href="#bayesian-count-regression-model" id="toc-bayesian-count-regression-model" class="nav-link" data-scroll-target="#bayesian-count-regression-model"><span class="header-section-number">6.7</span> Bayesian count regression model</a></li>
  <li><a href="#logistic-regression-model-rms" id="toc-logistic-regression-model-rms" class="nav-link" data-scroll-target="#logistic-regression-model-rms"><span class="header-section-number">6.8</span> Logistic regression model (rms)</a></li>
  <li><a href="#bayesian-logistic-regression-model" id="toc-bayesian-logistic-regression-model" class="nav-link" data-scroll-target="#bayesian-logistic-regression-model"><span class="header-section-number">6.9</span> Bayesian logistic regression model</a></li>
  </ul></li>
  <li><a href="#hierarchical-linear-regression" id="toc-hierarchical-linear-regression" class="nav-link" data-scroll-target="#hierarchical-linear-regression"><span class="header-section-number">7</span> Hierarchical Linear Regression</a></li>
  <li><a href="#moderation" id="toc-moderation" class="nav-link" data-scroll-target="#moderation"><span class="header-section-number">8</span> Moderated Multiple Regression</a>
  <ul>
  <li><a href="#mean-center-predictors" id="toc-mean-center-predictors" class="nav-link" data-scroll-target="#mean-center-predictors"><span class="header-section-number">8.1</span> Mean Center Predictors</a></li>
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model"><span class="header-section-number">8.2</span> Model</a></li>
  <li><a href="#plots" id="toc-plots" class="nav-link" data-scroll-target="#plots"><span class="header-section-number">8.3</span> Plots</a></li>
  <li><a href="#simple-slopes-analysis" id="toc-simple-slopes-analysis" class="nav-link" data-scroll-target="#simple-slopes-analysis"><span class="header-section-number">8.4</span> Simple Slopes Analysis</a></li>
  <li><a href="#johnson-neyman-intervals" id="toc-johnson-neyman-intervals" class="nav-link" data-scroll-target="#johnson-neyman-intervals"><span class="header-section-number">8.5</span> Johnson-Neyman intervals</a></li>
  </ul></li>
  <li><a href="#compareCorrelations" id="toc-compareCorrelations" class="nav-link" data-scroll-target="#compareCorrelations"><span class="header-section-number">9</span> Comparing Correlations</a></li>
  <li><a href="#missingness" id="toc-missingness" class="nav-link" data-scroll-target="#missingness"><span class="header-section-number">10</span> Approaches to Handling Missingness</a>
  <ul>
  <li><a href="#listwiseDeletion" id="toc-listwiseDeletion" class="nav-link" data-scroll-target="#listwiseDeletion"><span class="header-section-number">10.1</span> Listwise deletion</a></li>
  <li><a href="#pairwiseDeletion" id="toc-pairwiseDeletion" class="nav-link" data-scroll-target="#pairwiseDeletion"><span class="header-section-number">10.2</span> Pairwise deletion</a></li>
  <li><a href="#fiml" id="toc-fiml" class="nav-link" data-scroll-target="#fiml"><span class="header-section-number">10.3</span> Full-information maximum likelihood (FIML)</a></li>
  <li><a href="#imputation" id="toc-imputation" class="nav-link" data-scroll-target="#imputation"><span class="header-section-number">10.4</span> Multiple imputation</a></li>
  </ul></li>
  <li><a href="#squaredSemiPartialCorrelation" id="toc-squaredSemiPartialCorrelation" class="nav-link" data-scroll-target="#squaredSemiPartialCorrelation"><span class="header-section-number">11</span> Squared Semi-Partial Correlation (<span class="math inline">\(sr^2\)</span>)</a></li>
  <li><a href="#partialRegressionPlot" id="toc-partialRegressionPlot" class="nav-link" data-scroll-target="#partialRegressionPlot"><span class="header-section-number">12</span> Partial Regression Plot</a></li>
  <li><a href="#dominanceAnalysis" id="toc-dominanceAnalysis" class="nav-link" data-scroll-target="#dominanceAnalysis"><span class="header-section-number">13</span> Dominance Analysis</a></li>
  <li><a href="#commonalityAnalysis" id="toc-commonalityAnalysis" class="nav-link" data-scroll-target="#commonalityAnalysis"><span class="header-section-number">14</span> Commonality Analysis</a></li>
  <li><a href="#model-building-steps" id="toc-model-building-steps" class="nav-link" data-scroll-target="#model-building-steps"><span class="header-section-number">15</span> Model Building Steps</a></li>
  <li><a href="#bootstrapped-estimates" id="toc-bootstrapped-estimates" class="nav-link" data-scroll-target="#bootstrapped-estimates"><span class="header-section-number">16</span> Bootstrapped Estimates</a>
  <ul>
  <li><a href="#linear-regression-1" id="toc-linear-regression-1" class="nav-link" data-scroll-target="#linear-regression-1"><span class="header-section-number">16.1</span> Linear Regression</a></li>
  <li><a href="#generalized-regression" id="toc-generalized-regression" class="nav-link" data-scroll-target="#generalized-regression"><span class="header-section-number">16.2</span> Generalized Regression</a></li>
  </ul></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation"><span class="header-section-number">17</span> Cross Validation</a>
  <ul>
  <li><a href="#k-fold-cross-validation" id="toc-k-fold-cross-validation" class="nav-link" data-scroll-target="#k-fold-cross-validation"><span class="header-section-number">17.1</span> K-fold cross validation</a></li>
  </ul></li>
  <li><a href="#examining-model-fits" id="toc-examining-model-fits" class="nav-link" data-scroll-target="#examining-model-fits"><span class="header-section-number">18</span> Examining Model Fits</a>
  <ul>
  <li><a href="#effect-plots" id="toc-effect-plots" class="nav-link" data-scroll-target="#effect-plots"><span class="header-section-number">18.1</span> Effect Plots</a></li>
  <li><a href="#confidence-ellipses" id="toc-confidence-ellipses" class="nav-link" data-scroll-target="#confidence-ellipses"><span class="header-section-number">18.2</span> Confidence Ellipses</a></li>
  <li><a href="#data-ellipse" id="toc-data-ellipse" class="nav-link" data-scroll-target="#data-ellipse"><span class="header-section-number">18.3</span> Data Ellipse</a></li>
  </ul></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics"><span class="header-section-number">19</span> Diagnostics</a>
  <ul>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions"><span class="header-section-number">19.1</span> Assumptions</a>
  <ul>
  <li><a href="#linearAssociation" id="toc-linearAssociation" class="nav-link" data-scroll-target="#linearAssociation"><span class="header-section-number">19.1.1</span> 1. Linear relation between predictors and outcome</a>
  <ul class="collapse">
  <li><a href="#ways-to-test" id="toc-ways-to-test" class="nav-link" data-scroll-target="#ways-to-test"><span class="header-section-number">19.1.1.1</span> Ways to Test</a>
  <ul class="collapse">
  <li><a href="#before-model-fitting" id="toc-before-model-fitting" class="nav-link" data-scroll-target="#before-model-fitting"><span class="header-section-number">19.1.1.1.1</span> Before Model Fitting</a></li>
  <li><a href="#after-model-fitting" id="toc-after-model-fitting" class="nav-link" data-scroll-target="#after-model-fitting"><span class="header-section-number">19.1.1.1.2</span> After Model Fitting</a></li>
  </ul></li>
  <li><a href="#ways-to-handle" id="toc-ways-to-handle" class="nav-link" data-scroll-target="#ways-to-handle"><span class="header-section-number">19.1.1.2</span> Ways to Handle</a>
  <ul class="collapse">
  <li><a href="#semi-parametric-or-non-parametric-regression-models" id="toc-semi-parametric-or-non-parametric-regression-models" class="nav-link" data-scroll-target="#semi-parametric-or-non-parametric-regression-models"><span class="header-section-number">19.1.1.2.1</span> Semi-parametric or non-parametric regression models</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exogeneity" id="toc-exogeneity" class="nav-link" data-scroll-target="#exogeneity"><span class="header-section-number">19.1.2</span> 2. Exogeneity</a>
  <ul class="collapse">
  <li><a href="#ways-to-test-1" id="toc-ways-to-test-1" class="nav-link" data-scroll-target="#ways-to-test-1"><span class="header-section-number">19.1.2.1</span> Ways to Test</a>
  <ul class="collapse">
  <li><a href="#durbin-wu-hausman-test-of-endogeneity" id="toc-durbin-wu-hausman-test-of-endogeneity" class="nav-link" data-scroll-target="#durbin-wu-hausman-test-of-endogeneity"><span class="header-section-number">19.1.2.1.1</span> Durbin-Wu-Hausman test of endogeneity</a></li>
  </ul></li>
  <li><a href="#ways-to-handle-1" id="toc-ways-to-handle-1" class="nav-link" data-scroll-target="#ways-to-handle-1"><span class="header-section-number">19.1.2.2</span> Ways to Handle</a></li>
  </ul></li>
  <li><a href="#homoscedasticity-of-residuals" id="toc-homoscedasticity-of-residuals" class="nav-link" data-scroll-target="#homoscedasticity-of-residuals"><span class="header-section-number">19.1.3</span> 3. Homoscedasticity of residuals</a>
  <ul class="collapse">
  <li><a href="#ways-to-test-2" id="toc-ways-to-test-2" class="nav-link" data-scroll-target="#ways-to-test-2"><span class="header-section-number">19.1.3.1</span> Ways to Test</a>
  <ul class="collapse">
  <li><a href="#residuals-vs.-outcome-and-predictor-variables" id="toc-residuals-vs.-outcome-and-predictor-variables" class="nav-link" data-scroll-target="#residuals-vs.-outcome-and-predictor-variables"><span class="header-section-number">19.1.3.1.1</span> Residuals vs.&nbsp;outcome and predictor variables</a></li>
  <li><a href="#spread-level-plot" id="toc-spread-level-plot" class="nav-link" data-scroll-target="#spread-level-plot"><span class="header-section-number">19.1.3.1.2</span> Spread-level plot</a></li>
  <li><a href="#breusch-pagan-test" id="toc-breusch-pagan-test" class="nav-link" data-scroll-target="#breusch-pagan-test"><span class="header-section-number">19.1.3.1.3</span> Breusch-Pagan test</a></li>
  <li><a href="#goldfeld-quandt-test" id="toc-goldfeld-quandt-test" class="nav-link" data-scroll-target="#goldfeld-quandt-test"><span class="header-section-number">19.1.3.1.4</span> Goldfeld-Quandt Test</a></li>
  <li><a href="#test-of-dependence-of-spread-on-level" id="toc-test-of-dependence-of-spread-on-level" class="nav-link" data-scroll-target="#test-of-dependence-of-spread-on-level"><span class="header-section-number">19.1.3.1.5</span> Test of dependence of spread on level</a></li>
  <li><a href="#test-of-dependence-of-spread-on-predictors" id="toc-test-of-dependence-of-spread-on-predictors" class="nav-link" data-scroll-target="#test-of-dependence-of-spread-on-predictors"><span class="header-section-number">19.1.3.1.6</span> Test of dependence of spread on predictors</a></li>
  </ul></li>
  <li><a href="#ways-to-handle-2" id="toc-ways-to-handle-2" class="nav-link" data-scroll-target="#ways-to-handle-2"><span class="header-section-number">19.1.3.2</span> Ways to Handle</a>
  <ul class="collapse">
  <li><a href="#huber-white-standard-errors" id="toc-huber-white-standard-errors" class="nav-link" data-scroll-target="#huber-white-standard-errors"><span class="header-section-number">19.1.3.2.1</span> Huber-White standard errors</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#errors-are-independent" id="toc-errors-are-independent" class="nav-link" data-scroll-target="#errors-are-independent"><span class="header-section-number">19.1.4</span> 4. Errors are independent</a>
  <ul class="collapse">
  <li><a href="#ways-to-test-3" id="toc-ways-to-test-3" class="nav-link" data-scroll-target="#ways-to-test-3"><span class="header-section-number">19.1.4.1</span> Ways to Test</a></li>
  <li><a href="#ways-to-handle-3" id="toc-ways-to-handle-3" class="nav-link" data-scroll-target="#ways-to-handle-3"><span class="header-section-number">19.1.4.2</span> Ways to Handle</a></li>
  </ul></li>
  <li><a href="#no-multicollinearity" id="toc-no-multicollinearity" class="nav-link" data-scroll-target="#no-multicollinearity"><span class="header-section-number">19.1.5</span> 5. No multicollinearity</a>
  <ul class="collapse">
  <li><a href="#ways-to-test-4" id="toc-ways-to-test-4" class="nav-link" data-scroll-target="#ways-to-test-4"><span class="header-section-number">19.1.5.1</span> Ways to Test</a>
  <ul class="collapse">
  <li><a href="#variance-inflation-factor-vif" id="toc-variance-inflation-factor-vif" class="nav-link" data-scroll-target="#variance-inflation-factor-vif"><span class="header-section-number">19.1.5.1.1</span> Variance Inflation Factor (VIF)</a></li>
  <li><a href="#generalized-variance-inflation-factor-gvif" id="toc-generalized-variance-inflation-factor-gvif" class="nav-link" data-scroll-target="#generalized-variance-inflation-factor-gvif"><span class="header-section-number">19.1.5.1.2</span> Generalized Variance Inflation Factor (GVIF)</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="header-section-number">19.1.5.1.3</span> Correlation</a></li>
  <li><a href="#tolerance" id="toc-tolerance" class="nav-link" data-scroll-target="#tolerance"><span class="header-section-number">19.1.5.1.4</span> Tolerance</a></li>
  <li><a href="#condition-index" id="toc-condition-index" class="nav-link" data-scroll-target="#condition-index"><span class="header-section-number">19.1.5.1.5</span> Condition Index</a></li>
  </ul></li>
  <li><a href="#ways-to-handle-4" id="toc-ways-to-handle-4" class="nav-link" data-scroll-target="#ways-to-handle-4"><span class="header-section-number">19.1.5.2</span> Ways to Handle</a></li>
  </ul></li>
  <li><a href="#errors-are-normally-distributed" id="toc-errors-are-normally-distributed" class="nav-link" data-scroll-target="#errors-are-normally-distributed"><span class="header-section-number">19.1.6</span> 6. Errors are normally distributed</a>
  <ul class="collapse">
  <li><a href="#ways-to-test-5" id="toc-ways-to-test-5" class="nav-link" data-scroll-target="#ways-to-test-5"><span class="header-section-number">19.1.6.1</span> Ways to Test</a></li>
  <li><a href="#ways-to-handle-5" id="toc-ways-to-handle-5" class="nav-link" data-scroll-target="#ways-to-handle-5"><span class="header-section-number">19.1.6.2</span> Ways to Handle</a>
  <ul class="collapse">
  <li><a href="#transformations-of-outcome-variable" id="toc-transformations-of-outcome-variable" class="nav-link" data-scroll-target="#transformations-of-outcome-variable"><span class="header-section-number">19.1.6.2.1</span> Transformations of Outcome Variable</a></li>
  <li><a href="#transformations-of-predictor-variable" id="toc-transformations-of-predictor-variable" class="nav-link" data-scroll-target="#transformations-of-predictor-variable"><span class="header-section-number">19.1.6.2.2</span> Transformations of Predictor Variable</a></li>
  <li><a href="#robust-models" id="toc-robust-models" class="nav-link" data-scroll-target="#robust-models"><span class="header-section-number">19.1.6.2.3</span> Robust models</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#examining-model-assumptions" id="toc-examining-model-assumptions" class="nav-link" data-scroll-target="#examining-model-assumptions"><span class="header-section-number">19.2</span> Examining Model Assumptions</a>
  <ul>
  <li><a href="#distribution-of-residuals" id="toc-distribution-of-residuals" class="nav-link" data-scroll-target="#distribution-of-residuals"><span class="header-section-number">19.2.1</span> Distribution of Residuals</a>
  <ul class="collapse">
  <li><a href="#qqPlot" id="toc-qqPlot" class="nav-link" data-scroll-target="#qqPlot"><span class="header-section-number">19.2.1.1</span> QQ plots</a></li>
  <li><a href="#ppPlot" id="toc-ppPlot" class="nav-link" data-scroll-target="#ppPlot"><span class="header-section-number">19.2.1.2</span> PP plots</a></li>
  <li><a href="#densityPlotResiduals" id="toc-densityPlotResiduals" class="nav-link" data-scroll-target="#densityPlotResiduals"><span class="header-section-number">19.2.1.3</span> Density Plot of Residuals</a></li>
  </ul></li>
  <li><a href="#residualPlots" id="toc-residualPlots" class="nav-link" data-scroll-target="#residualPlots"><span class="header-section-number">19.2.2</span> Residual Plots</a></li>
  <li><a href="#marginalModelPlots" id="toc-marginalModelPlots" class="nav-link" data-scroll-target="#marginalModelPlots"><span class="header-section-number">19.2.3</span> Marginal Model Plots</a></li>
  <li><a href="#addedVariablePlots" id="toc-addedVariablePlots" class="nav-link" data-scroll-target="#addedVariablePlots"><span class="header-section-number">19.2.4</span> Added-Variable Plots</a>
  <ul class="collapse">
  <li><a href="#refit-model-removing-jointly-influential-observations" id="toc-refit-model-removing-jointly-influential-observations" class="nav-link" data-scroll-target="#refit-model-removing-jointly-influential-observations"><span class="header-section-number">19.2.4.1</span> Refit model removing jointly influential observations</a></li>
  </ul></li>
  <li><a href="#outlier-test" id="toc-outlier-test" class="nav-link" data-scroll-target="#outlier-test"><span class="header-section-number">19.2.5</span> Outlier test</a></li>
  <li><a href="#observations-with-high-leverage" id="toc-observations-with-high-leverage" class="nav-link" data-scroll-target="#observations-with-high-leverage"><span class="header-section-number">19.2.6</span> Observations with high leverage</a></li>
  <li><a href="#observations-with-high-influence-on-ols-regression-coefficients" id="toc-observations-with-high-influence-on-ols-regression-coefficients" class="nav-link" data-scroll-target="#observations-with-high-influence-on-ols-regression-coefficients"><span class="header-section-number">19.2.7</span> Observations with high influence (on OLS regression coefficients)</a></li>
  <li><a href="#dfbeta" id="toc-dfbeta" class="nav-link" data-scroll-target="#dfbeta"><span class="header-section-number">19.2.8</span> DFBETA</a></li>
  <li><a href="#dffits" id="toc-dffits" class="nav-link" data-scroll-target="#dffits"><span class="header-section-number">19.2.9</span> DFFITS</a></li>
  <li><a href="#cooksDistance" id="toc-cooksDistance" class="nav-link" data-scroll-target="#cooksDistance"><span class="header-section-number">19.2.10</span> Cook’s Distance</a>
  <ul class="collapse">
  <li><a href="#refit-model-removing-values-with-high-cooks-distance" id="toc-refit-model-removing-values-with-high-cooks-distance" class="nav-link" data-scroll-target="#refit-model-removing-values-with-high-cooks-distance"><span class="header-section-number">19.2.10.1</span> Refit model removing values with high cook’s distance</a>
  <ul class="collapse">
  <li><a href="#examine-how-much-regression-coefficients-change-when-excluding-influential-observations" id="toc-examine-how-much-regression-coefficients-change-when-excluding-influential-observations" class="nav-link" data-scroll-target="#examine-how-much-regression-coefficients-change-when-excluding-influential-observations"><span class="header-section-number">19.2.10.1.1</span> Examine how much regression coefficients change when excluding influential observations</a></li>
  </ul></li>
  <li><a href="#examine-how-much-regression-coefficients-change-when-using-least-trimmed-squares-lts-that-is-resistant-to-outliers" id="toc-examine-how-much-regression-coefficients-change-when-using-least-trimmed-squares-lts-that-is-resistant-to-outliers" class="nav-link" data-scroll-target="#examine-how-much-regression-coefficients-change-when-using-least-trimmed-squares-lts-that-is-resistant-to-outliers"><span class="header-section-number">19.2.10.2</span> Examine how much regression coefficients change when using least trimmed squares (LTS) that is resistant to outliers</a></li>
  </ul></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources"><span class="header-section-number">19.2.11</span> Resources</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">20</span> Session Info</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/DevPsyLab/DataAnalysis/edit/main/regression.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/blob/main/regression.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Regression</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="preamble" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Preamble</h1>
<section id="install-libraries" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="install-libraries"><span class="header-section-number">1.1</span> Install Libraries</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("remotes")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("DevPsyLab/petersenlab")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="load-libraries" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="load-libraries"><span class="header-section-number">1.2</span> Load Libraries</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"petersenlab"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"MASS"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"psych"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rms"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"robustbase"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"brms"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"cvTools"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"car"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mgcv"</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"AER"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"foreign"</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"olsrr"</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"quantreg"</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mblm"</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"effects"</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"correlation"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"interactions"</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"lavaan"</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"regtools"</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mice"</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"XICOR"</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"cocor"</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"effectsize"</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rockchalk"</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"yhat"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="import-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Import Data</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://osf.io/8syp5/download"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="data-preparation" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data Preparation</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>countVariable <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(mydata<span class="sc">$</span>bpi_antisocialT2Sum)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>orderedVariable <span class="ot">&lt;-</span> <span class="fu">factor</span>(mydata<span class="sc">$</span>countVariable, <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>female <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>female[<span class="fu">which</span>(mydata<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"male"</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>female[<span class="fu">which</span>(mydata<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"female"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="overview-of-multiple-regression" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Overview of Multiple Regression</h1>
<p><a href="https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/multiple-regression.html" class="uri">https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/multiple-regression.html</a></p>
</section>
<section id="linear-regression" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Linear Regression</h1>
<section id="linear-regression-model" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="linear-regression-model"><span class="header-section-number">5.1</span> Linear regression model</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.3755 -1.2337 -0.2212  0.9911 12.8017 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              1.19830    0.05983  20.029  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.979 on 2871 degrees of freedom
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.262, Adjusted R-squared:  0.2615 
F-statistic: 509.6 on 2 and 2871 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                            2.5 %    97.5 %
(Intercept)             1.0809881 1.3156128
bpi_antisocialT1Sum     0.4290884 0.5019688
bpi_anxiousDepressedSum 0.1035825 0.2179258</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(multipleRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |        95% CI
----------------------------------------------------
(Intercept)             |   1.62e-16 | [-0.03, 0.03]
bpi antisocialT1Sum     |       0.46 | [ 0.42, 0.49]
bpi anxiousDepressedSum |       0.10 | [ 0.06, 0.14]</code></pre>
</div>
</div>
<section id="remove-missing-data" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="remove-missing-data"><span class="header-section-number">5.1.1</span> Remove missing data</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelNoMissing <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelNoMissing <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata <span class="sc">%&gt;%</span> <span class="fu">select</span>(bpi_antisocialT2Sum, bpi_antisocialT1Sum, bpi_anxiousDepressedSum) <span class="sc">%&gt;%</span> na.omit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="linear-regression-model-on-correlationcovariance-matrix-for-pairwise-deletion" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="linear-regression-model-on-correlationcovariance-matrix-for-pairwise-deletion"><span class="header-section-number">5.2</span> Linear regression model on correlation/covariance matrix (for pairwise deletion)</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelPairwise <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">setCor</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">cov</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT2Sum"</span>,<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span>)], <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.obs =</span> <span class="fu">nrow</span>(mydata))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModelPairwise)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multiple Regression from matrix input 
psych::setCor(y = "bpi_antisocialT2Sum", x = c("bpi_antisocialT1Sum", 
    "bpi_anxiousDepressedSum"), data = cov(mydata[, c("bpi_antisocialT2Sum", 
    "bpi_antisocialT1Sum", "bpi_anxiousDepressedSum")], use = "pairwise.complete.obs"), 
    n.obs = nrow(mydata))

Multiple Regression from matrix input 

Beta weights 
                        bpi_antisocialT2Sum
bpi_antisocialT1Sum                    0.46
bpi_anxiousDepressedSum                0.09

Multiple R 
bpi_antisocialT2Sum 
               0.51 

Multiple R2 
bpi_antisocialT2Sum 
               0.26 

Cohen's set correlation R2 
[1] 0.26

Squared Canonical Correlations
NULL</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelPairwise[<span class="fu">c</span>(<span class="st">"coefficients"</span>,<span class="st">"se"</span>,<span class="st">"Probability"</span>,<span class="st">"R2"</span>,<span class="st">"shrunkenR2"</span>)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$coefficients
                        bpi_antisocialT2Sum
bpi_antisocialT1Sum               0.4560961
bpi_anxiousDepressedSum           0.0899642

$se
                        bpi_antisocialT2Sum
bpi_antisocialT1Sum             0.009253718
bpi_anxiousDepressedSum         0.009253718

$Probability
                        bpi_antisocialT2Sum
bpi_antisocialT1Sum            0.000000e+00
bpi_anxiousDepressedSum        2.959352e-22

$R2
bpi_antisocialT2Sum 
           0.256918 

$shrunkenR2
bpi_antisocialT2Sum 
           0.256789 </code></pre>
</div>
</div>
</section>
<section id="linear-regression-model-with-robust-covariance-matrix-rms" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="linear-regression-model-with-robust-covariance-matrix-rms"><span class="header-section-number">5.3</span> Linear regression model with robust covariance matrix (rms)</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>rmsMultipleRegressionModel <span class="ot">&lt;-</span> <span class="fu">robcov</span>(<span class="fu">ols</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>rmsMultipleRegressionModel</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
    bpi_antisocialT2Sum     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
                   7501                    7613                    7616 

Linear Regression Model

ols(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, x = TRUE, y = TRUE)

                Model Likelihood    Discrimination    
                      Ratio Test           Indexes    
Obs    2874    LR chi2    873.09    R2       0.262    
sigma1.9786    d.f.            2    R2 adj   0.261    
d.f.   2871    Pr(&gt; chi2) 0.0000    g        1.278    

Residuals

    Min      1Q  Median      3Q     Max 
-8.3755 -1.2337 -0.2212  0.9911 12.8017 

                        Coef   S.E.   t     Pr(&gt;|t|)
Intercept               1.1983 0.0622 19.26 &lt;0.0001 
bpi_antisocialT1Sum     0.4655 0.0229 20.30 &lt;0.0001 
bpi_anxiousDepressedSum 0.1608 0.0330  4.87 &lt;0.0001 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(rmsMultipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             2.5 %    97.5 %
Intercept               1.07631713 1.3202837
bpi_antisocialT1Sum     0.42056957 0.5104877
bpi_anxiousDepressedSum 0.09606644 0.2254418</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(rmsMultipleRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |        95% CI
----------------------------------------------------
Intercept               |   1.62e-16 | [-0.03, 0.03]
bpi antisocialT1Sum     |       0.46 | [ 0.42, 0.49]
bpi anxiousDepressedSum |       0.10 | [ 0.06, 0.14]</code></pre>
</div>
</div>
</section>
<section id="robust-linear-regression-mm-type-iteratively-reweighted-least-squares-regression" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="robust-linear-regression-mm-type-iteratively-reweighted-least-squares-regression"><span class="header-section-number">5.4</span> Robust linear regression (MM-type iteratively reweighted least squares regression)</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>robustLinearRegression <span class="ot">&lt;-</span> <span class="fu">lmrob</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(robustLinearRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lmrob(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, na.action = na.exclude)
 \--&gt; method = "MM"
Residuals:
     Min       1Q   Median       3Q      Max 
-8.43518 -1.06680 -0.06707  1.14090 13.05599 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              0.94401    0.05406  17.464  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.49135    0.02237  21.966  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.15766    0.03102   5.083 3.96e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Robust residual standard error: 1.628 
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.326, Adjusted R-squared:  0.3255 
Convergence in 14 IRWLS iterations

Robustness weights: 
 12 observations c(52,347,354,517,709,766,768,979,1618,2402,2403,2404)
     are outliers with |weight| = 0 ( &lt; 3.5e-05); 
 283 weights are ~= 1. The remaining 2579 ones are summarized as
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
0.0001311 0.8599000 0.9470000 0.8814000 0.9816000 0.9990000 
Algorithmic parameters: 
       tuning.chi                bb        tuning.psi        refine.tol 
        1.548e+00         5.000e-01         4.685e+00         1.000e-07 
          rel.tol         scale.tol         solve.tol          zero.tol 
        1.000e-07         1.000e-10         1.000e-07         1.000e-10 
      eps.outlier             eps.x warn.limit.reject warn.limit.meanrw 
        3.479e-05         2.365e-11         5.000e-01         5.000e-01 
     nResample         max.it         groups        n.group       best.r.s 
           500             50              5            400              2 
      k.fast.s          k.max    maxit.scale      trace.lev            mts 
             1            200            200              0           1000 
    compute.rd fast.s.large.n 
             0           2000 
                  psi           subsampling                   cov 
           "bisquare"         "nonsingular"         ".vcov.avar1" 
compute.outlier.stats 
                 "SM" 
seed : int(0) </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(robustLinearRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             2.5 %    97.5 %
(Intercept)             0.83801565 1.0499981
bpi_antisocialT1Sum     0.44749135 0.5352118
bpi_anxiousDepressedSum 0.09683728 0.2184779</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(robustLinearRegression), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |         95% CI
-----------------------------------------------------
(Intercept)             |      -0.08 | [-0.11, -0.05]
bpi antisocialT1Sum     |       0.48 | [ 0.44,  0.52]
bpi anxiousDepressedSum |       0.10 | [ 0.06,  0.14]</code></pre>
</div>
</div>
</section>
<section id="least-trimmed-squares-regression-for-removing-outliers" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="least-trimmed-squares-regression-for-removing-outliers"><span class="header-section-number">5.5</span> Least trimmed squares regression (for removing outliers)</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ltsRegression <span class="ot">&lt;-</span> robustbase<span class="sc">::</span><span class="fu">ltsReg</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ltsRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
ltsReg.formula(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
    bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)

Residuals (from reweighted LS):
    Min      1Q  Median      3Q     Max 
-3.9305 -0.9091  0.0000  0.9997  3.9036 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
Intercept                0.74932    0.04795  15.626  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.54338    0.01524  35.647  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.13826    0.02343   5.901 4.06e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.534 on 2710 degrees of freedom
Multiple R-Squared: 0.4121, Adjusted R-squared: 0.4116 
F-statistic: 949.7 on 2 and 2710 DF,  p-value: &lt; 2.2e-16 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(robustLinearRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             2.5 %    97.5 %
(Intercept)             0.83801565 1.0499981
bpi_antisocialT1Sum     0.44749135 0.5352118
bpi_anxiousDepressedSum 0.09683728 0.2184779</code></pre>
</div>
</div>
</section>
<section id="bayesian-linear-regression" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="bayesian-linear-regression"><span class="header-section-number">5.6</span> Bayesian linear regression</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>bayesianRegularizedRegression <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianRegularizedRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity 
Formula: bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum 
   Data: mydata (Number of observations: 2874) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                   1.20      0.06     1.08     1.32 1.00     4472
bpi_antisocialT1Sum         0.47      0.02     0.43     0.50 1.00     3350
bpi_anxiousDepressedSum     0.16      0.03     0.10     0.22 1.00     3184
                        Tail_ESS
Intercept                   3070
bpi_antisocialT1Sum         3292
bpi_anxiousDepressedSum     2958

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     1.98      0.03     1.93     2.03 1.00     4104     3454

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianRegularizedRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: basic

Component   |               Parameter | Std. Median |       95% CI
------------------------------------------------------------------
conditional |             (Intercept) |        0.00 | [0.00, 0.00]
conditional |     bpi_antisocialT1Sum |        0.46 | [0.42, 0.49]
conditional | bpi_anxiousDepressedSum |        0.10 | [0.07, 0.14]
sigma       |                   sigma |        1.98 | [1.93, 2.03]</code></pre>
</div>
</div>
</section>
</section>
<section id="generalized-linear-regression" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Generalized Linear Regression</h1>
<section id="generalized-regression-model" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="generalized-regression-model"><span class="header-section-number">6.1</span> Generalized regression model</h2>
<p>In this example, we predict a count variable that has a poisson distribution. We could change the distribution.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>generalizedRegressionModel <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(generalizedRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    family = "poisson", data = mydata, na.action = na.exclude)

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             0.459999   0.019650  23.410  &lt; 2e-16 ***
bpi_antisocialT1Sum     0.141577   0.004891  28.948  &lt; 2e-16 ***
bpi_anxiousDepressedSum 0.047567   0.008036   5.919 3.23e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 5849.4  on 2873  degrees of freedom
Residual deviance: 4562.6  on 2871  degrees of freedom
  (8656 observations deleted due to missingness)
AIC: 11482

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(generalizedRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             2.5 %     97.5 %
(Intercept)             0.42136094 0.49838751
bpi_antisocialT1Sum     0.13196544 0.15113708
bpi_anxiousDepressedSum 0.03177425 0.06327445</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(generalizedRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |       95% CI
---------------------------------------------------
(Intercept)             |       0.91 | [0.89, 0.94]
bpi antisocialT1Sum     |       0.32 | [0.30, 0.34]
bpi anxiousDepressedSum |       0.07 | [0.05, 0.09]

- Response is unstandardized.</code></pre>
</div>
</div>
</section>
<section id="generalized-regression-model-rms" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="generalized-regression-model-rms"><span class="header-section-number">6.2</span> Generalized regression model (rms)</h2>
<p>In this example, we predict a count variable that has a poisson distribution. We could change the distribution.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>rmsGeneralizedRegressionModel <span class="ot">&lt;-</span> rms<span class="sc">::</span><span class="fu">Glm</span>(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>rmsGeneralizedRegressionModel</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
          countVariable     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
                   7501                    7613                    7616 

General Linear Model

rms::Glm(formula = countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    family = "poisson", data = mydata, x = TRUE, y = TRUE)

                       Model Likelihood    
                             Ratio Test    
          Obs2874    LR chi2    1286.72    
Residual d.f.2871    d.f.             2    
          g 0.387    Pr(&gt; chi2) &lt;0.0001    

                        Coef   S.E.   Wald Z Pr(&gt;|Z|)
Intercept               0.4600 0.0196 23.41  &lt;0.0001 
bpi_antisocialT1Sum     0.1416 0.0049 28.95  &lt;0.0001 
bpi_anxiousDepressedSum 0.0476 0.0080  5.92  &lt;0.0001 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(rmsGeneralizedRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summary.rms()`:
! adjustment values not defined here or with datadist for bpi_antisocialT1Sum bpi_anxiousDepressedSum</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(rmsGeneralizedRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |       95% CI
---------------------------------------------------
Intercept               |       0.91 | [0.89, 0.94]
bpi antisocialT1Sum     |       0.32 | [0.30, 0.34]
bpi anxiousDepressedSum |       0.07 | [0.05, 0.09]

- Response is unstandardized.</code></pre>
</div>
</div>
</section>
<section id="bayesian-generalized-linear-model" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="bayesian-generalized-linear-model"><span class="header-section-number">6.3</span> Bayesian generalized linear model</h2>
<p>In this example, we predict a count variable that has a poisson distribution. We could change the distribution. For example, we could use Gamma regression, <code>family = Gamma</code>, when the response variable is continuous and positive, and the coefficient of variation–rather than the variance–is constant.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>bayesianGeneralizedLinearRegression <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> poisson,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianGeneralizedLinearRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: poisson 
  Links: mu = log 
Formula: countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum 
   Data: mydata (Number of observations: 2874) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                   0.46      0.02     0.42     0.50 1.00     3095
bpi_antisocialT1Sum         0.14      0.00     0.13     0.15 1.00     2776
bpi_anxiousDepressedSum     0.05      0.01     0.03     0.06 1.00     2620
                        Tail_ESS
Intercept                   2987
bpi_antisocialT1Sum         2762
bpi_anxiousDepressedSum     2689

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianGeneralizedLinearRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: basic

Parameter               | Std. Median |       95% CI
----------------------------------------------------
(Intercept)             |        0.00 | [0.00, 0.00]
bpi_antisocialT1Sum     |        0.32 | [0.30, 0.34]
bpi_anxiousDepressedSum |        0.07 | [0.05, 0.09]

- Response is unstandardized.</code></pre>
</div>
</div>
</section>
<section id="robust-generalized-regression" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="robust-generalized-regression"><span class="header-section-number">6.4</span> Robust generalized regression</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>robustGeneralizedRegression <span class="ot">&lt;-</span> robustbase<span class="sc">::</span><span class="fu">glmrob</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(robustGeneralizedRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  robustbase::glmrob(formula = countVariable ~ bpi_antisocialT1Sum +      bpi_anxiousDepressedSum, family = "poisson", data = mydata,      na.action = na.exclude) 


Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             0.365934   0.020794  17.598  &lt; 2e-16 ***
bpi_antisocialT1Sum     0.156275   0.005046  30.969  &lt; 2e-16 ***
bpi_anxiousDepressedSum 0.050526   0.008332   6.064 1.32e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
Robustness weights w.r * w.x: 
 2273 weights are ~= 1. The remaining 601 ones are summarized as
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1286  0.5550  0.7574  0.7183  0.8874  0.9982 

Number of observations: 2874 
Fitted by method 'Mqle'  (in 5 iterations)

(Dispersion parameter for poisson family taken to be 1)

No deviance values available 
Algorithmic parameters: 
   acc    tcc 
0.0001 1.3450 
maxit 
   50 
test.acc 
  "coef" </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(robustGeneralizedRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `glm.control()`:
! unused arguments (acc = 1e-04, test.acc = "coef", tcc = 1.345)</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(robustGeneralizedRegression), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |       95% CI
---------------------------------------------------
(Intercept)             |       0.87 | [0.84, 0.89]
bpi antisocialT1Sum     |       0.35 | [0.33, 0.38]
bpi anxiousDepressedSum |       0.07 | [0.05, 0.10]

- Response is unstandardized.</code></pre>
</div>
</div>
</section>
<section id="ordinal-regression-model" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="ordinal-regression-model"><span class="header-section-number">6.5</span> Ordinal regression model</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel1 <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">polr</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  orderedVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel2 <span class="ot">&lt;-</span> rms<span class="sc">::</span><span class="fu">lrm</span>(</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  orderedVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel3 <span class="ot">&lt;-</span> rms<span class="sc">::</span><span class="fu">orm</span>(</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  orderedVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ordinalRegressionModel1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
MASS::polr(formula = orderedVariable ~ bpi_antisocialT1Sum + 
    bpi_anxiousDepressedSum, data = mydata)

Coefficients:
                         Value Std. Error t value
bpi_antisocialT1Sum     0.4404    0.01862  23.647
bpi_anxiousDepressedSum 0.1427    0.02615   5.457

Intercepts:
      Value   Std. Error t value
0|1   -0.6001  0.0630    -9.5185
1|2    0.6766  0.0585    11.5656
2|3    1.5801  0.0634    24.9191
3|4    2.4110  0.0720    33.4816
4|5    3.1617  0.0825    38.3006
5|6    3.8560  0.0949    40.6120
6|7    4.5367  0.1106    41.0316
7|8    5.1667  0.1291    40.0147
8|9    5.8129  0.1545    37.6263
9|10   6.5364  0.1962    33.3193
10|11  7.1835  0.2513    28.5820
11|12  7.8469  0.3331    23.5566
12|14  8.7818  0.5113    17.1741

Residual Deviance: 11088.49 
AIC: 11118.49 
(8656 observations deleted due to missingness)</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(ordinalRegressionModel1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             2.5 %    97.5 %
bpi_antisocialT1Sum     0.40403039 0.4770422
bpi_anxiousDepressedSum 0.09149919 0.1940080</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
        orderedVariable     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
                   7501                    7613                    7616 

Logistic Regression Model

rms::lrm(formula = orderedVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, x = TRUE, y = TRUE)


Frequencies of Responses

  0   1   2   3   4   5   6   7   8   9  10  11  12  14 
455 597 527 444 313 205 133  80  52  33  16   9   6   4 

                       Model Likelihood       Discrimination    Rank Discrim.    
                             Ratio Test              Indexes          Indexes    
Obs          2874    LR chi2     881.26       R2       0.268    C       0.705    
max |deriv| 6e-06    d.f.             2      R2(2,2874)0.264    Dxy     0.410    
                     Pr(&gt; chi2) &lt;0.0001    R2(2,2803.4)0.269    gamma   0.426    
                                              Brier    0.195    tau-a   0.350    

                        Coef   S.E.   Wald Z Pr(&gt;|Z|)
bpi_antisocialT1Sum     0.4404 0.0186 23.65  &lt;0.0001 
bpi_anxiousDepressedSum 0.1427 0.0261  5.46  &lt;0.0001 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(ordinalRegressionModel2), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |         95% CI
-----------------------------------------------------
y&gt;=1                    |       2.01 | [ 1.90,  2.12]
y&gt;=2                    |       0.73 | [ 0.65,  0.81]
y&gt;=3                    |      -0.17 | [-0.25, -0.09]
y&gt;=4                    |      -1.00 | [-1.09, -0.91]
y&gt;=5                    |      -1.75 | [-1.86, -1.65]
y&gt;=6                    |      -2.45 | [-2.58, -2.32]
y&gt;=7                    |      -3.13 | [-3.29, -2.97]
y&gt;=8                    |      -3.76 | [-3.96, -3.56]
y&gt;=9                    |      -4.40 | [-4.66, -4.14]
y&gt;=10                   |      -5.13 | [-5.48, -4.78]
y&gt;=11                   |      -5.78 | [-6.24, -5.31]
y&gt;=12                   |      -6.44 | [-7.07, -5.81]
y&gt;=14                   |      -7.37 | [-8.36, -6.39]
bpi antisocialT1Sum     |       0.99 | [ 0.91,  1.08]
bpi anxiousDepressedSum |       0.21 | [ 0.13,  0.28]

- Response is unstandardized.</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel3</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
        orderedVariable     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
                   7501                    7613                    7616 

Logistic (Proportional Odds) Ordinal Regression Model

rms::orm(formula = orderedVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, x = TRUE, y = TRUE)


Frequencies of Responses

  0   1   2   3   4   5   6   7   8   9  10  11  12  14 
455 597 527 444 313 205 133  80  52  33  16   9   6   4 

                        Model Likelihood               Discrimination    Rank Discrim.    
                              Ratio Test                      Indexes          Indexes    
Obs           2874    LR chi2     881.26    R2                  0.268    rho     0.506    
ESS         2803.4    d.f.             2    R2(2,2874)          0.264    Dxy     0.410    
Distinct Y      14    Pr(&gt; chi2) &lt;0.0001    R2(2,2803.4)        0.269                     
Median Y         3    Score chi2  916.79    |Pr(Y&gt;=median)-0.5| 0.188                     
max |deriv|  2e-12    Pr(&gt; chi2) &lt;0.0001                                                  

                        Coef   S.E.   Wald Z Pr(&gt;|Z|)
bpi_antisocialT1Sum     0.4404 0.0186 23.65  &lt;0.0001 
bpi_anxiousDepressedSum 0.1427 0.0261  5.46  &lt;0.0001 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(ordinalRegressionModel3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                              2.5 %     97.5 %
y&gt;=1                             NA         NA
y&gt;=2                    -0.79129972 -0.5619711
y&gt;=3                             NA         NA
y&gt;=4                             NA         NA
y&gt;=5                             NA         NA
y&gt;=6                             NA         NA
y&gt;=7                             NA         NA
y&gt;=8                             NA         NA
y&gt;=9                             NA         NA
y&gt;=10                            NA         NA
y&gt;=11                            NA         NA
y&gt;=12                            NA         NA
y&gt;=14                            NA         NA
bpi_antisocialT1Sum      0.40390078  0.4769035
bpi_anxiousDepressedSum  0.09143921  0.1939303</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(ordinalRegressionModel3), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |       95% CI
---------------------------------------------------
y&gt;=2                    |       0.73 | [0.65, 0.81]
bpi antisocialT1Sum     |       0.99 | [0.91, 1.08]
bpi anxiousDepressedSum |       0.21 | [0.13, 0.28]

- Response is unstandardized.</code></pre>
</div>
</div>
</section>
<section id="bayesian-ordinal-regression-model" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="bayesian-ordinal-regression-model"><span class="header-section-number">6.6</span> Bayesian ordinal regression model</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>bayesianOrdinalRegression <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  orderedVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">cumulative</span>(),</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianOrdinalRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: cumulative 
  Links: mu = logit 
Formula: orderedVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum 
   Data: mydata (Number of observations: 2874) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept[1]               -0.60      0.06    -0.73    -0.48 1.00     4659
Intercept[2]                0.67      0.06     0.55     0.79 1.00     6134
Intercept[3]                1.57      0.06     1.45     1.70 1.00     5916
Intercept[4]                2.40      0.07     2.26     2.54 1.00     5305
Intercept[5]                3.15      0.08     2.99     3.31 1.00     4846
Intercept[6]                3.84      0.09     3.66     4.03 1.00     4741
Intercept[7]                4.52      0.11     4.31     4.74 1.00     4796
Intercept[8]                5.15      0.13     4.90     5.40 1.00     4908
Intercept[9]                5.79      0.15     5.50     6.11 1.00     5172
Intercept[10]               6.51      0.20     6.14     6.90 1.00     5196
Intercept[11]               7.17      0.25     6.69     7.69 1.00     5867
Intercept[12]               7.87      0.34     7.25     8.56 1.00     5503
Intercept[13]               8.91      0.53     7.99    10.06 1.00     5868
bpi_antisocialT1Sum         0.44      0.02     0.40     0.48 1.00     4321
bpi_anxiousDepressedSum     0.14      0.03     0.09     0.19 1.00     4514
                        Tail_ESS
Intercept[1]                3538
Intercept[2]                3487
Intercept[3]                3551
Intercept[4]                3532
Intercept[5]                3866
Intercept[6]                3599
Intercept[7]                3222
Intercept[8]                3125
Intercept[9]                2991
Intercept[10]               3098
Intercept[11]               3043
Intercept[12]               2906
Intercept[13]               2873
bpi_antisocialT1Sum         2945
bpi_anxiousDepressedSum     3156

Further Distributional Parameters:
     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
disc     1.00      0.00     1.00     1.00   NA       NA       NA

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianOrdinalRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: basic

Parameter               | Std. Median |         95% CI
------------------------------------------------------
Intercept[1]            |        0.00 | [ 0.00,  0.00]
Intercept[2]            |        1.51 | [ 1.25,  1.78]
Intercept[3]            |        2.26 | [ 2.08,  2.45]
Intercept[4]            |        2.40 | [ 2.26,  2.54]
Intercept[5]            |        3.15 | [ 2.99,  3.31]
Intercept[6]            |        3.84 | [ 3.66,  4.03]
Intercept[7]            |        4.52 | [ 4.31,  4.74]
Intercept[8]            |        5.14 | [ 4.90,  5.40]
Intercept[9]            |        5.78 | [ 5.50,  6.11]
Intercept[10]           |        6.50 | [ 6.14,  6.90]
Intercept[11]           |        7.15 | [ 6.69,  7.69]
Intercept[12]           |        7.84 | [ 7.25,  8.56]
Intercept[13]           |        8.87 | [ 7.99, 10.06]
bpi_antisocialT1Sum     |        0.44 | [ 0.40,  0.48]
bpi_anxiousDepressedSum |        0.14 | [ 0.09,  0.19]

- Response is unstandardized.</code></pre>
</div>
</div>
</section>
<section id="bayesian-count-regression-model" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="bayesian-count-regression-model"><span class="header-section-number">6.7</span> Bayesian count regression model</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>bayesianCountRegression <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>,</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianCountRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: poisson 
  Links: mu = log 
Formula: countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum 
   Data: mydata (Number of observations: 2874) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                   0.46      0.02     0.42     0.50 1.00     3095
bpi_antisocialT1Sum         0.14      0.00     0.13     0.15 1.00     2776
bpi_anxiousDepressedSum     0.05      0.01     0.03     0.06 1.00     2620
                        Tail_ESS
Intercept                   2987
bpi_antisocialT1Sum         2762
bpi_anxiousDepressedSum     2689

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianCountRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: basic

Parameter               | Std. Median |       95% CI
----------------------------------------------------
(Intercept)             |        0.00 | [0.00, 0.00]
bpi_antisocialT1Sum     |        0.32 | [0.30, 0.34]
bpi_anxiousDepressedSum |        0.07 | [0.05, 0.09]

- Response is unstandardized.</code></pre>
</div>
</div>
</section>
<section id="logistic-regression-model-rms" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="logistic-regression-model-rms"><span class="header-section-number">6.8</span> Logistic regression model (rms)</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>logisticRegressionModel <span class="ot">&lt;-</span> rms<span class="sc">::</span><span class="fu">robcov</span>(rms<span class="sc">::</span><span class="fu">lrm</span>(</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  female <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>))</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>logisticRegressionModel</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
                 female     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
                      2                    7613                    7616 

Logistic Regression Model

rms::lrm(formula = female ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, x = TRUE, y = TRUE)

                       Model Likelihood       Discrimination    Rank Discrim.    
                             Ratio Test              Indexes          Indexes    
Obs          3914    LR chi2      66.63       R2       0.023    C       0.571    
 0           1965    d.f.             2      R2(2,3914)0.016    Dxy     0.142    
 1           1949    Pr(&gt; chi2) &lt;0.0001    R2(2,2935.5)0.022    gamma   0.147    
max |deriv| 1e-07                             Brier    0.246    tau-a   0.071    

                        Coef    S.E.   Wald Z Pr(&gt;|Z|)
Intercept                0.3002 0.0529  5.67  &lt;0.0001 
bpi_antisocialT1Sum     -0.1244 0.0166 -7.48  &lt;0.0001 
bpi_anxiousDepressedSum  0.0382 0.0253  1.51  0.1314  </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(logisticRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summary.rms()`:
! adjustment values not defined here or with datadist for bpi_antisocialT1Sum bpi_anxiousDepressedSum</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(logisticRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |         95% CI
-----------------------------------------------------
Intercept               |  -9.88e-03 | [-0.07,  0.05]
bpi antisocialT1Sum     |      -0.29 | [-0.36, -0.21]
bpi anxiousDepressedSum |       0.06 | [-0.02,  0.13]

- Response is unstandardized.</code></pre>
</div>
</div>
</section>
<section id="bayesian-logistic-regression-model" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="bayesian-logistic-regression-model"><span class="header-section-number">6.9</span> Bayesian logistic regression model</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>bayesianLogisticRegression <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  female <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> bernoulli,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>,</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianLogisticRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: female ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum 
   Data: mydata (Number of observations: 3914) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                   0.30      0.05     0.20     0.41 1.00     4125
bpi_antisocialT1Sum        -0.13      0.02    -0.16    -0.09 1.00     2943
bpi_anxiousDepressedSum     0.04      0.03    -0.01     0.09 1.00     3084
                        Tail_ESS
Intercept                   3269
bpi_antisocialT1Sum         2857
bpi_anxiousDepressedSum     2730

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianLogisticRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: basic

Parameter               | Std. Median |         95% CI
------------------------------------------------------
(Intercept)             |        0.00 | [ 0.00,  0.00]
bpi_antisocialT1Sum     |       -0.29 | [-0.36, -0.22]
bpi_anxiousDepressedSum |        0.06 | [-0.02,  0.13]

- Response is unstandardized.</code></pre>
</div>
</div>
</section>
</section>
<section id="hierarchical-linear-regression" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Hierarchical Linear Regression</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata <span class="sc">%&gt;%</span> <span class="fu">select</span>(bpi_antisocialT2Sum, bpi_antisocialT1Sum, bpi_anxiousDepressedSum) <span class="sc">%&gt;%</span> na.omit,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata <span class="sc">%&gt;%</span> <span class="fu">select</span>(bpi_antisocialT2Sum, bpi_antisocialT1Sum, bpi_anxiousDepressedSum) <span class="sc">%&gt;%</span> na.omit,</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)<span class="sc">$</span>adj.r.squared</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2614694</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1, model2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"2872","2":"11358.86","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"2871","2":"11239.86","3":"1","4":"119.0016","5":"30.39663","6":"3.834142e-08","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)<span class="sc">$</span>adj.r.squared <span class="sc">-</span> <span class="fu">summary</span>(model1)<span class="sc">$</span>adj.r.squared</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.007559301</code></pre>
</div>
</div>
</section>
<section id="moderation" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Moderated Multiple Regression</h1>
<p>When testing for the possibility of moderation/interaction, it is first important to think about what shape the interaction might take. If you expect a bilinear interaction (i.e., the slope of the regression line between <code>X</code> and <code>Y</code> changes as a <em>linear</em> function of a third variable, <code>Z</code>), it is appropriate to treat the moderator as continuous in moderated multiple regression. However, if you expect that the interaction might take a different form (e.g., a threshold effect), you may need to consider other approaches, such as using categorical variables, polynomial interactions, spline functions, generalized additive models (GAMs), or machine learning.</p>
<p>For information on the (low) power to detect interactions and how to improve it, see: <a href="https://isaactpetersen.github.io/Principles-Psychological-Assessment/reliability.html#productTerm-reliability" class="uri">https://isaactpetersen.github.io/Principles-Psychological-Assessment/reliability.html#productTerm-reliability</a></p>
<p>The examples below use the <code>interactions</code> package in R. <a href="https://cran.r-project.org/web/packages/interactions/vignettes/interactions.html" class="uri">https://cran.r-project.org/web/packages/interactions/vignettes/interactions.html</a> (archived at <a href="https://perma.cc/P34H-7BH3" class="uri">https://perma.cc/P34H-7BH3</a>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(state.x77)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>states<span class="sc">$</span>HS.Grad <span class="ot">&lt;-</span> states<span class="sc">$</span><span class="st">`</span><span class="at">HS Grad</span><span class="st">`</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="mean-center-predictors" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="mean-center-predictors"><span class="header-section-number">8.1</span> Mean Center Predictors</h2>
<p>Make sure to mean-center or orthogonalize predictors before computing the interaction term.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>states<span class="sc">$</span>Illiteracy_centered <span class="ot">&lt;-</span> <span class="fu">scale</span>(states<span class="sc">$</span>Illiteracy, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>states<span class="sc">$</span>Murder_centered <span class="ot">&lt;-</span> <span class="fu">scale</span>(states<span class="sc">$</span>Murder, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="model" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="model"><span class="header-section-number">8.2</span> Model</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>interactionModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  Income <span class="sc">~</span> Illiteracy_centered <span class="sc">+</span> Murder_centered <span class="sc">+</span> Illiteracy_centered<span class="sc">:</span>Murder_centered <span class="sc">+</span> HS.Grad,</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> states)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interactionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Income ~ Illiteracy_centered + Murder_centered + 
    Illiteracy_centered:Murder_centered + HS.Grad, data = states)

Residuals:
    Min      1Q  Median      3Q     Max 
-916.27 -244.42   28.42  228.14 1221.16 

Coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                          2421.46     594.36   4.074 0.000185 ***
Illiteracy_centered                    37.12     192.56   0.193 0.848005    
Murder_centered                        17.07      25.52   0.669 0.507085    
HS.Grad                                40.76      10.92   3.733 0.000530 ***
Illiteracy_centered:Murder_centered   -97.04      35.86  -2.706 0.009584 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 459.5 on 45 degrees of freedom
Multiple R-squared:  0.4864,    Adjusted R-squared:  0.4407 
F-statistic: 10.65 on 4 and 45 DF,  p-value: 3.689e-06</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(interactionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter                             | Std. Coef. |         95% CI
-------------------------------------------------------------------
(Intercept)                           |       0.24 | [-0.04,  0.53]
Illiteracy centered                   |       0.04 | [-0.35,  0.42]
Murder centered                       |       0.10 | [-0.21,  0.41]
HS Grad                               |       0.54 | [ 0.25,  0.82]
Illiteracy centered × Murder centered |      -0.36 | [-0.62, -0.09]</code></pre>
</div>
</div>
</section>
<section id="plots" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="plots"><span class="header-section-number">8.3</span> Plots</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">interact_plot</span>(</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">interact_plot</span>(</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.points =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">interact_plot</span>(</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">johnson_neyman</span>(</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> .<span class="dv">05</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>JOHNSON-NEYMAN INTERVAL

When Murder_centered is OUTSIDE the interval [-8.13, 4.37], the slope of
Illiteracy_centered is p &lt; .05.

Note: The range of observed values of Murder_centered is [-5.98, 7.72]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-31-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="simple-slopes-analysis" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="simple-slopes-analysis"><span class="header-section-number">8.4</span> Simple Slopes Analysis</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">sim_slopes</span>(</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">johnson_neyman =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

Slope of Illiteracy_centered when Murder_centered = -3.69154e+00 (- 1 SD): 

    Est.     S.E.   t val.      p
-------- -------- -------- ------
  395.34   274.84     1.44   0.16

Slope of Illiteracy_centered when Murder_centered = -1.24345e-16 (Mean): 

   Est.     S.E.   t val.      p
------- -------- -------- ------
  37.12   192.56     0.19   0.85

Slope of Illiteracy_centered when Murder_centered =  3.69154e+00 (+ 1 SD): 

     Est.     S.E.   t val.      p
--------- -------- -------- ------
  -321.10   183.49    -1.75   0.09</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">sim_slopes</span>(</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx.values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">johnson_neyman =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

Slope of Illiteracy_centered when Murder_centered =  0.00: 

   Est.     S.E.   t val.      p
------- -------- -------- ------
  37.12   192.56     0.19   0.85

Slope of Illiteracy_centered when Murder_centered =  5.00: 

     Est.     S.E.   t val.      p
--------- -------- -------- ------
  -448.07   202.17    -2.22   0.03

Slope of Illiteracy_centered when Murder_centered = 10.00: 

     Est.     S.E.   t val.      p
--------- -------- -------- ------
  -933.27   330.10    -2.83   0.01</code></pre>
</div>
</div>
</section>
<section id="johnson-neyman-intervals" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="johnson-neyman-intervals"><span class="header-section-number">8.5</span> Johnson-Neyman intervals</h2>
<p>Indicates all the values of the moderator for which the slope of the predictor is statistically significant.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">sim_slopes</span>(</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">johnson_neyman =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>JOHNSON-NEYMAN INTERVAL

When Murder_centered is OUTSIDE the interval [-8.13, 4.37], the slope of
Illiteracy_centered is p &lt; .05.

Note: The range of observed values of Murder_centered is [-5.98, 7.72]

SIMPLE SLOPES ANALYSIS

Slope of Illiteracy_centered when Murder_centered = -3.69154e+00 (- 1 SD): 

    Est.     S.E.   t val.      p
-------- -------- -------- ------
  395.34   274.84     1.44   0.16

Slope of Illiteracy_centered when Murder_centered = -1.24345e-16 (Mean): 

   Est.     S.E.   t val.      p
------- -------- -------- ------
  37.12   192.56     0.19   0.85

Slope of Illiteracy_centered when Murder_centered =  3.69154e+00 (+ 1 SD): 

     Est.     S.E.   t val.      p
--------- -------- -------- ------
  -321.10   183.49    -1.75   0.09</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">probe_interaction</span>(</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cond.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">jnplot =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>JOHNSON-NEYMAN INTERVAL

When Murder_centered is OUTSIDE the interval [-8.13, 4.37], the slope of
Illiteracy_centered is p &lt; .05.

Note: The range of observed values of Murder_centered is [-5.98, 7.72]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

When Murder_centered = -3.69154e+00 (- 1 SD): 

                                        Est.     S.E.   t val.      p
---------------------------------- --------- -------- -------- ------
Slope of Illiteracy_centered          395.34   274.84     1.44   0.16
Conditional intercept                4523.23   134.99    33.51   0.00

When Murder_centered = -1.24345e-16 (Mean): 

                                        Est.     S.E.   t val.      p
---------------------------------- --------- -------- -------- ------
Slope of Illiteracy_centered           37.12   192.56     0.19   0.85
Conditional intercept                4586.22    85.52    53.63   0.00

When Murder_centered =  3.69154e+00 (+ 1 SD): 

                                        Est.     S.E.   t val.      p
---------------------------------- --------- -------- -------- ------
Slope of Illiteracy_centered         -321.10   183.49    -1.75   0.09
Conditional intercept                4649.22   118.97    39.08   0.00</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="compareCorrelations" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Comparing Correlations</h1>
<p>Fisher’s <em>r</em>-to-<em>z</em> test.</p>
<p><a href="http://comparingcorrelations.org" class="uri">http://comparingcorrelations.org</a> (archived at <a href="https://perma.cc/X3EU-24GL" class="uri">https://perma.cc/X3EU-24GL</a>)</p>
<p>Independent groups (two different groups):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>cocor<span class="sc">::</span><span class="fu">cocor.indep.groups</span>(</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">r1.jk =</span> .<span class="dv">7</span>,</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">r2.hm =</span> .<span class="dv">6</span>,</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n1 =</span> <span class="dv">305</span>,</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">n2 =</span> <span class="dv">210</span>,</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data.name =</span> <span class="fu">c</span>(<span class="st">"group1"</span>, <span class="st">"group2"</span>),</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.labels =</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"intelligence"</span>, <span class="st">"age"</span>, <span class="st">"intelligence"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
  Results of a comparison of two correlations based on independent groups

Comparison between r1.jk (age, intelligence) = 0.7 and r2.hm (age, intelligence) = 0.6
Difference: r1.jk - r2.hm = 0.1
Data: group1: j = age, k = intelligence; group2: h = age, m = intelligence
Group sizes: n1 = 305, n2 = 210
Null hypothesis: r1.jk is equal to r2.hm
Alternative hypothesis: r1.jk is not equal to r2.hm (two-sided)
Alpha: 0.05

fisher1925: Fisher's z (1925)
  z = 1.9300, p-value = 0.0536
  Null hypothesis retained

zou2007: Zou's (2007) confidence interval
  95% confidence interval for r1.jk - r2.hm: -0.0014 0.2082
  Null hypothesis retained (Interval includes 0)</code></pre>
</div>
</div>
<p>Dependent groups (same group), overlapping correlation (shares a variable in common—in this case, the variable <code>age</code> is shared in both correlations):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>cocor<span class="sc">::</span><span class="fu">cocor.dep.groups.overlap</span>(</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jk =</span> .<span class="dv">2</span>, <span class="co"># Correlation (age, intelligence)</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jh =</span> .<span class="dv">5</span>, <span class="co"># Correlation (age, shoe size)</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.kh =</span> .<span class="dv">1</span>, <span class="co"># Correlation (intelligence, shoe index)</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">315</span>,</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.labels =</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"intelligence"</span>, <span class="st">"shoe size"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
  Results of a comparison of two overlapping correlations based on dependent groups

Comparison between r.jk (age, intelligence) = 0.2 and r.jh (age, shoe size) = 0.5
Difference: r.jk - r.jh = -0.3
Related correlation: r.kh = 0.1
Data: j = age, k = intelligence, h = shoe size
Group size: n = 315
Null hypothesis: r.jk is equal to r.jh
Alternative hypothesis: r.jk is not equal to r.jh (two-sided)
Alpha: 0.05

pearson1898: Pearson and Filon's z (1898)
  z = -4.4807, p-value = 0.0000
  Null hypothesis rejected

hotelling1940: Hotelling's t (1940)
  t = -4.6314, df = 312, p-value = 0.0000
  Null hypothesis rejected

williams1959: Williams' t (1959)
  t = -4.4950, df = 312, p-value = 0.0000
  Null hypothesis rejected

olkin1967: Olkin's z (1967)
  z = -4.4807, p-value = 0.0000
  Null hypothesis rejected

dunn1969: Dunn and Clark's z (1969)
  z = -4.4412, p-value = 0.0000
  Null hypothesis rejected

hendrickson1970: Hendrickson, Stanley, and Hills' (1970) modification of Williams' t (1959)
  t = -4.6313, df = 312, p-value = 0.0000
  Null hypothesis rejected

steiger1980: Steiger's (1980) modification of Dunn and Clark's z (1969) using average correlations
  z = -4.4152, p-value = 0.0000
  Null hypothesis rejected

meng1992: Meng, Rosenthal, and Rubin's z (1992)
  z = -4.3899, p-value = 0.0000
  Null hypothesis rejected
  95% confidence interval for r.jk - r.jh: -0.5013 -0.1918
  Null hypothesis rejected (Interval does not include 0)

hittner2003: Hittner, May, and Silver's (2003) modification of Dunn and Clark's z (1969) using a backtransformed average Fisher's (1921) Z procedure
  z = -4.4077, p-value = 0.0000
  Null hypothesis rejected

zou2007: Zou's (2007) confidence interval
  95% confidence interval for r.jk - r.jh: -0.4307 -0.1675
  Null hypothesis rejected (Interval does not include 0)</code></pre>
</div>
</div>
<p>Dependent groups (same group), non-overlapping correlation (does not share a variable in common):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>cocor<span class="sc">::</span><span class="fu">cocor.dep.groups.nonoverlap</span>(</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jk =</span> .<span class="dv">2</span>, <span class="co"># Correlation (age, intelligence)</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.hm =</span> .<span class="dv">7</span>, <span class="co"># Correlation (body mass index, shoe size)</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jh =</span> .<span class="dv">4</span>, <span class="co"># Correlation (age, body mass index)</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jm =</span> .<span class="dv">5</span>, <span class="co"># Correlation (age, shoe size)</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.kh =</span> .<span class="dv">1</span>, <span class="co"># Correlation (intelligence, body mass index)</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.km =</span> .<span class="dv">3</span>, <span class="co"># Correlation (intelligence, shoe size)</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">232</span>,</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.labels =</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"intelligence"</span>, <span class="st">"body mass index"</span>, <span class="st">"shoe size"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
  Results of a comparison of two nonoverlapping correlations based on dependent groups

Comparison between r.jk (age, intelligence) = 0.2 and r.hm (body mass index, shoe size) = 0.7
Difference: r.jk - r.hm = -0.5
Related correlations: r.jh = 0.4, r.jm = 0.5, r.kh = 0.1, r.km = 0.3
Data: j = age, k = intelligence, h = body mass index, m = shoe size
Group size: n = 232
Null hypothesis: r.jk is equal to r.hm
Alternative hypothesis: r.jk is not equal to r.hm (two-sided)
Alpha: 0.05

pearson1898: Pearson and Filon's z (1898)
  z = -7.1697, p-value = 0.0000
  Null hypothesis rejected

dunn1969: Dunn and Clark's z (1969)
  z = -7.3134, p-value = 0.0000
  Null hypothesis rejected

steiger1980: Steiger's (1980) modification of Dunn and Clark's z (1969) using average correlations
  z = -7.3010, p-value = 0.0000
  Null hypothesis rejected

raghunathan1996: Raghunathan, Rosenthal, and Rubin's (1996) modification of Pearson and Filon's z (1898)
  z = -7.3134, p-value = 0.0000
  Null hypothesis rejected

silver2004: Silver, Hittner, and May's (2004) modification of Dunn and Clark's z (1969) using a backtransformed average Fisher's (1921) Z procedure
  z = -7.2737, p-value = 0.0000
  Null hypothesis rejected

zou2007: Zou's (2007) confidence interval
  95% confidence interval for r.jk - r.hm: -0.6375 -0.3629
  Null hypothesis rejected (Interval does not include 0)</code></pre>
</div>
</div>
</section>
<section id="missingness" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Approaches to Handling Missingness</h1>
<section id="listwiseDeletion" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="listwiseDeletion"><span class="header-section-number">10.1</span> Listwise deletion</h2>
<p>Listwise deletion deletes every row in the data file that has a missing value for one of the model variables.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>listwiseDeletionModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(listwiseDeletionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.3755 -1.2337 -0.2212  0.9911 12.8017 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              1.19830    0.05983  20.029  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.979 on 2871 degrees of freedom
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.262, Adjusted R-squared:  0.2615 
F-statistic: 509.6 on 2 and 2871 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(listwiseDeletionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                            2.5 %    97.5 %
(Intercept)             1.0809881 1.3156128
bpi_antisocialT1Sum     0.4290884 0.5019688
bpi_anxiousDepressedSum 0.1035825 0.2179258</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(listwiseDeletionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Standardization method: refit

Parameter               | Std. Coef. |        95% CI
----------------------------------------------------
(Intercept)             |   1.62e-16 | [-0.03, 0.03]
bpi antisocialT1Sum     |       0.46 | [ 0.42, 0.49]
bpi anxiousDepressedSum |       0.10 | [ 0.06, 0.14]</code></pre>
</div>
</div>
</section>
<section id="pairwiseDeletion" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="pairwiseDeletion"><span class="header-section-number">10.2</span> Pairwise deletion</h2>
<p>Also see here:</p>
<ul>
<li><a href="https://stats.stackexchange.com/questions/158366/fit-multiple-regression-model-with-pairwise-deletion-or-on-a-correlation-covari/173002#173002" class="uri">https://stats.stackexchange.com/questions/158366/fit-multiple-regression-model-with-pairwise-deletion-or-on-a-correlation-covari/173002#173002</a> (archived at <a href="https://perma.cc/GH5T-RXD9" class="uri">https://perma.cc/GH5T-RXD9</a>)</li>
<li><a href="https://stats.stackexchange.com/questions/299792/r-lm-covariance-matrix-manual-calculation-failure" class="uri">https://stats.stackexchange.com/questions/299792/r-lm-covariance-matrix-manual-calculation-failure</a> (archived at <a href="https://perma.cc/F7EL-AUFZ" class="uri">https://perma.cc/F7EL-AUFZ</a>)</li>
<li><a href="https://stats.stackexchange.com/questions/107597/is-there-a-way-to-use-the-covariance-matrix-to-find-coefficients-for-multiple-re" class="uri">https://stats.stackexchange.com/questions/107597/is-there-a-way-to-use-the-covariance-matrix-to-find-coefficients-for-multiple-re</a> (archived at <a href="https://perma.cc/KU3X-FB2C" class="uri">https://perma.cc/KU3X-FB2C</a>)</li>
<li><a href="https://stats.stackexchange.com/questions/105006/how-to-perform-a-bivariate-regression-using-pairwise-deletion-of-missing-values" class="uri">https://stats.stackexchange.com/questions/105006/how-to-perform-a-bivariate-regression-using-pairwise-deletion-of-missing-values</a> (archived at <a href="https://perma.cc/QWQ5-2TLW" class="uri">https://perma.cc/QWQ5-2TLW</a>)</li>
<li><a href="https://dl.dropboxusercontent.com/s/4sf0et3p47ykctx/MissingPairwise.sps" class="uri">https://dl.dropboxusercontent.com/s/4sf0et3p47ykctx/MissingPairwise.sps</a> (archived at <a href="https://perma.cc/UC4K-2L9T" class="uri">https://perma.cc/UC4K-2L9T</a>)</li>
</ul>
<p>Adapted from here: <a href="https://stefvanbuuren.name/fimd/sec-simplesolutions.html#sec:pairwise" class="uri">https://stefvanbuuren.name/fimd/sec-simplesolutions.html#sec:pairwise</a> (archived at <a href="https://perma.cc/EGU6-3M3Q" class="uri">https://perma.cc/EGU6-3M3Q</a>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>modelData <span class="ot">&lt;-</span> mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT2Sum"</span>,<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span>)]</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>varMeans <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(modelData, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>varCovariances <span class="ot">&lt;-</span> <span class="fu">cov</span>(modelData, <span class="at">use =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>pairwiseRegression_syntax <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum</span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~~ bpi_antisocialT2Sum</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~ 1</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>pairwiseRegression_fit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">lavaan</span>(</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>  pairwiseRegression_syntax,</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.mean =</span> varMeans,</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.cov =</span> varCovariances,</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.nobs =</span> <span class="fu">sum</span>(<span class="fu">complete.cases</span>(modelData))</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(</span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>  pairwiseRegression_fit,</span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         4

  Number of observations                          2874

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                        Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  bpi_antisocialT2Sum ~                                                      
    bpi_antsclT1Sm         0.441    0.018   24.611    0.000    0.441    0.456
    bp_nxsDprssdSm         0.137    0.028    4.854    0.000    0.137    0.090

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .bpi_antsclT2Sm    1.175    0.058   20.125    0.000    1.175    0.523

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .bpi_antsclT2Sm    3.755    0.099   37.908    0.000    3.755    0.743

R-Square:
                   Estimate
    bpi_antsclT2Sm    0.257</code></pre>
</div>
</div>
</section>
<section id="fiml" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="fiml"><span class="header-section-number">10.3</span> Full-information maximum likelihood (FIML)</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>fimlRegression_syntax <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~~ bpi_antisocialT2Sum</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~ 1</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>fimlRegression_fit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">lavaan</span>(</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>  fimlRegression_syntax,</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>  fimlRegression_fit,</span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 11 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         4

                                                  Used       Total
  Number of observations                          3914       11530
  Number of missing patterns                         2            

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Regressions:
                        Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  bpi_antisocialT2Sum ~                                                      
    bpi_antsclT1Sm         0.466    0.019   25.062    0.000    0.466    0.466
    bp_nxsDprssdSm         0.161    0.029    5.516    0.000    0.161    0.102

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .bpi_antsclT2Sm    1.198    0.060   20.039    0.000    1.198    0.516

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .bpi_antsclT2Sm    3.911    0.103   37.908    0.000    3.911    0.725

R-Square:
                   Estimate
    bpi_antsclT2Sm    0.275</code></pre>
</div>
</div>
</section>
<section id="imputation" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="imputation"><span class="header-section-number">10.4</span> Multiple imputation</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>modelData_imputed <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">mice</span>(</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  modelData,</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="dv">5</span>,</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"pmm"</span>) <span class="co"># predictive mean matching; can choose among many methods</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  1   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  1   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  1   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  1   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  2   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  2   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  2   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  2   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  2   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  3   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  3   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  3   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  3   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  3   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  4   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  4   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  4   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  4   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  4   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  5   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  5   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  5   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  5   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum
  5   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>imputedData_fit <span class="ot">&lt;-</span> <span class="fu">with</span>(</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  modelData_imputed,</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum))</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>imputedData_pooledEstimates <span class="ot">&lt;-</span> <span class="fu">pool</span>(imputedData_fit)</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(imputedData_pooledEstimates)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["fct"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"1.2789436","3":"0.23621515","4":"5.414317","5":"4.022125","6":"0.005549756"},{"1":"bpi_antisocialT1Sum","2":"0.4168212","3":"0.08816866","4":"4.727544","5":"3.946597","6":"0.009424913"},{"1":"bpi_anxiousDepressedSum","2":"0.1329727","3":"0.06919004","4":"1.921848","5":"4.322191","6":"0.121680733"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="squaredSemiPartialCorrelation" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Squared Semi-Partial Correlation (<span class="math inline">\(sr^2\)</span>)</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>rockchalk<span class="sc">::</span><span class="fu">getDeltaRsquare</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The deltaR-square values: the change in the R-square
      observed when a single term is removed.
Same as the square of the 'semi-partial correlation coefficient'
                        deltaRsquare
bpi_antisocialT1Sum      0.161297120
bpi_anxiousDepressedSum  0.007813728</code></pre>
</div>
</div>
</section>
<section id="partialRegressionPlot" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Partial Regression Plot</h1>
<p>A partial regression plot (aka added-variable) examines the association between the predictor and the outcome after controlling for the covariates.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">avPlots</span>(</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Manually:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DV residuals (outcome residualized on covariates)</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>ry <span class="ot">&lt;-</span> <span class="fu">resid</span>(<span class="fu">lm</span>(</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum, </span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata, <span class="at">na.action =</span> na.exclude))</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictor residuals (focal predictor residualized on covariates)</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>rx <span class="ot">&lt;-</span> <span class="fu">resid</span>(<span class="fu">lm</span>(</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>  bpi_anxiousDepressedSum <span class="sc">~</span> bpi_antisocialT1Sum,</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata, <span class="at">na.action =</span> na.exclude))</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the partial regression plot</span></span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(rx, ry)</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_plot,</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> rx, <span class="at">y =</span> ry)) <span class="sc">+</span></span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Residualized bpi_antisocialT1Sum"</span>,</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residualized bpi_antisocialT2Sum"</span>,</span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Partial Regression Plot</span><span class="sc">\n</span><span class="st">bpi_antisocialT2Sum ~ bpi_antisocialT1Sum controlling for bpi_anxiousDepressedSum"</span></span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="dominanceAnalysis" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Dominance Analysis</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">dominance_analysis</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Dominance Analysis Results

Model R2 Value:  0.262 

General Dominance Statistics

Parameter               | General Dominance | Percent | Ranks |                  Subset
---------------------------------------------------------------------------------------
(Intercept)             |                   |         |       |                constant
bpi_antisocialT1Sum     |             0.208 |   0.793 |     1 |     bpi_antisocialT1Sum
bpi_anxiousDepressedSum |             0.054 |   0.207 |     2 | bpi_anxiousDepressedSum

Conditional Dominance Statistics

Subset                  | IVs: 1 | IVs: 2
-----------------------------------------
bpi_antisocialT1Sum     |  0.254 |  0.161
bpi_anxiousDepressedSum |  0.101 |  0.008

Complete Dominance Designations

Subset                  | &lt; bpi_antisocialT1Sum | &lt; bpi_anxiousDepressedSum
---------------------------------------------------------------------------
bpi_antisocialT1Sum     |                       |                     FALSE
bpi_anxiousDepressedSum |                  TRUE |                          </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>allPossibleSubsetsRegression <span class="ot">&lt;-</span> yhat<span class="sc">::</span><span class="fu">aps</span>(</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataMatrix =</span> mydata,</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ivlist =</span> <span class="fu">list</span>(<span class="st">"bpi_antisocialT1Sum"</span>, <span class="st">"bpi_anxiousDepressedSum"</span>))</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>yhat<span class="sc">::</span><span class="fu">dominance</span>(allPossibleSubsetsRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$DA
                                            k        R2 bpi_antisocialT1Sum.Inc
bpi_antisocialT1Sum                         1 0.2541698                      NA
bpi_anxiousDepressedSum                     1 0.1006864               0.1612971
bpi_antisocialT1Sum,bpi_anxiousDepressedSum 2 0.2619835                      NA
                                            bpi_anxiousDepressedSum.Inc
bpi_antisocialT1Sum                                         0.007813728
bpi_anxiousDepressedSum                                              NA
bpi_antisocialT1Sum,bpi_anxiousDepressedSum                          NA

$CD
     bpi_antisocialT1Sum bpi_anxiousDepressedSum
CD:0           0.2541698             0.100686422
CD:1           0.1612971             0.007813728

$GD
    bpi_antisocialT1Sum bpi_anxiousDepressedSum 
             0.20773347              0.05425008 </code></pre>
</div>
</div>
</section>
<section id="commonalityAnalysis" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Commonality Analysis</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>yhat<span class="sc">::</span><span class="fu">calc.yhat</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$PredictorMetrics
                            b  Beta     r    rs   rs2 Unique Common  CD:0  CD:1
bpi_antisocialT1Sum     0.466 0.456 0.504 0.985 0.970  0.161  0.093 0.254 0.161
bpi_anxiousDepressedSum 0.161 0.100 0.317 0.620 0.384  0.008  0.093 0.101 0.008
Total                      NA    NA    NA    NA 1.354  0.169  0.186 0.355 0.169
                        GenDom Pratt   RLW
bpi_antisocialT1Sum      0.208 0.230 0.208
bpi_anxiousDepressedSum  0.054 0.032 0.054
Total                    0.262 0.262 0.262

$OrderedPredictorMetrics
                        b Beta r rs rs2 Unique Common CD:0 CD:1 GenDom Pratt
bpi_antisocialT1Sum     1    1 1  1   1      1      1    1    1      1     1
bpi_anxiousDepressedSum 2    2 2  2   2      2      2    2    2      2     2
                        RLW
bpi_antisocialT1Sum       1
bpi_anxiousDepressedSum   2

$PairedDominanceMetrics
                                            Comp Cond Gen
bpi_antisocialT1Sum&gt;bpi_anxiousDepressedSum    1    1   1

$APSRelatedMetrics
                                            Commonality  % Total    R2
bpi_antisocialT1Sum                               0.161    0.616 0.254
bpi_anxiousDepressedSum                           0.008    0.030 0.101
bpi_antisocialT1Sum,bpi_anxiousDepressedSum       0.093    0.354 0.262
Total                                             0.262    1.000    NA
                                            bpi_antisocialT1Sum.Inc
bpi_antisocialT1Sum                                              NA
bpi_anxiousDepressedSum                                       0.161
bpi_antisocialT1Sum,bpi_anxiousDepressedSum                      NA
Total                                                            NA
                                            bpi_anxiousDepressedSum.Inc
bpi_antisocialT1Sum                                               0.008
bpi_anxiousDepressedSum                                              NA
bpi_antisocialT1Sum,bpi_anxiousDepressedSum                          NA
Total                                                                NA</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>allPossibleSubsetsRegression <span class="ot">&lt;-</span> yhat<span class="sc">::</span><span class="fu">aps</span>(</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataMatrix =</span> mydata,</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ivlist =</span> <span class="fu">list</span>(<span class="st">"bpi_antisocialT1Sum"</span>, <span class="st">"bpi_anxiousDepressedSum"</span>))</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>yhat<span class="sc">::</span><span class="fu">commonality</span>(allPossibleSubsetsRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                            Coefficient    % Total
bpi_antisocialT1Sum                         0.161297120 0.61567654
bpi_anxiousDepressedSum                     0.007813728 0.02982526
bpi_antisocialT1Sum,bpi_anxiousDepressedSum 0.092872694 0.35449820</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>commonalityAnalysis <span class="ot">&lt;-</span> yhat<span class="sc">::</span><span class="fu">commonalityCoefficients</span>(</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataMatrix =</span> mydata,</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ivlist =</span> <span class="fu">list</span>(<span class="st">"bpi_antisocialT1Sum"</span>, <span class="st">"bpi_anxiousDepressedSum"</span>))</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>commonalityAnalysis</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$CC
                                                           Coefficient
Unique to bpi_antisocialT1Sum                                   0.1613
Unique to bpi_anxiousDepressedSum                               0.0078
Common to bpi_antisocialT1Sum, and bpi_anxiousDepressedSum      0.0929
Total                                                           0.2620
                                                               % Total
Unique to bpi_antisocialT1Sum                                    61.57
Unique to bpi_anxiousDepressedSum                                 2.98
Common to bpi_antisocialT1Sum, and bpi_anxiousDepressedSum       35.45
Total                                                           100.00

$CCTotalbyVar
                        Unique Common  Total
bpi_antisocialT1Sum     0.1613 0.0929 0.2542
bpi_anxiousDepressedSum 0.0078 0.0929 0.1007</code></pre>
</div>
</div>
</section>
<section id="model-building-steps" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Model Building Steps</h1>
<ol type="1">
<li>Examine extent and type of missing data, consider <a href="#missingness">how to handle missing values</a> (<a href="#imputation">multiple imputation</a>, <a href="#fiml">FIML</a>, <a href="#pairwiseDeletion">pairwise deletion</a>, <a href="#listwiseDeletion">listwise deletion</a>)
<ul>
<li>Little’s MCAR test from <code>mcar_test()</code> function of the <code>njtierney/naniar</code> package</li>
<li>Bayesian handling of missing data: <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_missings.html" class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_missings.html</a> (archived at <a href="https://perma.cc/Z4HT-QXWR" class="uri">https://perma.cc/Z4HT-QXWR</a>)</li>
</ul></li>
<li>Examine descriptive statistics, consider variable transformations</li>
<li>Examine scatterplot matrix to examine whether associations between predictor and outcomes are linear or nonlinear</li>
<li>Model building: theory and empiricism (stepwise regression, likelihood ratio tests, k-fold cross validation to check for over-fitting compared to simpler model)</li>
<li>Test assumptions
<ul>
<li>Examine whether predictors have linear association with outcome (Residual Plots, Marginal Model Plots, Added-Variable Plots—check for non-horizontal lines)</li>
<li>Examine whether residuals have constant variance across levels of outcome and predictors Residual Plots, Spread-Level Plots—check for fan-shaped plot or other increasing/decreasing structure)</li>
<li>Examine whether predictors show multicollinearity (VIF)</li>
<li>Examine whether residuals are normally distributed (QQ plot and density plot)</li>
<li>Examine influence of influential observations (high outlyingness and leverage) on parameter stimates by iteratively removing influential observations and refitting (Added-Variable Plots)</li>
</ul></li>
<li>Handle violated assumptions, select final set of predictors/outcomes and transformation of each</li>
<li>Use k-fold cross validation to identify the best estimation procedure (OLS, MM, or LTS) on the final model</li>
<li>Use identified estimation procedure to fit final model and determine the best parameter point estimates</li>
<li>Calculate bootstrapped estimates to determine the confidence intervals around the parameter estimates of the final model</li>
</ol>
</section>
<section id="bootstrapped-estimates" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Bootstrapped Estimates</h1>
<p>To determine the confidence intervals of parameter estimates</p>
<section id="linear-regression-1" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="linear-regression-1"><span class="header-section-number">16.1</span> Linear Regression</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelBootstrapped <span class="ot">&lt;-</span> <span class="fu">Boot</span>(multipleRegressionModelNoMissing, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModelBootstrapped)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["R"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["original"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["bootBias"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["bootSE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["bootMed"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1000","2":"1.1983004","3":"1.173800e-04","4":"0.06248669","5":"1.1953709","_rn_":"(Intercept)"},{"1":"1000","2":"0.4655286","3":"-4.146956e-05","4":"0.02274763","5":"0.4653895","_rn_":"bpi_antisocialT1Sum"},{"1":"1000","2":"0.1607541","3":"-1.130336e-03","4":"0.03209855","5":"0.1605050","_rn_":"bpi_anxiousDepressedSum"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(multipleRegressionModelBootstrapped, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">type =</span> <span class="st">"bca"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap percent confidence intervals

                            2.5 %    97.5 %
(Intercept)             1.0727049 1.3213438
bpi_antisocialT1Sum     0.4212631 0.5108728
bpi_anxiousDepressedSum 0.0974418 0.2245887</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(multipleRegressionModelBootstrapped)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="generalized-regression" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="generalized-regression"><span class="header-section-number">16.2</span> Generalized Regression</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>generalizedRegressionModelBootstrapped <span class="ot">&lt;-</span> <span class="fu">Boot</span>(multipleRegressionModelNoMissing, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(generalizedRegressionModelBootstrapped)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["R"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["original"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["bootBias"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["bootSE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["bootMed"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1000","2":"1.1983004","3":"-0.0030950960","4":"0.06396346","5":"1.1943392","_rn_":"(Intercept)"},{"1":"1000","2":"0.4655286","3":"0.0006171253","4":"0.02307335","5":"0.4666881","_rn_":"bpi_antisocialT1Sum"},{"1":"1000","2":"0.1607541","3":"0.0004919260","4":"0.03318537","5":"0.1632956","_rn_":"bpi_anxiousDepressedSum"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(generalizedRegressionModelBootstrapped, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">type =</span> <span class="st">"bca"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap percent confidence intervals

                             2.5 %    97.5 %
(Intercept)             1.06720638 1.3271064
bpi_antisocialT1Sum     0.42003141 0.5129344
bpi_anxiousDepressedSum 0.09482516 0.2232879</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(generalizedRegressionModelBootstrapped)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="cross-validation" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Cross Validation</h1>
<p>To examine degree of prediction error and over-fitting to determine best model</p>
<p><a href="https://stats.stackexchange.com/questions/103459/how-do-i-know-which-method-of-cross-validation-is-best" class="uri">https://stats.stackexchange.com/questions/103459/how-do-i-know-which-method-of-cross-validation-is-best</a> (archived at <a href="https://perma.cc/38BL-KLRJ" class="uri">https://perma.cc/38BL-KLRJ</a>)</p>
<section id="k-fold-cross-validation" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="k-fold-cross-validation"><span class="header-section-number">17.1</span> K-fold cross validation</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>kFolds <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>replications <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">cvFolds</span>(<span class="fu">nrow</span>(mydata), <span class="at">K =</span> kFolds, <span class="at">R =</span> replications)</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>fitLm <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>)</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>fitLmrob <span class="ot">&lt;-</span> <span class="fu">lmrob</span>(</span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>)</span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>fitLts <span class="ot">&lt;-</span> <span class="fu">ltsReg</span>(</span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>)</span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a>cvFitLm <span class="ot">&lt;-</span> <span class="fu">cvLm</span>(</span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>  fitLm,</span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> kFolds,</span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> replications)</span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a>cvFitLmrob <span class="ot">&lt;-</span> <span class="fu">cvLmrob</span>(</span>
<span id="cb162-27"><a href="#cb162-27" aria-hidden="true" tabindex="-1"></a>  fitLmrob,</span>
<span id="cb162-28"><a href="#cb162-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> kFolds,</span>
<span id="cb162-29"><a href="#cb162-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> replications)</span>
<span id="cb162-30"><a href="#cb162-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-31"><a href="#cb162-31" aria-hidden="true" tabindex="-1"></a>cvFitLts <span class="ot">&lt;-</span> <span class="fu">cvLts</span>(</span>
<span id="cb162-32"><a href="#cb162-32" aria-hidden="true" tabindex="-1"></a>  fitLts,</span>
<span id="cb162-33"><a href="#cb162-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> kFolds,</span>
<span id="cb162-34"><a href="#cb162-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> replications)</span>
<span id="cb162-35"><a href="#cb162-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-36"><a href="#cb162-36" aria-hidden="true" tabindex="-1"></a>cvFits <span class="ot">&lt;-</span> <span class="fu">cvSelect</span>(</span>
<span id="cb162-37"><a href="#cb162-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">OLS =</span> cvFitLm,</span>
<span id="cb162-38"><a href="#cb162-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">MM =</span> cvFitLmrob,</span>
<span id="cb162-39"><a href="#cb162-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">LTS =</span> cvFitLts)</span>
<span id="cb162-40"><a href="#cb162-40" aria-hidden="true" tabindex="-1"></a>cvFits</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
10-fold CV results:
  Fit       CV
1 OLS 1.980368
2  MM 1.026487
3 LTS 1.006971

Best model:
   CV 
"LTS" </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>  cvFits,</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Root Mean Square Error"</span>,</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(cvFits<span class="sc">$</span>cv<span class="sc">$</span>CV) <span class="sc">+</span> <span class="fl">0.2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="examining-model-fits" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Examining Model Fits</h1>
<section id="effect-plots" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="effect-plots"><span class="header-section-number">18.1</span> Effect Plots</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">allEffects</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> model: bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum

 bpi_antisocialT1Sum effect
bpi_antisocialT1Sum
       0      3.2      6.5      9.8       13 
1.394591 2.884283 4.420527 5.956772 7.446463 

 bpi_anxiousDepressedSum effect
bpi_anxiousDepressedSum
       0        2        4        6        8 
2.502636 2.824145 3.145653 3.467161 3.788669 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(multipleRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="confidence-ellipses" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="confidence-ellipses"><span class="header-section-number">18.2</span> Confidence Ellipses</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confidenceEllipse</span>(</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, .<span class="dv">95</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-ellipse" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="data-ellipse"><span class="header-section-number">18.3</span> Data Ellipse</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>mydata_nomissing <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)])</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dataEllipse</span>(</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  mydata_nomissing<span class="sc">$</span>bpi_antisocialT1Sum,</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  mydata_nomissing<span class="sc">$</span>bpi_antisocialT2Sum,</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, .<span class="dv">95</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="diagnostics" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Diagnostics</h1>
<section id="assumptions" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="assumptions"><span class="header-section-number">19.1</span> Assumptions</h2>
<section id="linearAssociation" class="level3" data-number="19.1.1">
<h3 data-number="19.1.1" class="anchored" data-anchor-id="linearAssociation"><span class="header-section-number">19.1.1</span> 1. Linear relation between predictors and outcome</h3>
<section id="ways-to-test" class="level4" data-number="19.1.1.1">
<h4 data-number="19.1.1.1" class="anchored" data-anchor-id="ways-to-test"><span class="header-section-number">19.1.1.1</span> Ways to Test</h4>
<section id="before-model-fitting" class="level5" data-number="19.1.1.1.1">
<h5 data-number="19.1.1.1.1" class="anchored" data-anchor-id="before-model-fitting"><span class="header-section-number">19.1.1.1.1</span> Before Model Fitting</h5>
<ul>
<li>scatterplot matrix</li>
<li>distance correlation</li>
</ul>
<section id="scatterplot-matrix" class="level6" data-number="19.1.1.1.1.1">
<h6 data-number="19.1.1.1.1.1" class="anchored" data-anchor-id="scatterplot-matrix"><span class="header-section-number">19.1.1.1.1.1</span> Scatterplot Matrix</h6>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplotMatrix</span>(</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> bpi_antisocialT2Sum <span class="sc">+</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distance-correlation" class="level6" data-number="19.1.1.1.1.2">
<h6 data-number="19.1.1.1.1.2" class="anchored" data-anchor-id="distance-correlation"><span class="header-section-number">19.1.1.1.1.2</span> Distance correlation</h6>
<p>The distance correlation is an index of the degree of the linear and non-linear association between two variables.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)],</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"distance"</span>,</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_adjust =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Parameter1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Parameter2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["r"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["t"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df_error"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Method"],"name":[10],"type":["chr"],"align":["left"]},{"label":["n_Obs"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"bpi_antisocialT1Sum","2":"bpi_antisocialT2Sum","3":"0.231721","4":"0.95","5":"0.1968321","6":"0.2660239","7":"484.0006","8":"4128499","9":"0","10":"Distance (Bias Corrected) correlation","11":"2875","_rn_":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="after-model-fitting" class="level5" data-number="19.1.1.1.2">
<h5 data-number="19.1.1.1.2" class="anchored" data-anchor-id="after-model-fitting"><span class="header-section-number">19.1.1.1.2</span> After Model Fitting</h5>
<p>Check for nonlinearities (non-horizontal line) in plots of:</p>
<ul>
<li>Residuals versus fitted values (<a href="#residualPlots">Residual Plots</a>)—best</li>
<li>Residuals versus predictors (<a href="#residualPlots">Residual Plots</a>)</li>
<li>Outcome versus fitted values (<a href="#marginalModelPlots">Marginal Model Plots</a>)</li>
<li>Outcome versus predictors, ignoring other predictors (<a href="#marginalModelPlots">Marginal Model Plots</a>)</li>
<li>Outcome versus predictors, controlling for other predictors (<a href="#addedVariablePlots">Added-Variable Plots</a>)</li>
</ul>
</section>
</section>
<section id="ways-to-handle" class="level4" data-number="19.1.1.2">
<h4 data-number="19.1.1.2" class="anchored" data-anchor-id="ways-to-handle"><span class="header-section-number">19.1.1.2</span> Ways to Handle</h4>
<ul>
<li>Transform outcome/predictor variables (Box-Cox transformations)</li>
<li>Semi-parametric regression models: Generalized additive models (GAM)</li>
<li>Non-parametric regression models: Nearest-Neighbor Kernel Regression</li>
</ul>
<section id="semi-parametric-or-non-parametric-regression-models" class="level5" data-number="19.1.1.2.1">
<h5 data-number="19.1.1.2.1" class="anchored" data-anchor-id="semi-parametric-or-non-parametric-regression-models"><span class="header-section-number">19.1.1.2.1</span> Semi-parametric or non-parametric regression models</h5>
<p><a href="http://www.lisa.stat.vt.edu/?q=node/7517" class="uri">http://www.lisa.stat.vt.edu/?q=node/7517</a> (archived at <a href="https://web.archive.org/web/20180113065042/http://www.lisa.stat.vt.edu/?q=node/7517" class="uri">https://web.archive.org/web/20180113065042/http://www.lisa.stat.vt.edu/?q=node/7517</a>)</p>
<p>Note: using semi-parametric or non-parametric models increases fit in context of nonlinearity at the expense of added complexity. Make sure to avoid fitting an overly complex model (e.g., use k-fold cross validation). Often, the simpler (generalized) linear model is preferable to semi-paremetric or non-parametric approaches</p>
<section id="semi-parametric-generalized-additive-models" class="level6" data-number="19.1.1.2.1.1">
<h6 data-number="19.1.1.2.1.1" class="anchored" data-anchor-id="semi-parametric-generalized-additive-models"><span class="header-section-number">19.1.1.2.1.1</span> Semi-parametric: Generalized Additive Models</h6>
<p><a href="http://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models" class="uri">http://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models</a> (archived at <a href="https://web.archive.org/web/20170213041653/http://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models" class="uri">https://web.archive.org/web/20170213041653/http://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models</a>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>generalizedAdditiveModel <span class="ot">&lt;-</span> <span class="fu">gam</span>(</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(generalizedAdditiveModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum

Parametric coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              1.19830    0.05983  20.029  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


R-sq.(adj) =  0.261   Deviance explained = 26.2%
GCV = 3.9191  Scale est. = 3.915     n = 2874</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(generalizedAdditiveModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `glm.control()`:
! unused arguments (nthreads = 1, ncv.threads = 1, irls.reg = 0, mgcv.tol = 1e-07, mgcv.half = 15, rank.tol = 1.49011611938477e-08, nlm = list(7, 1e-06, 2, 1e-04, 200, FALSE), optim = list(1e+07), newton = list(1e-06, 5, 2, 30, FALSE), idLinksBases = TRUE, scalePenalty = TRUE, efs.lspmax = 15, efs.tol = 0.1, keepData = FALSE, scale.est = "fletcher", edge.correct = FALSE)</code></pre>
</div>
</div>
</section>
<section id="non-parametric-nearest-neighbor-kernel-regression" class="level6" data-number="19.1.1.2.1.2">
<h6 data-number="19.1.1.2.1.2" class="anchored" data-anchor-id="non-parametric-nearest-neighbor-kernel-regression"><span class="header-section-number">19.1.1.2.1.2</span> Non-parametric: Nearest-Neighbor Kernel Regression</h6>
</section>
</section>
</section>
</section>
<section id="exogeneity" class="level3" data-number="19.1.2">
<h3 data-number="19.1.2" class="anchored" data-anchor-id="exogeneity"><span class="header-section-number">19.1.2</span> 2. Exogeneity</h3>
<p>Exogeneity means that the association between predictors and outcome is fully causal and unrelated to other variables.</p>
<section id="ways-to-test-1" class="level4" data-number="19.1.2.1">
<h4 data-number="19.1.2.1" class="anchored" data-anchor-id="ways-to-test-1"><span class="header-section-number">19.1.2.1</span> Ways to Test</h4>
<ul>
<li>Durbin-Wu-Hausman test of endogeneity</li>
</ul>
<section id="durbin-wu-hausman-test-of-endogeneity" class="level5" data-number="19.1.2.1.1">
<h5 data-number="19.1.2.1.1" class="anchored" data-anchor-id="durbin-wu-hausman-test-of-endogeneity"><span class="header-section-number">19.1.2.1.1</span> Durbin-Wu-Hausman test of endogeneity</h5>
<p>The instrumental variables (2SLS) estimator is implemented in the <code>R</code> package <code>AER</code> as command:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ivreg</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> w1 <span class="sc">+</span> w2 <span class="sc">|</span> z1 <span class="sc">+</span> z2 <span class="sc">+</span> z3 <span class="sc">+</span> w1 <span class="sc">+</span> w2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>where <code>x1</code> and <code>x2</code> are endogenous regressors, <code>w1</code> and <code>w2</code> exogeneous regressors, and <code>z1</code> to <code>z3</code> are excluded instruments.</p>
<p>Durbin-Wu-Hausman test:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>hsng2 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"https://www.stata-press.com/data/r11/hsng2.dta"</span>) <span class="co">#archived at https://perma.cc/7P2Q-ARKR</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>fiv <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  rent <span class="sc">~</span> hsngval <span class="sc">+</span> pcturban <span class="sc">|</span> pcturban <span class="sc">+</span> faminc <span class="sc">+</span> reg2 <span class="sc">+</span> reg3 <span class="sc">+</span> reg4,</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hsng2) <span class="co">#Housing values are likely endogeneous and therefore instrumented by median family income (faminc) and 3 regional dummies (reg2, reg4, reg4)</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>  fiv,</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">diagnostics =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
ivreg(formula = rent ~ hsngval + pcturban | pcturban + faminc + 
    reg2 + reg3 + reg4, data = hsng2)

Residuals:
     Min       1Q   Median       3Q      Max 
-84.1948 -11.6023  -0.5239   8.6583  73.6130 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.207e+02  1.571e+01   7.685 7.55e-10 ***
hsngval     2.240e-03  3.388e-04   6.612 3.17e-08 ***
pcturban    8.152e-02  3.082e-01   0.265    0.793    

Diagnostic tests:
                 df1 df2 statistic  p-value    
Weak instruments   4  44     13.30  3.5e-07 ***
Wu-Hausman         1  46     15.91 0.000236 ***
Sargan             3  NA     11.29 0.010268 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 22.86 on 47 degrees of freedom
Multiple R-Squared: 0.5989, Adjusted R-squared: 0.5818 
Wald test: 42.66 on 2 and 47 DF,  p-value: 2.731e-11 </code></pre>
</div>
</div>
<p>The Eicker-Huber-White covariance estimator which is robust to heteroscedastic error terms is reported after estimation with <code>vcov = sandwich</code> in <code>coeftest()</code></p>
<p>First stage results are reported by explicitly estimating them. For example:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>first <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>  hsngval <span class="sc">~</span> pcturban <span class="sc">+</span> faminc <span class="sc">+</span> reg2 <span class="sc">+</span> reg3 <span class="sc">+</span> reg4,</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hsng2)</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(first)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hsngval ~ pcturban + faminc + reg2 + reg3 + reg4, 
    data = hsng2)

Residuals:
   Min     1Q Median     3Q    Max 
-10504  -5223  -1162   2939  46756 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.867e+04  1.200e+04  -1.557 0.126736    
pcturban     1.822e+02  1.150e+02   1.584 0.120289    
faminc       2.731e+00  6.819e-01   4.006 0.000235 ***
reg2        -5.095e+03  4.122e+03  -1.236 0.223007    
reg3        -1.778e+03  4.073e+03  -0.437 0.664552    
reg4         1.341e+04  4.048e+03   3.314 0.001849 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9253 on 44 degrees of freedom
Multiple R-squared:  0.6908,    Adjusted R-squared:  0.6557 
F-statistic: 19.66 on 5 and 44 DF,  p-value: 3.032e-10</code></pre>
</div>
</div>
<p>In case of a single endogenous variable (K = 1), the F-statistic to assess weak instruments is reported after estimating the first stage with, for example:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">waldtest</span>(</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>  first,</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  . <span class="sc">~</span> . <span class="sc">-</span> faminc <span class="sc">-</span> reg2 <span class="sc">-</span> reg3 <span class="sc">-</span> reg4)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"44","2":"NA","3":"NA","4":"NA","_rn_":"1"},{"1":"48","2":"-4","3":"13.29778","4":"3.495112e-07","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>or in case of heteroscedatistic errors:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">waldtest</span>(</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>  first,</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  . <span class="sc">~</span> . <span class="sc">-</span> faminc <span class="sc">-</span> reg2 <span class="sc">-</span> reg3<span class="sc">-</span> reg4,</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> sandwich)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"44","2":"NA","3":"NA","4":"NA","_rn_":"1"},{"1":"48","2":"-4","3":"12.97475","4":"4.643466e-07","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="ways-to-handle-1" class="level4" data-number="19.1.2.2">
<h4 data-number="19.1.2.2" class="anchored" data-anchor-id="ways-to-handle-1"><span class="header-section-number">19.1.2.2</span> Ways to Handle</h4>
<ul>
<li>Conduct an experiment/RCT with random assignment</li>
<li>Instrumental variables</li>
</ul>
</section>
</section>
<section id="homoscedasticity-of-residuals" class="level3" data-number="19.1.3">
<h3 data-number="19.1.3" class="anchored" data-anchor-id="homoscedasticity-of-residuals"><span class="header-section-number">19.1.3</span> 3. Homoscedasticity of residuals</h3>
<p>Homoscedasticity of the residuals means that the variance of the residuals does not differ as a function of the outcome/predictors (i.e., the residuals show constant variance as a function of outcome/predictors).</p>
<section id="ways-to-test-2" class="level4" data-number="19.1.3.1">
<h4 data-number="19.1.3.1" class="anchored" data-anchor-id="ways-to-test-2"><span class="header-section-number">19.1.3.1</span> Ways to Test</h4>
<ul>
<li>Plot residuals vs.&nbsp;outcome and predictor variables (<a href="#residualPlots">Residual Plots</a>)</li>
<li>Plot residuals vs.&nbsp;fitted values (<a href="#residualPlots">Residual Plots</a>)</li>
<li>Time Series data: Plot residuals vs.&nbsp;time</li>
<li>Spread-level plot</li>
<li>Breusch-Pagan test: <code>bptest()</code> function from <code>lmtest</code> package</li>
<li>Goldfeld-Quandt Test</li>
</ul>
<section id="residuals-vs.-outcome-and-predictor-variables" class="level5" data-number="19.1.3.1.1">
<h5 data-number="19.1.3.1.1" class="anchored" data-anchor-id="residuals-vs.-outcome-and-predictor-variables"><span class="header-section-number">19.1.3.1.1</span> Residuals vs.&nbsp;outcome and predictor variables</h5>
<p>Plot residuals, or perhaps their absolute values, versus the outcome and predictor variables (<a href="#residualPlots">Residual Plots</a>). Examine whether residual variance is constant at all levels of other variables or whether it increases/decreases as a function of another variable (or shows some others structure, e.g., small variance at low and high levels of a predictor and high variance in the middle). Note that this is <em>different than whether the residuals show non-linearities</em>—i.e., a non-horizontal line, which would indicate a <a href="#linearAssociation">nonlinear association between variables</a> (see Assumption #1, above). Rather, here we are examining whether there is change in the variance as a function of another variable (e.g., a fan-shaped <a href="#residualPlots">Residual Plot</a>)</p>
</section>
<section id="spread-level-plot" class="level5" data-number="19.1.3.1.2">
<h5 data-number="19.1.3.1.2" class="anchored" data-anchor-id="spread-level-plot"><span class="header-section-number">19.1.3.1.2</span> Spread-level plot</h5>
<p>Examining whether level (e.g., mean) depends on spread (e.g., variance)—plot of log of the absolute Studentized residuals against the log of the fitted values</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spreadLevelPlot</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Suggested power transformation:  0.5304728 </code></pre>
</div>
</div>
</section>
<section id="breusch-pagan-test" class="level5" data-number="19.1.3.1.3">
<h5 data-number="19.1.3.1.3" class="anchored" data-anchor-id="breusch-pagan-test"><span class="header-section-number">19.1.3.1.3</span> Breusch-Pagan test</h5>
<p><a href="https://www.rdocumentation.org/packages/lmtest/versions/0.9-40/topics/bptest" class="uri">https://www.rdocumentation.org/packages/lmtest/versions/0.9-40/topics/bptest</a> (archived at <a href="https://perma.cc/K4WC-7TVW" class="uri">https://perma.cc/K4WC-7TVW</a>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  multipleRegressionModel
BP = 94.638, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="goldfeld-quandt-test" class="level5" data-number="19.1.3.1.4">
<h5 data-number="19.1.3.1.4" class="anchored" data-anchor-id="goldfeld-quandt-test"><span class="header-section-number">19.1.3.1.4</span> Goldfeld-Quandt Test</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gqtest</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Goldfeld-Quandt test

data:  multipleRegressionModel
GQ = 1.0755, df1 = 1434, df2 = 1434, p-value = 0.08417
alternative hypothesis: variance increases from segment 1 to 2</code></pre>
</div>
</div>
</section>
<section id="test-of-dependence-of-spread-on-level" class="level5" data-number="19.1.3.1.5">
<h5 data-number="19.1.3.1.5" class="anchored" data-anchor-id="test-of-dependence-of-spread-on-level"><span class="header-section-number">19.1.3.1.5</span> Test of dependence of spread on level</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncvTest</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 232.1196, Df = 1, p = &lt; 2.22e-16</code></pre>
</div>
</div>
</section>
<section id="test-of-dependence-of-spread-on-predictors" class="level5" data-number="19.1.3.1.6">
<h5 data-number="19.1.3.1.6" class="anchored" data-anchor-id="test-of-dependence-of-spread-on-predictors"><span class="header-section-number">19.1.3.1.6</span> Test of dependence of spread on predictors</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncvTest</span>(</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Non-constant Variance Score Test 
Variance formula: ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum 
Chisquare = 233.2878, Df = 2, p = &lt; 2.22e-16</code></pre>
</div>
</div>
</section>
</section>
<section id="ways-to-handle-2" class="level4" data-number="19.1.3.2">
<h4 data-number="19.1.3.2" class="anchored" data-anchor-id="ways-to-handle-2"><span class="header-section-number">19.1.3.2</span> Ways to Handle</h4>
<ul>
<li>If residual variance increases as a function of the fitted values, consider a poisson regression model (especially for count data), for which the variance does increase with the mean</li>
<li>If residual variance differs as a function of model predictors, consider adding interactions/product terms (the effect of one variable depends on the level of another variable)</li>
<li>Try transforming the outcome variable to be normally distributed (log-transform if the errors seem consistent in percentage rather than absolute terms)</li>
<li>If the error variance is proportional to a variable <span class="math inline">\(z\)</span>, then fit the model using Weighted Least Squares (WLS), with the weights given be <span class="math inline">\(1/z\)</span></li>
<li>Weighted least squares (WLS) using the “weights” argument of the <code>lm()</code> function; to get weights, see: <a href="https://stats.stackexchange.com/a/100410/20338" class="uri">https://stats.stackexchange.com/a/100410/20338</a> (archived at <a href="https://perma.cc/C6BY-G9MS" class="uri">https://perma.cc/C6BY-G9MS</a>)</li>
<li>Huber-White standard errors (a.k.a. “Sandwich” estimates) from a heteroscedasticity-corrected covariance matrix
<ul>
<li><code>coeftest()</code> function from the <code>sandwich</code> package along with hccm sandwich estimates from the <code>car</code> package</li>
<li><code>robcov()</code> function from the <code>rms</code> package</li>
</ul></li>
<li>Time series data: ARCH (auto-regressive conditional heteroscedasticity) models</li>
<li>Time series data: seasonal patterns can be addressed by applying log transformation to outcome variable</li>
</ul>
<section id="huber-white-standard-errors" class="level5" data-number="19.1.3.2.1">
<h5 data-number="19.1.3.2.1" class="anchored" data-anchor-id="huber-white-standard-errors"><span class="header-section-number">19.1.3.2.1</span> Huber-White standard errors</h5>
<p>Standard errors (SEs) on the diagonal increase</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          (Intercept) bpi_antisocialT1Sum
(Intercept)              0.0035795220       -0.0006533375
bpi_antisocialT1Sum     -0.0006533375        0.0003453814
bpi_anxiousDepressedSum -0.0003167540       -0.0002574524
                        bpi_anxiousDepressedSum
(Intercept)                       -0.0003167540
bpi_antisocialT1Sum               -0.0002574524
bpi_anxiousDepressedSum            0.0008501565</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hccm</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `V %*% t(X) %*% apply(X, 2, "*", (e^2) / factor)`:
! non-conformable arguments</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.3755 -1.2337 -0.2212  0.9911 12.8017 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              1.19830    0.05983  20.029  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.979 on 2871 degrees of freedom
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.262, Adjusted R-squared:  0.2615 
F-statistic: 509.6 on 2 and 2871 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(multipleRegressionModel, <span class="at">vcov =</span> sandwich)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

                        Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)             1.198300   0.062211 19.2618 &lt; 2.2e-16 ***
bpi_antisocialT1Sum     0.465529   0.022929 20.3030 &lt; 2.2e-16 ***
bpi_anxiousDepressedSum 0.160754   0.032991  4.8727  1.16e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(multipleRegressionModel, <span class="at">vcov =</span> hccm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `V %*% t(X) %*% apply(X, 2, "*", (e^2) / factor)`:
! non-conformable arguments</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">robcov</span>(<span class="fu">ols</span>(</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
    bpi_antisocialT2Sum     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
                   7501                    7613                    7616 

Linear Regression Model

ols(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, x = TRUE, y = TRUE)

                Model Likelihood    Discrimination    
                      Ratio Test           Indexes    
Obs    2874    LR chi2    873.09    R2       0.262    
sigma1.9786    d.f.            2    R2 adj   0.261    
d.f.   2871    Pr(&gt; chi2) 0.0000    g        1.278    

Residuals

    Min      1Q  Median      3Q     Max 
-8.3755 -1.2337 -0.2212  0.9911 12.8017 

                        Coef   S.E.   t     Pr(&gt;|t|)
Intercept               1.1983 0.0622 19.26 &lt;0.0001 
bpi_antisocialT1Sum     0.4655 0.0229 20.30 &lt;0.0001 
bpi_anxiousDepressedSum 0.1608 0.0330  4.87 &lt;0.0001 </code></pre>
</div>
</div>
<p>Use “cluster” variable to account for nested data within-subject:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">robcov</span>(<span class="fu">ols</span>(</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>  t_ext <span class="sc">~</span> m_ext <span class="sc">+</span> age,</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>),</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster =</span> mydata<span class="sc">$</span>tcid) <span class="co">#account for nested data within subject</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
</section>
<section id="errors-are-independent" class="level3" data-number="19.1.4">
<h3 data-number="19.1.4" class="anchored" data-anchor-id="errors-are-independent"><span class="header-section-number">19.1.4</span> 4. Errors are independent</h3>
<p>Independent errors means that the errors are uncorrelated with each other.</p>
<section id="ways-to-test-3" class="level4" data-number="19.1.4.1">
<h4 data-number="19.1.4.1" class="anchored" data-anchor-id="ways-to-test-3"><span class="header-section-number">19.1.4.1</span> Ways to Test</h4>
<ul>
<li>Intraclass correlation coefficient (ICC) from mixed model</li>
<li>Plot residuals vs.&nbsp;predictors (<a href="#residualPlots">Residual Plots</a>)</li>
<li>Time Series data: Residual time series plot (residuals vs.&nbsp;row number)</li>
<li>Time Series data: Table or plot of residual autocorrelations</li>
<li>Time Series data: Durbin-Watson statistic for test of significant residual autocorrelation at lag 1</li>
</ul>
</section>
<section id="ways-to-handle-3" class="level4" data-number="19.1.4.2">
<h4 data-number="19.1.4.2" class="anchored" data-anchor-id="ways-to-handle-3"><span class="header-section-number">19.1.4.2</span> Ways to Handle</h4>
<ul>
<li>Generalized least squares (GLS) models are capable of handling correlated errors: <a href="https://stat.ethz.ch/R-manual/R-devel/library/nlme/html/gls.html" class="uri">https://stat.ethz.ch/R-manual/R-devel/library/nlme/html/gls.html</a> (archived at <a href="https://perma.cc/RHZ6-5GT8" class="uri">https://perma.cc/RHZ6-5GT8</a>)</li>
<li>Regression with cluster variable
<ul>
<li><code>robcov()</code> from <code>rms</code> package</li>
</ul></li>
<li><a href="./hlm.html">Hierarchical linear modeling</a>
<ul>
<li><a href="./hlm.html#linear">Linear mixed effects models</a></li>
<li><a href="./hlm.html#generalized">Generalized linear mixed effects models</a></li>
<li><a href="./hlm.html#nonlinear">Nonlinear mixed effects models</a></li>
</ul></li>
</ul>
</section>
</section>
<section id="no-multicollinearity" class="level3" data-number="19.1.5">
<h3 data-number="19.1.5" class="anchored" data-anchor-id="no-multicollinearity"><span class="header-section-number">19.1.5</span> 5. No multicollinearity</h3>
<p>Multicollinearity occurs when the predictors are correlated with each other.</p>
<section id="ways-to-test-4" class="level4" data-number="19.1.5.1">
<h4 data-number="19.1.5.1" class="anchored" data-anchor-id="ways-to-test-4"><span class="header-section-number">19.1.5.1</span> Ways to Test</h4>
<ul>
<li>Variance Inflation Factor (VIF)</li>
<li>Generalized Variance Inflation Factor (GVIF)—when models have related regressors (multiple polynomial terms or contrasts from same predictor)</li>
<li>Correlation</li>
<li>Tolerance</li>
<li>Condition Index</li>
</ul>
<section id="variance-inflation-factor-vif" class="level5" data-number="19.1.5.1.1">
<h5 data-number="19.1.5.1.1" class="anchored" data-anchor-id="variance-inflation-factor-vif"><span class="header-section-number">19.1.5.1.1</span> Variance Inflation Factor (VIF)</h5>
<p><span class="math display">\[
\text{VIF} = 1/\text{Tolerance}
\]</span></p>
<p>If the variance inflation factor of a predictor variable were 5.27 (<span class="math inline">\(\sqrt{5.27} = 2.3\)</span>), this means that the standard error for the coefficient of that predictor variable is 2.3 times as large (i.e., confidence interval is 2.3 times wider) as it would be if that predictor variable were uncorrelated with the other predictor variables.</p>
<p>VIF = 1: Not correlated<br>
1 &lt; VIF &lt; 5: Moderately correlated<br>
VIF &gt; 5 to 10: Highly correlated (multicollinearity present)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    bpi_antisocialT1Sum bpi_anxiousDepressedSum 
               1.291545                1.291545 </code></pre>
</div>
</div>
</section>
<section id="generalized-variance-inflation-factor-gvif" class="level5" data-number="19.1.5.1.2">
<h5 data-number="19.1.5.1.2" class="anchored" data-anchor-id="generalized-variance-inflation-factor-gvif"><span class="header-section-number">19.1.5.1.2</span> Generalized Variance Inflation Factor (GVIF)</h5>
<p>Useful when models have related regressors (multiple polynomial terms or contrasts from same predictor)</p>
</section>
<section id="correlation" class="level5" data-number="19.1.5.1.3">
<h5 data-number="19.1.5.1.3" class="anchored" data-anchor-id="correlation"><span class="header-section-number">19.1.5.1.3</span> Correlation</h5>
<p>correlation among all independent variables the correlation coefficients should be smaller than .08</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span>)],</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                        bpi_antisocialT1Sum bpi_anxiousDepressedSum
bpi_antisocialT1Sum                1.000000                0.497279
bpi_anxiousDepressedSum            0.497279                1.000000</code></pre>
</div>
</div>
</section>
<section id="tolerance" class="level5" data-number="19.1.5.1.4">
<h5 data-number="19.1.5.1.4" class="anchored" data-anchor-id="tolerance"><span class="header-section-number">19.1.5.1.4</span> Tolerance</h5>
<p>The tolerance is an index of the influence of one independent variable on all other independent variables.</p>
<p><span class="math display">\[
\text{tolerance} = 1/\text{VIF}
\]</span></p>
<p>T &lt; 0.2: there might be multicollinearity in the data<br>
T &lt; 0.01: there certainly is multicollinarity in the data</p>
</section>
<section id="condition-index" class="level5" data-number="19.1.5.1.5">
<h5 data-number="19.1.5.1.5" class="anchored" data-anchor-id="condition-index"><span class="header-section-number">19.1.5.1.5</span> Condition Index</h5>
<p>The condition index is calculated using a factor analysis on the independent variables. Values of 10-30 indicate a mediocre multicollinearity in the regression variables. Values &gt; 30 indicate strong multicollinearity.</p>
<p>For how to interpret, see here: <a href="https://stats.stackexchange.com/a/87610/20338" class="uri">https://stats.stackexchange.com/a/87610/20338</a> (archived at <a href="https://perma.cc/Y4J8-MY7Q" class="uri">https://perma.cc/Y4J8-MY7Q</a>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_eigen_cindex</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Eigenvalue"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Condition Index"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["intercept"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["bpi_antisocialT1Sum"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["bpi_anxiousDepressedSum"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2.4393975","2":"1.000000","3":"0.05150939","4":"0.04435009","5":"0.05806627"},{"1":"0.3575629","2":"2.611951","3":"0.40330814","4":"0.01600701","5":"0.75801976"},{"1":"0.2030395","2":"3.466179","3":"0.54518247","4":"0.93964290","5":"0.18391397"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="ways-to-handle-4" class="level4" data-number="19.1.5.2">
<h4 data-number="19.1.5.2" class="anchored" data-anchor-id="ways-to-handle-4"><span class="header-section-number">19.1.5.2</span> Ways to Handle</h4>
<ul>
<li>Remove highly correlated (i.e., redundant) predictors</li>
<li>Average the correlated predictors</li>
<li><a href="./pca.html">Principal Component Analysis</a> for data reduction</li>
<li>Standardize predictors</li>
<li>Center the data (deduct the mean)</li>
<li>Singular-value decomposition of the model matrix or the mean-centered model matrix</li>
<li>Conduct a <a href="#factorAnalysis.qmd">factor analysis</a> and rotate the factors to ensure independence of the factors</li>
</ul>
</section>
</section>
<section id="errors-are-normally-distributed" class="level3" data-number="19.1.6">
<h3 data-number="19.1.6" class="anchored" data-anchor-id="errors-are-normally-distributed"><span class="header-section-number">19.1.6</span> 6. Errors are normally distributed</h3>
<section id="ways-to-test-5" class="level4" data-number="19.1.6.1">
<h4 data-number="19.1.6.1" class="anchored" data-anchor-id="ways-to-test-5"><span class="header-section-number">19.1.6.1</span> Ways to Test</h4>
<ul>
<li>Probability Plots
<ul>
<li><a href="#qqPlot">Normal Quantile (QQ) Plots</a> (based on non-cumulative distribution of residuals)</li>
<li><a href="#ppPlot">Normal Probability (PP) Plots</a> (based on cumulative distribution of residuals)</li>
</ul></li>
<li><a href="#densityPlotResiduals">Density Plot of Residuals</a></li>
<li>Statistical Tests
<ul>
<li>Kolmogorov-Smirnov test</li>
<li>Shapiro-Wilk test</li>
<li>Jarque-Bera test</li>
<li>Anderson-Darling test (best test)</li>
</ul></li>
<li>Examine influence of outliers</li>
</ul>
</section>
<section id="ways-to-handle-5" class="level4" data-number="19.1.6.2">
<h4 data-number="19.1.6.2" class="anchored" data-anchor-id="ways-to-handle-5"><span class="header-section-number">19.1.6.2</span> Ways to Handle</h4>
<ul>
<li>Apply a transformation to the predictor or outcome variable</li>
<li>Exclude outliers</li>
<li>Robust regression
<ul>
<li>Best when no outliers: MM-type regression estimator
<ul>
<li><code>lmrob()</code>/<code>glmrob()</code> function of <code>robustbase</code> package</li>
<li>Iteratively reweighted least squares (IRLS): <code>rlm(, method = "MM")</code> function of <code>MASS</code> package: <a href="http://www.ats.ucla.edu/stat/r/dae/rreg.htm" class="uri">http://www.ats.ucla.edu/stat/r/dae/rreg.htm</a> (archived at <a href="https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm" class="uri">https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm</a>)</li>
</ul></li>
<li>Most resistant to outliers: Least trimmed squares (LTS)—but not good as a standalone estimator, better for identifying outliers
<ul>
<li><code>ltsReg()</code> function of <code>robustbase</code> package (best)</li>
</ul></li>
<li>Best when single predictor: Theil-Sen estimator
<ul>
<li><code>mblm(, repeated = FALSE)</code> function of <code>mblm</code> package</li>
</ul></li>
<li>Robust correlation
<ul>
<li>Spearman’s rho: <code>cor(, method = "spearman")</code></li>
<li>Percentage bend correlation</li>
<li>Minimum vollume ellipsoid</li>
<li>Minimum covariance determinant:</li>
<li>Winsorized correlation</li>
<li>Biweight midcorrelation</li>
<li>Xi (<span class="math inline">\(\xi\)</span>) correlation</li>
</ul></li>
<li>Not great options:
<ul>
<li>Quantile (L1) regression: <code>rq()</code> function of <code>quantreg</code> package</li>
</ul></li>
</ul></li>
</ul>
<section id="transformations-of-outcome-variable" class="level5" data-number="19.1.6.2.1">
<h5 data-number="19.1.6.2.1" class="anchored" data-anchor-id="transformations-of-outcome-variable"><span class="header-section-number">19.1.6.2.1</span> Transformations of Outcome Variable</h5>
<section id="box-cox-transformation" class="level6" data-number="19.1.6.2.1.1">
<h6 data-number="19.1.6.2.1.1" class="anchored" data-anchor-id="box-cox-transformation"><span class="header-section-number">19.1.6.2.1.1</span> Box-Cox Transformation</h6>
<p>Useful if the outcome is strictly positive (or add a constant to outcome to make it strictly positive)</p>
<p>lambda = -1: inverse transformation<br>
lambda = -0.5: 1/sqrt(Y)<br>
lambda = 0: log transformation<br>
lambda = 0.5: square root<br>
lambda = 0.333: cube root<br>
lambda = 1: no transformation<br>
lambda = 2: squared<br>
</p>
<section id="raw-distribution" class="level7">
<p class="heading">Raw distribution</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">na.omit</span>(mydata<span class="sc">$</span>bpi_antisocialT2Sum)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="add-constant-to-outcome-to-make-it-strictly-positive" class="level7">
<p class="heading">Add constant to outcome to make it strictly positive</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>strictlyPositiveDV <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">+</span> <span class="dv">1</span> <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="identify-best-power-transformation-lambda" class="level7">
<p class="heading">Identify best power transformation (lambda)</p>
<p>Consider rounding the power to a common value (square root = .5; cube root = .333; squared = 2)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxCox</span>(strictlyPositiveDV)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">powerTransform</span>(strictlyPositiveDV) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated transformation parameter 
      Y1 
0.234032 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>transformedDV <span class="ot">&lt;-</span> <span class="fu">powerTransform</span>(strictlyPositiveDV)</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(transformedDV)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>bcPower Transformation to Normality 
   Est Power Rounded Pwr Wald Lwr Bnd Wald Upr Bnd
Y1     0.234        0.23       0.1825       0.2856

Likelihood ratio test that transformation parameter is equal to 0
 (log transformation)
                           LRT df       pval
LR test, lambda = (0) 78.04052  1 &lt; 2.22e-16

Likelihood ratio test that no transformation is needed
                           LRT df       pval
LR test, lambda = (1) 853.8675  1 &lt; 2.22e-16</code></pre>
</div>
</div>
</section>
<section id="transform-the-dv" class="level7">
<p class="heading">Transform the DV</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>bpi_antisocialT2SumTransformed <span class="ot">&lt;-</span> <span class="fu">bcPower</span>(mydata<span class="sc">$</span>bpi_antisocialT2Sum <span class="sc">+</span> <span class="dv">1</span>, <span class="fu">coef</span>(transformedDV))</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">na.omit</span>(mydata<span class="sc">$</span>bpi_antisocialT2SumTransformed)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="compare-residuals-from-model-with-and-without-transformation" class="level7">
<p class="heading">Compare residuals from model with and without transformation</p>
<section id="model-without-transformation" class="level8">
<p class="heading">Model without transformation</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelWithoutTransformation <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">+</span> <span class="dv">1</span> <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bpi_antisocialT2Sum + 1 ~ bpi_antisocialT1Sum + 
    bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.3755 -1.2337 -0.2212  0.9911 12.8017 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              2.19830    0.05983  36.743  &lt; 2e-16 ***
bpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***
bpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.979 on 2871 degrees of freedom
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.262, Adjusted R-squared:  0.2615 
F-statistic: 509.6 on 2 and 2871 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">na.omit</span>(<span class="fu">studres</span>(modelWithoutTransformation))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-with-transformation" class="level8">
<p class="heading">Model with transformation</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelWithTransformation <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2SumTransformed <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bpi_antisocialT2SumTransformed ~ bpi_antisocialT1Sum + 
    bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.3429 -0.4868  0.0096  0.4922  2.9799 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             0.800373   0.022024  36.342  &lt; 2e-16 ***
bpi_antisocialT1Sum     0.165476   0.006841  24.189  &lt; 2e-16 ***
bpi_anxiousDepressedSum 0.055910   0.010733   5.209 2.03e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7283 on 2871 degrees of freedom
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.2477,    Adjusted R-squared:  0.2472 
F-statistic: 472.7 on 2 and 2871 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">na.omit</span>(<span class="fu">studres</span>(modelWithTransformation))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="constructed-variable-test-plot" class="level7">
<p class="heading">Constructed Variable Test &amp; Plot</p>
<p>A significant <em>p</em>-value indicates a strong need to transform variable:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_constructedVariable <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>  . <span class="sc">~</span> . <span class="sc">+</span> <span class="fu">boxCoxVariable</span>(bpi_antisocialT1Sum <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel_constructedVariable)<span class="sc">$</span>coef[<span class="st">"boxCoxVariable(bpi_antisocialT1Sum + 1)"</span>, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                           Estimate Std. Error   t value
boxCoxVariable(bpi_antisocialT1Sum + 1) -0.06064732 0.04683415 -1.294938
                                         Pr(&gt;|t|)
boxCoxVariable(bpi_antisocialT1Sum + 1) 0.1954457</code></pre>
</div>
</div>
<p>Plot allows us to see whether the need for transformation is spread through data or whether it is just dependent on a small fraction of observations:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(multipleRegressionModel_constructedVariable, <span class="st">"boxCoxVariable(bpi_antisocialT1Sum + 1)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="inverse-response-plot" class="level7">
<p class="heading">Inverse Response Plot</p>
<p>The black line is the best-fitting power transformation:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inverseResponsePlot</span>(strictlyPositiveDV, <span class="at">lambda =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["lambda"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.8481126","2":"2940.938"},{"1":"-1.0000000","2":"3329.131"},{"1":"-0.5000000","2":"3189.376"},{"1":"0.0000000","2":"3052.679"},{"1":"0.3333333","2":"2984.003"},{"1":"0.5000000","2":"2960.827"},{"1":"1.0000000","2":"2944.657"},{"1":"2.0000000","2":"3116.590"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="yeo-johnson-transformations" class="level6" data-number="19.1.6.2.1.2">
<h6 data-number="19.1.6.2.1.2" class="anchored" data-anchor-id="yeo-johnson-transformations"><span class="header-section-number">19.1.6.2.1.2</span> Yeo-Johnson Transformations</h6>
<p>Useful if the outcome is not strictly positive.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">yjPower</span>(DV, lambda)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="transformations-of-predictor-variable" class="level5" data-number="19.1.6.2.2">
<h5 data-number="19.1.6.2.2" class="anchored" data-anchor-id="transformations-of-predictor-variable"><span class="header-section-number">19.1.6.2.2</span> Transformations of Predictor Variable</h5>
<section id="component-plus-residual-plots-partial-residual-plots" class="level6" data-number="19.1.6.2.2.1">
<h6 data-number="19.1.6.2.2.1" class="anchored" data-anchor-id="component-plus-residual-plots-partial-residual-plots"><span class="header-section-number">19.1.6.2.2.1</span> Component-Plus-Residual Plots (Partial Residual Plots)</h6>
<p>Linear model:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crPlots</span>(multipleRegressionModelNoMissing, <span class="at">order =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Quadratic model:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crPlots</span>(multipleRegressionModelNoMissing, <span class="at">order =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_quadratic <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> <span class="fu">I</span>(bpi_antisocialT1Sum<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel_quadratic)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + I(bpi_antisocialT1Sum^2) + 
    bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.6238 -1.2610 -0.2484  0.9923 12.9008 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               1.099237   0.076509  14.367  &lt; 2e-16 ***
bpi_antisocialT1Sum       0.547680   0.043723  12.526  &lt; 2e-16 ***
I(bpi_antisocialT1Sum^2) -0.010221   0.004925  -2.075    0.038 *  
bpi_anxiousDepressedSum   0.161734   0.029144   5.549 3.13e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.977 on 2870 degrees of freedom
  (8656 observations deleted due to missingness)
Multiple R-squared:  0.2631,    Adjusted R-squared:  0.2623 
F-statistic: 341.5 on 3 and 2870 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_quadratic,</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"2870","2":"11223.01","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"2871","2":"11239.86","3":"-1","4":"-16.84449","5":"4.307551","6":"0.03803241","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crPlots</span>(multipleRegressionModel_quadratic, <span class="at">order =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ceres-plot-combining-conditional-expectations-and-residuals" class="level6" data-number="19.1.6.2.2.2">
<h6 data-number="19.1.6.2.2.2" class="anchored" data-anchor-id="ceres-plot-combining-conditional-expectations-and-residuals"><span class="header-section-number">19.1.6.2.2.2</span> CERES Plot (Combining conditional Expectations and RESiduals)</h6>
<p>Useful when nonlinear associations among the predictors are very strong (component-plus-residual plots may appear nonlinear even though the true partial regression is linear, a phenonomen called leakage)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceresPlots</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceresPlots</span>(multipleRegressionModel_quadratic)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `plot.window()`:
! need finite 'ylim' values</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-86-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="box-tidwell-method-for-choosing-predictor-transformations" class="level6" data-number="19.1.6.2.2.3">
<h6 data-number="19.1.6.2.2.3" class="anchored" data-anchor-id="box-tidwell-method-for-choosing-predictor-transformations"><span class="header-section-number">19.1.6.2.2.3</span> Box-Tidwell Method for Choosing Predictor Transformations</h6>
<p>predictors must be strictly positive (or add a constant to make it strictly positive)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxTidwell</span>(</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> <span class="fu">I</span>(bpi_antisocialT1Sum <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">I</span>(bpi_anxiousDepressedSum <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">other.x =</span> <span class="cn">NULL</span>, <span class="co">#list variables not to be transformed in other.x</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                               MLE of lambda Score Statistic (t) Pr(&gt;|t|)
I(bpi_antisocialT1Sum + 1)           0.90820             -1.0591   0.2897
I(bpi_anxiousDepressedSum + 1)       0.36689             -1.0650   0.2870

iterations =  4 

Score test for null hypothesis that all lambdas = 1:
F = 1.4056, df = 2 and 2869, Pr(&gt;F) = 0.2454</code></pre>
</div>
</div>
</section>
<section id="constructed-variables-plot" class="level6" data-number="19.1.6.2.2.4">
<h6 data-number="19.1.6.2.2.4" class="anchored" data-anchor-id="constructed-variables-plot"><span class="header-section-number">19.1.6.2.2.4</span> Constructed-Variables Plot</h6>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_cv <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> <span class="fu">I</span>(bpi_antisocialT1Sum <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">I</span>(bpi_anxiousDepressedSum <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">I</span>(bpi_antisocialT1Sum <span class="sc">*</span> <span class="fu">log</span>(bpi_antisocialT1Sum)) <span class="sc">+</span> <span class="fu">I</span>(bpi_anxiousDepressedSum <span class="sc">*</span> <span class="fu">log</span>(bpi_anxiousDepressedSum)),</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel_cv)<span class="sc">$</span>coef[<span class="st">"I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum))"</span>, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                    Estimate Std. Error
I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum)) -0.1691003 0.06887107
                                                    t value   Pr(&gt;|t|)
I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum)) -2.455317 0.01418393</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel_cv)<span class="sc">$</span>coef[<span class="st">"I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum))"</span>, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                            Estimate Std. Error
I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum)) 0.00828867  0.1384918
                                                             t value  Pr(&gt;|t|)
I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum)) 0.05984953 0.9522831</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(multipleRegressionModel_cv, <span class="st">"I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum))"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(multipleRegressionModel_cv, <span class="st">"I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum))"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-88-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="robust-models" class="level5" data-number="19.1.6.2.3">
<h5 data-number="19.1.6.2.3" class="anchored" data-anchor-id="robust-models"><span class="header-section-number">19.1.6.2.3</span> Robust models</h5>
<p>Resources</p>
<ul>
<li>For comparison of methods, see Book: “Modern Methods for Robust Regression”</li>
<li><a href="http://www.ats.ucla.edu/stat/r/dae/rreg.htm" class="uri">http://www.ats.ucla.edu/stat/r/dae/rreg.htm</a> (archived at <a href="https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm" class="uri">https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm</a>)</li>
<li><a href="https://stats.stackexchange.com/a/46234/20338" class="uri">https://stats.stackexchange.com/a/46234/20338</a> (archived at <a href="https://perma.cc/WC57-9GA7" class="uri">https://perma.cc/WC57-9GA7</a>)</li>
<li><a href="https://cran.r-project.org/web/views/Robust.html" class="uri">https://cran.r-project.org/web/views/Robust.html</a> (archived at <a href="https://perma.cc/THN5-KNY3" class="uri">https://perma.cc/THN5-KNY3</a>)</li>
</ul>
<section id="robust-correlation" class="level6" data-number="19.1.6.2.3.1">
<h6 data-number="19.1.6.2.3.1" class="anchored" data-anchor-id="robust-correlation"><span class="header-section-number">19.1.6.2.3.1</span> Robust correlation</h6>
<section id="spearmans-rho" class="level7">
<p class="heading">Spearman’s rho</p>
<p>Spearman’s rho is a non-parametric correlation.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT1Sum,</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT2Sum) <span class="co">#Pearson r, correlation that is sensitive to outliers</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  mydata$bpi_antisocialT1Sum and mydata$bpi_antisocialT2Sum
t = 31.274, df = 2873, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.4761758 0.5307381
sample estimates:
      cor 
0.5039595 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT1Sum,</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT2Sum, <span class="at">method =</span> <span class="st">"spearman"</span>) <span class="co">#Spearman's rho, a rank correlation that is less sensitive to outliers</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  mydata$bpi_antisocialT1Sum and mydata$bpi_antisocialT2Sum
S = 1997347186, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.4956973 </code></pre>
</div>
</div>
</section>
<section id="minimum-vollume-ellipsoid" class="level7">
<p class="heading">Minimum vollume ellipsoid</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov.mve</span>(</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)]),</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$center
bpi_antisocialT1Sum bpi_antisocialT2Sum 
           2.272655            2.248461 

$cov
                    bpi_antisocialT1Sum bpi_antisocialT2Sum
bpi_antisocialT1Sum            2.587323            1.404446
bpi_antisocialT2Sum            1.404446            3.007363

$msg
[1] "143 singular samples of size 3 out of 1500"

$crit
[1] 3.943936

$best
   [1]    1    3    8    9   10   12   13   14   15   16   17   18   19   21
  [15]   22   23   24   32   39   40   42   43   44   46   48   50   51   55
  [29]   56   57   60   61   65   67   70   71   73   76   79   80   81   82
  [43]   86   87   88   93   94   95   97   98   99  102  104  105  106  107
  [57]  108  116  117  119  120  121  122  123  124  129  130  131  132  133
  [71]  134  138  139  140  142  143  145  146  148  149  150  153  154  155
  [85]  160  161  164  166  168  170  176  177  178  179  180  181  182  183
  [99]  184  187  188  190  191  192  194  195  196  197  198  200  201  205
 [113]  206  207  209  213  214  227  228  229  231  232  233  234  235  236
 [127]  237  238  239  241  242  243  244  245  246  247  248  249  251  253
 [141]  254  255  256  261  263  265  268  272  275  281  282  284  288  289
 [155]  290  293  294  295  296  297  298  299  300  301  304  307  308  310
 [169]  313  315  329  330  331  332  333  334  335  339  341  342  343  345
 [183]  350  357  359  364  367  370  371  374  376  379  380  381  382  386
 [197]  387  388  389  390  391  397  399  403  404  407  408  409  410  411
 [211]  413  416  421  422  423  425  426  430  431  432  435  438  440  441
 [225]  442  443  444  445  448  449  450  451  453  454  455  456  459  461
 [239]  462  463  464  466  468  469  471  473  474  477  478  480  483  484
 [253]  486  493  495  497  498  499  501  502  503  504  505  506  507  509
 [267]  510  513  518  519  520  521  522  523  524  525  527  528  529  531
 [281]  532  533  534  535  536  537  538  539  541  543  545  546  550  553
 [295]  554  557  564  566  568  572  578  579  582  583  585  599  600  605
 [309]  608  609  610  615  616  617  618  619  620  621  622  623  625  626
 [323]  627  631  633  634  635  636  637  639  641  642  643  646  647  648
 [337]  649  650  660  661  662  667  670  673  674  675  676  679  680  681
 [351]  682  683  685  687  691  693  696  701  705  706  707  710  713  714
 [365]  715  717  718  719  720  721  722  723  728  730  732  733  734  737
 [379]  741  742  743  744  745  746  747  751  752  758  762  763  764  765
 [393]  769  772  774  776  779  780  782  783  785  786  789  791  798  799
 [407]  801  803  805  806  808  809  810  811  812  813  814  817  818  819
 [421]  822  824  826  827  828  829  832  834  836  837  838  839  840  843
 [435]  847  848  849  854  857  858  859  860  862  865  866  867  868  869
 [449]  871  872  873  874  877  880  881  888  889  892  893  895  898  899
 [463]  900  902  903  904  905  906  907  909  912  913  914  918  919  920
 [477]  921  923  925  926  927  928  931  932  933  934  935  936  937  939
 [491]  940  943  944  946  949  950  951  954  955  956  957  960  962  964
 [505]  965  967  970  972  973  974  975  976  977  980  983  985  987  988
 [519]  990  998 1001 1002 1003 1004 1005 1006 1007 1008 1013 1014 1015 1016
 [533] 1017 1021 1022 1023 1024 1025 1026 1027 1029 1030 1032 1034 1036 1037
 [547] 1040 1041 1043 1044 1047 1050 1051 1054 1055 1057 1058 1061 1062 1064
 [561] 1065 1066 1067 1072 1075 1076 1079 1083 1086 1087 1088 1091 1094 1095
 [575] 1097 1101 1105 1109 1111 1112 1113 1114 1115 1119 1121 1123 1124 1125
 [589] 1128 1129 1136 1138 1139 1144 1145 1146 1147 1148 1149 1150 1152 1154
 [603] 1158 1160 1162 1163 1164 1165 1171 1172 1176 1177 1178 1179 1180 1181
 [617] 1182 1184 1185 1186 1187 1188 1189 1197 1198 1200 1201 1203 1205 1206
 [631] 1207 1208 1214 1215 1216 1217 1218 1219 1220 1221 1223 1225 1229 1230
 [645] 1231 1232 1233 1234 1235 1242 1243 1244 1245 1246 1247 1248 1249 1250
 [659] 1251 1254 1255 1259 1261 1262 1263 1265 1266 1267 1269 1271 1272 1274
 [673] 1275 1276 1280 1282 1283 1284 1285 1287 1288 1290 1291 1292 1293 1294
 [687] 1296 1299 1301 1303 1304 1306 1309 1310 1311 1312 1314 1315 1316 1318
 [701] 1319 1320 1322 1323 1325 1326 1333 1334 1336 1337 1338 1339 1341 1343
 [715] 1344 1346 1347 1348 1349 1350 1352 1353 1354 1355 1357 1358 1359 1360
 [729] 1361 1362 1363 1365 1366 1369 1370 1371 1372 1373 1374 1375 1377 1381
 [743] 1382 1383 1387 1388 1389 1390 1391 1395 1396 1397 1398 1399 1400 1401
 [757] 1405 1408 1412 1413 1414 1417 1419 1421 1422 1423 1426 1428 1430 1432
 [771] 1433 1434 1438 1439 1440 1444 1445 1447 1448 1449 1456 1458 1459 1464
 [785] 1467 1469 1471 1479 1483 1484 1485 1486 1489 1495 1499 1500 1502 1506
 [799] 1508 1513 1514 1515 1516 1518 1519 1521 1522 1524 1525 1527 1531 1532
 [813] 1533 1534 1535 1536 1537 1539 1540 1541 1542 1543 1544 1545 1547 1549
 [827] 1551 1554 1560 1561 1563 1565 1569 1571 1572 1575 1576 1577 1583 1585
 [841] 1586 1588 1589 1590 1591 1592 1593 1594 1595 1596 1597 1598 1600 1602
 [855] 1604 1605 1611 1612 1613 1614 1617 1621 1623 1625 1626 1627 1634 1640
 [869] 1641 1644 1656 1657 1661 1664 1672 1673 1674 1675 1677 1686 1687 1689
 [883] 1690 1691 1692 1694 1699 1701 1705 1708 1709 1710 1711 1712 1713 1714
 [897] 1716 1719 1721 1722 1724 1731 1732 1738 1742 1750 1753 1754 1757 1759
 [911] 1760 1761 1763 1764 1765 1766 1770 1772 1774 1775 1778 1780 1781 1791
 [925] 1795 1797 1798 1801 1802 1803 1804 1806 1807 1809 1812 1813 1815 1817
 [939] 1818 1821 1824 1827 1834 1835 1836 1837 1840 1846 1847 1848 1849 1850
 [953] 1851 1852 1855 1859 1860 1863 1864 1866 1867 1868 1870 1881 1884 1888
 [967] 1890 1892 1902 1904 1915 1921 1924 1925 1926 1927 1932 1933 1935 1936
 [981] 1938 1940 1943 1947 1948 1950 1951 1954 1955 1956 1957 1960 1961 1962
 [995] 1963 1966 1967 1969 1970 1971 1972 1973 1974 1979 1981 1982 1984 1986
[1009] 1990 1992 1993 1994 1995 1999 2002 2005 2006 2011 2012 2013 2017 2019
[1023] 2021 2022 2027 2029 2032 2034 2036 2038 2042 2043 2045 2049 2051 2053
[1037] 2054 2055 2059 2061 2062 2063 2068 2069 2070 2071 2073 2074 2076 2077
[1051] 2078 2079 2080 2081 2082 2083 2084 2085 2086 2087 2088 2089 2094 2096
[1065] 2097 2099 2100 2101 2102 2104 2105 2106 2108 2110 2112 2113 2114 2116
[1079] 2117 2118 2119 2123 2124 2125 2127 2129 2130 2131 2137 2138 2139 2142
[1093] 2143 2145 2151 2157 2158 2160 2161 2166 2167 2168 2169 2174 2175 2176
[1107] 2177 2178 2179 2180 2181 2183 2185 2188 2189 2190 2191 2200 2201 2202
[1121] 2203 2205 2206 2207 2208 2210 2212 2215 2219 2221 2222 2223 2225 2226
[1135] 2227 2228 2231 2232 2234 2236 2237 2238 2239 2241 2242 2245 2248 2249
[1149] 2255 2257 2258 2259 2260 2261 2262 2264 2265 2269 2271 2272 2273 2275
[1163] 2280 2283 2285 2290 2291 2294 2297 2298 2299 2301 2302 2306 2307 2310
[1177] 2311 2314 2316 2319 2320 2322 2323 2324 2325 2326 2329 2330 2331 2332
[1191] 2334 2336 2337 2338 2340 2341 2342 2343 2344 2345 2348 2349 2350 2351
[1205] 2352 2354 2356 2364 2367 2368 2369 2371 2373 2377 2378 2379 2384 2385
[1219] 2388 2398 2400 2402 2410 2411 2414 2415 2416 2418 2420 2424 2425 2428
[1233] 2429 2437 2442 2443 2444 2445 2446 2447 2448 2449 2450 2451 2452 2453
[1247] 2462 2463 2464 2465 2466 2473 2475 2476 2477 2481 2483 2485 2489 2490
[1261] 2491 2495 2496 2497 2498 2499 2500 2503 2504 2506 2507 2508 2510 2511
[1275] 2512 2513 2522 2523 2525 2526 2527 2528 2529 2530 2531 2532 2533 2535
[1289] 2536 2537 2539 2541 2543 2546 2547 2554 2561 2562 2563 2564 2565 2570
[1303] 2571 2572 2573 2575 2578 2582 2583 2584 2585 2588 2591 2595 2597 2598
[1317] 2599 2605 2606 2607 2613 2614 2615 2617 2618 2619 2621 2627 2629 2636
[1331] 2638 2639 2640 2641 2642 2643 2644 2645 2647 2653 2655 2656 2657 2658
[1345] 2659 2662 2663 2664 2667 2668 2670 2672 2673 2674 2676 2677 2678 2679
[1359] 2680 2682 2685 2686 2687 2688 2689 2692 2693 2694 2695 2698 2699 2700
[1373] 2701 2703 2704 2707 2709 2711 2713 2714 2718 2721 2722 2723 2724 2727
[1387] 2729 2731 2733 2736 2738 2739 2740 2741 2742 2746 2748 2753 2757 2759
[1401] 2760 2763 2764 2765 2766 2776 2777 2778 2781 2783 2784 2786 2787 2788
[1415] 2789 2790 2792 2794 2795 2799 2800 2803 2804 2806 2807 2808 2809 2810
[1429] 2813 2814 2817 2818 2819 2821 2822 2825 2831 2832 2834 2838 2839 2844
[1443] 2846 2847 2848 2849 2850 2851 2852 2855 2856 2857 2862 2863 2868 2869
[1457] 2870 2871 2872 2873

$cor
                    bpi_antisocialT1Sum bpi_antisocialT2Sum
bpi_antisocialT1Sum           1.0000000           0.5034855
bpi_antisocialT2Sum           0.5034855           1.0000000

$n.obs
[1] 2875</code></pre>
</div>
</div>
</section>
<section id="minimum-covariance-determinant" class="level7">
<p class="heading">Minimum covariance determinant</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov.mcd</span>(</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)]),</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$center
bpi_antisocialT1Sum bpi_antisocialT2Sum 
           2.181181            2.094954 

$cov
                    bpi_antisocialT1Sum bpi_antisocialT2Sum
bpi_antisocialT1Sum            2.379036            1.096437
bpi_antisocialT2Sum            1.096437            2.482409

$msg
[1] "160 singular samples of size 3 out of 1500"

$crit
[1] -0.3839279

$best
   [1]    1    3    8    9   10   12   13   14   15   16   17   18   19   21
  [15]   22   23   24   39   40   42   43   44   46   48   50   55   56   57
  [29]   60   61   63   65   67   69   70   76   79   80   81   82   86   87
  [43]   88   93   95   97   98   99  102  104  105  106  107  108  116  117
  [57]  119  120  121  122  123  124  129  130  131  132  133  134  138  139
  [71]  140  141  142  143  145  148  149  150  153  154  155  160  161  166
  [85]  168  169  170  176  177  178  179  180  181  182  183  184  187  188
  [99]  190  191  192  194  195  196  197  198  200  201  202  205  206  207
 [113]  209  212  213  214  227  228  231  232  233  234  235  237  238  239
 [127]  240  241  242  243  244  245  246  247  249  251  253  254  255  256
 [141]  261  262  265  268  269  272  275  281  282  284  289  290  291  293
 [155]  294  295  296  297  298  299  300  301  304  307  308  310  313  315
 [169]  329  330  331  332  333  334  335  339  341  342  343  345  346  350
 [183]  355  356  357  359  364  367  370  371  376  379  380  381  382  386
 [197]  387  388  389  390  391  397  399  401  403  404  407  408  409  410
 [211]  411  413  416  421  422  423  425  426  430  431  432  435  437  438
 [225]  440  441  442  443  445  448  449  450  451  453  455  456  458  459
 [239]  461  462  463  464  466  467  468  469  471  473  474  476  477  478
 [253]  480  482  483  484  486  493  494  495  496  497  498  499  500  501
 [267]  502  503  504  505  506  507  509  510  513  518  519  520  521  522
 [281]  523  524  525  527  528  529  531  532  533  534  535  536  537  538
 [295]  539  541  543  545  546  550  553  554  557  558  562  564  566  568
 [309]  572  575  578  579  582  583  585  599  600  601  605  608  609  610
 [323]  615  616  617  618  619  620  621  622  623  625  626  627  628  631
 [337]  633  634  635  636  637  639  641  642  643  646  647  648  649  650
 [351]  657  660  662  667  670  672  673  674  675  676  679  680  681  682
 [365]  683  685  686  687  690  691  693  696  701  704  705  706  707  710
 [379]  713  714  715  717  718  719  720  721  722  723  728  730  732  733
 [393]  734  736  737  740  741  742  743  744  745  746  747  751  752  758
 [407]  762  763  764  765  769  772  774  776  779  780  782  783  786  789
 [421]  791  798  799  801  802  803  805  806  808  809  810  811  812  813
 [435]  814  817  818  819  822  824  826  827  828  832  834  836  837  838
 [449]  839  840  842  843  847  848  849  852  855  857  858  859  860  861
 [463]  862  865  866  867  868  869  871  872  873  874  877  880  881  882
 [477]  888  889  892  893  895  898  899  900  901  902  903  905  906  907
 [491]  909  912  913  914  918  920  921  923  925  926  927  928  931  932
 [505]  933  934  935  936  937  939  940  941  943  944  945  946  949  950
 [519]  951  954  955  956  957  959  960  962  964  965  967  970  972  973
 [533]  974  975  976  977  980  983  985  987  988  990  992  995  998 1000
 [547] 1001 1002 1003 1004 1005 1006 1007 1008 1013 1014 1015 1016 1017 1019
 [561] 1021 1022 1023 1024 1025 1026 1027 1029 1030 1032 1034 1036 1037 1041
 [575] 1043 1044 1046 1047 1049 1050 1051 1053 1054 1055 1057 1058 1059 1061
 [589] 1064 1066 1067 1070 1072 1075 1076 1079 1083 1086 1087 1088 1091 1094
 [603] 1095 1097 1101 1105 1109 1111 1112 1113 1114 1115 1119 1121 1123 1124
 [617] 1125 1128 1129 1132 1135 1136 1138 1139 1144 1145 1146 1147 1148 1149
 [631] 1150 1152 1154 1158 1160 1162 1163 1164 1165 1171 1176 1177 1178 1179
 [645] 1180 1181 1182 1184 1185 1186 1187 1188 1189 1190 1191 1197 1198 1200
 [659] 1201 1203 1205 1206 1207 1208 1209 1214 1215 1216 1217 1218 1219 1220
 [673] 1221 1223 1224 1229 1230 1231 1232 1233 1234 1235 1242 1243 1244 1245
 [687] 1246 1247 1248 1249 1250 1251 1254 1255 1259 1261 1262 1263 1265 1266
 [701] 1267 1269 1271 1272 1273 1274 1275 1276 1280 1281 1282 1283 1284 1285
 [715] 1286 1287 1288 1289 1290 1291 1292 1293 1294 1296 1299 1301 1302 1303
 [729] 1304 1306 1309 1310 1311 1312 1314 1315 1316 1318 1319 1320 1322 1323
 [743] 1325 1326 1333 1334 1336 1337 1338 1339 1341 1343 1344 1347 1348 1349
 [757] 1350 1352 1353 1354 1355 1356 1357 1358 1359 1360 1361 1362 1363 1365
 [771] 1366 1367 1368 1369 1370 1371 1372 1373 1374 1375 1376 1377 1380 1381
 [785] 1382 1383 1387 1388 1389 1390 1391 1395 1396 1397 1398 1399 1400 1401
 [799] 1402 1405 1408 1412 1413 1414 1417 1419 1421 1422 1423 1424 1426 1428
 [813] 1430 1432 1433 1434 1438 1439 1440 1444 1445 1447 1448 1449 1456 1458
 [827] 1459 1464 1467 1468 1469 1470 1471 1483 1485 1486 1489 1495 1499 1500
 [841] 1502 1504 1505 1506 1508 1513 1514 1515 1516 1517 1518 1519 1521 1522
 [855] 1524 1525 1527 1531 1532 1533 1534 1535 1536 1537 1539 1540 1541 1542
 [869] 1543 1544 1545 1546 1547 1548 1549 1551 1553 1554 1560 1561 1563 1565
 [883] 1569 1571 1572 1575 1576 1577 1583 1584 1585 1586 1588 1589 1590 1591
 [897] 1592 1593 1594 1595 1596 1597 1598 1600 1602 1604 1605 1606 1611 1612
 [911] 1613 1614 1617 1621 1623 1624 1625 1626 1627 1634 1640 1641 1644 1652
 [925] 1656 1657 1661 1664 1665 1672 1674 1675 1686 1687 1689 1690 1691 1692
 [939] 1694 1699 1701 1705 1706 1708 1709 1710 1711 1712 1714 1716 1718 1719
 [953] 1721 1722 1723 1724 1731 1732 1738 1739 1742 1750 1753 1754 1757 1759
 [967] 1760 1761 1763 1764 1765 1766 1772 1774 1775 1776 1777 1778 1781 1791
 [981] 1795 1797 1798 1801 1802 1803 1804 1806 1807 1809 1810 1812 1813 1815
 [995] 1817 1818 1821 1824 1827 1834 1835 1836 1837 1840 1842 1846 1847 1848
[1009] 1849 1850 1851 1852 1855 1858 1859 1860 1861 1863 1864 1866 1867 1868
[1023] 1870 1881 1884 1885 1888 1890 1892 1902 1904 1910 1915 1921 1922 1923
[1037] 1924 1925 1926 1927 1932 1933 1935 1936 1938 1940 1941 1943 1947 1948
[1051] 1950 1951 1954 1955 1956 1957 1960 1961 1962 1963 1966 1967 1969 1970
[1065] 1971 1972 1973 1974 1979 1981 1984 1986 1988 1990 1992 1993 1994 1995
[1079] 1999 2002 2005 2006 2009 2011 2012 2017 2019 2021 2022 2027 2029 2032
[1093] 2034 2036 2038 2042 2043 2045 2049 2051 2053 2054 2055 2059 2061 2062
[1107] 2063 2068 2069 2070 2071 2073 2074 2077 2078 2079 2080 2081 2082 2083
[1121] 2084 2085 2086 2087 2088 2089 2094 2096 2097 2098 2099 2100 2101 2102
[1135] 2104 2105 2108 2110 2112 2113 2114 2116 2117 2118 2119 2123 2124 2125
[1149] 2126 2127 2129 2130 2131 2137 2138 2139 2143 2145 2151 2157 2158 2160
[1163] 2161 2163 2166 2167 2168 2169 2171 2174 2175 2176 2177 2178 2179 2180
[1177] 2181 2183 2185 2188 2189 2190 2191 2200 2201 2202 2203 2205 2206 2207
[1191] 2208 2210 2212 2215 2219 2221 2222 2223 2225 2226 2227 2228 2231 2232
[1205] 2234 2236 2237 2238 2239 2241 2242 2245 2248 2249 2253 2255 2257 2258
[1219] 2259 2260 2261 2262 2264 2269 2271 2272 2273 2274 2275 2280 2283 2285
[1233] 2290 2291 2297 2298 2299 2301 2302 2305 2306 2307 2311 2314 2316 2317
[1247] 2319 2320 2322 2323 2324 2325 2326 2328 2329 2330 2331 2332 2334 2336
[1261] 2337 2338 2340 2341 2342 2343 2344 2345 2348 2349 2350 2351 2352 2354
[1275] 2356 2359 2362 2364 2367 2368 2369 2371 2373 2377 2378 2379 2380 2384
[1289] 2385 2386 2388 2398 2400 2402 2410 2411 2414 2415 2416 2418 2420 2424
[1303] 2425 2428 2429 2437 2442 2443 2444 2445 2446 2447 2448 2449 2450 2451
[1317] 2452 2453 2454 2462 2463 2464 2465 2466 2467 2469 2472 2473 2475 2477
[1331] 2481 2483 2485 2489 2490 2491 2492 2495 2496 2497 2498 2499 2500 2503
[1345] 2504 2506 2507 2508 2509 2510 2511 2512 2513 2520 2522 2523 2525 2526
[1359] 2527 2528 2529 2530 2531 2532 2533 2535 2536 2539 2541 2543 2545 2546
[1373] 2547 2554 2561 2562 2563 2564 2565 2566 2570 2571 2572 2573 2575 2577
[1387] 2578 2581 2582 2583 2584 2585 2588 2590 2591 2597 2598 2599 2603 2604
[1401] 2605 2606 2607 2608 2613 2614 2615 2617 2618 2619 2620 2621 2627 2634
[1415] 2635 2636 2638 2639 2640 2641 2642 2643 2644 2645 2647 2653 2655 2656
[1429] 2657 2658 2659 2663 2664 2667 2668 2669 2670 2672 2673 2674 2676 2677
[1443] 2678 2679 2680 2682 2685 2686 2687 2688 2689 2692 2693 2694 2695 2698
[1457] 2700 2701 2702 2703 2704 2707 2709 2711 2713 2714 2717 2718 2721 2722
[1471] 2723 2724 2727 2728 2729 2731 2733 2736 2738 2739 2740 2741 2742 2746
[1485] 2748 2753 2757 2759 2760 2763 2764 2765 2766 2771 2773 2776 2777 2778
[1499] 2781 2783 2784 2786 2788 2789 2790 2792 2797 2799 2800 2803 2804 2806
[1513] 2807 2808 2809 2810 2813 2814 2817 2819 2821 2825 2826 2831 2832 2834
[1527] 2838 2839 2844 2846 2847 2848 2849 2850 2851 2852 2855 2856 2857 2862
[1541] 2863 2868 2869 2870 2871 2872 2873

$cor
                    bpi_antisocialT1Sum bpi_antisocialT2Sum
bpi_antisocialT1Sum           1.0000000           0.4511764
bpi_antisocialT2Sum           0.4511764           1.0000000

$n.obs
[1] 2875</code></pre>
</div>
</div>
</section>
<section id="winsorized-correlation" class="level7">
<p class="heading">Winsorized correlation</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)],</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">winsorize =</span> <span class="fl">0.2</span>,</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_adjust =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Parameter1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Parameter2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["r"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["t"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df_error"],"name":[8],"type":["int"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Method"],"name":[10],"type":["chr"],"align":["left"]},{"label":["n_Obs"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"bpi_antisocialT1Sum","2":"bpi_antisocialT2Sum","3":"0.4651836","4":"0.95","5":"0.4360424","6":"0.4933503","7":"28.16721","8":"2873","9":"2.369015e-154","10":"Winsorized Pearson correlation","11":"2875","_rn_":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="percentage-bend-correlation" class="level7">
<p class="heading">Percentage bend correlation</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)],</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"percentage"</span>,</span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_adjust =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Parameter1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Parameter2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["r"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["t"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df_error"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Method"],"name":[10],"type":["chr"],"align":["left"]},{"label":["n_Obs"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"bpi_antisocialT1Sum","2":"bpi_antisocialT2Sum","3":"0.4837302","4":"0.95","5":"0.4552238","6":"0.511246","7":"29.62478","8":"2873","9":"1.536055e-168","10":"Percentage Bend correlation","11":"2875","_rn_":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="biweight-midcorrelation" class="level7">
<p class="heading">Biweight midcorrelation</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)],</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"biweight"</span>,</span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_adjust =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Parameter1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Parameter2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["r"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["t"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df_error"],"name":[8],"type":["int"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Method"],"name":[10],"type":["chr"],"align":["left"]},{"label":["n_Obs"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"bpi_antisocialT1Sum","2":"bpi_antisocialT2Sum","3":"0.4792883","4":"0.95","5":"0.465104","6":"0.4932265","7":"58.63389","8":"2873","9":"0","10":"Biweight correlation","11":"2875","_rn_":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="xi-xi" class="level7">
<p class="heading">Xi (<span class="math inline">\(\xi\)</span>)</p>
<p>Xi (<span class="math inline">\(\xi\)</span>) is an index of the degree of dependence between two variables</p>
<p>Chatterjee, S. (2021). A new coefficient of correlation. <em>Journal of the American Statistical Association, 116</em>(536), 2009-2022. <a href="https://doi.org/10.1080/01621459.2020.1758115" class="uri">https://doi.org/10.1080/01621459.2020.1758115</a></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>) <span class="co"># for reproducibility</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>XICOR<span class="sc">::</span><span class="fu">xicor</span>(</span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT1Sum,</span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT2Sum,</span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"permutation"</span>,</span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pvalue =</span> <span class="cn">TRUE</span></span>
<span id="cb259-8"><a href="#cb259-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$xi
[1] 0.1751217

$sd
[1] 0.012695

$pval
[1] 0</code></pre>
</div>
</div>
</section>
</section>
<section id="robust-regression-with-a-single-predictor" class="level6" data-number="19.1.6.2.3.2">
<h6 data-number="19.1.6.2.3.2" class="anchored" data-anchor-id="robust-regression-with-a-single-predictor"><span class="header-section-number">19.1.6.2.3.2</span> Robust regression with a single predictor</h6>
<section id="theil-sen-estimator" class="level7">
<p class="heading">Theil-Sen estimator</p>
<p>The Theil-Sen single median estimator is robust to outliers; have to remove missing values first</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>mydata_subset <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)])[<span class="dv">1</span><span class="sc">:</span><span class="dv">400</span>,]</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mblm</span>(</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum,</span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataframe =</span> mydata_subset,</span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">repeated =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
mblm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum, dataframe = mydata_subset, 
    repeated = FALSE)

Coefficients:
        (Intercept)  bpi_antisocialT1Sum  
                1.0                  0.6  </code></pre>
</div>
</div>
</section>
</section>
<section id="robust-multiple-regression" class="level6" data-number="19.1.6.2.3.3">
<h6 data-number="19.1.6.2.3.3" class="anchored" data-anchor-id="robust-multiple-regression"><span class="header-section-number">19.1.6.2.3.3</span> Robust multiple regression</h6>
<p>Best when no outliers: MM-type regression estimator</p>
<section id="robust-linear-regression" class="level7">
<p class="heading">Robust linear regression</p>
<p>MM-type regression estimator (best):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmrob</span>(</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lmrob(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,     data = mydata, na.action = na.exclude)
 \--&gt; method = "MM"
Coefficients:
            (Intercept)      bpi_antisocialT1Sum  bpi_anxiousDepressedSum  
                 0.9440                   0.4914                   0.1577  </code></pre>
</div>
</div>
<p>Iteratively reweighted least squares (IRLS): <a href="http://www.ats.ucla.edu/stat/r/dae/rreg.htm" class="uri">http://www.ats.ucla.edu/stat/r/dae/rreg.htm</a> (archived at <a href="https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm" class="uri">https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm</a>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rlm</span>(</span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rlm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    data = mydata, na.action = na.exclude)
Converged in 6 iterations

Coefficients:
            (Intercept)     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
              0.9838033               0.4873118               0.1620020 

Degrees of freedom: 2874 total; 2871 residual
  (8656 observations deleted due to missingness)
Scale estimate: 1.62 </code></pre>
</div>
</div>
</section>
<section id="robust-generalized-regression-1" class="level7">
<p class="heading">Robust generalized regression</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glmrob</span>(</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glmrob(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum +      bpi_anxiousDepressedSum, family = "poisson", data = mydata,      na.action = "na.exclude") 

Coefficients:
            (Intercept)      bpi_antisocialT1Sum  bpi_anxiousDepressedSum  
                0.37281                  0.15589                  0.05026  

Number of observations: 2874 
Fitted by method  'Mqle' </code></pre>
</div>
</div>
<p>Most resistant to outliers: Least trimmed squares (LTS)—but not good as a standalone estimator, better for identifying outliers</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ltsReg</span>(</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
ltsReg.formula(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum +     bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)

Coefficients:
              Intercept      bpi_antisocialT1Sum  bpi_anxiousDepressedSum  
                 0.7813                   0.5145                   0.1318  

Scale estimate 1.75 </code></pre>
</div>
</div>
<section id="not-great-options" class="level8">
<p class="heading">Not great options:</p>
<p>Quantile (L1) regression: <code>rq()</code> function of quantreg package</p>
<p><a href="https://data.library.virginia.edu/getting-started-with-quantile-regression/" class="uri">https://data.library.virginia.edu/getting-started-with-quantile-regression/</a> (archived at <a href="https://perma.cc/FSV4-5DCR" class="uri">https://perma.cc/FSV4-5DCR</a>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>quantiles <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span><span class="sc">/</span><span class="dv">10</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>quantileRegressionModel <span class="ot">&lt;-</span> <span class="fu">rq</span>(</span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau =</span> quantiles,</span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a>quantileRegressionModel</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

Coefficients:
                           tau= 0.1  tau= 0.2   tau= 0.3 tau= 0.4 tau= 0.5
(Intercept)             -0.19607843 0.0000000 0.09090909      0.5     0.88
bpi_antisocialT1Sum      0.19607843 0.3333333 0.45454545      0.5     0.52
bpi_anxiousDepressedSum  0.09803922 0.1111111 0.13636364      0.1     0.12
                         tau= 0.6 tau= 0.7 tau= 0.8  tau= 0.9
(Intercept)             1.0000000   1.3750   2.1250 3.1000000
bpi_antisocialT1Sum     0.5913978   0.6250   0.6250 0.6428571
bpi_anxiousDepressedSum 0.2043011   0.1875   0.1875 0.2285714

Degrees of freedom: 11530 total; 11527 residual</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quantileRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.1

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)             -0.19608  0.05341   -3.67101  0.00025
bpi_antisocialT1Sum      0.19608  0.03492    5.61452  0.00000
bpi_anxiousDepressedSum  0.09804  0.03536    2.77276  0.00559

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.2

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              0.00000  0.04196    0.00000  1.00000
bpi_antisocialT1Sum      0.33333  0.02103   15.85299  0.00000
bpi_anxiousDepressedSum  0.11111  0.02669    4.16376  0.00003

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.3

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              0.09091  0.05830    1.55945  0.11900
bpi_antisocialT1Sum      0.45455  0.02584   17.59380  0.00000
bpi_anxiousDepressedSum  0.13636  0.03601    3.78723  0.00016

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.4

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              0.50000  0.06410    7.80035  0.00000
bpi_antisocialT1Sum      0.50000  0.02374   21.06425  0.00000
bpi_anxiousDepressedSum  0.10000  0.03372    2.96584  0.00304

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.5

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              0.88000  0.06584   13.36547  0.00000
bpi_antisocialT1Sum      0.52000  0.02491   20.87561  0.00000
bpi_anxiousDepressedSum  0.12000  0.03771    3.18245  0.00148

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.6

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              1.00000  0.04246   23.55356  0.00000
bpi_antisocialT1Sum      0.59140  0.02146   27.55553  0.00000
bpi_anxiousDepressedSum  0.20430  0.03156    6.47422  0.00000

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.7

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              1.37500  0.07716   17.82011  0.00000
bpi_antisocialT1Sum      0.62500  0.02397   26.07659  0.00000
bpi_anxiousDepressedSum  0.18750  0.03760    4.98623  0.00000

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.8

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              2.12500  0.09498   22.37224  0.00000
bpi_antisocialT1Sum      0.62500  0.03524   17.73509  0.00000
bpi_anxiousDepressedSum  0.18750  0.05040    3.72020  0.00020

Call: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, 
    tau = quantiles, data = mydata, na.action = na.exclude)

tau: [1] 0.9

Coefficients:
                        Value    Std. Error t value  Pr(&gt;|t|)
(Intercept)              3.10000  0.11730   26.42749  0.00000
bpi_antisocialT1Sum      0.64286  0.04797   13.40136  0.00000
bpi_anxiousDepressedSum  0.22857  0.06439    3.54960  0.00039</code></pre>
</div>
</div>
<p>Plot to examine the association between the predictor and the outcome at different levels (i.e., quantiles) of the predictor:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>  mydata,</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(bpi_antisocialT1Sum, bpi_antisocialT2Sum)) <span class="sc">+</span> </span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quantile</span>(</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">quantiles =</span> quantiles,</span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(<span class="fu">after_stat</span>(quantile))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Below is a plot that examines the difference in quantile coefficients (and associated confidence intervals) at different levels (i.e., quantiles) of the predictor. The x-axis is the quantile of the predictor. The y-axis is the slope coefficient. Each black dot is the slope coefficient for the given quantile of the predictor. The red lines are the least squares estimate of the slope coefficient and its confidence interval.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(quantileRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(quantileRegressionModel),</span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parm =</span> <span class="st">"bpi_antisocialT1Sum"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-103-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
</section>
</section>
</section>
<section id="examining-model-assumptions" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="examining-model-assumptions"><span class="header-section-number">19.2</span> Examining Model Assumptions</h2>
<section id="distribution-of-residuals" class="level3" data-number="19.2.1">
<h3 data-number="19.2.1" class="anchored" data-anchor-id="distribution-of-residuals"><span class="header-section-number">19.2.1</span> Distribution of Residuals</h3>
<section id="qqPlot" class="level4" data-number="19.2.1.1">
<h4 data-number="19.2.1.1" class="anchored" data-anchor-id="qqPlot"><span class="header-section-number">19.2.1.1</span> QQ plots</h4>
<p><a href="https://www.ucd.ie/ecomodel/Resources/QQplots_WebVersion.html" class="uri">https://www.ucd.ie/ecomodel/Resources/QQplots_WebVersion.html</a> (archived at <a href="https://perma.cc/9UC3-3WRX" class="uri">https://perma.cc/9UC3-3WRX</a>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(multipleRegressionModel, <span class="at">main =</span> <span class="st">"QQ Plot"</span>, <span class="at">id =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8955 8956</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(multipleRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-104-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(rmsMultipleRegressionModel))</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(robustLinearRegression))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-104-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(ltsRegression))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-104-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(generalizedRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-104-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(rmsGeneralizedRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `residuals.Glm()`:
! argument "type" is missing, with no default</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(robustGeneralizedRegression))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-104-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(multilevelRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `h()`:
! error in evaluating the argument 'object' in selecting a method for function 'resid': object 'multilevelRegressionModel' not found</code></pre>
</div>
</div>
</section>
<section id="ppPlot" class="level4" data-number="19.2.1.2">
<h4 data-number="19.2.1.2" class="anchored" data-anchor-id="ppPlot"><span class="header-section-number">19.2.1.2</span> PP plots</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(rmsMultipleRegressionModel)</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(robustLinearRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-105-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(ltsRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-105-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(generalizedRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-105-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(rmsGeneralizedRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `residuals.Glm()`:
! argument "type" is missing, with no default</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(robustGeneralizedRegression)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-105-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="densityPlotResiduals" class="level4" data-number="19.2.1.3">
<h4 data-number="19.2.1.3" class="anchored" data-anchor-id="densityPlotResiduals"><span class="header-section-number">19.2.1.3</span> Density Plot of Residuals</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>studentizedResiduals <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">rstudent</span>(multipleRegressionModel))</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">density</span>(studentizedResiduals),</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>xfit <span class="ot">&lt;-</span> <span class="fu">seq</span>(</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(studentizedResiduals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(studentizedResiduals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">length =</span> <span class="dv">40</span>)</span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(</span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a>  xfit,</span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(xfit),</span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="st">"gray"</span>) <span class="co">#compare to normal distribution</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="residualPlots" class="level3" data-number="19.2.2">
<h3 data-number="19.2.2" class="anchored" data-anchor-id="residualPlots"><span class="header-section-number">19.2.2</span> Residual Plots</h3>
<p>Residual plots are plots of the residuals versus observed/fitted values.</p>
<p>Includes plots of a) model residuals versus observed values on predictors and b) model residuals versus model fitted values.</p>
<p>Note: have to remove <code>na.action = na.exclude</code></p>
<p>Tests include:</p>
<ul>
<li>lack-of-fit test for every numeric predictor, t-test for the regressor, added to the model, indicating no lack-of-fit for this type</li>
<li>Tukey’s test for nonadditivity: adding the squares of the fitted values to the model and refitting (evaluates adequacy of model fit)</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residualPlots</span>(</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModelNoMissing,</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Test stat Pr(&gt;|Test stat|)  
bpi_antisocialT1Sum       -2.0755          0.03803 *
bpi_anxiousDepressedSum   -1.2769          0.20175  
Tukey test                -2.3351          0.01954 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="marginalModelPlots" class="level3" data-number="19.2.3">
<h3 data-number="19.2.3" class="anchored" data-anchor-id="marginalModelPlots"><span class="header-section-number">19.2.3</span> Marginal Model Plots</h3>
<p>Marginal model plots are plots of the outcome versus predictors/fitted values.</p>
<p>Includes plots of a) observed outcome values versus values on predictors (ignoring the other predictors) and b) observed outcome values versus model fitted values.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">marginalModelPlots</span>(</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> <span class="cn">TRUE</span>,</span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="addedVariablePlots" class="level3" data-number="19.2.4">
<h3 data-number="19.2.4" class="anchored" data-anchor-id="addedVariablePlots"><span class="header-section-number">19.2.4</span> Added-Variable Plots</h3>
<p>Added-variable plots are plots of the partial association between the outcome and each predictor, controlling for all other predictors.</p>
<p>Useful for identifying jointly influential observations and studying the impact of observations on the regression coefficients.</p>
<p>y-axis: residuals from model with all predictors excluding the predictor of interest</p>
<p>x-axis: residuals from model regressing predictor of interest on all other predictors</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(</span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="refit-model-removing-jointly-influential-observations" class="level4" data-number="19.2.4.1">
<h4 data-number="19.2.4.1" class="anchored" data-anchor-id="refit-model-removing-jointly-influential-observations"><span class="header-section-number">19.2.4.1</span> Refit model removing jointly influential observations</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_removeJointlyInfluentialObs <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">6318</span>,<span class="dv">6023</span>,<span class="dv">4022</span>,<span class="dv">4040</span>))</span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(</span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_removeJointlyInfluentialObs,</span>
<span id="cb301-9"><a href="#cb301-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compareCoefs</span>(</span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_removeJointlyInfluentialObs)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Calls:
1: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)
2: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(6318, 6023, 4022, 4040),
   na.action = na.exclude)

                        Model 1 Model 2
(Intercept)              1.1983  1.1949
SE                       0.0598  0.0599
                                       
bpi_antisocialT1Sum      0.4655  0.4649
SE                       0.0186  0.0188
                                       
bpi_anxiousDepressedSum  0.1608  0.1665
SE                       0.0292  0.0295
                                       </code></pre>
</div>
</div>
</section>
</section>
<section id="outlier-test" class="level3" data-number="19.2.5">
<h3 data-number="19.2.5" class="anchored" data-anchor-id="outlier-test"><span class="header-section-number">19.2.5</span> Outlier test</h3>
<p>Locates the largest Studentized residuals in absolute value and computes the Bonferroni-corrected p-values based on a t-test for linear models.</p>
<p>Test of outlyingness, i.e., how likely one would have a residual of a given magnitude in a normal distribution with the same sample size</p>
<p>Note: it does not test how extreme an observation is relative to its distribution (i.e., leverage)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">outlierTest</span>(multipleRegressionModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     rstudent unadjusted p-value Bonferroni p
8955 6.519574         8.2999e-11   2.3854e-07
8956 6.519574         8.2999e-11   2.3854e-07
8957 6.182195         7.2185e-10   2.0746e-06
2560 4.914941         9.3800e-07   2.6958e-03
1385 4.573975         4.9884e-06   1.4337e-02</code></pre>
</div>
</div>
</section>
<section id="observations-with-high-leverage" class="level3" data-number="19.2.6">
<h3 data-number="19.2.6" class="anchored" data-anchor-id="observations-with-high-leverage"><span class="header-section-number">19.2.6</span> Observations with high leverage</h3>
<p>Identifies observations with high leverage (i.e., high hat values)</p>
<p>hat values are an index of leverage (observations that are far from the center of the regressor space and have greater influence on OLS regression coefficients)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">hatvalues</span>(multipleRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hatvalues</span>(multipleRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-112-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">influenceIndexPlot</span>(</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-112-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>) <span class="co"># circle size is proportional to Cook's Distance</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-112-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["StudRes"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Hat"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["CookD"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"-3.940128","2":"0.006990052","3":"0.03624388","_rn_":"5286"},{"1":"-4.264903","2":"0.009024093","3":"0.05488391","_rn_":"10898"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveragePlots</span>(</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-112-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="observations-with-high-influence-on-ols-regression-coefficients" class="level3" data-number="19.2.7">
<h3 data-number="19.2.7" class="anchored" data-anchor-id="observations-with-high-influence-on-ols-regression-coefficients"><span class="header-section-number">19.2.7</span> Observations with high influence (on OLS regression coefficients)</h3>
<p><a href="https://cran.r-project.org/web/packages/olsrr/vignettes/influence_measures.html" class="uri">https://cran.r-project.org/web/packages/olsrr/vignettes/influence_measures.html</a> (archived at <a href="https://perma.cc/T2TS-PZZ4" class="uri">https://perma.cc/T2TS-PZZ4</a>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">influence.measures</span>(multipleRegressionModel)<span class="sc">$</span>infmat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        dfb.1_     dfb.b_T1     dfb.b_DS       dffit     cov.r       cook.d
1  0.000000000  0.000000000  0.000000000          NA 1.0000000           NA
2  0.000000000  0.000000000  0.000000000          NA 1.0000000           NA
3 -0.006546394  0.008357248 -0.006308529 -0.01004886 1.0024362 0.0000336708
4  0.042862749 -0.025185789 -0.007782877  0.04286275 0.9998621 0.0006121902
5  0.000000000  0.000000000  0.000000000          NA 1.0000000           NA
6 -0.018327367  0.010769006  0.003327823 -0.01832737 1.0015775 0.0001119888
           hat
1 0.0000000000
2 0.0000000000
3 0.0014593072
4 0.0009143185
5 0.0000000000
6 0.0009143185</code></pre>
</div>
</div>
</section>
<section id="dfbeta" class="level3" data-number="19.2.8">
<h3 data-number="19.2.8" class="anchored" data-anchor-id="dfbeta"><span class="header-section-number">19.2.8</span> DFBETA</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">dfbeta</span>(multipleRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    (Intercept) bpi_antisocialT1Sum bpi_anxiousDepressedSum
1  0.0000000000        0.0000000000            0.000000e+00
2  0.0000000000        0.0000000000            0.000000e+00
3 -0.0003917284        0.0001553400           -1.839704e-04
4  0.0025639901       -0.0004679817           -2.268890e-04
5  0.0000000000        0.0000000000            0.000000e+00
6 -0.0010966309        0.0002001580            9.704151e-05</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">dfbeta</span>(multipleRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dfbetasPlots</span>(</span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `dfbetasPlots.lm()`:
! argument 2 matches multiple formal arguments</code></pre>
</div>
</div>
</section>
<section id="dffits" class="level3" data-number="19.2.9">
<h3 data-number="19.2.9" class="anchored" data-anchor-id="dffits"><span class="header-section-number">19.2.9</span> DFFITS</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">dffits</span>(multipleRegressionModel)[<span class="fu">order</span>(<span class="fu">dffits</span>(multipleRegressionModel), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     8472      4468      1917      8955      8956      1986 
0.2664075 0.2428065 0.2237760 0.1972271 0.1972271 0.1923034 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">dffits</span>(multipleRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dffits</span>(multipleRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-115-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dffits</span>(multipleRegressionModel)[<span class="fu">order</span>(<span class="fu">dffits</span>(multipleRegressionModel), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-115-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cooksDistance" class="level3" data-number="19.2.10">
<h3 data-number="19.2.10" class="anchored" data-anchor-id="cooksDistance"><span class="header-section-number">19.2.10</span> Cook’s Distance</h3>
<p>Observations that are both outlying (have a high residual from the regression line) and have high leverage (are far from the center of the regressor space) have high influence on the OLS regression coefficients. An observation will have less influence if it lies on the regression line (not an outlier, i.e., has a low residual) or if it has low leverage (i.e., has a value near the center of a predictor’s distribution).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel)[<span class="fu">order</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      2765       1371       2767       8472       6170       6023 
0.05488391 0.03624388 0.03624388 0.02358305 0.02323282 0.02315496 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-116-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel)[<span class="fu">order</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-116-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="refit-model-removing-values-with-high-cooks-distance" class="level4" data-number="19.2.10.1">
<h4 data-number="19.2.10.1" class="anchored" data-anchor-id="refit-model-removing-values-with-high-cooks-distance"><span class="header-section-number">19.2.10.1</span> Refit model removing values with high cook’s distance</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>))</span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>))</span>
<span id="cb328-12"><a href="#cb328-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-13"><a href="#cb328-13" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb328-14"><a href="#cb328-14" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb328-15"><a href="#cb328-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb328-16"><a href="#cb328-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb328-17"><a href="#cb328-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>,<span class="dv">8472</span>))</span>
<span id="cb328-18"><a href="#cb328-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-19"><a href="#cb328-19" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb328-20"><a href="#cb328-20" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb328-21"><a href="#cb328-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb328-22"><a href="#cb328-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb328-23"><a href="#cb328-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>,<span class="dv">8472</span>,<span class="dv">6170</span>))</span>
<span id="cb328-24"><a href="#cb328-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-25"><a href="#cb328-25" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb328-26"><a href="#cb328-26" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb328-27"><a href="#cb328-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb328-28"><a href="#cb328-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb328-29"><a href="#cb328-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>,<span class="dv">8472</span>,<span class="dv">6170</span>,<span class="dv">6023</span>))</span>
<span id="cb328-30"><a href="#cb328-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-31"><a href="#cb328-31" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb328-32"><a href="#cb328-32" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb328-33"><a href="#cb328-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb328-34"><a href="#cb328-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb328-35"><a href="#cb328-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>,<span class="dv">8472</span>,<span class="dv">6170</span>,<span class="dv">6023</span>,<span class="dv">2766</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="examine-how-much-regression-coefficients-change-when-excluding-influential-observations" class="level5" data-number="19.2.10.1.1">
<h5 data-number="19.2.10.1.1" class="anchored" data-anchor-id="examine-how-much-regression-coefficients-change-when-excluding-influential-observations"><span class="header-section-number">19.2.10.1.1</span> Examine how much regression coefficients change when excluding influential observations</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compareCoefs</span>(</span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_2,</span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_3,</span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_4,</span>
<span id="cb329-6"><a href="#cb329-6" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_5,</span>
<span id="cb329-7"><a href="#cb329-7" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_6,</span>
<span id="cb329-8"><a href="#cb329-8" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_7)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Calls:
1: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)
2: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371), na.action =
   na.exclude)
3: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767), 
  na.action = na.exclude)
4: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767, 8472),
   na.action = na.exclude)
5: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767, 8472, 
  6170), na.action = na.exclude)
6: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767, 8472, 
  6170, 6023), na.action = na.exclude)
7: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + 
  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767, 8472, 
  6170, 6023, 2766), na.action = na.exclude)

                        Model 1 Model 2 Model 3 Model 4 Model 5 Model 6 Model 7
(Intercept)              1.1983  1.1704  1.1577  1.1676  1.1620  1.1537  1.1439
SE                       0.0598  0.0597  0.0596  0.0596  0.0596  0.0595  0.0595
                                                                               
bpi_antisocialT1Sum      0.4655  0.4739  0.4779  0.4748  0.4744  0.4793  0.4836
SE                       0.0186  0.0185  0.0185  0.0185  0.0185  0.0185  0.0185
                                                                               
bpi_anxiousDepressedSum  0.1608  0.1691  0.1726  0.1699  0.1770  0.1742  0.1743
SE                       0.0292  0.0290  0.0290  0.0289  0.0290  0.0290  0.0289
                                                                               </code></pre>
</div>
</div>
</section>
</section>
<section id="examine-how-much-regression-coefficients-change-when-using-least-trimmed-squares-lts-that-is-resistant-to-outliers" class="level4" data-number="19.2.10.2">
<h4 data-number="19.2.10.2" class="anchored" data-anchor-id="examine-how-much-regression-coefficients-change-when-using-least-trimmed-squares-lts-that-is-resistant-to-outliers"><span class="header-section-number">19.2.10.2</span> Examine how much regression coefficients change when using least trimmed squares (LTS) that is resistant to outliers</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(</span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action=</span><span class="st">"na.exclude"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
              1.1983004               0.4655286               0.1607541 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">ltsReg</span>(</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              Intercept     bpi_antisocialT1Sum bpi_anxiousDepressedSum 
              0.7439567               0.5432644               0.1524929 </code></pre>
</div>
</div>
</section>
</section>
<section id="resources" class="level3" data-number="19.2.11">
<h3 data-number="19.2.11" class="anchored" data-anchor-id="resources"><span class="header-section-number">19.2.11</span> Resources</h3>
<p>Book: An <code>R</code> Companion to Applied Regression</p>
<p><a href="https://people.duke.edu/~rnau/testing.htm" class="uri">https://people.duke.edu/~rnau/testing.htm</a> (archived at <a href="https://perma.cc/9CXH-GBSN" class="uri">https://perma.cc/9CXH-GBSN</a>)</p>
<p><a href="https://www.statmethods.net/stats/rdiagnostics.html" class="uri">https://www.statmethods.net/stats/rdiagnostics.html</a> (archived at <a href="https://perma.cc/7JX8-K6BY" class="uri">https://perma.cc/7JX8-K6BY</a>)</p>
<p><a href="https://socserv.socsci.mcmaster.ca/jfox/Courses/Brazil-2009/index.html" class="uri">https://socserv.socsci.mcmaster.ca/jfox/Courses/Brazil-2009/index.html</a> (archived at <a href="https://perma.cc/4A2P-9S49" class="uri">https://perma.cc/4A2P-9S49</a>)</p>
<p><a href="https://en.wikipedia.org/wiki/Ordinary_least_squares#Assumptions" class="uri">https://en.wikipedia.org/wiki/Ordinary_least_squares#Assumptions</a> (archived at <a href="https://perma.cc/Q4NS-X8TJ" class="uri">https://perma.cc/Q4NS-X8TJ</a>)</p>
</section>
</section>
</section>
<section id="session-info" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Session Info</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.2 (2025-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] yhat_2.0-5         rockchalk_1.8.157  effectsize_1.0.1   cocor_1.1-4       
 [5] XICOR_0.4.1        mice_3.19.0        regtools_1.7.0     gtools_3.9.5      
 [9] FNN_1.1.4.1        lavaan_0.6-21      interactions_1.2.0 correlation_0.8.8 
[13] effects_4.2-4      mblm_0.12.1        quantreg_6.1       SparseM_1.84-2    
[17] olsrr_0.6.1        foreign_0.8-90     AER_1.2-15         survival_3.8-3    
[21] sandwich_3.1-1     lmtest_0.9-40      zoo_1.8-15         mgcv_1.9-3        
[25] nlme_3.1-168       car_3.1-3          carData_3.0-5      cvTools_0.3.3     
[29] lattice_0.22-7     brms_2.23.0        Rcpp_1.1.0         robustbase_0.99-6 
[33] rms_8.1-0          Hmisc_5.2-4        psych_2.5.6        lubridate_1.9.4   
[37] forcats_1.0.1      stringr_1.6.0      dplyr_1.1.4        purrr_1.2.0       
[41] readr_2.1.6        tidyr_1.3.2        tibble_3.3.0       ggplot2_4.0.1     
[45] tidyverse_2.0.0    MASS_7.3-65        petersenlab_1.2.2 

loaded via a namespace (and not attached):
  [1] domir_1.2.0           splines_4.5.2         polspline_1.1.25     
  [4] R.oo_1.27.1           datawizard_1.3.0      rpart_4.1.24         
  [7] lifecycle_1.0.4       Rdpack_2.6.4          StanHeaders_2.32.10  
 [10] processx_3.8.6        globals_0.18.0        insight_1.4.4        
 [13] backports_1.5.0       survey_4.4-8          magrittr_2.0.4       
 [16] openxlsx_4.2.8.1      rmarkdown_2.30        plotrix_3.8-13       
 [19] yaml_2.3.12           otel_0.2.0            text2vec_0.6.6       
 [22] zip_2.3.3             pkgbuild_1.4.8        DBI_1.2.3            
 [25] minqa_1.2.8           RColorBrewer_1.1-3    multcomp_1.4-29      
 [28] abind_1.4-8           quadprog_1.5-8        nnet_7.3-20          
 [31] TH.data_1.1-5         tensorA_0.36.2.1      psychTools_2.5.7.22  
 [34] jtools_2.3.0          float_0.3-3           inline_0.3.21        
 [37] listenv_0.10.0        nortest_1.0-4         performance_0.15.3   
 [40] MatrixModels_0.5-4    goftest_1.2-3         bridgesampling_1.2-1 
 [43] parallelly_1.46.0     codetools_0.2-20      tidyselect_1.2.1     
 [46] shape_1.4.6.1         bayesplot_1.15.0      farver_2.1.2         
 [49] lme4_1.1-38           broom.mixed_0.2.9.6   matrixStats_1.5.0    
 [52] stats4_4.5.2          base64enc_0.1-3       jsonlite_2.0.0       
 [55] rsparse_0.5.3         mitml_0.4-5           Formula_1.2-5        
 [58] iterators_1.0.14      foreach_1.5.2         tools_4.5.2          
 [61] miscTools_0.6-28      yacca_1.4-2           glue_1.8.0           
 [64] mnormt_2.1.1          gridExtra_2.3         pan_1.9              
 [67] xfun_0.55             distributional_0.5.0  rtf_0.4-14.1         
 [70] rje_1.12.1            loo_2.8.0             withr_3.0.2          
 [73] fastmap_1.2.0         mitools_2.4           boot_1.3-32          
 [76] callr_3.7.6           digest_0.6.39         estimability_1.5.1   
 [79] timechange_0.3.0      R6_2.6.1              colorspace_2.1-2     
 [82] mix_1.0-13            R.methodsS3_1.8.2     RhpcBLASctl_0.23-42  
 [85] generics_0.1.4        data.table_1.17.8     htmlwidgets_1.6.4    
 [88] parameters_0.28.3     pkgconfig_2.0.3       gtable_0.3.6         
 [91] S7_0.2.1              furrr_0.3.1           htmltools_0.5.9      
 [94] scales_1.4.0          posterior_1.6.1       reformulas_0.4.3     
 [97] lgr_0.5.0             knitr_1.51            rstudioapi_0.17.1    
[100] tzdb_0.5.0            reshape2_1.4.5        coda_0.19-4.1        
[103] checkmate_2.3.3       nloptr_2.2.1          parallel_4.5.2       
[106] mlapi_0.1.1           pillar_1.11.1         grid_4.5.2           
[109] vctrs_0.6.5           jomo_2.7-6            xtable_1.8-4         
[112] cluster_2.1.8.1       htmlTable_2.4.3       evaluate_1.0.5       
[115] pbivnorm_0.6.0        kutils_1.73           mvtnorm_1.3-3        
[118] cli_3.6.5             compiler_4.5.2        rlang_1.1.6          
[121] crayon_1.5.3          rstantools_2.5.0      labeling_0.4.3       
[124] ps_1.9.1              plyr_1.8.9            rstan_2.32.7         
[127] stringi_1.8.7         pander_0.6.6          QuickJSR_1.8.1       
[130] viridisLite_0.4.2     glmnet_4.1-10         Brobdingnag_1.2-9    
[133] bayestestR_0.17.0     Matrix_1.7-4          hms_1.1.4            
[136] future_1.68.0         rbibutils_2.4         broom_1.0.11         
[139] RcppParallel_5.1.11-1 DEoptimR_1.1-4       </code></pre>
</div>
</div>


<!-- -->

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section></div></main> <!-- /main -->
<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/DevPsyLab\.github\.io\/DataAnalysis\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb337" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Regression"</span></span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span></span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html_document:</span></span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a><span class="co">    code_folding: show</span></span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-8"><a href="#cb337-8" aria-hidden="true" tabindex="-1"></a><span class="fu"># Preamble</span></span>
<span id="cb337-9"><a href="#cb337-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-10"><a href="#cb337-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## Install Libraries</span></span>
<span id="cb337-11"><a href="#cb337-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-14"><a href="#cb337-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-15"><a href="#cb337-15" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("remotes")</span></span>
<span id="cb337-16"><a href="#cb337-16" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("DevPsyLab/petersenlab")</span></span>
<span id="cb337-17"><a href="#cb337-17" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-18"><a href="#cb337-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-19"><a href="#cb337-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Libraries</span></span>
<span id="cb337-20"><a href="#cb337-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-23"><a href="#cb337-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-24"><a href="#cb337-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"petersenlab"</span>)</span>
<span id="cb337-25"><a href="#cb337-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"MASS"</span>)</span>
<span id="cb337-26"><a href="#cb337-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb337-27"><a href="#cb337-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"psych"</span>)</span>
<span id="cb337-28"><a href="#cb337-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rms"</span>)</span>
<span id="cb337-29"><a href="#cb337-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"robustbase"</span>)</span>
<span id="cb337-30"><a href="#cb337-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"brms"</span>)</span>
<span id="cb337-31"><a href="#cb337-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"cvTools"</span>)</span>
<span id="cb337-32"><a href="#cb337-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"car"</span>)</span>
<span id="cb337-33"><a href="#cb337-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mgcv"</span>)</span>
<span id="cb337-34"><a href="#cb337-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"AER"</span>)</span>
<span id="cb337-35"><a href="#cb337-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"foreign"</span>)</span>
<span id="cb337-36"><a href="#cb337-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"olsrr"</span>)</span>
<span id="cb337-37"><a href="#cb337-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"quantreg"</span>)</span>
<span id="cb337-38"><a href="#cb337-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mblm"</span>)</span>
<span id="cb337-39"><a href="#cb337-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"effects"</span>)</span>
<span id="cb337-40"><a href="#cb337-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"correlation"</span>)</span>
<span id="cb337-41"><a href="#cb337-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"interactions"</span>)</span>
<span id="cb337-42"><a href="#cb337-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"lavaan"</span>)</span>
<span id="cb337-43"><a href="#cb337-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"regtools"</span>)</span>
<span id="cb337-44"><a href="#cb337-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mice"</span>)</span>
<span id="cb337-45"><a href="#cb337-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"XICOR"</span>)</span>
<span id="cb337-46"><a href="#cb337-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"cocor"</span>)</span>
<span id="cb337-47"><a href="#cb337-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"effectsize"</span>)</span>
<span id="cb337-48"><a href="#cb337-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rockchalk"</span>)</span>
<span id="cb337-49"><a href="#cb337-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"yhat"</span>)</span>
<span id="cb337-50"><a href="#cb337-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-51"><a href="#cb337-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-52"><a href="#cb337-52" aria-hidden="true" tabindex="-1"></a><span class="fu"># Import Data</span></span>
<span id="cb337-53"><a href="#cb337-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-56"><a href="#cb337-56" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-57"><a href="#cb337-57" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb337-58"><a href="#cb337-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-59"><a href="#cb337-59" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://osf.io/8syp5/download"</span>)</span>
<span id="cb337-60"><a href="#cb337-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-61"><a href="#cb337-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-64"><a href="#cb337-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-65"><a href="#cb337-65" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb337-66"><a href="#cb337-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-67"><a href="#cb337-67" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/cnlsy.csv"</span>) <span class="co">#https://osf.io/8syp5/download</span></span>
<span id="cb337-68"><a href="#cb337-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-69"><a href="#cb337-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-70"><a href="#cb337-70" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Preparation</span></span>
<span id="cb337-71"><a href="#cb337-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-74"><a href="#cb337-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-75"><a href="#cb337-75" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>countVariable <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(mydata<span class="sc">$</span>bpi_antisocialT2Sum)</span>
<span id="cb337-76"><a href="#cb337-76" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>orderedVariable <span class="ot">&lt;-</span> <span class="fu">factor</span>(mydata<span class="sc">$</span>countVariable, <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-77"><a href="#cb337-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-78"><a href="#cb337-78" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>female <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb337-79"><a href="#cb337-79" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>female[<span class="fu">which</span>(mydata<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"male"</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb337-80"><a href="#cb337-80" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>female[<span class="fu">which</span>(mydata<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"female"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb337-81"><a href="#cb337-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-82"><a href="#cb337-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-83"><a href="#cb337-83" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview of Multiple Regression</span></span>
<span id="cb337-84"><a href="#cb337-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-85"><a href="#cb337-85" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/multiple-regression.html&gt;</span></span>
<span id="cb337-86"><a href="#cb337-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-87"><a href="#cb337-87" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linear Regression</span></span>
<span id="cb337-88"><a href="#cb337-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-89"><a href="#cb337-89" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear regression model</span></span>
<span id="cb337-90"><a href="#cb337-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-93"><a href="#cb337-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-94"><a href="#cb337-94" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-95"><a href="#cb337-95" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-96"><a href="#cb337-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-97"><a href="#cb337-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-98"><a href="#cb337-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-99"><a href="#cb337-99" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel)</span>
<span id="cb337-100"><a href="#cb337-100" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(multipleRegressionModel)</span>
<span id="cb337-101"><a href="#cb337-101" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(multipleRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-102"><a href="#cb337-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-103"><a href="#cb337-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-104"><a href="#cb337-104" aria-hidden="true" tabindex="-1"></a><span class="fu">### Remove missing data</span></span>
<span id="cb337-105"><a href="#cb337-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-108"><a href="#cb337-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-109"><a href="#cb337-109" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelNoMissing <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-110"><a href="#cb337-110" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-111"><a href="#cb337-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-112"><a href="#cb337-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit)</span>
<span id="cb337-113"><a href="#cb337-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-114"><a href="#cb337-114" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelNoMissing <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-115"><a href="#cb337-115" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-116"><a href="#cb337-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata <span class="sc">%&gt;%</span> <span class="fu">select</span>(bpi_antisocialT2Sum, bpi_antisocialT1Sum, bpi_anxiousDepressedSum) <span class="sc">%&gt;%</span> na.omit)</span>
<span id="cb337-117"><a href="#cb337-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-118"><a href="#cb337-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-119"><a href="#cb337-119" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear regression model on correlation/covariance matrix (for pairwise deletion)</span></span>
<span id="cb337-120"><a href="#cb337-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-123"><a href="#cb337-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-124"><a href="#cb337-124" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelPairwise <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">setCor</span>(</span>
<span id="cb337-125"><a href="#cb337-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span id="cb337-126"><a href="#cb337-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span>),</span>
<span id="cb337-127"><a href="#cb337-127" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">cov</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT2Sum"</span>,<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span>)], <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>),</span>
<span id="cb337-128"><a href="#cb337-128" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.obs =</span> <span class="fu">nrow</span>(mydata))</span>
<span id="cb337-129"><a href="#cb337-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-130"><a href="#cb337-130" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModelPairwise)</span>
<span id="cb337-131"><a href="#cb337-131" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelPairwise[<span class="fu">c</span>(<span class="st">"coefficients"</span>,<span class="st">"se"</span>,<span class="st">"Probability"</span>,<span class="st">"R2"</span>,<span class="st">"shrunkenR2"</span>)]</span>
<span id="cb337-132"><a href="#cb337-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-133"><a href="#cb337-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-134"><a href="#cb337-134" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear regression model with robust covariance matrix (rms)</span></span>
<span id="cb337-135"><a href="#cb337-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-138"><a href="#cb337-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-139"><a href="#cb337-139" aria-hidden="true" tabindex="-1"></a>rmsMultipleRegressionModel <span class="ot">&lt;-</span> <span class="fu">robcov</span>(<span class="fu">ols</span>(</span>
<span id="cb337-140"><a href="#cb337-140" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-141"><a href="#cb337-141" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-142"><a href="#cb337-142" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-143"><a href="#cb337-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>))</span>
<span id="cb337-144"><a href="#cb337-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-145"><a href="#cb337-145" aria-hidden="true" tabindex="-1"></a>rmsMultipleRegressionModel</span>
<span id="cb337-146"><a href="#cb337-146" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(rmsMultipleRegressionModel)</span>
<span id="cb337-147"><a href="#cb337-147" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(rmsMultipleRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-148"><a href="#cb337-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-149"><a href="#cb337-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-150"><a href="#cb337-150" aria-hidden="true" tabindex="-1"></a><span class="fu">## Robust linear regression (MM-type iteratively reweighted least squares regression)</span></span>
<span id="cb337-151"><a href="#cb337-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-154"><a href="#cb337-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-155"><a href="#cb337-155" aria-hidden="true" tabindex="-1"></a>robustLinearRegression <span class="ot">&lt;-</span> <span class="fu">lmrob</span>(</span>
<span id="cb337-156"><a href="#cb337-156" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-157"><a href="#cb337-157" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-158"><a href="#cb337-158" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-159"><a href="#cb337-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-160"><a href="#cb337-160" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(robustLinearRegression)</span>
<span id="cb337-161"><a href="#cb337-161" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(robustLinearRegression)</span>
<span id="cb337-162"><a href="#cb337-162" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(robustLinearRegression), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-163"><a href="#cb337-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-164"><a href="#cb337-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-165"><a href="#cb337-165" aria-hidden="true" tabindex="-1"></a><span class="fu">## Least trimmed squares regression (for removing outliers)</span></span>
<span id="cb337-166"><a href="#cb337-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-169"><a href="#cb337-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-170"><a href="#cb337-170" aria-hidden="true" tabindex="-1"></a>ltsRegression <span class="ot">&lt;-</span> robustbase<span class="sc">::</span><span class="fu">ltsReg</span>(</span>
<span id="cb337-171"><a href="#cb337-171" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-172"><a href="#cb337-172" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-173"><a href="#cb337-173" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-174"><a href="#cb337-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-175"><a href="#cb337-175" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ltsRegression)</span>
<span id="cb337-176"><a href="#cb337-176" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(robustLinearRegression)</span>
<span id="cb337-177"><a href="#cb337-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-178"><a href="#cb337-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-179"><a href="#cb337-179" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian linear regression</span></span>
<span id="cb337-180"><a href="#cb337-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-183"><a href="#cb337-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-184"><a href="#cb337-184" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb337-185"><a href="#cb337-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-186"><a href="#cb337-186" aria-hidden="true" tabindex="-1"></a>bayesianRegularizedRegression <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb337-187"><a href="#cb337-187" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-188"><a href="#cb337-188" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-189"><a href="#cb337-189" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb337-190"><a href="#cb337-190" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb337-191"><a href="#cb337-191" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>)</span>
<span id="cb337-192"><a href="#cb337-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-193"><a href="#cb337-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-196"><a href="#cb337-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-197"><a href="#cb337-197" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianRegularizedRegression)</span>
<span id="cb337-198"><a href="#cb337-198" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianRegularizedRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-199"><a href="#cb337-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-200"><a href="#cb337-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-201"><a href="#cb337-201" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generalized Linear Regression</span></span>
<span id="cb337-202"><a href="#cb337-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-203"><a href="#cb337-203" aria-hidden="true" tabindex="-1"></a><span class="fu">## Generalized regression model</span></span>
<span id="cb337-204"><a href="#cb337-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-205"><a href="#cb337-205" aria-hidden="true" tabindex="-1"></a>In this example, we predict a count variable that has a poisson distribution.</span>
<span id="cb337-206"><a href="#cb337-206" aria-hidden="true" tabindex="-1"></a>We could change the distribution.</span>
<span id="cb337-207"><a href="#cb337-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-210"><a href="#cb337-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-211"><a href="#cb337-211" aria-hidden="true" tabindex="-1"></a>generalizedRegressionModel <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb337-212"><a href="#cb337-212" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-213"><a href="#cb337-213" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-214"><a href="#cb337-214" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb337-215"><a href="#cb337-215" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-216"><a href="#cb337-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-217"><a href="#cb337-217" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(generalizedRegressionModel)</span>
<span id="cb337-218"><a href="#cb337-218" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(generalizedRegressionModel)</span>
<span id="cb337-219"><a href="#cb337-219" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(generalizedRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-220"><a href="#cb337-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-221"><a href="#cb337-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-222"><a href="#cb337-222" aria-hidden="true" tabindex="-1"></a><span class="fu">## Generalized regression model (rms)</span></span>
<span id="cb337-223"><a href="#cb337-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-224"><a href="#cb337-224" aria-hidden="true" tabindex="-1"></a>In this example, we predict a count variable that has a poisson distribution.</span>
<span id="cb337-225"><a href="#cb337-225" aria-hidden="true" tabindex="-1"></a>We could change the distribution.</span>
<span id="cb337-226"><a href="#cb337-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-229"><a href="#cb337-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-230"><a href="#cb337-230" aria-hidden="true" tabindex="-1"></a>rmsGeneralizedRegressionModel <span class="ot">&lt;-</span> rms<span class="sc">::</span><span class="fu">Glm</span>(</span>
<span id="cb337-231"><a href="#cb337-231" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-232"><a href="#cb337-232" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-233"><a href="#cb337-233" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-234"><a href="#cb337-234" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-235"><a href="#cb337-235" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb337-236"><a href="#cb337-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-237"><a href="#cb337-237" aria-hidden="true" tabindex="-1"></a>rmsGeneralizedRegressionModel</span>
<span id="cb337-238"><a href="#cb337-238" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(rmsGeneralizedRegressionModel)</span>
<span id="cb337-239"><a href="#cb337-239" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(rmsGeneralizedRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-240"><a href="#cb337-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-241"><a href="#cb337-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-242"><a href="#cb337-242" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian generalized linear model</span></span>
<span id="cb337-243"><a href="#cb337-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-244"><a href="#cb337-244" aria-hidden="true" tabindex="-1"></a>In this example, we predict a count variable that has a poisson distribution.</span>
<span id="cb337-245"><a href="#cb337-245" aria-hidden="true" tabindex="-1"></a>We could change the distribution.</span>
<span id="cb337-246"><a href="#cb337-246" aria-hidden="true" tabindex="-1"></a>For example, we could use Gamma regression, <span class="in">`family = Gamma`</span>, when the response variable is continuous and positive, and the coefficient of variation--rather than the variance--is constant.</span>
<span id="cb337-247"><a href="#cb337-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-250"><a href="#cb337-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-251"><a href="#cb337-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb337-252"><a href="#cb337-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-253"><a href="#cb337-253" aria-hidden="true" tabindex="-1"></a>bayesianGeneralizedLinearRegression <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb337-254"><a href="#cb337-254" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-255"><a href="#cb337-255" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-256"><a href="#cb337-256" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> poisson,</span>
<span id="cb337-257"><a href="#cb337-257" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb337-258"><a href="#cb337-258" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>,</span>
<span id="cb337-259"><a href="#cb337-259" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>)</span>
<span id="cb337-260"><a href="#cb337-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-261"><a href="#cb337-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-264"><a href="#cb337-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-265"><a href="#cb337-265" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianGeneralizedLinearRegression)</span>
<span id="cb337-266"><a href="#cb337-266" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianGeneralizedLinearRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-267"><a href="#cb337-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-268"><a href="#cb337-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-269"><a href="#cb337-269" aria-hidden="true" tabindex="-1"></a><span class="fu">## Robust generalized regression</span></span>
<span id="cb337-270"><a href="#cb337-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-273"><a href="#cb337-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-274"><a href="#cb337-274" aria-hidden="true" tabindex="-1"></a>robustGeneralizedRegression <span class="ot">&lt;-</span> robustbase<span class="sc">::</span><span class="fu">glmrob</span>(</span>
<span id="cb337-275"><a href="#cb337-275" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-276"><a href="#cb337-276" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-277"><a href="#cb337-277" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb337-278"><a href="#cb337-278" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-279"><a href="#cb337-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-280"><a href="#cb337-280" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(robustGeneralizedRegression)</span>
<span id="cb337-281"><a href="#cb337-281" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(robustGeneralizedRegression)</span>
<span id="cb337-282"><a href="#cb337-282" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(robustGeneralizedRegression), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-283"><a href="#cb337-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-284"><a href="#cb337-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-285"><a href="#cb337-285" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ordinal regression model</span></span>
<span id="cb337-286"><a href="#cb337-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-289"><a href="#cb337-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-290"><a href="#cb337-290" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel1 <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">polr</span>(</span>
<span id="cb337-291"><a href="#cb337-291" aria-hidden="true" tabindex="-1"></a>  orderedVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-292"><a href="#cb337-292" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata)</span>
<span id="cb337-293"><a href="#cb337-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-294"><a href="#cb337-294" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel2 <span class="ot">&lt;-</span> rms<span class="sc">::</span><span class="fu">lrm</span>(</span>
<span id="cb337-295"><a href="#cb337-295" aria-hidden="true" tabindex="-1"></a>  orderedVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-296"><a href="#cb337-296" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-297"><a href="#cb337-297" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-298"><a href="#cb337-298" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-299"><a href="#cb337-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-300"><a href="#cb337-300" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel3 <span class="ot">&lt;-</span> rms<span class="sc">::</span><span class="fu">orm</span>(</span>
<span id="cb337-301"><a href="#cb337-301" aria-hidden="true" tabindex="-1"></a>  orderedVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-302"><a href="#cb337-302" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-303"><a href="#cb337-303" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-304"><a href="#cb337-304" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-305"><a href="#cb337-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-306"><a href="#cb337-306" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ordinalRegressionModel1)</span>
<span id="cb337-307"><a href="#cb337-307" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(ordinalRegressionModel1)</span>
<span id="cb337-308"><a href="#cb337-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-309"><a href="#cb337-309" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel2</span>
<span id="cb337-310"><a href="#cb337-310" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(ordinalRegressionModel2), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-311"><a href="#cb337-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-312"><a href="#cb337-312" aria-hidden="true" tabindex="-1"></a>ordinalRegressionModel3</span>
<span id="cb337-313"><a href="#cb337-313" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(ordinalRegressionModel3)</span>
<span id="cb337-314"><a href="#cb337-314" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(ordinalRegressionModel3), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-315"><a href="#cb337-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-316"><a href="#cb337-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-317"><a href="#cb337-317" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian ordinal regression model</span></span>
<span id="cb337-318"><a href="#cb337-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-321"><a href="#cb337-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-322"><a href="#cb337-322" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb337-323"><a href="#cb337-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-324"><a href="#cb337-324" aria-hidden="true" tabindex="-1"></a>bayesianOrdinalRegression <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb337-325"><a href="#cb337-325" aria-hidden="true" tabindex="-1"></a>  orderedVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-326"><a href="#cb337-326" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-327"><a href="#cb337-327" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">cumulative</span>(),</span>
<span id="cb337-328"><a href="#cb337-328" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb337-329"><a href="#cb337-329" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>,</span>
<span id="cb337-330"><a href="#cb337-330" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>)</span>
<span id="cb337-331"><a href="#cb337-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-332"><a href="#cb337-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-335"><a href="#cb337-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-336"><a href="#cb337-336" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianOrdinalRegression)</span>
<span id="cb337-337"><a href="#cb337-337" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianOrdinalRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-338"><a href="#cb337-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-339"><a href="#cb337-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-340"><a href="#cb337-340" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian count regression model</span></span>
<span id="cb337-341"><a href="#cb337-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-344"><a href="#cb337-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-345"><a href="#cb337-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb337-346"><a href="#cb337-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-347"><a href="#cb337-347" aria-hidden="true" tabindex="-1"></a>bayesianCountRegression <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb337-348"><a href="#cb337-348" aria-hidden="true" tabindex="-1"></a>  countVariable <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-349"><a href="#cb337-349" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-350"><a href="#cb337-350" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb337-351"><a href="#cb337-351" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb337-352"><a href="#cb337-352" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>,</span>
<span id="cb337-353"><a href="#cb337-353" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>)</span>
<span id="cb337-354"><a href="#cb337-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-355"><a href="#cb337-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-358"><a href="#cb337-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-359"><a href="#cb337-359" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianCountRegression)</span>
<span id="cb337-360"><a href="#cb337-360" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianCountRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-361"><a href="#cb337-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-362"><a href="#cb337-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-363"><a href="#cb337-363" aria-hidden="true" tabindex="-1"></a><span class="fu">## Logistic regression model (rms)</span></span>
<span id="cb337-364"><a href="#cb337-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-367"><a href="#cb337-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-368"><a href="#cb337-368" aria-hidden="true" tabindex="-1"></a>logisticRegressionModel <span class="ot">&lt;-</span> rms<span class="sc">::</span><span class="fu">robcov</span>(rms<span class="sc">::</span><span class="fu">lrm</span>(</span>
<span id="cb337-369"><a href="#cb337-369" aria-hidden="true" tabindex="-1"></a>  female <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-370"><a href="#cb337-370" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-371"><a href="#cb337-371" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-372"><a href="#cb337-372" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>))</span>
<span id="cb337-373"><a href="#cb337-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-374"><a href="#cb337-374" aria-hidden="true" tabindex="-1"></a>logisticRegressionModel</span>
<span id="cb337-375"><a href="#cb337-375" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(logisticRegressionModel)</span>
<span id="cb337-376"><a href="#cb337-376" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(logisticRegressionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-377"><a href="#cb337-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-378"><a href="#cb337-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-379"><a href="#cb337-379" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian logistic regression model</span></span>
<span id="cb337-380"><a href="#cb337-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-383"><a href="#cb337-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-384"><a href="#cb337-384" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb337-385"><a href="#cb337-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-386"><a href="#cb337-386" aria-hidden="true" tabindex="-1"></a>bayesianLogisticRegression <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb337-387"><a href="#cb337-387" aria-hidden="true" tabindex="-1"></a>  female <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-388"><a href="#cb337-388" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-389"><a href="#cb337-389" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> bernoulli,</span>
<span id="cb337-390"><a href="#cb337-390" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb337-391"><a href="#cb337-391" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>,</span>
<span id="cb337-392"><a href="#cb337-392" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>)</span>
<span id="cb337-393"><a href="#cb337-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-394"><a href="#cb337-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-397"><a href="#cb337-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-398"><a href="#cb337-398" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayesianLogisticRegression)</span>
<span id="cb337-399"><a href="#cb337-399" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(bayesianLogisticRegression, <span class="at">method =</span> <span class="st">"basic"</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-400"><a href="#cb337-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-401"><a href="#cb337-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-402"><a href="#cb337-402" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hierarchical Linear Regression</span></span>
<span id="cb337-403"><a href="#cb337-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-406"><a href="#cb337-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-407"><a href="#cb337-407" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-408"><a href="#cb337-408" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum,</span>
<span id="cb337-409"><a href="#cb337-409" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata <span class="sc">%&gt;%</span> <span class="fu">select</span>(bpi_antisocialT2Sum, bpi_antisocialT1Sum, bpi_anxiousDepressedSum) <span class="sc">%&gt;%</span> na.omit,</span>
<span id="cb337-410"><a href="#cb337-410" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-411"><a href="#cb337-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-412"><a href="#cb337-412" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-413"><a href="#cb337-413" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-414"><a href="#cb337-414" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata <span class="sc">%&gt;%</span> <span class="fu">select</span>(bpi_antisocialT2Sum, bpi_antisocialT1Sum, bpi_anxiousDepressedSum) <span class="sc">%&gt;%</span> na.omit,</span>
<span id="cb337-415"><a href="#cb337-415" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-416"><a href="#cb337-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-417"><a href="#cb337-417" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)<span class="sc">$</span>adj.r.squared</span>
<span id="cb337-418"><a href="#cb337-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-419"><a href="#cb337-419" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1, model2)</span>
<span id="cb337-420"><a href="#cb337-420" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)<span class="sc">$</span>adj.r.squared <span class="sc">-</span> <span class="fu">summary</span>(model1)<span class="sc">$</span>adj.r.squared</span>
<span id="cb337-421"><a href="#cb337-421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-422"><a href="#cb337-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-423"><a href="#cb337-423" aria-hidden="true" tabindex="-1"></a><span class="fu"># Moderated Multiple Regression {#moderation}</span></span>
<span id="cb337-424"><a href="#cb337-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-425"><a href="#cb337-425" aria-hidden="true" tabindex="-1"></a>When testing for the possibility of moderation/interaction, it is first important to think about what shape the interaction might take.</span>
<span id="cb337-426"><a href="#cb337-426" aria-hidden="true" tabindex="-1"></a>If you expect a bilinear interaction (i.e., the slope of the regression line between <span class="in">`X`</span> and <span class="in">`Y`</span> changes as a *linear* function of a third variable, <span class="in">`Z`</span>), it is appropriate to treat the moderator as continuous in moderated multiple regression.</span>
<span id="cb337-427"><a href="#cb337-427" aria-hidden="true" tabindex="-1"></a>However, if you expect that the interaction might take a different form (e.g., a threshold effect), you may need to consider other approaches, such as using categorical variables, polynomial interactions, spline functions, generalized additive models (GAMs), or machine learning.</span>
<span id="cb337-428"><a href="#cb337-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-429"><a href="#cb337-429" aria-hidden="true" tabindex="-1"></a>For information on the (low) power to detect interactions and how to improve it, see:</span>
<span id="cb337-430"><a href="#cb337-430" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://isaactpetersen.github.io/Principles-Psychological-Assessment/reliability.html#productTerm-reliability&gt;</span></span>
<span id="cb337-431"><a href="#cb337-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-432"><a href="#cb337-432" aria-hidden="true" tabindex="-1"></a>The examples below use the <span class="in">`interactions`</span> package in R.</span>
<span id="cb337-433"><a href="#cb337-433" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://cran.r-project.org/web/packages/interactions/vignettes/interactions.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/P34H-7BH3&gt;</span>)</span>
<span id="cb337-434"><a href="#cb337-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-437"><a href="#cb337-437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-438"><a href="#cb337-438" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(state.x77)</span>
<span id="cb337-439"><a href="#cb337-439" aria-hidden="true" tabindex="-1"></a>states<span class="sc">$</span>HS.Grad <span class="ot">&lt;-</span> states<span class="sc">$</span><span class="st">`</span><span class="at">HS Grad</span><span class="st">`</span></span>
<span id="cb337-440"><a href="#cb337-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-441"><a href="#cb337-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-442"><a href="#cb337-442" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mean Center Predictors</span></span>
<span id="cb337-443"><a href="#cb337-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-444"><a href="#cb337-444" aria-hidden="true" tabindex="-1"></a>Make sure to mean-center or orthogonalize predictors before computing the interaction term.</span>
<span id="cb337-445"><a href="#cb337-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-448"><a href="#cb337-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-449"><a href="#cb337-449" aria-hidden="true" tabindex="-1"></a>states<span class="sc">$</span>Illiteracy_centered <span class="ot">&lt;-</span> <span class="fu">scale</span>(states<span class="sc">$</span>Illiteracy, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb337-450"><a href="#cb337-450" aria-hidden="true" tabindex="-1"></a>states<span class="sc">$</span>Murder_centered <span class="ot">&lt;-</span> <span class="fu">scale</span>(states<span class="sc">$</span>Murder, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb337-451"><a href="#cb337-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-452"><a href="#cb337-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-453"><a href="#cb337-453" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model</span></span>
<span id="cb337-454"><a href="#cb337-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-457"><a href="#cb337-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-458"><a href="#cb337-458" aria-hidden="true" tabindex="-1"></a>interactionModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-459"><a href="#cb337-459" aria-hidden="true" tabindex="-1"></a>  Income <span class="sc">~</span> Illiteracy_centered <span class="sc">+</span> Murder_centered <span class="sc">+</span> Illiteracy_centered<span class="sc">:</span>Murder_centered <span class="sc">+</span> HS.Grad,</span>
<span id="cb337-460"><a href="#cb337-460" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> states)</span>
<span id="cb337-461"><a href="#cb337-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-462"><a href="#cb337-462" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interactionModel)</span>
<span id="cb337-463"><a href="#cb337-463" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(interactionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-464"><a href="#cb337-464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-465"><a href="#cb337-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-466"><a href="#cb337-466" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plots</span></span>
<span id="cb337-467"><a href="#cb337-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-470"><a href="#cb337-470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-471"><a href="#cb337-471" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">interact_plot</span>(</span>
<span id="cb337-472"><a href="#cb337-472" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-473"><a href="#cb337-473" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-474"><a href="#cb337-474" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered)</span>
<span id="cb337-475"><a href="#cb337-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-476"><a href="#cb337-476" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">interact_plot</span>(</span>
<span id="cb337-477"><a href="#cb337-477" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-478"><a href="#cb337-478" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-479"><a href="#cb337-479" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-480"><a href="#cb337-480" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.points =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-481"><a href="#cb337-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-482"><a href="#cb337-482" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">interact_plot</span>(</span>
<span id="cb337-483"><a href="#cb337-483" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-484"><a href="#cb337-484" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-485"><a href="#cb337-485" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-486"><a href="#cb337-486" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-487"><a href="#cb337-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-488"><a href="#cb337-488" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">johnson_neyman</span>(</span>
<span id="cb337-489"><a href="#cb337-489" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-490"><a href="#cb337-490" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-491"><a href="#cb337-491" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-492"><a href="#cb337-492" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> .<span class="dv">05</span>)</span>
<span id="cb337-493"><a href="#cb337-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-494"><a href="#cb337-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-495"><a href="#cb337-495" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simple Slopes Analysis</span></span>
<span id="cb337-496"><a href="#cb337-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-499"><a href="#cb337-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-500"><a href="#cb337-500" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">sim_slopes</span>(</span>
<span id="cb337-501"><a href="#cb337-501" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-502"><a href="#cb337-502" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-503"><a href="#cb337-503" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-504"><a href="#cb337-504" aria-hidden="true" tabindex="-1"></a>  <span class="at">johnson_neyman =</span> <span class="cn">FALSE</span>)</span>
<span id="cb337-505"><a href="#cb337-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-506"><a href="#cb337-506" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">sim_slopes</span>(</span>
<span id="cb337-507"><a href="#cb337-507" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-508"><a href="#cb337-508" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-509"><a href="#cb337-509" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-510"><a href="#cb337-510" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx.values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb337-511"><a href="#cb337-511" aria-hidden="true" tabindex="-1"></a>  <span class="at">johnson_neyman =</span> <span class="cn">FALSE</span>)</span>
<span id="cb337-512"><a href="#cb337-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-513"><a href="#cb337-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-514"><a href="#cb337-514" aria-hidden="true" tabindex="-1"></a><span class="fu">## Johnson-Neyman intervals</span></span>
<span id="cb337-515"><a href="#cb337-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-516"><a href="#cb337-516" aria-hidden="true" tabindex="-1"></a>Indicates all the values of the moderator for which the slope of the predictor is statistically significant.</span>
<span id="cb337-517"><a href="#cb337-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-520"><a href="#cb337-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-521"><a href="#cb337-521" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">sim_slopes</span>(</span>
<span id="cb337-522"><a href="#cb337-522" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-523"><a href="#cb337-523" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-524"><a href="#cb337-524" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-525"><a href="#cb337-525" aria-hidden="true" tabindex="-1"></a>  <span class="at">johnson_neyman =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-526"><a href="#cb337-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-527"><a href="#cb337-527" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">probe_interaction</span>(</span>
<span id="cb337-528"><a href="#cb337-528" aria-hidden="true" tabindex="-1"></a>  interactionModel,</span>
<span id="cb337-529"><a href="#cb337-529" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Illiteracy_centered,</span>
<span id="cb337-530"><a href="#cb337-530" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Murder_centered,</span>
<span id="cb337-531"><a href="#cb337-531" aria-hidden="true" tabindex="-1"></a>  <span class="at">cond.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-532"><a href="#cb337-532" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-533"><a href="#cb337-533" aria-hidden="true" tabindex="-1"></a>  <span class="at">jnplot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-534"><a href="#cb337-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-535"><a href="#cb337-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-536"><a href="#cb337-536" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparing Correlations {#compareCorrelations}</span></span>
<span id="cb337-537"><a href="#cb337-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-538"><a href="#cb337-538" aria-hidden="true" tabindex="-1"></a>Fisher's *r*-to-*z* test.</span>
<span id="cb337-539"><a href="#cb337-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-540"><a href="#cb337-540" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;http://comparingcorrelations.org&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/X3EU-24GL&gt;</span>)</span>
<span id="cb337-541"><a href="#cb337-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-542"><a href="#cb337-542" aria-hidden="true" tabindex="-1"></a>Independent groups (two different groups):</span>
<span id="cb337-543"><a href="#cb337-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-546"><a href="#cb337-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-547"><a href="#cb337-547" aria-hidden="true" tabindex="-1"></a>cocor<span class="sc">::</span><span class="fu">cocor.indep.groups</span>(</span>
<span id="cb337-548"><a href="#cb337-548" aria-hidden="true" tabindex="-1"></a>  <span class="at">r1.jk =</span> .<span class="dv">7</span>,</span>
<span id="cb337-549"><a href="#cb337-549" aria-hidden="true" tabindex="-1"></a>  <span class="at">r2.hm =</span> .<span class="dv">6</span>,</span>
<span id="cb337-550"><a href="#cb337-550" aria-hidden="true" tabindex="-1"></a>  <span class="at">n1 =</span> <span class="dv">305</span>,</span>
<span id="cb337-551"><a href="#cb337-551" aria-hidden="true" tabindex="-1"></a>  <span class="at">n2 =</span> <span class="dv">210</span>,</span>
<span id="cb337-552"><a href="#cb337-552" aria-hidden="true" tabindex="-1"></a>  <span class="at">data.name =</span> <span class="fu">c</span>(<span class="st">"group1"</span>, <span class="st">"group2"</span>),</span>
<span id="cb337-553"><a href="#cb337-553" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.labels =</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"intelligence"</span>, <span class="st">"age"</span>, <span class="st">"intelligence"</span>))</span>
<span id="cb337-554"><a href="#cb337-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-555"><a href="#cb337-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-556"><a href="#cb337-556" aria-hidden="true" tabindex="-1"></a>Dependent groups (same group), overlapping correlation (shares a variable in common—in this case, the variable <span class="in">`age`</span> is shared in both correlations):</span>
<span id="cb337-557"><a href="#cb337-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-560"><a href="#cb337-560" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-561"><a href="#cb337-561" aria-hidden="true" tabindex="-1"></a>cocor<span class="sc">::</span><span class="fu">cocor.dep.groups.overlap</span>(</span>
<span id="cb337-562"><a href="#cb337-562" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jk =</span> .<span class="dv">2</span>, <span class="co"># Correlation (age, intelligence)</span></span>
<span id="cb337-563"><a href="#cb337-563" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jh =</span> .<span class="dv">5</span>, <span class="co"># Correlation (age, shoe size)</span></span>
<span id="cb337-564"><a href="#cb337-564" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.kh =</span> .<span class="dv">1</span>, <span class="co"># Correlation (intelligence, shoe index)</span></span>
<span id="cb337-565"><a href="#cb337-565" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">315</span>,</span>
<span id="cb337-566"><a href="#cb337-566" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.labels =</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"intelligence"</span>, <span class="st">"shoe size"</span>))</span>
<span id="cb337-567"><a href="#cb337-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-568"><a href="#cb337-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-569"><a href="#cb337-569" aria-hidden="true" tabindex="-1"></a>Dependent groups (same group), non-overlapping correlation (does not share a variable in common):</span>
<span id="cb337-570"><a href="#cb337-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-573"><a href="#cb337-573" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-574"><a href="#cb337-574" aria-hidden="true" tabindex="-1"></a>cocor<span class="sc">::</span><span class="fu">cocor.dep.groups.nonoverlap</span>(</span>
<span id="cb337-575"><a href="#cb337-575" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jk =</span> .<span class="dv">2</span>, <span class="co"># Correlation (age, intelligence)</span></span>
<span id="cb337-576"><a href="#cb337-576" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.hm =</span> .<span class="dv">7</span>, <span class="co"># Correlation (body mass index, shoe size)</span></span>
<span id="cb337-577"><a href="#cb337-577" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jh =</span> .<span class="dv">4</span>, <span class="co"># Correlation (age, body mass index)</span></span>
<span id="cb337-578"><a href="#cb337-578" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.jm =</span> .<span class="dv">5</span>, <span class="co"># Correlation (age, shoe size)</span></span>
<span id="cb337-579"><a href="#cb337-579" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.kh =</span> .<span class="dv">1</span>, <span class="co"># Correlation (intelligence, body mass index)</span></span>
<span id="cb337-580"><a href="#cb337-580" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.km =</span> .<span class="dv">3</span>, <span class="co"># Correlation (intelligence, shoe size)</span></span>
<span id="cb337-581"><a href="#cb337-581" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">232</span>,</span>
<span id="cb337-582"><a href="#cb337-582" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.labels =</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"intelligence"</span>, <span class="st">"body mass index"</span>, <span class="st">"shoe size"</span>))</span>
<span id="cb337-583"><a href="#cb337-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-584"><a href="#cb337-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-585"><a href="#cb337-585" aria-hidden="true" tabindex="-1"></a><span class="fu"># Approaches to Handling Missingness {#missingness}</span></span>
<span id="cb337-586"><a href="#cb337-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-587"><a href="#cb337-587" aria-hidden="true" tabindex="-1"></a><span class="fu">## Listwise deletion {#listwiseDeletion}</span></span>
<span id="cb337-588"><a href="#cb337-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-589"><a href="#cb337-589" aria-hidden="true" tabindex="-1"></a>Listwise deletion deletes every row in the data file that has a missing value for one of the model variables.</span>
<span id="cb337-590"><a href="#cb337-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-593"><a href="#cb337-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-594"><a href="#cb337-594" aria-hidden="true" tabindex="-1"></a>listwiseDeletionModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-595"><a href="#cb337-595" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-596"><a href="#cb337-596" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-597"><a href="#cb337-597" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-598"><a href="#cb337-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-599"><a href="#cb337-599" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(listwiseDeletionModel)</span>
<span id="cb337-600"><a href="#cb337-600" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(listwiseDeletionModel)</span>
<span id="cb337-601"><a href="#cb337-601" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effectsize<span class="sc">::</span><span class="fu">standardize_parameters</span>(listwiseDeletionModel), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb337-602"><a href="#cb337-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-603"><a href="#cb337-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-604"><a href="#cb337-604" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pairwise deletion {#pairwiseDeletion}</span></span>
<span id="cb337-605"><a href="#cb337-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-606"><a href="#cb337-606" aria-hidden="true" tabindex="-1"></a>Also see here:</span>
<span id="cb337-607"><a href="#cb337-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-608"><a href="#cb337-608" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://stats.stackexchange.com/questions/158366/fit-multiple-regression-model-with-pairwise-deletion-or-on-a-correlation-covari/173002#173002&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/GH5T-RXD9&gt;</span>)</span>
<span id="cb337-609"><a href="#cb337-609" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://stats.stackexchange.com/questions/299792/r-lm-covariance-matrix-manual-calculation-failure&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/F7EL-AUFZ&gt;</span>)</span>
<span id="cb337-610"><a href="#cb337-610" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://stats.stackexchange.com/questions/107597/is-there-a-way-to-use-the-covariance-matrix-to-find-coefficients-for-multiple-re&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/KU3X-FB2C&gt;</span>)</span>
<span id="cb337-611"><a href="#cb337-611" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://stats.stackexchange.com/questions/105006/how-to-perform-a-bivariate-regression-using-pairwise-deletion-of-missing-values&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/QWQ5-2TLW&gt;</span>)</span>
<span id="cb337-612"><a href="#cb337-612" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://dl.dropboxusercontent.com/s/4sf0et3p47ykctx/MissingPairwise.sps&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/UC4K-2L9T&gt;</span>)</span>
<span id="cb337-613"><a href="#cb337-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-614"><a href="#cb337-614" aria-hidden="true" tabindex="-1"></a>Adapted from here: <span class="ot">&lt;https://stefvanbuuren.name/fimd/sec-simplesolutions.html#sec:pairwise&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/EGU6-3M3Q&gt;</span>)</span>
<span id="cb337-615"><a href="#cb337-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-618"><a href="#cb337-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-619"><a href="#cb337-619" aria-hidden="true" tabindex="-1"></a>modelData <span class="ot">&lt;-</span> mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT2Sum"</span>,<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span>)]</span>
<span id="cb337-620"><a href="#cb337-620" aria-hidden="true" tabindex="-1"></a>varMeans <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(modelData, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-621"><a href="#cb337-621" aria-hidden="true" tabindex="-1"></a>varCovariances <span class="ot">&lt;-</span> <span class="fu">cov</span>(modelData, <span class="at">use =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb337-622"><a href="#cb337-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-623"><a href="#cb337-623" aria-hidden="true" tabindex="-1"></a>pairwiseRegression_syntax <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb337-624"><a href="#cb337-624" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum</span></span>
<span id="cb337-625"><a href="#cb337-625" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~~ bpi_antisocialT2Sum</span></span>
<span id="cb337-626"><a href="#cb337-626" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~ 1</span></span>
<span id="cb337-627"><a href="#cb337-627" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb337-628"><a href="#cb337-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-629"><a href="#cb337-629" aria-hidden="true" tabindex="-1"></a>pairwiseRegression_fit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">lavaan</span>(</span>
<span id="cb337-630"><a href="#cb337-630" aria-hidden="true" tabindex="-1"></a>  pairwiseRegression_syntax,</span>
<span id="cb337-631"><a href="#cb337-631" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.mean =</span> varMeans,</span>
<span id="cb337-632"><a href="#cb337-632" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.cov =</span> varCovariances,</span>
<span id="cb337-633"><a href="#cb337-633" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.nobs =</span> <span class="fu">sum</span>(<span class="fu">complete.cases</span>(modelData))</span>
<span id="cb337-634"><a href="#cb337-634" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb337-635"><a href="#cb337-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-636"><a href="#cb337-636" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(</span>
<span id="cb337-637"><a href="#cb337-637" aria-hidden="true" tabindex="-1"></a>  pairwiseRegression_fit,</span>
<span id="cb337-638"><a href="#cb337-638" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-639"><a href="#cb337-639" aria-hidden="true" tabindex="-1"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-640"><a href="#cb337-640" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-641"><a href="#cb337-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-642"><a href="#cb337-642" aria-hidden="true" tabindex="-1"></a><span class="fu">## Full-information maximum likelihood (FIML) {#fiml}</span></span>
<span id="cb337-643"><a href="#cb337-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-646"><a href="#cb337-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-647"><a href="#cb337-647" aria-hidden="true" tabindex="-1"></a>fimlRegression_syntax <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb337-648"><a href="#cb337-648" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum</span></span>
<span id="cb337-649"><a href="#cb337-649" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~~ bpi_antisocialT2Sum</span></span>
<span id="cb337-650"><a href="#cb337-650" aria-hidden="true" tabindex="-1"></a><span class="st">  bpi_antisocialT2Sum ~ 1</span></span>
<span id="cb337-651"><a href="#cb337-651" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb337-652"><a href="#cb337-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-653"><a href="#cb337-653" aria-hidden="true" tabindex="-1"></a>fimlRegression_fit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">lavaan</span>(</span>
<span id="cb337-654"><a href="#cb337-654" aria-hidden="true" tabindex="-1"></a>  fimlRegression_syntax,</span>
<span id="cb337-655"><a href="#cb337-655" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-656"><a href="#cb337-656" aria-hidden="true" tabindex="-1"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb337-657"><a href="#cb337-657" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb337-658"><a href="#cb337-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-659"><a href="#cb337-659" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(</span>
<span id="cb337-660"><a href="#cb337-660" aria-hidden="true" tabindex="-1"></a>  fimlRegression_fit,</span>
<span id="cb337-661"><a href="#cb337-661" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-662"><a href="#cb337-662" aria-hidden="true" tabindex="-1"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-663"><a href="#cb337-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-664"><a href="#cb337-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-665"><a href="#cb337-665" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple imputation {#imputation}</span></span>
<span id="cb337-666"><a href="#cb337-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-669"><a href="#cb337-669" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-670"><a href="#cb337-670" aria-hidden="true" tabindex="-1"></a>modelData_imputed <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">mice</span>(</span>
<span id="cb337-671"><a href="#cb337-671" aria-hidden="true" tabindex="-1"></a>  modelData,</span>
<span id="cb337-672"><a href="#cb337-672" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="dv">5</span>,</span>
<span id="cb337-673"><a href="#cb337-673" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"pmm"</span>) <span class="co"># predictive mean matching; can choose among many methods</span></span>
<span id="cb337-674"><a href="#cb337-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-675"><a href="#cb337-675" aria-hidden="true" tabindex="-1"></a>imputedData_fit <span class="ot">&lt;-</span> <span class="fu">with</span>(</span>
<span id="cb337-676"><a href="#cb337-676" aria-hidden="true" tabindex="-1"></a>  modelData_imputed,</span>
<span id="cb337-677"><a href="#cb337-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum))</span>
<span id="cb337-678"><a href="#cb337-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-679"><a href="#cb337-679" aria-hidden="true" tabindex="-1"></a>imputedData_pooledEstimates <span class="ot">&lt;-</span> <span class="fu">pool</span>(imputedData_fit)</span>
<span id="cb337-680"><a href="#cb337-680" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(imputedData_pooledEstimates)</span>
<span id="cb337-681"><a href="#cb337-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-682"><a href="#cb337-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-683"><a href="#cb337-683" aria-hidden="true" tabindex="-1"></a><span class="fu"># Squared Semi-Partial Correlation ($sr^2$) {#squaredSemiPartialCorrelation}</span></span>
<span id="cb337-684"><a href="#cb337-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-687"><a href="#cb337-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-688"><a href="#cb337-688" aria-hidden="true" tabindex="-1"></a>rockchalk<span class="sc">::</span><span class="fu">getDeltaRsquare</span>(multipleRegressionModel)</span>
<span id="cb337-689"><a href="#cb337-689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-690"><a href="#cb337-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-691"><a href="#cb337-691" aria-hidden="true" tabindex="-1"></a><span class="fu"># Partial Regression Plot {#partialRegressionPlot}</span></span>
<span id="cb337-692"><a href="#cb337-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-693"><a href="#cb337-693" aria-hidden="true" tabindex="-1"></a>A partial regression plot (aka added-variable) examines the association between the predictor and the outcome after controlling for the covariates.</span>
<span id="cb337-694"><a href="#cb337-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-697"><a href="#cb337-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-698"><a href="#cb337-698" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">avPlots</span>(</span>
<span id="cb337-699"><a href="#cb337-699" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-700"><a href="#cb337-700" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">FALSE</span>)</span>
<span id="cb337-701"><a href="#cb337-701" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-702"><a href="#cb337-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-703"><a href="#cb337-703" aria-hidden="true" tabindex="-1"></a>Manually:</span>
<span id="cb337-704"><a href="#cb337-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-707"><a href="#cb337-707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-708"><a href="#cb337-708" aria-hidden="true" tabindex="-1"></a><span class="co"># DV residuals (outcome residualized on covariates)</span></span>
<span id="cb337-709"><a href="#cb337-709" aria-hidden="true" tabindex="-1"></a>ry <span class="ot">&lt;-</span> <span class="fu">resid</span>(<span class="fu">lm</span>(</span>
<span id="cb337-710"><a href="#cb337-710" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum, </span>
<span id="cb337-711"><a href="#cb337-711" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata, <span class="at">na.action =</span> na.exclude))</span>
<span id="cb337-712"><a href="#cb337-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-713"><a href="#cb337-713" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictor residuals (focal predictor residualized on covariates)</span></span>
<span id="cb337-714"><a href="#cb337-714" aria-hidden="true" tabindex="-1"></a>rx <span class="ot">&lt;-</span> <span class="fu">resid</span>(<span class="fu">lm</span>(</span>
<span id="cb337-715"><a href="#cb337-715" aria-hidden="true" tabindex="-1"></a>  bpi_anxiousDepressedSum <span class="sc">~</span> bpi_antisocialT1Sum,</span>
<span id="cb337-716"><a href="#cb337-716" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata, <span class="at">na.action =</span> na.exclude))</span>
<span id="cb337-717"><a href="#cb337-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-718"><a href="#cb337-718" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the partial regression plot</span></span>
<span id="cb337-719"><a href="#cb337-719" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(rx, ry)</span>
<span id="cb337-720"><a href="#cb337-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-721"><a href="#cb337-721" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb337-722"><a href="#cb337-722" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_plot,</span>
<span id="cb337-723"><a href="#cb337-723" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> rx, <span class="at">y =</span> ry)) <span class="sc">+</span></span>
<span id="cb337-724"><a href="#cb337-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb337-725"><a href="#cb337-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb337-726"><a href="#cb337-726" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb337-727"><a href="#cb337-727" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb337-728"><a href="#cb337-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb337-729"><a href="#cb337-729" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Residualized bpi_antisocialT1Sum"</span>,</span>
<span id="cb337-730"><a href="#cb337-730" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residualized bpi_antisocialT2Sum"</span>,</span>
<span id="cb337-731"><a href="#cb337-731" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Partial Regression Plot</span><span class="sc">\n</span><span class="st">bpi_antisocialT2Sum ~ bpi_antisocialT1Sum controlling for bpi_anxiousDepressedSum"</span></span>
<span id="cb337-732"><a href="#cb337-732" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb337-733"><a href="#cb337-733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-734"><a href="#cb337-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-735"><a href="#cb337-735" aria-hidden="true" tabindex="-1"></a><span class="fu"># Dominance Analysis {#dominanceAnalysis}</span></span>
<span id="cb337-736"><a href="#cb337-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-739"><a href="#cb337-739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-740"><a href="#cb337-740" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">dominance_analysis</span>(multipleRegressionModel)</span>
<span id="cb337-741"><a href="#cb337-741" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-742"><a href="#cb337-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-745"><a href="#cb337-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-746"><a href="#cb337-746" aria-hidden="true" tabindex="-1"></a>allPossibleSubsetsRegression <span class="ot">&lt;-</span> yhat<span class="sc">::</span><span class="fu">aps</span>(</span>
<span id="cb337-747"><a href="#cb337-747" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataMatrix =</span> mydata,</span>
<span id="cb337-748"><a href="#cb337-748" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span id="cb337-749"><a href="#cb337-749" aria-hidden="true" tabindex="-1"></a>  <span class="at">ivlist =</span> <span class="fu">list</span>(<span class="st">"bpi_antisocialT1Sum"</span>, <span class="st">"bpi_anxiousDepressedSum"</span>))</span>
<span id="cb337-750"><a href="#cb337-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-751"><a href="#cb337-751" aria-hidden="true" tabindex="-1"></a>yhat<span class="sc">::</span><span class="fu">dominance</span>(allPossibleSubsetsRegression)</span>
<span id="cb337-752"><a href="#cb337-752" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-753"><a href="#cb337-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-754"><a href="#cb337-754" aria-hidden="true" tabindex="-1"></a><span class="fu"># Commonality Analysis {#commonalityAnalysis}</span></span>
<span id="cb337-755"><a href="#cb337-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-758"><a href="#cb337-758" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-759"><a href="#cb337-759" aria-hidden="true" tabindex="-1"></a>yhat<span class="sc">::</span><span class="fu">calc.yhat</span>(multipleRegressionModel)</span>
<span id="cb337-760"><a href="#cb337-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-761"><a href="#cb337-761" aria-hidden="true" tabindex="-1"></a>allPossibleSubsetsRegression <span class="ot">&lt;-</span> yhat<span class="sc">::</span><span class="fu">aps</span>(</span>
<span id="cb337-762"><a href="#cb337-762" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataMatrix =</span> mydata,</span>
<span id="cb337-763"><a href="#cb337-763" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span id="cb337-764"><a href="#cb337-764" aria-hidden="true" tabindex="-1"></a>  <span class="at">ivlist =</span> <span class="fu">list</span>(<span class="st">"bpi_antisocialT1Sum"</span>, <span class="st">"bpi_anxiousDepressedSum"</span>))</span>
<span id="cb337-765"><a href="#cb337-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-766"><a href="#cb337-766" aria-hidden="true" tabindex="-1"></a>yhat<span class="sc">::</span><span class="fu">commonality</span>(allPossibleSubsetsRegression)</span>
<span id="cb337-767"><a href="#cb337-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-768"><a href="#cb337-768" aria-hidden="true" tabindex="-1"></a>commonalityAnalysis <span class="ot">&lt;-</span> yhat<span class="sc">::</span><span class="fu">commonalityCoefficients</span>(</span>
<span id="cb337-769"><a href="#cb337-769" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataMatrix =</span> mydata,</span>
<span id="cb337-770"><a href="#cb337-770" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">"bpi_antisocialT2Sum"</span>,</span>
<span id="cb337-771"><a href="#cb337-771" aria-hidden="true" tabindex="-1"></a>  <span class="at">ivlist =</span> <span class="fu">list</span>(<span class="st">"bpi_antisocialT1Sum"</span>, <span class="st">"bpi_anxiousDepressedSum"</span>))</span>
<span id="cb337-772"><a href="#cb337-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-773"><a href="#cb337-773" aria-hidden="true" tabindex="-1"></a>commonalityAnalysis</span>
<span id="cb337-774"><a href="#cb337-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-775"><a href="#cb337-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-776"><a href="#cb337-776" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model Building Steps</span></span>
<span id="cb337-777"><a href="#cb337-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-778"><a href="#cb337-778" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Examine extent and type of missing data, consider <span class="co">[</span><span class="ot">how to handle missing values</span><span class="co">](#missingness)</span> (<span class="co">[</span><span class="ot">multiple imputation</span><span class="co">](#imputation)</span>, <span class="co">[</span><span class="ot">FIML</span><span class="co">](#fiml)</span>, <span class="co">[</span><span class="ot">pairwise deletion</span><span class="co">](#pairwiseDeletion)</span>, <span class="co">[</span><span class="ot">listwise deletion</span><span class="co">](#listwiseDeletion)</span>)</span>
<span id="cb337-779"><a href="#cb337-779" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Little's MCAR test from <span class="in">`mcar_test()`</span> function of the <span class="in">`njtierney/naniar`</span> package</span>
<span id="cb337-780"><a href="#cb337-780" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Bayesian handling of missing data: <span class="ot">&lt;https://cran.r-project.org/web/packages/brms/vignettes/brms_missings.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/Z4HT-QXWR&gt;</span>)</span>
<span id="cb337-781"><a href="#cb337-781" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Examine descriptive statistics, consider variable transformations</span>
<span id="cb337-782"><a href="#cb337-782" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Examine scatterplot matrix to examine whether associations between predictor and outcomes are linear or nonlinear</span>
<span id="cb337-783"><a href="#cb337-783" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Model building: theory and empiricism (stepwise regression, likelihood ratio tests, k-fold cross validation to check for over-fitting compared to simpler model)</span>
<span id="cb337-784"><a href="#cb337-784" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Test assumptions</span>
<span id="cb337-785"><a href="#cb337-785" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Examine whether predictors have linear association with outcome (Residual Plots, Marginal Model Plots, Added-Variable Plots—check for non-horizontal lines)</span>
<span id="cb337-786"><a href="#cb337-786" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Examine whether residuals have constant variance across levels of outcome and predictors Residual Plots, Spread-Level Plots—check for fan-shaped plot or other increasing/decreasing structure)</span>
<span id="cb337-787"><a href="#cb337-787" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Examine whether predictors show multicollinearity (VIF)</span>
<span id="cb337-788"><a href="#cb337-788" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Examine whether residuals are normally distributed (QQ plot and density plot)</span>
<span id="cb337-789"><a href="#cb337-789" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Examine influence of influential observations (high outlyingness and leverage) on parameter stimates by iteratively removing influential observations and refitting (Added-Variable Plots)</span>
<span id="cb337-790"><a href="#cb337-790" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Handle violated assumptions, select final set of predictors/outcomes and transformation of each</span>
<span id="cb337-791"><a href="#cb337-791" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use k-fold cross validation to identify the best estimation procedure (OLS, MM, or LTS) on the final model</span>
<span id="cb337-792"><a href="#cb337-792" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use identified estimation procedure to fit final model and determine the best parameter point estimates</span>
<span id="cb337-793"><a href="#cb337-793" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Calculate bootstrapped estimates to determine the confidence intervals around the parameter estimates of the final model</span>
<span id="cb337-794"><a href="#cb337-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-795"><a href="#cb337-795" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bootstrapped Estimates</span></span>
<span id="cb337-796"><a href="#cb337-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-797"><a href="#cb337-797" aria-hidden="true" tabindex="-1"></a>To determine the confidence intervals of parameter estimates</span>
<span id="cb337-798"><a href="#cb337-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-799"><a href="#cb337-799" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear Regression</span></span>
<span id="cb337-800"><a href="#cb337-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-803"><a href="#cb337-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-804"><a href="#cb337-804" aria-hidden="true" tabindex="-1"></a>multipleRegressionModelBootstrapped <span class="ot">&lt;-</span> <span class="fu">Boot</span>(multipleRegressionModelNoMissing, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb337-805"><a href="#cb337-805" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModelBootstrapped)</span>
<span id="cb337-806"><a href="#cb337-806" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(multipleRegressionModelBootstrapped, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">type =</span> <span class="st">"bca"</span>)</span>
<span id="cb337-807"><a href="#cb337-807" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(multipleRegressionModelBootstrapped)</span>
<span id="cb337-808"><a href="#cb337-808" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-809"><a href="#cb337-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-810"><a href="#cb337-810" aria-hidden="true" tabindex="-1"></a><span class="fu">## Generalized Regression</span></span>
<span id="cb337-811"><a href="#cb337-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-814"><a href="#cb337-814" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-815"><a href="#cb337-815" aria-hidden="true" tabindex="-1"></a>generalizedRegressionModelBootstrapped <span class="ot">&lt;-</span> <span class="fu">Boot</span>(multipleRegressionModelNoMissing, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb337-816"><a href="#cb337-816" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(generalizedRegressionModelBootstrapped)</span>
<span id="cb337-817"><a href="#cb337-817" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(generalizedRegressionModelBootstrapped, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">type =</span> <span class="st">"bca"</span>)</span>
<span id="cb337-818"><a href="#cb337-818" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(generalizedRegressionModelBootstrapped)</span>
<span id="cb337-819"><a href="#cb337-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-820"><a href="#cb337-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-821"><a href="#cb337-821" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cross Validation</span></span>
<span id="cb337-822"><a href="#cb337-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-823"><a href="#cb337-823" aria-hidden="true" tabindex="-1"></a>To examine degree of prediction error and over-fitting to determine best model</span>
<span id="cb337-824"><a href="#cb337-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-825"><a href="#cb337-825" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.stackexchange.com/questions/103459/how-do-i-know-which-method-of-cross-validation-is-best&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/38BL-KLRJ&gt;</span>)</span>
<span id="cb337-826"><a href="#cb337-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-827"><a href="#cb337-827" aria-hidden="true" tabindex="-1"></a><span class="fu">## K-fold cross validation</span></span>
<span id="cb337-828"><a href="#cb337-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-831"><a href="#cb337-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-832"><a href="#cb337-832" aria-hidden="true" tabindex="-1"></a>kFolds <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb337-833"><a href="#cb337-833" aria-hidden="true" tabindex="-1"></a>replications <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb337-834"><a href="#cb337-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-835"><a href="#cb337-835" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">cvFolds</span>(<span class="fu">nrow</span>(mydata), <span class="at">K =</span> kFolds, <span class="at">R =</span> replications)</span>
<span id="cb337-836"><a href="#cb337-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-837"><a href="#cb337-837" aria-hidden="true" tabindex="-1"></a>fitLm <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-838"><a href="#cb337-838" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-839"><a href="#cb337-839" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-840"><a href="#cb337-840" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>)</span>
<span id="cb337-841"><a href="#cb337-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-842"><a href="#cb337-842" aria-hidden="true" tabindex="-1"></a>fitLmrob <span class="ot">&lt;-</span> <span class="fu">lmrob</span>(</span>
<span id="cb337-843"><a href="#cb337-843" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-844"><a href="#cb337-844" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-845"><a href="#cb337-845" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>)</span>
<span id="cb337-846"><a href="#cb337-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-847"><a href="#cb337-847" aria-hidden="true" tabindex="-1"></a>fitLts <span class="ot">&lt;-</span> <span class="fu">ltsReg</span>(</span>
<span id="cb337-848"><a href="#cb337-848" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-849"><a href="#cb337-849" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-850"><a href="#cb337-850" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>)</span>
<span id="cb337-851"><a href="#cb337-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-852"><a href="#cb337-852" aria-hidden="true" tabindex="-1"></a>cvFitLm <span class="ot">&lt;-</span> <span class="fu">cvLm</span>(</span>
<span id="cb337-853"><a href="#cb337-853" aria-hidden="true" tabindex="-1"></a>  fitLm,</span>
<span id="cb337-854"><a href="#cb337-854" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> kFolds,</span>
<span id="cb337-855"><a href="#cb337-855" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> replications)</span>
<span id="cb337-856"><a href="#cb337-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-857"><a href="#cb337-857" aria-hidden="true" tabindex="-1"></a>cvFitLmrob <span class="ot">&lt;-</span> <span class="fu">cvLmrob</span>(</span>
<span id="cb337-858"><a href="#cb337-858" aria-hidden="true" tabindex="-1"></a>  fitLmrob,</span>
<span id="cb337-859"><a href="#cb337-859" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> kFolds,</span>
<span id="cb337-860"><a href="#cb337-860" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> replications)</span>
<span id="cb337-861"><a href="#cb337-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-862"><a href="#cb337-862" aria-hidden="true" tabindex="-1"></a>cvFitLts <span class="ot">&lt;-</span> <span class="fu">cvLts</span>(</span>
<span id="cb337-863"><a href="#cb337-863" aria-hidden="true" tabindex="-1"></a>  fitLts,</span>
<span id="cb337-864"><a href="#cb337-864" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> kFolds,</span>
<span id="cb337-865"><a href="#cb337-865" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> replications)</span>
<span id="cb337-866"><a href="#cb337-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-867"><a href="#cb337-867" aria-hidden="true" tabindex="-1"></a>cvFits <span class="ot">&lt;-</span> <span class="fu">cvSelect</span>(</span>
<span id="cb337-868"><a href="#cb337-868" aria-hidden="true" tabindex="-1"></a>  <span class="at">OLS =</span> cvFitLm,</span>
<span id="cb337-869"><a href="#cb337-869" aria-hidden="true" tabindex="-1"></a>  <span class="at">MM =</span> cvFitLmrob,</span>
<span id="cb337-870"><a href="#cb337-870" aria-hidden="true" tabindex="-1"></a>  <span class="at">LTS =</span> cvFitLts)</span>
<span id="cb337-871"><a href="#cb337-871" aria-hidden="true" tabindex="-1"></a>cvFits</span>
<span id="cb337-872"><a href="#cb337-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-873"><a href="#cb337-873" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(</span>
<span id="cb337-874"><a href="#cb337-874" aria-hidden="true" tabindex="-1"></a>  cvFits,</span>
<span id="cb337-875"><a href="#cb337-875" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Root Mean Square Error"</span>,</span>
<span id="cb337-876"><a href="#cb337-876" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(cvFits<span class="sc">$</span>cv<span class="sc">$</span>CV) <span class="sc">+</span> <span class="fl">0.2</span>))</span>
<span id="cb337-877"><a href="#cb337-877" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-878"><a href="#cb337-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-879"><a href="#cb337-879" aria-hidden="true" tabindex="-1"></a><span class="fu"># Examining Model Fits</span></span>
<span id="cb337-880"><a href="#cb337-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-881"><a href="#cb337-881" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effect Plots</span></span>
<span id="cb337-882"><a href="#cb337-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-885"><a href="#cb337-885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-886"><a href="#cb337-886" aria-hidden="true" tabindex="-1"></a><span class="fu">allEffects</span>(multipleRegressionModel)</span>
<span id="cb337-887"><a href="#cb337-887" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(multipleRegressionModel))</span>
<span id="cb337-888"><a href="#cb337-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-889"><a href="#cb337-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-890"><a href="#cb337-890" aria-hidden="true" tabindex="-1"></a><span class="fu">## Confidence Ellipses</span></span>
<span id="cb337-891"><a href="#cb337-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-894"><a href="#cb337-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-895"><a href="#cb337-895" aria-hidden="true" tabindex="-1"></a><span class="fu">confidenceEllipse</span>(</span>
<span id="cb337-896"><a href="#cb337-896" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-897"><a href="#cb337-897" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, .<span class="dv">95</span>))</span>
<span id="cb337-898"><a href="#cb337-898" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-899"><a href="#cb337-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-900"><a href="#cb337-900" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Ellipse</span></span>
<span id="cb337-901"><a href="#cb337-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-904"><a href="#cb337-904" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-905"><a href="#cb337-905" aria-hidden="true" tabindex="-1"></a>mydata_nomissing <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)])</span>
<span id="cb337-906"><a href="#cb337-906" aria-hidden="true" tabindex="-1"></a><span class="fu">dataEllipse</span>(</span>
<span id="cb337-907"><a href="#cb337-907" aria-hidden="true" tabindex="-1"></a>  mydata_nomissing<span class="sc">$</span>bpi_antisocialT1Sum,</span>
<span id="cb337-908"><a href="#cb337-908" aria-hidden="true" tabindex="-1"></a>  mydata_nomissing<span class="sc">$</span>bpi_antisocialT2Sum,</span>
<span id="cb337-909"><a href="#cb337-909" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, .<span class="dv">95</span>))</span>
<span id="cb337-910"><a href="#cb337-910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-911"><a href="#cb337-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-912"><a href="#cb337-912" aria-hidden="true" tabindex="-1"></a><span class="fu"># Diagnostics</span></span>
<span id="cb337-913"><a href="#cb337-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-914"><a href="#cb337-914" aria-hidden="true" tabindex="-1"></a><span class="fu">## Assumptions</span></span>
<span id="cb337-915"><a href="#cb337-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-916"><a href="#cb337-916" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1. Linear relation between predictors and outcome {#linearAssociation}</span></span>
<span id="cb337-917"><a href="#cb337-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-918"><a href="#cb337-918" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Test</span></span>
<span id="cb337-919"><a href="#cb337-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-920"><a href="#cb337-920" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Before Model Fitting</span></span>
<span id="cb337-921"><a href="#cb337-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-922"><a href="#cb337-922" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>scatterplot matrix</span>
<span id="cb337-923"><a href="#cb337-923" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>distance correlation</span>
<span id="cb337-924"><a href="#cb337-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-925"><a href="#cb337-925" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Scatterplot Matrix</span></span>
<span id="cb337-926"><a href="#cb337-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-929"><a href="#cb337-929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-930"><a href="#cb337-930" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplotMatrix</span>(</span>
<span id="cb337-931"><a href="#cb337-931" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> bpi_antisocialT2Sum <span class="sc">+</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-932"><a href="#cb337-932" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata)</span>
<span id="cb337-933"><a href="#cb337-933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-934"><a href="#cb337-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-935"><a href="#cb337-935" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Distance correlation</span></span>
<span id="cb337-936"><a href="#cb337-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-937"><a href="#cb337-937" aria-hidden="true" tabindex="-1"></a>The distance correlation is an index of the degree of the linear and non-linear association between two variables.</span>
<span id="cb337-938"><a href="#cb337-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-941"><a href="#cb337-941" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-942"><a href="#cb337-942" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(</span>
<span id="cb337-943"><a href="#cb337-943" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)],</span>
<span id="cb337-944"><a href="#cb337-944" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"distance"</span>,</span>
<span id="cb337-945"><a href="#cb337-945" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb337-946"><a href="#cb337-946" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-947"><a href="#cb337-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-948"><a href="#cb337-948" aria-hidden="true" tabindex="-1"></a><span class="fu">##### After Model Fitting</span></span>
<span id="cb337-949"><a href="#cb337-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-950"><a href="#cb337-950" aria-hidden="true" tabindex="-1"></a>Check for nonlinearities (non-horizontal line) in plots of:</span>
<span id="cb337-951"><a href="#cb337-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-952"><a href="#cb337-952" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Residuals versus fitted values (<span class="co">[</span><span class="ot">Residual Plots</span><span class="co">](#residualPlots)</span>)—best</span>
<span id="cb337-953"><a href="#cb337-953" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Residuals versus predictors (<span class="co">[</span><span class="ot">Residual Plots</span><span class="co">](#residualPlots)</span>)</span>
<span id="cb337-954"><a href="#cb337-954" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Outcome versus fitted values (<span class="co">[</span><span class="ot">Marginal Model Plots</span><span class="co">](#marginalModelPlots)</span>)</span>
<span id="cb337-955"><a href="#cb337-955" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Outcome versus predictors, ignoring other predictors (<span class="co">[</span><span class="ot">Marginal Model Plots</span><span class="co">](#marginalModelPlots)</span>)</span>
<span id="cb337-956"><a href="#cb337-956" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Outcome versus predictors, controlling for other predictors (<span class="co">[</span><span class="ot">Added-Variable Plots</span><span class="co">](#addedVariablePlots)</span>)</span>
<span id="cb337-957"><a href="#cb337-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-958"><a href="#cb337-958" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Handle</span></span>
<span id="cb337-959"><a href="#cb337-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-960"><a href="#cb337-960" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Transform outcome/predictor variables (Box-Cox transformations)</span>
<span id="cb337-961"><a href="#cb337-961" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Semi-parametric regression models: Generalized additive models (GAM)</span>
<span id="cb337-962"><a href="#cb337-962" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Non-parametric regression models: Nearest-Neighbor Kernel Regression</span>
<span id="cb337-963"><a href="#cb337-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-964"><a href="#cb337-964" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Semi-parametric or non-parametric regression models</span></span>
<span id="cb337-965"><a href="#cb337-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-966"><a href="#cb337-966" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;http://www.lisa.stat.vt.edu/?q=node/7517&gt;</span> (archived at <span class="ot">&lt;https://web.archive.org/web/20180113065042/http://www.lisa.stat.vt.edu/?q=node/7517&gt;</span>)</span>
<span id="cb337-967"><a href="#cb337-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-968"><a href="#cb337-968" aria-hidden="true" tabindex="-1"></a>Note: using semi-parametric or non-parametric models increases fit in context of nonlinearity at the expense of added complexity.</span>
<span id="cb337-969"><a href="#cb337-969" aria-hidden="true" tabindex="-1"></a>Make sure to avoid fitting an overly complex model (e.g., use k-fold cross validation).</span>
<span id="cb337-970"><a href="#cb337-970" aria-hidden="true" tabindex="-1"></a>Often, the simpler (generalized) linear model is preferable to semi-paremetric or non-parametric approaches</span>
<span id="cb337-971"><a href="#cb337-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-972"><a href="#cb337-972" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Semi-parametric: Generalized Additive Models</span></span>
<span id="cb337-973"><a href="#cb337-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-974"><a href="#cb337-974" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;http://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models&gt;</span> (archived at <span class="ot">&lt;https://web.archive.org/web/20170213041653/http://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models&gt;</span>)</span>
<span id="cb337-975"><a href="#cb337-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-978"><a href="#cb337-978" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-979"><a href="#cb337-979" aria-hidden="true" tabindex="-1"></a>generalizedAdditiveModel <span class="ot">&lt;-</span> <span class="fu">gam</span>(</span>
<span id="cb337-980"><a href="#cb337-980" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-981"><a href="#cb337-981" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb337-982"><a href="#cb337-982" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-983"><a href="#cb337-983" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-984"><a href="#cb337-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-985"><a href="#cb337-985" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(generalizedAdditiveModel)</span>
<span id="cb337-986"><a href="#cb337-986" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(generalizedAdditiveModel)</span>
<span id="cb337-987"><a href="#cb337-987" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-988"><a href="#cb337-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-989"><a href="#cb337-989" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Non-parametric: Nearest-Neighbor Kernel Regression</span></span>
<span id="cb337-990"><a href="#cb337-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-991"><a href="#cb337-991" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2. Exogeneity</span></span>
<span id="cb337-992"><a href="#cb337-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-993"><a href="#cb337-993" aria-hidden="true" tabindex="-1"></a>Exogeneity means that the association between predictors and outcome is fully causal and unrelated to other variables.</span>
<span id="cb337-994"><a href="#cb337-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-995"><a href="#cb337-995" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Test</span></span>
<span id="cb337-996"><a href="#cb337-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-997"><a href="#cb337-997" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Durbin-Wu-Hausman test of endogeneity</span>
<span id="cb337-998"><a href="#cb337-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-999"><a href="#cb337-999" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Durbin-Wu-Hausman test of endogeneity</span></span>
<span id="cb337-1000"><a href="#cb337-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1001"><a href="#cb337-1001" aria-hidden="true" tabindex="-1"></a>The instrumental variables (2SLS) estimator is implemented in the <span class="in">`R`</span> package <span class="in">`AER`</span> as command:</span>
<span id="cb337-1002"><a href="#cb337-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1005"><a href="#cb337-1005" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1006"><a href="#cb337-1006" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb337-1007"><a href="#cb337-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1008"><a href="#cb337-1008" aria-hidden="true" tabindex="-1"></a><span class="fu">ivreg</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> w1 <span class="sc">+</span> w2 <span class="sc">|</span> z1 <span class="sc">+</span> z2 <span class="sc">+</span> z3 <span class="sc">+</span> w1 <span class="sc">+</span> w2)</span>
<span id="cb337-1009"><a href="#cb337-1009" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1010"><a href="#cb337-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1011"><a href="#cb337-1011" aria-hidden="true" tabindex="-1"></a>where <span class="in">`x1`</span> and <span class="in">`x2`</span> are endogenous regressors, <span class="in">`w1`</span> and <span class="in">`w2`</span> exogeneous regressors, and <span class="in">`z1`</span> to <span class="in">`z3`</span> are excluded instruments.</span>
<span id="cb337-1012"><a href="#cb337-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1013"><a href="#cb337-1013" aria-hidden="true" tabindex="-1"></a>Durbin-Wu-Hausman test:</span>
<span id="cb337-1014"><a href="#cb337-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1017"><a href="#cb337-1017" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1018"><a href="#cb337-1018" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb337-1019"><a href="#cb337-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1020"><a href="#cb337-1020" aria-hidden="true" tabindex="-1"></a>hsng2 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"https://www.stata-press.com/data/r11/hsng2.dta"</span>) <span class="co">#archived at https://perma.cc/7P2Q-ARKR</span></span>
<span id="cb337-1021"><a href="#cb337-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1022"><a href="#cb337-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1025"><a href="#cb337-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1026"><a href="#cb337-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb337-1027"><a href="#cb337-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1028"><a href="#cb337-1028" aria-hidden="true" tabindex="-1"></a>hsng2 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"./data/hsng2.dta"</span>) <span class="co">#https://www.stata-press.com/data/r11/hsng2.dta archived at https://perma.cc/7P2Q-ARKR</span></span>
<span id="cb337-1029"><a href="#cb337-1029" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1030"><a href="#cb337-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1033"><a href="#cb337-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1034"><a href="#cb337-1034" aria-hidden="true" tabindex="-1"></a>fiv <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(</span>
<span id="cb337-1035"><a href="#cb337-1035" aria-hidden="true" tabindex="-1"></a>  rent <span class="sc">~</span> hsngval <span class="sc">+</span> pcturban <span class="sc">|</span> pcturban <span class="sc">+</span> faminc <span class="sc">+</span> reg2 <span class="sc">+</span> reg3 <span class="sc">+</span> reg4,</span>
<span id="cb337-1036"><a href="#cb337-1036" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hsng2) <span class="co">#Housing values are likely endogeneous and therefore instrumented by median family income (faminc) and 3 regional dummies (reg2, reg4, reg4)</span></span>
<span id="cb337-1037"><a href="#cb337-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1038"><a href="#cb337-1038" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(</span>
<span id="cb337-1039"><a href="#cb337-1039" aria-hidden="true" tabindex="-1"></a>  fiv,</span>
<span id="cb337-1040"><a href="#cb337-1040" aria-hidden="true" tabindex="-1"></a>  <span class="at">diagnostics =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1041"><a href="#cb337-1041" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1042"><a href="#cb337-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1043"><a href="#cb337-1043" aria-hidden="true" tabindex="-1"></a>The Eicker-Huber-White covariance estimator which is robust to heteroscedastic error terms is reported after estimation with <span class="in">`vcov = sandwich`</span> in <span class="in">`coeftest()`</span></span>
<span id="cb337-1044"><a href="#cb337-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1045"><a href="#cb337-1045" aria-hidden="true" tabindex="-1"></a>First stage results are reported by explicitly estimating them.</span>
<span id="cb337-1046"><a href="#cb337-1046" aria-hidden="true" tabindex="-1"></a>For example:</span>
<span id="cb337-1047"><a href="#cb337-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1050"><a href="#cb337-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1051"><a href="#cb337-1051" aria-hidden="true" tabindex="-1"></a>first <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1052"><a href="#cb337-1052" aria-hidden="true" tabindex="-1"></a>  hsngval <span class="sc">~</span> pcturban <span class="sc">+</span> faminc <span class="sc">+</span> reg2 <span class="sc">+</span> reg3 <span class="sc">+</span> reg4,</span>
<span id="cb337-1053"><a href="#cb337-1053" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hsng2)</span>
<span id="cb337-1054"><a href="#cb337-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1055"><a href="#cb337-1055" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(first)</span>
<span id="cb337-1056"><a href="#cb337-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1057"><a href="#cb337-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1058"><a href="#cb337-1058" aria-hidden="true" tabindex="-1"></a>In case of a single endogenous variable (K = 1), the F-statistic to assess weak instruments is reported after estimating the first stage with, for example:</span>
<span id="cb337-1059"><a href="#cb337-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1062"><a href="#cb337-1062" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1063"><a href="#cb337-1063" aria-hidden="true" tabindex="-1"></a><span class="fu">waldtest</span>(</span>
<span id="cb337-1064"><a href="#cb337-1064" aria-hidden="true" tabindex="-1"></a>  first,</span>
<span id="cb337-1065"><a href="#cb337-1065" aria-hidden="true" tabindex="-1"></a>  . <span class="sc">~</span> . <span class="sc">-</span> faminc <span class="sc">-</span> reg2 <span class="sc">-</span> reg3 <span class="sc">-</span> reg4)</span>
<span id="cb337-1066"><a href="#cb337-1066" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1067"><a href="#cb337-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1068"><a href="#cb337-1068" aria-hidden="true" tabindex="-1"></a>or in case of heteroscedatistic errors:</span>
<span id="cb337-1069"><a href="#cb337-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1072"><a href="#cb337-1072" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1073"><a href="#cb337-1073" aria-hidden="true" tabindex="-1"></a><span class="fu">waldtest</span>(</span>
<span id="cb337-1074"><a href="#cb337-1074" aria-hidden="true" tabindex="-1"></a>  first,</span>
<span id="cb337-1075"><a href="#cb337-1075" aria-hidden="true" tabindex="-1"></a>  . <span class="sc">~</span> . <span class="sc">-</span> faminc <span class="sc">-</span> reg2 <span class="sc">-</span> reg3<span class="sc">-</span> reg4,</span>
<span id="cb337-1076"><a href="#cb337-1076" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> sandwich)</span>
<span id="cb337-1077"><a href="#cb337-1077" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1078"><a href="#cb337-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1079"><a href="#cb337-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Handle</span></span>
<span id="cb337-1080"><a href="#cb337-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1081"><a href="#cb337-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Conduct an experiment/RCT with random assignment</span>
<span id="cb337-1082"><a href="#cb337-1082" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Instrumental variables</span>
<span id="cb337-1083"><a href="#cb337-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1084"><a href="#cb337-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3. Homoscedasticity of residuals</span></span>
<span id="cb337-1085"><a href="#cb337-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1086"><a href="#cb337-1086" aria-hidden="true" tabindex="-1"></a>Homoscedasticity of the residuals means that the variance of the residuals does not differ as a function of the outcome/predictors (i.e., the residuals show constant variance as a function of outcome/predictors).</span>
<span id="cb337-1087"><a href="#cb337-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1088"><a href="#cb337-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Test</span></span>
<span id="cb337-1089"><a href="#cb337-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1090"><a href="#cb337-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Plot residuals vs. outcome and predictor variables (<span class="co">[</span><span class="ot">Residual Plots</span><span class="co">](#residualPlots)</span>)</span>
<span id="cb337-1091"><a href="#cb337-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Plot residuals vs. fitted values (<span class="co">[</span><span class="ot">Residual Plots</span><span class="co">](#residualPlots)</span>)</span>
<span id="cb337-1092"><a href="#cb337-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Time Series data: Plot residuals vs. time</span>
<span id="cb337-1093"><a href="#cb337-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Spread-level plot</span>
<span id="cb337-1094"><a href="#cb337-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Breusch-Pagan test: <span class="in">`bptest()`</span> function from <span class="in">`lmtest`</span> package</span>
<span id="cb337-1095"><a href="#cb337-1095" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Goldfeld-Quandt Test</span>
<span id="cb337-1096"><a href="#cb337-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1097"><a href="#cb337-1097" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Residuals vs. outcome and predictor variables</span></span>
<span id="cb337-1098"><a href="#cb337-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1099"><a href="#cb337-1099" aria-hidden="true" tabindex="-1"></a>Plot residuals, or perhaps their absolute values, versus the outcome and predictor variables (<span class="co">[</span><span class="ot">Residual Plots</span><span class="co">](#residualPlots)</span>).</span>
<span id="cb337-1100"><a href="#cb337-1100" aria-hidden="true" tabindex="-1"></a>Examine whether residual variance is constant at all levels of other variables or whether it increases/decreases as a function of another variable (or shows some others structure, e.g., small variance at low and high levels of a predictor and high variance in the middle).</span>
<span id="cb337-1101"><a href="#cb337-1101" aria-hidden="true" tabindex="-1"></a>Note that this is *different than whether the residuals show non-linearities*—i.e., a non-horizontal line, which would indicate a <span class="co">[</span><span class="ot">nonlinear association between variables</span><span class="co">](#linearAssociation)</span> (see Assumption #1, above).</span>
<span id="cb337-1102"><a href="#cb337-1102" aria-hidden="true" tabindex="-1"></a>Rather, here we are examining whether there is change in the variance as a function of another variable (e.g., a fan-shaped <span class="co">[</span><span class="ot">Residual Plot</span><span class="co">](#residualPlots)</span>)</span>
<span id="cb337-1103"><a href="#cb337-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1104"><a href="#cb337-1104" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Spread-level plot</span></span>
<span id="cb337-1105"><a href="#cb337-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1106"><a href="#cb337-1106" aria-hidden="true" tabindex="-1"></a>Examining whether level (e.g., mean) depends on spread (e.g., variance)—plot of log of the absolute Studentized residuals against the log of the fitted values</span>
<span id="cb337-1107"><a href="#cb337-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1110"><a href="#cb337-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1111"><a href="#cb337-1111" aria-hidden="true" tabindex="-1"></a><span class="fu">spreadLevelPlot</span>(multipleRegressionModel)</span>
<span id="cb337-1112"><a href="#cb337-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1113"><a href="#cb337-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1114"><a href="#cb337-1114" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Breusch-Pagan test</span></span>
<span id="cb337-1115"><a href="#cb337-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1116"><a href="#cb337-1116" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://www.rdocumentation.org/packages/lmtest/versions/0.9-40/topics/bptest&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/K4WC-7TVW&gt;</span>)</span>
<span id="cb337-1117"><a href="#cb337-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1120"><a href="#cb337-1120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1121"><a href="#cb337-1121" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(multipleRegressionModel)</span>
<span id="cb337-1122"><a href="#cb337-1122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1123"><a href="#cb337-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1124"><a href="#cb337-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Goldfeld-Quandt Test</span></span>
<span id="cb337-1125"><a href="#cb337-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1128"><a href="#cb337-1128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1129"><a href="#cb337-1129" aria-hidden="true" tabindex="-1"></a><span class="fu">gqtest</span>(multipleRegressionModel)</span>
<span id="cb337-1130"><a href="#cb337-1130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1131"><a href="#cb337-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1132"><a href="#cb337-1132" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Test of dependence of spread on level</span></span>
<span id="cb337-1133"><a href="#cb337-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1136"><a href="#cb337-1136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1137"><a href="#cb337-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">ncvTest</span>(multipleRegressionModel)</span>
<span id="cb337-1138"><a href="#cb337-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1139"><a href="#cb337-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1140"><a href="#cb337-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Test of dependence of spread on predictors</span></span>
<span id="cb337-1141"><a href="#cb337-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1144"><a href="#cb337-1144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1145"><a href="#cb337-1145" aria-hidden="true" tabindex="-1"></a><span class="fu">ncvTest</span>(</span>
<span id="cb337-1146"><a href="#cb337-1146" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1147"><a href="#cb337-1147" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum)</span>
<span id="cb337-1148"><a href="#cb337-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1149"><a href="#cb337-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1150"><a href="#cb337-1150" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Handle</span></span>
<span id="cb337-1151"><a href="#cb337-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1152"><a href="#cb337-1152" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If residual variance increases as a function of the fitted values, consider a poisson regression model (especially for count data), for which the variance does increase with the mean</span>
<span id="cb337-1153"><a href="#cb337-1153" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If residual variance differs as a function of model predictors, consider adding interactions/product terms (the effect of one variable depends on the level of another variable)</span>
<span id="cb337-1154"><a href="#cb337-1154" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Try transforming the outcome variable to be normally distributed (log-transform if the errors seem consistent in percentage rather than absolute terms)</span>
<span id="cb337-1155"><a href="#cb337-1155" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the error variance is proportional to a variable $z$, then fit the model using Weighted Least Squares (WLS), with the weights given be $1/z$</span>
<span id="cb337-1156"><a href="#cb337-1156" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Weighted least squares (WLS) using the "weights" argument of the <span class="in">`lm()`</span> function; to get weights, see: <span class="ot">&lt;https://stats.stackexchange.com/a/100410/20338&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/C6BY-G9MS&gt;</span>)</span>
<span id="cb337-1157"><a href="#cb337-1157" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Huber-White standard errors (a.k.a. "Sandwich" estimates) from a heteroscedasticity-corrected covariance matrix</span>
<span id="cb337-1158"><a href="#cb337-1158" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="in">`coeftest()`</span> function from the <span class="in">`sandwich`</span> package along with hccm sandwich estimates from the <span class="in">`car`</span> package </span>
<span id="cb337-1159"><a href="#cb337-1159" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="in">`robcov()`</span> function from the <span class="in">`rms`</span> package</span>
<span id="cb337-1160"><a href="#cb337-1160" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Time series data: ARCH (auto-regressive conditional heteroscedasticity) models</span>
<span id="cb337-1161"><a href="#cb337-1161" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Time series data: seasonal patterns can be addressed by applying log transformation to outcome variable</span>
<span id="cb337-1162"><a href="#cb337-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1163"><a href="#cb337-1163" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Huber-White standard errors</span></span>
<span id="cb337-1164"><a href="#cb337-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1165"><a href="#cb337-1165" aria-hidden="true" tabindex="-1"></a>Standard errors (SEs) on the diagonal increase</span>
<span id="cb337-1166"><a href="#cb337-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1169"><a href="#cb337-1169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1170"><a href="#cb337-1170" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(multipleRegressionModel)</span>
<span id="cb337-1171"><a href="#cb337-1171" aria-hidden="true" tabindex="-1"></a><span class="fu">hccm</span>(multipleRegressionModel)</span>
<span id="cb337-1172"><a href="#cb337-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1173"><a href="#cb337-1173" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel)</span>
<span id="cb337-1174"><a href="#cb337-1174" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(multipleRegressionModel, <span class="at">vcov =</span> sandwich)</span>
<span id="cb337-1175"><a href="#cb337-1175" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(multipleRegressionModel, <span class="at">vcov =</span> hccm)</span>
<span id="cb337-1176"><a href="#cb337-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1177"><a href="#cb337-1177" aria-hidden="true" tabindex="-1"></a><span class="fu">robcov</span>(<span class="fu">ols</span>(</span>
<span id="cb337-1178"><a href="#cb337-1178" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1179"><a href="#cb337-1179" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1180"><a href="#cb337-1180" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-1181"><a href="#cb337-1181" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>))</span>
<span id="cb337-1182"><a href="#cb337-1182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1183"><a href="#cb337-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1184"><a href="#cb337-1184" aria-hidden="true" tabindex="-1"></a>Use "cluster" variable to account for nested data within-subject:</span>
<span id="cb337-1185"><a href="#cb337-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1188"><a href="#cb337-1188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1189"><a href="#cb337-1189" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb337-1190"><a href="#cb337-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1191"><a href="#cb337-1191" aria-hidden="true" tabindex="-1"></a><span class="fu">robcov</span>(<span class="fu">ols</span>(</span>
<span id="cb337-1192"><a href="#cb337-1192" aria-hidden="true" tabindex="-1"></a>  t_ext <span class="sc">~</span> m_ext <span class="sc">+</span> age,</span>
<span id="cb337-1193"><a href="#cb337-1193" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1194"><a href="#cb337-1194" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-1195"><a href="#cb337-1195" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>),</span>
<span id="cb337-1196"><a href="#cb337-1196" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster =</span> mydata<span class="sc">$</span>tcid) <span class="co">#account for nested data within subject</span></span>
<span id="cb337-1197"><a href="#cb337-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1198"><a href="#cb337-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1199"><a href="#cb337-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1200"><a href="#cb337-1200" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4. Errors are independent</span></span>
<span id="cb337-1201"><a href="#cb337-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1202"><a href="#cb337-1202" aria-hidden="true" tabindex="-1"></a>Independent errors means that the errors are uncorrelated with each other.</span>
<span id="cb337-1203"><a href="#cb337-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1204"><a href="#cb337-1204" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Test</span></span>
<span id="cb337-1205"><a href="#cb337-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1206"><a href="#cb337-1206" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Intraclass correlation coefficient (ICC) from mixed model</span>
<span id="cb337-1207"><a href="#cb337-1207" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Plot residuals vs. predictors (<span class="co">[</span><span class="ot">Residual Plots</span><span class="co">](#residualPlots)</span>)</span>
<span id="cb337-1208"><a href="#cb337-1208" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Time Series data: Residual time series plot (residuals vs. row number)</span>
<span id="cb337-1209"><a href="#cb337-1209" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Time Series data: Table or plot of residual autocorrelations</span>
<span id="cb337-1210"><a href="#cb337-1210" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Time Series data: Durbin-Watson statistic for test of significant residual autocorrelation at lag 1</span>
<span id="cb337-1211"><a href="#cb337-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1212"><a href="#cb337-1212" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Handle</span></span>
<span id="cb337-1213"><a href="#cb337-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1214"><a href="#cb337-1214" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Generalized least squares (GLS) models are capable of handling correlated errors: <span class="ot">&lt;https://stat.ethz.ch/R-manual/R-devel/library/nlme/html/gls.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/RHZ6-5GT8&gt;</span>)</span>
<span id="cb337-1215"><a href="#cb337-1215" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Regression with cluster variable</span>
<span id="cb337-1216"><a href="#cb337-1216" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="in">`robcov()`</span> from <span class="in">`rms`</span> package</span>
<span id="cb337-1217"><a href="#cb337-1217" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Hierarchical linear modeling</span><span class="co">](hlm.qmd)</span></span>
<span id="cb337-1218"><a href="#cb337-1218" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Linear mixed effects models</span><span class="co">](hlm.qmd#linear)</span></span>
<span id="cb337-1219"><a href="#cb337-1219" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Generalized linear mixed effects models</span><span class="co">](hlm.qmd#generalized)</span></span>
<span id="cb337-1220"><a href="#cb337-1220" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Nonlinear mixed effects models</span><span class="co">](hlm.qmd#nonlinear)</span></span>
<span id="cb337-1221"><a href="#cb337-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1222"><a href="#cb337-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5. No multicollinearity</span></span>
<span id="cb337-1223"><a href="#cb337-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1224"><a href="#cb337-1224" aria-hidden="true" tabindex="-1"></a>Multicollinearity occurs when the predictors are correlated with each other.</span>
<span id="cb337-1225"><a href="#cb337-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1226"><a href="#cb337-1226" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Test</span></span>
<span id="cb337-1227"><a href="#cb337-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1228"><a href="#cb337-1228" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Variance Inflation Factor (VIF)</span>
<span id="cb337-1229"><a href="#cb337-1229" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Generalized Variance Inflation Factor (GVIF)—when models have related regressors (multiple polynomial terms or contrasts from same predictor)</span>
<span id="cb337-1230"><a href="#cb337-1230" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Correlation</span>
<span id="cb337-1231"><a href="#cb337-1231" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tolerance</span>
<span id="cb337-1232"><a href="#cb337-1232" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Condition Index</span>
<span id="cb337-1233"><a href="#cb337-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1234"><a href="#cb337-1234" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Variance Inflation Factor (VIF)</span></span>
<span id="cb337-1235"><a href="#cb337-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1236"><a href="#cb337-1236" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb337-1237"><a href="#cb337-1237" aria-hidden="true" tabindex="-1"></a>\text{VIF} = 1/\text{Tolerance}</span>
<span id="cb337-1238"><a href="#cb337-1238" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb337-1239"><a href="#cb337-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1240"><a href="#cb337-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1241"><a href="#cb337-1241" aria-hidden="true" tabindex="-1"></a>If the variance inflation factor of a predictor variable were 5.27 ($\sqrt{5.27} = 2.3$), this means that the standard error for the coefficient of that predictor variable is 2.3 times as large (i.e., confidence interval is 2.3 times wider) as it would be if that predictor variable were uncorrelated with the other predictor variables.</span>
<span id="cb337-1242"><a href="#cb337-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1243"><a href="#cb337-1243" aria-hidden="true" tabindex="-1"></a>VIF = 1: Not correlated\</span>
<span id="cb337-1244"><a href="#cb337-1244" aria-hidden="true" tabindex="-1"></a>1 &lt; VIF &lt; 5: Moderately correlated\</span>
<span id="cb337-1245"><a href="#cb337-1245" aria-hidden="true" tabindex="-1"></a>VIF &gt; 5 to 10: Highly correlated (multicollinearity present)</span>
<span id="cb337-1246"><a href="#cb337-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1249"><a href="#cb337-1249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1250"><a href="#cb337-1250" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(multipleRegressionModel)</span>
<span id="cb337-1251"><a href="#cb337-1251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1252"><a href="#cb337-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1253"><a href="#cb337-1253" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Generalized Variance Inflation Factor (GVIF)</span></span>
<span id="cb337-1254"><a href="#cb337-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1255"><a href="#cb337-1255" aria-hidden="true" tabindex="-1"></a>Useful when models have related regressors (multiple polynomial terms or contrasts from same predictor)</span>
<span id="cb337-1256"><a href="#cb337-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1257"><a href="#cb337-1257" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Correlation</span></span>
<span id="cb337-1258"><a href="#cb337-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1259"><a href="#cb337-1259" aria-hidden="true" tabindex="-1"></a>correlation among all independent variables the correlation coefficients should be smaller than .08</span>
<span id="cb337-1260"><a href="#cb337-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1263"><a href="#cb337-1263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1264"><a href="#cb337-1264" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(</span>
<span id="cb337-1265"><a href="#cb337-1265" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_anxiousDepressedSum"</span>)],</span>
<span id="cb337-1266"><a href="#cb337-1266" aria-hidden="true" tabindex="-1"></a>  <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb337-1267"><a href="#cb337-1267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1268"><a href="#cb337-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1269"><a href="#cb337-1269" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tolerance</span></span>
<span id="cb337-1270"><a href="#cb337-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1271"><a href="#cb337-1271" aria-hidden="true" tabindex="-1"></a>The tolerance is an index of the influence of one independent variable on all other independent variables.</span>
<span id="cb337-1272"><a href="#cb337-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1273"><a href="#cb337-1273" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb337-1274"><a href="#cb337-1274" aria-hidden="true" tabindex="-1"></a>\text{tolerance} = 1/\text{VIF}</span>
<span id="cb337-1275"><a href="#cb337-1275" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb337-1276"><a href="#cb337-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1277"><a href="#cb337-1277" aria-hidden="true" tabindex="-1"></a>T &lt; 0.2: there might be multicollinearity in the data\</span>
<span id="cb337-1278"><a href="#cb337-1278" aria-hidden="true" tabindex="-1"></a>T &lt; 0.01: there certainly is multicollinarity in the data</span>
<span id="cb337-1279"><a href="#cb337-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1280"><a href="#cb337-1280" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Condition Index</span></span>
<span id="cb337-1281"><a href="#cb337-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1282"><a href="#cb337-1282" aria-hidden="true" tabindex="-1"></a>The condition index is calculated using a factor analysis on the independent variables.</span>
<span id="cb337-1283"><a href="#cb337-1283" aria-hidden="true" tabindex="-1"></a>Values of 10-30 indicate a mediocre multicollinearity in the regression variables.</span>
<span id="cb337-1284"><a href="#cb337-1284" aria-hidden="true" tabindex="-1"></a>Values &gt; 30 indicate strong multicollinearity.</span>
<span id="cb337-1285"><a href="#cb337-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1286"><a href="#cb337-1286" aria-hidden="true" tabindex="-1"></a>For how to interpret, see here: <span class="ot">&lt;https://stats.stackexchange.com/a/87610/20338&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/Y4J8-MY7Q&gt;</span>)</span>
<span id="cb337-1287"><a href="#cb337-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1290"><a href="#cb337-1290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1291"><a href="#cb337-1291" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_eigen_cindex</span>(multipleRegressionModel)</span>
<span id="cb337-1292"><a href="#cb337-1292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1293"><a href="#cb337-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1294"><a href="#cb337-1294" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Handle</span></span>
<span id="cb337-1295"><a href="#cb337-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1296"><a href="#cb337-1296" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Remove highly correlated (i.e., redundant) predictors</span>
<span id="cb337-1297"><a href="#cb337-1297" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Average the correlated predictors</span>
<span id="cb337-1298"><a href="#cb337-1298" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Principal Component Analysis</span><span class="co">](pca.qmd)</span> for data reduction</span>
<span id="cb337-1299"><a href="#cb337-1299" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Standardize predictors</span>
<span id="cb337-1300"><a href="#cb337-1300" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Center the data (deduct the mean)</span>
<span id="cb337-1301"><a href="#cb337-1301" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Singular-value decomposition of the model matrix or the mean-centered model matrix</span>
<span id="cb337-1302"><a href="#cb337-1302" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Conduct a <span class="co">[</span><span class="ot">factor analysis</span><span class="co">](#factorAnalysis.qmd)</span> and rotate the factors to ensure independence of the factors</span>
<span id="cb337-1303"><a href="#cb337-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1304"><a href="#cb337-1304" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6. Errors are normally distributed</span></span>
<span id="cb337-1305"><a href="#cb337-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1306"><a href="#cb337-1306" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Test</span></span>
<span id="cb337-1307"><a href="#cb337-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1308"><a href="#cb337-1308" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Probability Plots</span>
<span id="cb337-1309"><a href="#cb337-1309" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Normal Quantile (QQ) Plots</span><span class="co">](#qqPlot)</span> (based on non-cumulative distribution of residuals)</span>
<span id="cb337-1310"><a href="#cb337-1310" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Normal Probability (PP) Plots</span><span class="co">](#ppPlot)</span> (based on cumulative distribution of residuals)</span>
<span id="cb337-1311"><a href="#cb337-1311" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Density Plot of Residuals</span><span class="co">](#densityPlotResiduals)</span></span>
<span id="cb337-1312"><a href="#cb337-1312" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Statistical Tests</span>
<span id="cb337-1313"><a href="#cb337-1313" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Kolmogorov-Smirnov test</span>
<span id="cb337-1314"><a href="#cb337-1314" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Shapiro-Wilk test</span>
<span id="cb337-1315"><a href="#cb337-1315" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Jarque-Bera test</span>
<span id="cb337-1316"><a href="#cb337-1316" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Anderson-Darling test (best test)</span>
<span id="cb337-1317"><a href="#cb337-1317" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Examine influence of outliers</span>
<span id="cb337-1318"><a href="#cb337-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1319"><a href="#cb337-1319" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ways to Handle</span></span>
<span id="cb337-1320"><a href="#cb337-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1321"><a href="#cb337-1321" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Apply a transformation to the predictor or outcome variable</span>
<span id="cb337-1322"><a href="#cb337-1322" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Exclude outliers</span>
<span id="cb337-1323"><a href="#cb337-1323" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Robust regression</span>
<span id="cb337-1324"><a href="#cb337-1324" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Best when no outliers: MM-type regression estimator</span>
<span id="cb337-1325"><a href="#cb337-1325" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`lmrob()`</span>/<span class="in">`glmrob()`</span> function of <span class="in">`robustbase`</span> package</span>
<span id="cb337-1326"><a href="#cb337-1326" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Iteratively reweighted least squares (IRLS): <span class="in">`rlm(, method = "MM")`</span> function of <span class="in">`MASS`</span> package: <span class="ot">&lt;http://www.ats.ucla.edu/stat/r/dae/rreg.htm&gt;</span> (archived at <span class="ot">&lt;https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm&gt;</span>)</span>
<span id="cb337-1327"><a href="#cb337-1327" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Most resistant to outliers: Least trimmed squares (LTS)—but not good as a standalone estimator, better for identifying outliers</span>
<span id="cb337-1328"><a href="#cb337-1328" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`ltsReg()`</span> function of <span class="in">`robustbase`</span> package (best)</span>
<span id="cb337-1329"><a href="#cb337-1329" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Best when single predictor: Theil-Sen estimator</span>
<span id="cb337-1330"><a href="#cb337-1330" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`mblm(, repeated = FALSE)`</span> function of <span class="in">`mblm`</span> package</span>
<span id="cb337-1331"><a href="#cb337-1331" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Robust correlation</span>
<span id="cb337-1332"><a href="#cb337-1332" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Spearman's rho: <span class="in">`cor(, method = "spearman")`</span></span>
<span id="cb337-1333"><a href="#cb337-1333" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Percentage bend correlation</span>
<span id="cb337-1334"><a href="#cb337-1334" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Minimum vollume ellipsoid</span>
<span id="cb337-1335"><a href="#cb337-1335" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Minimum covariance determinant:</span>
<span id="cb337-1336"><a href="#cb337-1336" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Winsorized correlation</span>
<span id="cb337-1337"><a href="#cb337-1337" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Biweight midcorrelation</span>
<span id="cb337-1338"><a href="#cb337-1338" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Xi ($\xi$) correlation</span>
<span id="cb337-1339"><a href="#cb337-1339" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Not great options:</span>
<span id="cb337-1340"><a href="#cb337-1340" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Quantile (L1) regression: <span class="in">`rq()`</span> function of <span class="in">`quantreg`</span> package</span>
<span id="cb337-1341"><a href="#cb337-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1342"><a href="#cb337-1342" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Transformations of Outcome Variable</span></span>
<span id="cb337-1343"><a href="#cb337-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1344"><a href="#cb337-1344" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Box-Cox Transformation</span></span>
<span id="cb337-1345"><a href="#cb337-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1346"><a href="#cb337-1346" aria-hidden="true" tabindex="-1"></a>Useful if the outcome is strictly positive (or add a constant to outcome to make it strictly positive)</span>
<span id="cb337-1347"><a href="#cb337-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1348"><a href="#cb337-1348" aria-hidden="true" tabindex="-1"></a>lambda = -1: inverse transformation\</span>
<span id="cb337-1349"><a href="#cb337-1349" aria-hidden="true" tabindex="-1"></a>lambda = -0.5: 1/sqrt(Y)\</span>
<span id="cb337-1350"><a href="#cb337-1350" aria-hidden="true" tabindex="-1"></a>lambda = 0: log transformation\</span>
<span id="cb337-1351"><a href="#cb337-1351" aria-hidden="true" tabindex="-1"></a>lambda = 0.5: square root\</span>
<span id="cb337-1352"><a href="#cb337-1352" aria-hidden="true" tabindex="-1"></a>lambda = 0.333: cube root\</span>
<span id="cb337-1353"><a href="#cb337-1353" aria-hidden="true" tabindex="-1"></a>lambda = 1: no transformation\</span>
<span id="cb337-1354"><a href="#cb337-1354" aria-hidden="true" tabindex="-1"></a>lambda = 2: squared\</span>
<span id="cb337-1355"><a href="#cb337-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1356"><a href="#cb337-1356" aria-hidden="true" tabindex="-1"></a>####### Raw distribution</span>
<span id="cb337-1357"><a href="#cb337-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1360"><a href="#cb337-1360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1361"><a href="#cb337-1361" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">na.omit</span>(mydata<span class="sc">$</span>bpi_antisocialT2Sum)))</span>
<span id="cb337-1362"><a href="#cb337-1362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1363"><a href="#cb337-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1364"><a href="#cb337-1364" aria-hidden="true" tabindex="-1"></a>####### Add constant to outcome to make it strictly positive</span>
<span id="cb337-1365"><a href="#cb337-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1368"><a href="#cb337-1368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1369"><a href="#cb337-1369" aria-hidden="true" tabindex="-1"></a>strictlyPositiveDV <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1370"><a href="#cb337-1370" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">+</span> <span class="dv">1</span> <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1371"><a href="#cb337-1371" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1372"><a href="#cb337-1372" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1373"><a href="#cb337-1373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1374"><a href="#cb337-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1375"><a href="#cb337-1375" aria-hidden="true" tabindex="-1"></a>####### Identify best power transformation (lambda)</span>
<span id="cb337-1376"><a href="#cb337-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1377"><a href="#cb337-1377" aria-hidden="true" tabindex="-1"></a>Consider rounding the power to a common value (square root = .5; cube root = .333; squared = 2)</span>
<span id="cb337-1378"><a href="#cb337-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1381"><a href="#cb337-1381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1382"><a href="#cb337-1382" aria-hidden="true" tabindex="-1"></a><span class="fu">boxCox</span>(strictlyPositiveDV)</span>
<span id="cb337-1383"><a href="#cb337-1383" aria-hidden="true" tabindex="-1"></a><span class="fu">powerTransform</span>(strictlyPositiveDV) </span>
<span id="cb337-1384"><a href="#cb337-1384" aria-hidden="true" tabindex="-1"></a>transformedDV <span class="ot">&lt;-</span> <span class="fu">powerTransform</span>(strictlyPositiveDV)</span>
<span id="cb337-1385"><a href="#cb337-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1386"><a href="#cb337-1386" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(transformedDV)</span>
<span id="cb337-1387"><a href="#cb337-1387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1388"><a href="#cb337-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1389"><a href="#cb337-1389" aria-hidden="true" tabindex="-1"></a>####### Transform the DV</span>
<span id="cb337-1390"><a href="#cb337-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1393"><a href="#cb337-1393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1394"><a href="#cb337-1394" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>bpi_antisocialT2SumTransformed <span class="ot">&lt;-</span> <span class="fu">bcPower</span>(mydata<span class="sc">$</span>bpi_antisocialT2Sum <span class="sc">+</span> <span class="dv">1</span>, <span class="fu">coef</span>(transformedDV))</span>
<span id="cb337-1395"><a href="#cb337-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1396"><a href="#cb337-1396" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">na.omit</span>(mydata<span class="sc">$</span>bpi_antisocialT2SumTransformed)))</span>
<span id="cb337-1397"><a href="#cb337-1397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1398"><a href="#cb337-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1399"><a href="#cb337-1399" aria-hidden="true" tabindex="-1"></a>####### Compare residuals from model with and without transformation</span>
<span id="cb337-1400"><a href="#cb337-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1401"><a href="#cb337-1401" aria-hidden="true" tabindex="-1"></a>######## Model without transformation</span>
<span id="cb337-1402"><a href="#cb337-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1405"><a href="#cb337-1405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1406"><a href="#cb337-1406" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelWithoutTransformation <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1407"><a href="#cb337-1407" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">+</span> <span class="dv">1</span> <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1408"><a href="#cb337-1408" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1409"><a href="#cb337-1409" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude))</span>
<span id="cb337-1410"><a href="#cb337-1410" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">na.omit</span>(<span class="fu">studres</span>(modelWithoutTransformation))))</span>
<span id="cb337-1411"><a href="#cb337-1411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1412"><a href="#cb337-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1413"><a href="#cb337-1413" aria-hidden="true" tabindex="-1"></a>######## Model with transformation</span>
<span id="cb337-1414"><a href="#cb337-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1417"><a href="#cb337-1417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1418"><a href="#cb337-1418" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelWithTransformation <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1419"><a href="#cb337-1419" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2SumTransformed <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1420"><a href="#cb337-1420" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1421"><a href="#cb337-1421" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude))</span>
<span id="cb337-1422"><a href="#cb337-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1423"><a href="#cb337-1423" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">na.omit</span>(<span class="fu">studres</span>(modelWithTransformation))))</span>
<span id="cb337-1424"><a href="#cb337-1424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1425"><a href="#cb337-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1426"><a href="#cb337-1426" aria-hidden="true" tabindex="-1"></a>####### Constructed Variable Test &amp; Plot</span>
<span id="cb337-1427"><a href="#cb337-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1428"><a href="#cb337-1428" aria-hidden="true" tabindex="-1"></a>A significant *p*-value indicates a strong need to transform variable:</span>
<span id="cb337-1429"><a href="#cb337-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1432"><a href="#cb337-1432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1433"><a href="#cb337-1433" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_constructedVariable <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb337-1434"><a href="#cb337-1434" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1435"><a href="#cb337-1435" aria-hidden="true" tabindex="-1"></a>  . <span class="sc">~</span> . <span class="sc">+</span> <span class="fu">boxCoxVariable</span>(bpi_antisocialT1Sum <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb337-1436"><a href="#cb337-1436" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel_constructedVariable)<span class="sc">$</span>coef[<span class="st">"boxCoxVariable(bpi_antisocialT1Sum + 1)"</span>, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb337-1437"><a href="#cb337-1437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1438"><a href="#cb337-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1439"><a href="#cb337-1439" aria-hidden="true" tabindex="-1"></a>Plot allows us to see whether the need for transformation is spread through data or whether it is just dependent on a small fraction of observations:</span>
<span id="cb337-1440"><a href="#cb337-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1443"><a href="#cb337-1443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1444"><a href="#cb337-1444" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(multipleRegressionModel_constructedVariable, <span class="st">"boxCoxVariable(bpi_antisocialT1Sum + 1)"</span>)</span>
<span id="cb337-1445"><a href="#cb337-1445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1446"><a href="#cb337-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1447"><a href="#cb337-1447" aria-hidden="true" tabindex="-1"></a>####### Inverse Response Plot</span>
<span id="cb337-1448"><a href="#cb337-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1449"><a href="#cb337-1449" aria-hidden="true" tabindex="-1"></a>The black line is the best-fitting power transformation:</span>
<span id="cb337-1450"><a href="#cb337-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1453"><a href="#cb337-1453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1454"><a href="#cb337-1454" aria-hidden="true" tabindex="-1"></a><span class="fu">inverseResponsePlot</span>(strictlyPositiveDV, <span class="at">lambda =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb337-1455"><a href="#cb337-1455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1456"><a href="#cb337-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1457"><a href="#cb337-1457" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Yeo-Johnson Transformations</span></span>
<span id="cb337-1458"><a href="#cb337-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1459"><a href="#cb337-1459" aria-hidden="true" tabindex="-1"></a>Useful if the outcome is not strictly positive.</span>
<span id="cb337-1460"><a href="#cb337-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1463"><a href="#cb337-1463" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1464"><a href="#cb337-1464" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb337-1465"><a href="#cb337-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1466"><a href="#cb337-1466" aria-hidden="true" tabindex="-1"></a><span class="fu">yjPower</span>(DV, lambda)</span>
<span id="cb337-1467"><a href="#cb337-1467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1468"><a href="#cb337-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1469"><a href="#cb337-1469" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Transformations of Predictor Variable</span></span>
<span id="cb337-1470"><a href="#cb337-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1471"><a href="#cb337-1471" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Component-Plus-Residual Plots (Partial Residual Plots)</span></span>
<span id="cb337-1472"><a href="#cb337-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1473"><a href="#cb337-1473" aria-hidden="true" tabindex="-1"></a>Linear model:</span>
<span id="cb337-1474"><a href="#cb337-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1477"><a href="#cb337-1477" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1478"><a href="#cb337-1478" aria-hidden="true" tabindex="-1"></a><span class="fu">crPlots</span>(multipleRegressionModelNoMissing, <span class="at">order =</span> <span class="dv">1</span>)</span>
<span id="cb337-1479"><a href="#cb337-1479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1480"><a href="#cb337-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1481"><a href="#cb337-1481" aria-hidden="true" tabindex="-1"></a>Quadratic model:</span>
<span id="cb337-1482"><a href="#cb337-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1485"><a href="#cb337-1485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1486"><a href="#cb337-1486" aria-hidden="true" tabindex="-1"></a><span class="fu">crPlots</span>(multipleRegressionModelNoMissing, <span class="at">order =</span> <span class="dv">2</span>)</span>
<span id="cb337-1487"><a href="#cb337-1487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1488"><a href="#cb337-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1489"><a href="#cb337-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1492"><a href="#cb337-1492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1493"><a href="#cb337-1493" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_quadratic <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1494"><a href="#cb337-1494" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> <span class="fu">I</span>(bpi_antisocialT1Sum<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1495"><a href="#cb337-1495" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1496"><a href="#cb337-1496" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1497"><a href="#cb337-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1498"><a href="#cb337-1498" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel_quadratic)</span>
<span id="cb337-1499"><a href="#cb337-1499" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(</span>
<span id="cb337-1500"><a href="#cb337-1500" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_quadratic,</span>
<span id="cb337-1501"><a href="#cb337-1501" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel)</span>
<span id="cb337-1502"><a href="#cb337-1502" aria-hidden="true" tabindex="-1"></a><span class="fu">crPlots</span>(multipleRegressionModel_quadratic, <span class="at">order =</span> <span class="dv">1</span>)</span>
<span id="cb337-1503"><a href="#cb337-1503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1504"><a href="#cb337-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1505"><a href="#cb337-1505" aria-hidden="true" tabindex="-1"></a><span class="fu">###### CERES Plot (Combining conditional Expectations and RESiduals)</span></span>
<span id="cb337-1506"><a href="#cb337-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1507"><a href="#cb337-1507" aria-hidden="true" tabindex="-1"></a>Useful when nonlinear associations among the predictors are very strong (component-plus-residual plots may appear nonlinear even though the true partial regression is linear, a phenonomen called leakage)</span>
<span id="cb337-1508"><a href="#cb337-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1511"><a href="#cb337-1511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1512"><a href="#cb337-1512" aria-hidden="true" tabindex="-1"></a><span class="fu">ceresPlots</span>(multipleRegressionModel)</span>
<span id="cb337-1513"><a href="#cb337-1513" aria-hidden="true" tabindex="-1"></a><span class="fu">ceresPlots</span>(multipleRegressionModel_quadratic)</span>
<span id="cb337-1514"><a href="#cb337-1514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1515"><a href="#cb337-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1516"><a href="#cb337-1516" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Box-Tidwell Method for Choosing Predictor Transformations</span></span>
<span id="cb337-1517"><a href="#cb337-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1518"><a href="#cb337-1518" aria-hidden="true" tabindex="-1"></a>predictors must be strictly positive (or add a constant to make it strictly positive)</span>
<span id="cb337-1519"><a href="#cb337-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1522"><a href="#cb337-1522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1523"><a href="#cb337-1523" aria-hidden="true" tabindex="-1"></a><span class="fu">boxTidwell</span>(</span>
<span id="cb337-1524"><a href="#cb337-1524" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> <span class="fu">I</span>(bpi_antisocialT1Sum <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">I</span>(bpi_anxiousDepressedSum <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb337-1525"><a href="#cb337-1525" aria-hidden="true" tabindex="-1"></a>  <span class="at">other.x =</span> <span class="cn">NULL</span>, <span class="co">#list variables not to be transformed in other.x</span></span>
<span id="cb337-1526"><a href="#cb337-1526" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1527"><a href="#cb337-1527" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1528"><a href="#cb337-1528" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1529"><a href="#cb337-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1530"><a href="#cb337-1530" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Constructed-Variables Plot</span></span>
<span id="cb337-1531"><a href="#cb337-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1534"><a href="#cb337-1534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1535"><a href="#cb337-1535" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_cv <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1536"><a href="#cb337-1536" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> <span class="fu">I</span>(bpi_antisocialT1Sum <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">I</span>(bpi_anxiousDepressedSum <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">I</span>(bpi_antisocialT1Sum <span class="sc">*</span> <span class="fu">log</span>(bpi_antisocialT1Sum)) <span class="sc">+</span> <span class="fu">I</span>(bpi_anxiousDepressedSum <span class="sc">*</span> <span class="fu">log</span>(bpi_anxiousDepressedSum)),</span>
<span id="cb337-1537"><a href="#cb337-1537" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1538"><a href="#cb337-1538" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1539"><a href="#cb337-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1540"><a href="#cb337-1540" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel_cv)<span class="sc">$</span>coef[<span class="st">"I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum))"</span>, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb337-1541"><a href="#cb337-1541" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multipleRegressionModel_cv)<span class="sc">$</span>coef[<span class="st">"I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum))"</span>, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb337-1542"><a href="#cb337-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1543"><a href="#cb337-1543" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(multipleRegressionModel_cv, <span class="st">"I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum))"</span>)</span>
<span id="cb337-1544"><a href="#cb337-1544" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(multipleRegressionModel_cv, <span class="st">"I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum))"</span>)</span>
<span id="cb337-1545"><a href="#cb337-1545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1546"><a href="#cb337-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1547"><a href="#cb337-1547" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Robust models</span></span>
<span id="cb337-1548"><a href="#cb337-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1549"><a href="#cb337-1549" aria-hidden="true" tabindex="-1"></a>Resources</span>
<span id="cb337-1550"><a href="#cb337-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1551"><a href="#cb337-1551" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For comparison of methods, see Book: "Modern Methods for Robust Regression"</span>
<span id="cb337-1552"><a href="#cb337-1552" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;http://www.ats.ucla.edu/stat/r/dae/rreg.htm&gt;</span> (archived at <span class="ot">&lt;https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm&gt;</span>)</span>
<span id="cb337-1553"><a href="#cb337-1553" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://stats.stackexchange.com/a/46234/20338&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/WC57-9GA7&gt;</span>)</span>
<span id="cb337-1554"><a href="#cb337-1554" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://cran.r-project.org/web/views/Robust.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/THN5-KNY3&gt;</span>)</span>
<span id="cb337-1555"><a href="#cb337-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1556"><a href="#cb337-1556" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Robust correlation</span></span>
<span id="cb337-1557"><a href="#cb337-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1558"><a href="#cb337-1558" aria-hidden="true" tabindex="-1"></a>####### Spearman's rho</span>
<span id="cb337-1559"><a href="#cb337-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1560"><a href="#cb337-1560" aria-hidden="true" tabindex="-1"></a>Spearman's rho is a non-parametric correlation.</span>
<span id="cb337-1561"><a href="#cb337-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1564"><a href="#cb337-1564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1565"><a href="#cb337-1565" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(</span>
<span id="cb337-1566"><a href="#cb337-1566" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT1Sum,</span>
<span id="cb337-1567"><a href="#cb337-1567" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT2Sum) <span class="co">#Pearson r, correlation that is sensitive to outliers</span></span>
<span id="cb337-1568"><a href="#cb337-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1569"><a href="#cb337-1569" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(</span>
<span id="cb337-1570"><a href="#cb337-1570" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT1Sum,</span>
<span id="cb337-1571"><a href="#cb337-1571" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT2Sum, <span class="at">method =</span> <span class="st">"spearman"</span>) <span class="co">#Spearman's rho, a rank correlation that is less sensitive to outliers</span></span>
<span id="cb337-1572"><a href="#cb337-1572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1573"><a href="#cb337-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1574"><a href="#cb337-1574" aria-hidden="true" tabindex="-1"></a>####### Minimum vollume ellipsoid</span>
<span id="cb337-1575"><a href="#cb337-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1578"><a href="#cb337-1578" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1579"><a href="#cb337-1579" aria-hidden="true" tabindex="-1"></a><span class="fu">cov.mve</span>(</span>
<span id="cb337-1580"><a href="#cb337-1580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)]),</span>
<span id="cb337-1581"><a href="#cb337-1581" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1582"><a href="#cb337-1582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1583"><a href="#cb337-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1584"><a href="#cb337-1584" aria-hidden="true" tabindex="-1"></a>####### Minimum covariance determinant</span>
<span id="cb337-1585"><a href="#cb337-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1588"><a href="#cb337-1588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1589"><a href="#cb337-1589" aria-hidden="true" tabindex="-1"></a><span class="fu">cov.mcd</span>(</span>
<span id="cb337-1590"><a href="#cb337-1590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)]),</span>
<span id="cb337-1591"><a href="#cb337-1591" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1592"><a href="#cb337-1592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1593"><a href="#cb337-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1594"><a href="#cb337-1594" aria-hidden="true" tabindex="-1"></a>####### Winsorized correlation</span>
<span id="cb337-1595"><a href="#cb337-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1598"><a href="#cb337-1598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1599"><a href="#cb337-1599" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(</span>
<span id="cb337-1600"><a href="#cb337-1600" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)],</span>
<span id="cb337-1601"><a href="#cb337-1601" aria-hidden="true" tabindex="-1"></a>  <span class="at">winsorize =</span> <span class="fl">0.2</span>,</span>
<span id="cb337-1602"><a href="#cb337-1602" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb337-1603"><a href="#cb337-1603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1604"><a href="#cb337-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1605"><a href="#cb337-1605" aria-hidden="true" tabindex="-1"></a>####### Percentage bend correlation</span>
<span id="cb337-1606"><a href="#cb337-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1609"><a href="#cb337-1609" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1610"><a href="#cb337-1610" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(</span>
<span id="cb337-1611"><a href="#cb337-1611" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)],</span>
<span id="cb337-1612"><a href="#cb337-1612" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"percentage"</span>,</span>
<span id="cb337-1613"><a href="#cb337-1613" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb337-1614"><a href="#cb337-1614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1615"><a href="#cb337-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1616"><a href="#cb337-1616" aria-hidden="true" tabindex="-1"></a>####### Biweight midcorrelation</span>
<span id="cb337-1617"><a href="#cb337-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1620"><a href="#cb337-1620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1621"><a href="#cb337-1621" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(</span>
<span id="cb337-1622"><a href="#cb337-1622" aria-hidden="true" tabindex="-1"></a>  mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)],</span>
<span id="cb337-1623"><a href="#cb337-1623" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"biweight"</span>,</span>
<span id="cb337-1624"><a href="#cb337-1624" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb337-1625"><a href="#cb337-1625" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1626"><a href="#cb337-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1627"><a href="#cb337-1627" aria-hidden="true" tabindex="-1"></a>####### Xi ($\xi$)</span>
<span id="cb337-1628"><a href="#cb337-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1629"><a href="#cb337-1629" aria-hidden="true" tabindex="-1"></a>Xi ($\xi$) is an index of the degree of dependence between two variables</span>
<span id="cb337-1630"><a href="#cb337-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1631"><a href="#cb337-1631" aria-hidden="true" tabindex="-1"></a>Chatterjee, S. (2021). A new coefficient of correlation. *Journal of the American Statistical Association, 116*(536), 2009-2022. <span class="ot">&lt;https://doi.org/10.1080/01621459.2020.1758115&gt;</span></span>
<span id="cb337-1632"><a href="#cb337-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1635"><a href="#cb337-1635" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1636"><a href="#cb337-1636" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>) <span class="co"># for reproducibility</span></span>
<span id="cb337-1637"><a href="#cb337-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1638"><a href="#cb337-1638" aria-hidden="true" tabindex="-1"></a>XICOR<span class="sc">::</span><span class="fu">xicor</span>(</span>
<span id="cb337-1639"><a href="#cb337-1639" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT1Sum,</span>
<span id="cb337-1640"><a href="#cb337-1640" aria-hidden="true" tabindex="-1"></a>  mydata<span class="sc">$</span>bpi_antisocialT2Sum,</span>
<span id="cb337-1641"><a href="#cb337-1641" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"permutation"</span>,</span>
<span id="cb337-1642"><a href="#cb337-1642" aria-hidden="true" tabindex="-1"></a>  <span class="at">pvalue =</span> <span class="cn">TRUE</span></span>
<span id="cb337-1643"><a href="#cb337-1643" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb337-1644"><a href="#cb337-1644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1645"><a href="#cb337-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1646"><a href="#cb337-1646" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Robust regression with a single predictor</span></span>
<span id="cb337-1647"><a href="#cb337-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1648"><a href="#cb337-1648" aria-hidden="true" tabindex="-1"></a>####### Theil-Sen estimator</span>
<span id="cb337-1649"><a href="#cb337-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1650"><a href="#cb337-1650" aria-hidden="true" tabindex="-1"></a>The Theil-Sen single median estimator is robust to outliers; have to remove missing values first</span>
<span id="cb337-1651"><a href="#cb337-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1654"><a href="#cb337-1654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1655"><a href="#cb337-1655" aria-hidden="true" tabindex="-1"></a>mydata_subset <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"bpi_antisocialT1Sum"</span>,<span class="st">"bpi_antisocialT2Sum"</span>)])[<span class="dv">1</span><span class="sc">:</span><span class="dv">400</span>,]</span>
<span id="cb337-1656"><a href="#cb337-1656" aria-hidden="true" tabindex="-1"></a><span class="fu">mblm</span>(</span>
<span id="cb337-1657"><a href="#cb337-1657" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum,</span>
<span id="cb337-1658"><a href="#cb337-1658" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataframe =</span> mydata_subset,</span>
<span id="cb337-1659"><a href="#cb337-1659" aria-hidden="true" tabindex="-1"></a>  <span class="at">repeated =</span> <span class="cn">FALSE</span>)</span>
<span id="cb337-1660"><a href="#cb337-1660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1661"><a href="#cb337-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1662"><a href="#cb337-1662" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Robust multiple regression</span></span>
<span id="cb337-1663"><a href="#cb337-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1664"><a href="#cb337-1664" aria-hidden="true" tabindex="-1"></a>Best when no outliers: MM-type regression estimator</span>
<span id="cb337-1665"><a href="#cb337-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1666"><a href="#cb337-1666" aria-hidden="true" tabindex="-1"></a>####### Robust linear regression</span>
<span id="cb337-1667"><a href="#cb337-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1668"><a href="#cb337-1668" aria-hidden="true" tabindex="-1"></a>MM-type regression estimator (best):</span>
<span id="cb337-1669"><a href="#cb337-1669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1672"><a href="#cb337-1672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1673"><a href="#cb337-1673" aria-hidden="true" tabindex="-1"></a><span class="fu">lmrob</span>(</span>
<span id="cb337-1674"><a href="#cb337-1674" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1675"><a href="#cb337-1675" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1676"><a href="#cb337-1676" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1677"><a href="#cb337-1677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1678"><a href="#cb337-1678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1679"><a href="#cb337-1679" aria-hidden="true" tabindex="-1"></a>Iteratively reweighted least squares (IRLS): <span class="ot">&lt;http://www.ats.ucla.edu/stat/r/dae/rreg.htm&gt;</span> (archived at <span class="ot">&lt;https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm&gt;</span>)</span>
<span id="cb337-1680"><a href="#cb337-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1683"><a href="#cb337-1683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1684"><a href="#cb337-1684" aria-hidden="true" tabindex="-1"></a><span class="fu">rlm</span>(</span>
<span id="cb337-1685"><a href="#cb337-1685" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1686"><a href="#cb337-1686" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1687"><a href="#cb337-1687" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1688"><a href="#cb337-1688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1689"><a href="#cb337-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1690"><a href="#cb337-1690" aria-hidden="true" tabindex="-1"></a>####### Robust generalized regression</span>
<span id="cb337-1691"><a href="#cb337-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1694"><a href="#cb337-1694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1695"><a href="#cb337-1695" aria-hidden="true" tabindex="-1"></a><span class="fu">glmrob</span>(</span>
<span id="cb337-1696"><a href="#cb337-1696" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1697"><a href="#cb337-1697" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1698"><a href="#cb337-1698" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb337-1699"><a href="#cb337-1699" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>)</span>
<span id="cb337-1700"><a href="#cb337-1700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1701"><a href="#cb337-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1702"><a href="#cb337-1702" aria-hidden="true" tabindex="-1"></a>Most resistant to outliers: Least trimmed squares (LTS)—but not good as a standalone estimator, better for identifying outliers</span>
<span id="cb337-1703"><a href="#cb337-1703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1706"><a href="#cb337-1706" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1707"><a href="#cb337-1707" aria-hidden="true" tabindex="-1"></a><span class="fu">ltsReg</span>(</span>
<span id="cb337-1708"><a href="#cb337-1708" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1709"><a href="#cb337-1709" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1710"><a href="#cb337-1710" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1711"><a href="#cb337-1711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1712"><a href="#cb337-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1713"><a href="#cb337-1713" aria-hidden="true" tabindex="-1"></a>######## Not great options:</span>
<span id="cb337-1714"><a href="#cb337-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1715"><a href="#cb337-1715" aria-hidden="true" tabindex="-1"></a>Quantile (L1) regression: <span class="in">`rq()`</span> function of quantreg package</span>
<span id="cb337-1716"><a href="#cb337-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1717"><a href="#cb337-1717" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://data.library.virginia.edu/getting-started-with-quantile-regression/&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/FSV4-5DCR&gt;</span>)</span>
<span id="cb337-1718"><a href="#cb337-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1721"><a href="#cb337-1721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1722"><a href="#cb337-1722" aria-hidden="true" tabindex="-1"></a>quantiles <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span><span class="sc">/</span><span class="dv">10</span></span>
<span id="cb337-1723"><a href="#cb337-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1724"><a href="#cb337-1724" aria-hidden="true" tabindex="-1"></a>quantileRegressionModel <span class="ot">&lt;-</span> <span class="fu">rq</span>(</span>
<span id="cb337-1725"><a href="#cb337-1725" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1726"><a href="#cb337-1726" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1727"><a href="#cb337-1727" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau =</span> quantiles,</span>
<span id="cb337-1728"><a href="#cb337-1728" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb337-1729"><a href="#cb337-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1730"><a href="#cb337-1730" aria-hidden="true" tabindex="-1"></a>quantileRegressionModel</span>
<span id="cb337-1731"><a href="#cb337-1731" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quantileRegressionModel)</span>
<span id="cb337-1732"><a href="#cb337-1732" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1733"><a href="#cb337-1733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1734"><a href="#cb337-1734" aria-hidden="true" tabindex="-1"></a>Plot to examine the association between the predictor and the outcome at different levels (i.e., quantiles) of the predictor:</span>
<span id="cb337-1735"><a href="#cb337-1735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1738"><a href="#cb337-1738" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1739"><a href="#cb337-1739" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb337-1740"><a href="#cb337-1740" aria-hidden="true" tabindex="-1"></a>  mydata,</span>
<span id="cb337-1741"><a href="#cb337-1741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(bpi_antisocialT1Sum, bpi_antisocialT2Sum)) <span class="sc">+</span> </span>
<span id="cb337-1742"><a href="#cb337-1742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb337-1743"><a href="#cb337-1743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quantile</span>(</span>
<span id="cb337-1744"><a href="#cb337-1744" aria-hidden="true" tabindex="-1"></a>    <span class="at">quantiles =</span> quantiles,</span>
<span id="cb337-1745"><a href="#cb337-1745" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(<span class="fu">after_stat</span>(quantile))))</span>
<span id="cb337-1746"><a href="#cb337-1746" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1747"><a href="#cb337-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1748"><a href="#cb337-1748" aria-hidden="true" tabindex="-1"></a>Below is a plot that examines the difference in quantile coefficients (and associated confidence intervals) at different levels (i.e., quantiles) of the predictor.</span>
<span id="cb337-1749"><a href="#cb337-1749" aria-hidden="true" tabindex="-1"></a>The x-axis is the quantile of the predictor.</span>
<span id="cb337-1750"><a href="#cb337-1750" aria-hidden="true" tabindex="-1"></a>The y-axis is the slope coefficient.</span>
<span id="cb337-1751"><a href="#cb337-1751" aria-hidden="true" tabindex="-1"></a>Each black dot is the slope coefficient for the given quantile of the predictor.</span>
<span id="cb337-1752"><a href="#cb337-1752" aria-hidden="true" tabindex="-1"></a>The red lines are the least squares estimate of the slope coefficient and its confidence interval.</span>
<span id="cb337-1753"><a href="#cb337-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1756"><a href="#cb337-1756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1757"><a href="#cb337-1757" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(quantileRegressionModel))</span>
<span id="cb337-1758"><a href="#cb337-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1759"><a href="#cb337-1759" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb337-1760"><a href="#cb337-1760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(quantileRegressionModel),</span>
<span id="cb337-1761"><a href="#cb337-1761" aria-hidden="true" tabindex="-1"></a>  <span class="at">parm =</span> <span class="st">"bpi_antisocialT1Sum"</span>)</span>
<span id="cb337-1762"><a href="#cb337-1762" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1763"><a href="#cb337-1763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1764"><a href="#cb337-1764" aria-hidden="true" tabindex="-1"></a><span class="fu">## Examining Model Assumptions</span></span>
<span id="cb337-1765"><a href="#cb337-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1766"><a href="#cb337-1766" aria-hidden="true" tabindex="-1"></a><span class="fu">### Distribution of Residuals</span></span>
<span id="cb337-1767"><a href="#cb337-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1768"><a href="#cb337-1768" aria-hidden="true" tabindex="-1"></a><span class="fu">#### QQ plots {#qqPlot}</span></span>
<span id="cb337-1769"><a href="#cb337-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1770"><a href="#cb337-1770" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://www.ucd.ie/ecomodel/Resources/QQplots_WebVersion.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/9UC3-3WRX&gt;</span>)</span>
<span id="cb337-1771"><a href="#cb337-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1774"><a href="#cb337-1774" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1775"><a href="#cb337-1775" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(multipleRegressionModel, <span class="at">main =</span> <span class="st">"QQ Plot"</span>, <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1776"><a href="#cb337-1776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1777"><a href="#cb337-1777" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(multipleRegressionModel))</span>
<span id="cb337-1778"><a href="#cb337-1778" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(rmsMultipleRegressionModel))</span>
<span id="cb337-1779"><a href="#cb337-1779" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(robustLinearRegression))</span>
<span id="cb337-1780"><a href="#cb337-1780" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(ltsRegression))</span>
<span id="cb337-1781"><a href="#cb337-1781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1782"><a href="#cb337-1782" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(generalizedRegressionModel))</span>
<span id="cb337-1783"><a href="#cb337-1783" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(rmsGeneralizedRegressionModel))</span>
<span id="cb337-1784"><a href="#cb337-1784" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(robustGeneralizedRegression))</span>
<span id="cb337-1785"><a href="#cb337-1785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1786"><a href="#cb337-1786" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(multilevelRegressionModel))</span>
<span id="cb337-1787"><a href="#cb337-1787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1788"><a href="#cb337-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1789"><a href="#cb337-1789" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PP plots {#ppPlot}</span></span>
<span id="cb337-1790"><a href="#cb337-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1793"><a href="#cb337-1793" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1794"><a href="#cb337-1794" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(multipleRegressionModel)</span>
<span id="cb337-1795"><a href="#cb337-1795" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(rmsMultipleRegressionModel)</span>
<span id="cb337-1796"><a href="#cb337-1796" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(robustLinearRegression)</span>
<span id="cb337-1797"><a href="#cb337-1797" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(ltsRegression)</span>
<span id="cb337-1798"><a href="#cb337-1798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1799"><a href="#cb337-1799" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(generalizedRegressionModel)</span>
<span id="cb337-1800"><a href="#cb337-1800" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(rmsGeneralizedRegressionModel)</span>
<span id="cb337-1801"><a href="#cb337-1801" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(robustGeneralizedRegression)</span>
<span id="cb337-1802"><a href="#cb337-1802" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1803"><a href="#cb337-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1804"><a href="#cb337-1804" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Density Plot of Residuals {#densityPlotResiduals}</span></span>
<span id="cb337-1805"><a href="#cb337-1805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1808"><a href="#cb337-1808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1809"><a href="#cb337-1809" aria-hidden="true" tabindex="-1"></a>studentizedResiduals <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">rstudent</span>(multipleRegressionModel))</span>
<span id="cb337-1810"><a href="#cb337-1810" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb337-1811"><a href="#cb337-1811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">density</span>(studentizedResiduals),</span>
<span id="cb337-1812"><a href="#cb337-1812" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb337-1813"><a href="#cb337-1813" aria-hidden="true" tabindex="-1"></a>xfit <span class="ot">&lt;-</span> <span class="fu">seq</span>(</span>
<span id="cb337-1814"><a href="#cb337-1814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(studentizedResiduals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb337-1815"><a href="#cb337-1815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(studentizedResiduals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb337-1816"><a href="#cb337-1816" aria-hidden="true" tabindex="-1"></a>  <span class="at">length =</span> <span class="dv">40</span>)</span>
<span id="cb337-1817"><a href="#cb337-1817" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(</span>
<span id="cb337-1818"><a href="#cb337-1818" aria-hidden="true" tabindex="-1"></a>  xfit,</span>
<span id="cb337-1819"><a href="#cb337-1819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(xfit),</span>
<span id="cb337-1820"><a href="#cb337-1820" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="st">"gray"</span>) <span class="co">#compare to normal distribution</span></span>
<span id="cb337-1821"><a href="#cb337-1821" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1822"><a href="#cb337-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1823"><a href="#cb337-1823" aria-hidden="true" tabindex="-1"></a><span class="fu">### Residual Plots {#residualPlots}</span></span>
<span id="cb337-1824"><a href="#cb337-1824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1825"><a href="#cb337-1825" aria-hidden="true" tabindex="-1"></a>Residual plots are plots of the residuals versus observed/fitted values.</span>
<span id="cb337-1826"><a href="#cb337-1826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1827"><a href="#cb337-1827" aria-hidden="true" tabindex="-1"></a>Includes plots of a) model residuals versus observed values on predictors and b) model residuals versus model fitted values.</span>
<span id="cb337-1828"><a href="#cb337-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1829"><a href="#cb337-1829" aria-hidden="true" tabindex="-1"></a>Note: have to remove <span class="in">`na.action = na.exclude`</span></span>
<span id="cb337-1830"><a href="#cb337-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1831"><a href="#cb337-1831" aria-hidden="true" tabindex="-1"></a>Tests include:</span>
<span id="cb337-1832"><a href="#cb337-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1833"><a href="#cb337-1833" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>lack-of-fit test for every numeric predictor, t-test for the regressor, added to the model, indicating no lack-of-fit for this type</span>
<span id="cb337-1834"><a href="#cb337-1834" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tukey's test for nonadditivity: adding the squares of the fitted values to the model and refitting (evaluates adequacy of model fit)</span>
<span id="cb337-1835"><a href="#cb337-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1838"><a href="#cb337-1838" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1839"><a href="#cb337-1839" aria-hidden="true" tabindex="-1"></a><span class="fu">residualPlots</span>(</span>
<span id="cb337-1840"><a href="#cb337-1840" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModelNoMissing,</span>
<span id="cb337-1841"><a href="#cb337-1841" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1842"><a href="#cb337-1842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1843"><a href="#cb337-1843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1844"><a href="#cb337-1844" aria-hidden="true" tabindex="-1"></a><span class="fu">### Marginal Model Plots {#marginalModelPlots}</span></span>
<span id="cb337-1845"><a href="#cb337-1845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1846"><a href="#cb337-1846" aria-hidden="true" tabindex="-1"></a>Marginal model plots are plots of the outcome versus predictors/fitted values.</span>
<span id="cb337-1847"><a href="#cb337-1847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1848"><a href="#cb337-1848" aria-hidden="true" tabindex="-1"></a>Includes plots of a) observed outcome values versus values on predictors (ignoring the other predictors) and b) observed outcome values versus model fitted values.</span>
<span id="cb337-1849"><a href="#cb337-1849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1852"><a href="#cb337-1852" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1853"><a href="#cb337-1853" aria-hidden="true" tabindex="-1"></a><span class="fu">marginalModelPlots</span>(</span>
<span id="cb337-1854"><a href="#cb337-1854" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1855"><a href="#cb337-1855" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-1856"><a href="#cb337-1856" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1857"><a href="#cb337-1857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1858"><a href="#cb337-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1859"><a href="#cb337-1859" aria-hidden="true" tabindex="-1"></a><span class="fu">### Added-Variable Plots {#addedVariablePlots}</span></span>
<span id="cb337-1860"><a href="#cb337-1860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1861"><a href="#cb337-1861" aria-hidden="true" tabindex="-1"></a>Added-variable plots are plots of the partial association between the outcome and each predictor, controlling for all other predictors.</span>
<span id="cb337-1862"><a href="#cb337-1862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1863"><a href="#cb337-1863" aria-hidden="true" tabindex="-1"></a>Useful for identifying jointly influential observations and studying the impact of observations on the regression coefficients.</span>
<span id="cb337-1864"><a href="#cb337-1864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1865"><a href="#cb337-1865" aria-hidden="true" tabindex="-1"></a>y-axis: residuals from model with all predictors excluding the predictor of interest</span>
<span id="cb337-1866"><a href="#cb337-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1867"><a href="#cb337-1867" aria-hidden="true" tabindex="-1"></a>x-axis: residuals from model regressing predictor of interest on all other predictors</span>
<span id="cb337-1868"><a href="#cb337-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1871"><a href="#cb337-1871" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1872"><a href="#cb337-1872" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(</span>
<span id="cb337-1873"><a href="#cb337-1873" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1874"><a href="#cb337-1874" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1875"><a href="#cb337-1875" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1876"><a href="#cb337-1876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1877"><a href="#cb337-1877" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Refit model removing jointly influential observations</span></span>
<span id="cb337-1878"><a href="#cb337-1878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1881"><a href="#cb337-1881" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1882"><a href="#cb337-1882" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_removeJointlyInfluentialObs <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1883"><a href="#cb337-1883" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1884"><a href="#cb337-1884" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1885"><a href="#cb337-1885" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-1886"><a href="#cb337-1886" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">6318</span>,<span class="dv">6023</span>,<span class="dv">4022</span>,<span class="dv">4040</span>))</span>
<span id="cb337-1887"><a href="#cb337-1887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1888"><a href="#cb337-1888" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(</span>
<span id="cb337-1889"><a href="#cb337-1889" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_removeJointlyInfluentialObs,</span>
<span id="cb337-1890"><a href="#cb337-1890" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1891"><a href="#cb337-1891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1892"><a href="#cb337-1892" aria-hidden="true" tabindex="-1"></a><span class="fu">compareCoefs</span>(</span>
<span id="cb337-1893"><a href="#cb337-1893" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1894"><a href="#cb337-1894" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_removeJointlyInfluentialObs)</span>
<span id="cb337-1895"><a href="#cb337-1895" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1896"><a href="#cb337-1896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1897"><a href="#cb337-1897" aria-hidden="true" tabindex="-1"></a><span class="fu">### Outlier test</span></span>
<span id="cb337-1898"><a href="#cb337-1898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1899"><a href="#cb337-1899" aria-hidden="true" tabindex="-1"></a>Locates the largest Studentized residuals in absolute value and computes the Bonferroni-corrected p-values based on a t-test for linear models.</span>
<span id="cb337-1900"><a href="#cb337-1900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1901"><a href="#cb337-1901" aria-hidden="true" tabindex="-1"></a>Test of outlyingness, i.e., how likely one would have a residual of a given magnitude in a normal distribution with the same sample size</span>
<span id="cb337-1902"><a href="#cb337-1902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1903"><a href="#cb337-1903" aria-hidden="true" tabindex="-1"></a>Note: it does not test how extreme an observation is relative to its distribution (i.e., leverage)</span>
<span id="cb337-1904"><a href="#cb337-1904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1907"><a href="#cb337-1907" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1908"><a href="#cb337-1908" aria-hidden="true" tabindex="-1"></a><span class="fu">outlierTest</span>(multipleRegressionModel)</span>
<span id="cb337-1909"><a href="#cb337-1909" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1910"><a href="#cb337-1910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1911"><a href="#cb337-1911" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observations with high leverage</span></span>
<span id="cb337-1912"><a href="#cb337-1912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1913"><a href="#cb337-1913" aria-hidden="true" tabindex="-1"></a>Identifies observations with high leverage (i.e., high hat values)</span>
<span id="cb337-1914"><a href="#cb337-1914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1915"><a href="#cb337-1915" aria-hidden="true" tabindex="-1"></a>hat values are an index of leverage (observations that are far from the center of the regressor space and have greater influence on OLS regression coefficients)</span>
<span id="cb337-1916"><a href="#cb337-1916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1919"><a href="#cb337-1919" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1920"><a href="#cb337-1920" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">hatvalues</span>(multipleRegressionModel))</span>
<span id="cb337-1921"><a href="#cb337-1921" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hatvalues</span>(multipleRegressionModel))</span>
<span id="cb337-1922"><a href="#cb337-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1923"><a href="#cb337-1923" aria-hidden="true" tabindex="-1"></a><span class="fu">influenceIndexPlot</span>(</span>
<span id="cb337-1924"><a href="#cb337-1924" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1925"><a href="#cb337-1925" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1926"><a href="#cb337-1926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1927"><a href="#cb337-1927" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(</span>
<span id="cb337-1928"><a href="#cb337-1928" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1929"><a href="#cb337-1929" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>) <span class="co"># circle size is proportional to Cook's Distance</span></span>
<span id="cb337-1930"><a href="#cb337-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1931"><a href="#cb337-1931" aria-hidden="true" tabindex="-1"></a><span class="fu">leveragePlots</span>(</span>
<span id="cb337-1932"><a href="#cb337-1932" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1933"><a href="#cb337-1933" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1934"><a href="#cb337-1934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1935"><a href="#cb337-1935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1936"><a href="#cb337-1936" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observations with high influence (on OLS regression coefficients)</span></span>
<span id="cb337-1937"><a href="#cb337-1937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1938"><a href="#cb337-1938" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://cran.r-project.org/web/packages/olsrr/vignettes/influence_measures.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/T2TS-PZZ4&gt;</span>)</span>
<span id="cb337-1939"><a href="#cb337-1939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1942"><a href="#cb337-1942" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1943"><a href="#cb337-1943" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">influence.measures</span>(multipleRegressionModel)<span class="sc">$</span>infmat)</span>
<span id="cb337-1944"><a href="#cb337-1944" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1945"><a href="#cb337-1945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1946"><a href="#cb337-1946" aria-hidden="true" tabindex="-1"></a><span class="fu">### DFBETA {#dfbeta}</span></span>
<span id="cb337-1947"><a href="#cb337-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1950"><a href="#cb337-1950" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1951"><a href="#cb337-1951" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">dfbeta</span>(multipleRegressionModel))</span>
<span id="cb337-1952"><a href="#cb337-1952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1953"><a href="#cb337-1953" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">dfbeta</span>(multipleRegressionModel))</span>
<span id="cb337-1954"><a href="#cb337-1954" aria-hidden="true" tabindex="-1"></a><span class="fu">dfbetasPlots</span>(</span>
<span id="cb337-1955"><a href="#cb337-1955" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-1956"><a href="#cb337-1956" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-1957"><a href="#cb337-1957" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1958"><a href="#cb337-1958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1959"><a href="#cb337-1959" aria-hidden="true" tabindex="-1"></a><span class="fu">### DFFITS {#dffits}</span></span>
<span id="cb337-1960"><a href="#cb337-1960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1963"><a href="#cb337-1963" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1964"><a href="#cb337-1964" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">dffits</span>(multipleRegressionModel)[<span class="fu">order</span>(<span class="fu">dffits</span>(multipleRegressionModel), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])</span>
<span id="cb337-1965"><a href="#cb337-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1966"><a href="#cb337-1966" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">dffits</span>(multipleRegressionModel))</span>
<span id="cb337-1967"><a href="#cb337-1967" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dffits</span>(multipleRegressionModel))</span>
<span id="cb337-1968"><a href="#cb337-1968" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dffits</span>(multipleRegressionModel)[<span class="fu">order</span>(<span class="fu">dffits</span>(multipleRegressionModel), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])</span>
<span id="cb337-1969"><a href="#cb337-1969" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1970"><a href="#cb337-1970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1971"><a href="#cb337-1971" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cook's Distance {#cooksDistance}</span></span>
<span id="cb337-1972"><a href="#cb337-1972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1973"><a href="#cb337-1973" aria-hidden="true" tabindex="-1"></a>Observations that are both outlying (have a high residual from the regression line) and have high leverage (are far from the center of the regressor space) have high influence on the OLS regression coefficients.</span>
<span id="cb337-1974"><a href="#cb337-1974" aria-hidden="true" tabindex="-1"></a>An observation will have less influence if it lies on the regression line (not an outlier, i.e., has a low residual) or if it has low leverage (i.e., has a value near the center of a predictor's distribution).</span>
<span id="cb337-1975"><a href="#cb337-1975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1978"><a href="#cb337-1978" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1979"><a href="#cb337-1979" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel)[<span class="fu">order</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])</span>
<span id="cb337-1980"><a href="#cb337-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1981"><a href="#cb337-1981" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel))</span>
<span id="cb337-1982"><a href="#cb337-1982" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel))</span>
<span id="cb337-1983"><a href="#cb337-1983" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel)[<span class="fu">order</span>(<span class="fu">cooks.distance</span>(multipleRegressionModel), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])</span>
<span id="cb337-1984"><a href="#cb337-1984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-1985"><a href="#cb337-1985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1986"><a href="#cb337-1986" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Refit model removing values with high cook's distance</span></span>
<span id="cb337-1987"><a href="#cb337-1987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1990"><a href="#cb337-1990" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-1991"><a href="#cb337-1991" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1992"><a href="#cb337-1992" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1993"><a href="#cb337-1993" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-1994"><a href="#cb337-1994" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-1995"><a href="#cb337-1995" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>))</span>
<span id="cb337-1996"><a href="#cb337-1996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-1997"><a href="#cb337-1997" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-1998"><a href="#cb337-1998" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-1999"><a href="#cb337-1999" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2000"><a href="#cb337-2000" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-2001"><a href="#cb337-2001" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>))</span>
<span id="cb337-2002"><a href="#cb337-2002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2003"><a href="#cb337-2003" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-2004"><a href="#cb337-2004" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2005"><a href="#cb337-2005" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2006"><a href="#cb337-2006" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-2007"><a href="#cb337-2007" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>,<span class="dv">8472</span>))</span>
<span id="cb337-2008"><a href="#cb337-2008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2009"><a href="#cb337-2009" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-2010"><a href="#cb337-2010" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2011"><a href="#cb337-2011" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2012"><a href="#cb337-2012" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-2013"><a href="#cb337-2013" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>,<span class="dv">8472</span>,<span class="dv">6170</span>))</span>
<span id="cb337-2014"><a href="#cb337-2014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2015"><a href="#cb337-2015" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-2016"><a href="#cb337-2016" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2017"><a href="#cb337-2017" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2018"><a href="#cb337-2018" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-2019"><a href="#cb337-2019" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>,<span class="dv">8472</span>,<span class="dv">6170</span>,<span class="dv">6023</span>))</span>
<span id="cb337-2020"><a href="#cb337-2020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2021"><a href="#cb337-2021" aria-hidden="true" tabindex="-1"></a>multipleRegressionModel_7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb337-2022"><a href="#cb337-2022" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2023"><a href="#cb337-2023" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2024"><a href="#cb337-2024" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb337-2025"><a href="#cb337-2025" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2765</span>,<span class="dv">1371</span>,<span class="dv">2767</span>,<span class="dv">8472</span>,<span class="dv">6170</span>,<span class="dv">6023</span>,<span class="dv">2766</span>))</span>
<span id="cb337-2026"><a href="#cb337-2026" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-2027"><a href="#cb337-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2028"><a href="#cb337-2028" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Examine how much regression coefficients change when excluding influential observations</span></span>
<span id="cb337-2029"><a href="#cb337-2029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2032"><a href="#cb337-2032" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-2033"><a href="#cb337-2033" aria-hidden="true" tabindex="-1"></a><span class="fu">compareCoefs</span>(</span>
<span id="cb337-2034"><a href="#cb337-2034" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel,</span>
<span id="cb337-2035"><a href="#cb337-2035" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_2,</span>
<span id="cb337-2036"><a href="#cb337-2036" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_3,</span>
<span id="cb337-2037"><a href="#cb337-2037" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_4,</span>
<span id="cb337-2038"><a href="#cb337-2038" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_5,</span>
<span id="cb337-2039"><a href="#cb337-2039" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_6,</span>
<span id="cb337-2040"><a href="#cb337-2040" aria-hidden="true" tabindex="-1"></a>  multipleRegressionModel_7)</span>
<span id="cb337-2041"><a href="#cb337-2041" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-2042"><a href="#cb337-2042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2043"><a href="#cb337-2043" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examine how much regression coefficients change when using least trimmed squares (LTS) that is resistant to outliers</span></span>
<span id="cb337-2044"><a href="#cb337-2044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2047"><a href="#cb337-2047" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-2048"><a href="#cb337-2048" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(</span>
<span id="cb337-2049"><a href="#cb337-2049" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2050"><a href="#cb337-2050" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2051"><a href="#cb337-2051" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action=</span><span class="st">"na.exclude"</span>))</span>
<span id="cb337-2052"><a href="#cb337-2052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2053"><a href="#cb337-2053" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">ltsReg</span>(</span>
<span id="cb337-2054"><a href="#cb337-2054" aria-hidden="true" tabindex="-1"></a>  bpi_antisocialT2Sum <span class="sc">~</span> bpi_antisocialT1Sum <span class="sc">+</span> bpi_anxiousDepressedSum,</span>
<span id="cb337-2055"><a href="#cb337-2055" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb337-2056"><a href="#cb337-2056" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> <span class="st">"na.exclude"</span>))</span>
<span id="cb337-2057"><a href="#cb337-2057" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb337-2058"><a href="#cb337-2058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2059"><a href="#cb337-2059" aria-hidden="true" tabindex="-1"></a><span class="fu">### Resources</span></span>
<span id="cb337-2060"><a href="#cb337-2060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2061"><a href="#cb337-2061" aria-hidden="true" tabindex="-1"></a>Book: An <span class="in">`R`</span> Companion to Applied Regression</span>
<span id="cb337-2062"><a href="#cb337-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2063"><a href="#cb337-2063" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://people.duke.edu/~rnau/testing.htm&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/9CXH-GBSN&gt;</span>)</span>
<span id="cb337-2064"><a href="#cb337-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2065"><a href="#cb337-2065" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://www.statmethods.net/stats/rdiagnostics.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/7JX8-K6BY&gt;</span>)</span>
<span id="cb337-2066"><a href="#cb337-2066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2067"><a href="#cb337-2067" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://socserv.socsci.mcmaster.ca/jfox/Courses/Brazil-2009/index.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/4A2P-9S49&gt;</span>)</span>
<span id="cb337-2068"><a href="#cb337-2068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2069"><a href="#cb337-2069" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://en.wikipedia.org/wiki/Ordinary_least_squares#Assumptions&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/Q4NS-X8TJ&gt;</span>)</span>
<span id="cb337-2070"><a href="#cb337-2070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2071"><a href="#cb337-2071" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session Info</span></span>
<span id="cb337-2072"><a href="#cb337-2072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2075"><a href="#cb337-2075" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb337-2076"><a href="#cb337-2076" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb337-2077"><a href="#cb337-2077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2078"><a href="#cb337-2078" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb337-2079"><a href="#cb337-2079" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/DevPsyLab/DataAnalysis/edit/main/regression.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/blob/main/regression.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>